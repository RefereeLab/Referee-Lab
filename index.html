<!DOCTYPE html>
<html lang="it" class="dark">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYY47HJGR6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-PYY47HJGR6');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RefereeLab - Analytics</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        slate: { 850: '#151e2e', 900: '#0f172a', 950: '#020617' },
                        brand: { gold: '#EAB308' }
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(0, 0, 0, 0.3)',
                    }
                }
            }
        }
    </script>

    <style>
        /* FIX 1: Prevent horizontal overflow/scrolling on mobile/tablet */
        html, body {
            overflow-x: hidden;
        }

        body {
            background-color: #020617;
            background-image:
                radial-gradient(circle at 15% 0%, rgba(30, 41, 59, 0.4) 0%, transparent 40%),
                radial-gradient(circle at 85% 0%, rgba(49, 46, 129, 0.2) 0%, transparent 40%);
            background-attachment: fixed;
            color: #e2e8f0;
        }

        /* Glassmorphism */
        .glass-panel {
            background: rgba(17, 24, 39, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
        }
        .glass-header {
            background: rgba(2, 6, 23, 0.85);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }

        /* Typography */
        .tabular-nums { font-variant-numeric: tabular-nums; }

        /* UI Elements */
        .season-btn { transition: all 0.2s; border: 1px solid transparent; }
        .season-btn:hover { background: rgba(255, 255, 255, 0.03); }
        .season-btn.active { background: rgba(234, 179, 8, 0.1); border-color: rgba(234, 179, 8, 0.3); color: #fbbf24; }

        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%; background: #EAB308; cursor: pointer; margin-top: -6px; box-shadow: 0 0 0 4px rgba(2, 6, 23, 1); }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px; }

        .toggle-checkbox:checked { right: 0; border-color: #EAB308; }
        .toggle-checkbox:checked + .toggle-label { background-color: rgba(234, 179, 8, 0.8); }

        /* Table & Sticky */
        #mainTable tr { transition: background-color 0.1s ease; }
        #mainTable tbody tr:hover { background-color: rgba(255,255,255,0.03); }

        /* Sticky Column Logic - Solid Backgrounds to prevent overlap transparency issues */
        .sticky-col-head { position: sticky; left: 0; z-index: 30; background-color: #0f172a; box-shadow: 4px 0 8px -2px rgba(0,0,0,0.3); }

        /* The sticky body column uses a SINGLE solid color (matching body) */
        .sticky-col-body {
            position: sticky;
            left: 0;
            z-index: 20;
            background-color: #020617; /* Solid color matching body */
            border-right: 1px solid rgba(255,255,255,0.05);
        }

        /* Ensure the hover effect works on sticky col too */
        tr:hover .sticky-col-body { background-color: #1e293b; }

        /* Accordion Animation */
        .details-row { display: none; background: rgba(0,0,0,0.2) !important; }
        .details-row.open { display: table-row; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Match Card */
        .match-card { background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%); border: 1px solid rgba(255,255,255,0.05); border-radius: 6px; }

        .nav-switcher-btn.active { background-color: #EAB308; color: #000; font-weight: 600; box-shadow: 0 0 15px rgba(234, 179, 8, 0.3); }
        .nav-switcher-btn { color: #94a3b8; }

        /* Loading Pulse */
        @keyframes pulse-light {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse-light { animation: pulse-light 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }

        /* New: Designations Modal Styles */
        #designations-modal {
            transition: transform 0.3s ease-in-out;
            transform: translateX(100%);
        }
        #designations-modal.open {
            transform: translateX(0);
        }
    </style>
</head>
<body class="font-sans antialiased min-h-screen flex flex-col selection:bg-yellow-500/30 selection:text-yellow-200 text-slate-300">

    <!-- Designations Modal (Mobile only) -->
    <div id="designations-modal" class="fixed inset-0 z-[60] bg-slate-950/95 backdrop-blur-xl lg:hidden">
        <div class="h-16 flex items-center px-4 border-b border-white/10 bg-slate-900/80">
            <button onclick="toggleDesignationsModal(false)" class="text-slate-400 hover:text-white transition-colors flex items-center gap-2 text-sm font-bold uppercase tracking-wider">
                <i class="fa-solid fa-arrow-left"></i> <span class="hidden sm:inline">Torna</span>
            </button>
            <h2 class="ml-auto text-white font-bold text-lg tracking-wide">DESIGNAZIONI</h2>
        </div>

        <!-- Contenuto delle designazioni -->
        <div class="p-4 overflow-y-auto h-[calc(100vh-4rem)]">
            <div id="designations-content" class="space-y-4">
                <div class="glass-panel rounded-xl p-3 border border-white/30">
                    <div class="pb-2 border-b border-white/30 mb-3 flex flex-col">
                        <h3 class="text-white font-bold text-lg tracking-wide mb-1">PROSSIMA GIORNATA <span class="text-red-600 font-bold"> (Novità)</span></h3>
                        <span class="text-yellow-500 font-mono text-base font-bold uppercase tracking-wider">13ª Giornata</span>
                    </div>

                    <div class="flex flex-col gap-y-3 text-xs">
                        <!-- ESEMPIO SINGOLA PARTITA (MANTENUTO SOLO COME STRUTTURA) -->
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">COMO-SASSUOLO</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Marchetti</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Ghersini</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">GENOA-VERONA</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Fabbri</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Mazzoleni</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">PARMA-UDINESE</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Piccinini</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Prontera</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">JUVENTUS-CAGLIARI</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Crezzini</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Di Bello</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">MILAN-LAZIO</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Collu</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Di Paolo</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">LECCE-TORINO</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Mariani</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Marini</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">PISA-INTER</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Guida</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Paterna</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">ATALANTA-FIORENTINA</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Marcenaro</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Camplone</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">ROMA-NAPOLI</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Massa</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Aureliano</span></div>
                            </div>
                        </div>
                        <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                            <div class="text-black font-bold bg-[#39FF14] text-center py-1">BOLOGNA-CREMONESE</div>
                            <div class="p-2">
                                <div class="flex flex-col items-start text-sm mt-0.1">
                                    <div class="text-[#39FF14] font-medium text-lg mb-1">ARB: Feliciani</div>
                                </div>
                                <div class="text-violet-200 font-medium text-sm">VAR: <span class="text-violet-200 font-medium">Gariglio</span></div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Navbar -->
    <nav class="glass-header sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2 sm:gap-3 cursor-pointer group" onclick="window.location.reload()">
                    <div class="hidden sm:flex w-7 h-7 sm:w-8 sm:h-8 rounded bg-gradient-to-br from-yellow-400 to-yellow-600 items-center justify-center text-slate-900 shadow-glow group-hover:scale-105 transition-transform">
                        <i class="fa-solid fa-whistle rotate-[-20deg] text-xs sm:text-sm"></i>
                    </div>
                    <div class="flex flex-col">
                        <span class="font-bold text-base sm:text-lg tracking-tight text-white leading-none">Referee<span class="text-yellow-500">Lab</span></span>
                        <span class="text-[9px] sm:text-[10px] uppercase tracking-widest text-slate-500 font-medium">Analytics</span>
                    </div>
                </div>

                <!-- NEW: Nav buttons layout adjusted to prevent overflow on mobile -->
                <div class="flex items-center bg-slate-900/80 rounded-full p-1 border border-white/10 w-full max-w-full justify-between sm:justify-start mx-2 sm:mx-4 sm:w-auto sm:max-w-none">
                    <button onclick="switchView('stats')" id="nav-stats" class="nav-switcher-btn active flex-1 justify-center px-2 sm:px-4 py-1.5 rounded-full text-[9px] sm:text-xs uppercase tracking-wider flex items-center gap-1 transition-all">
                        <i class="fa-solid fa-chart-simple"></i> <span class="inline">Stats</span>
                    </button>
                    <button onclick="switchView('playingTime')" id="nav-time" class="nav-switcher-btn flex-1 justify-center px-2 sm:px-4 py-1.5 rounded-full text-[9px] sm:text-xs uppercase tracking-wider flex items-center gap-1 transition-all">
                        <i class="fa-solid fa-stopwatch"></i> <span class="inline">Tempo</span>
                    </button>
                    <button onclick="switchView('matches')" id="nav-matches" class="nav-switcher-btn flex-1 justify-center px-2 sm:px-4 py-1.5 rounded-full text-[9px] sm:text-xs uppercase tracking-wider flex items-center gap-1 transition-all">
                        <i class="fa-solid fa-futbol"></i> <span>Partite</span>
                    </button>
                    <!-- NEW: Designations Button for Mobile/Tablet - takes up minimal space on mobile -->
                    <button onclick="toggleDesignationsModal(true)" id="nav-designations-mobile" class="lg:hidden nav-switcher-btn flex-1 justify-center px-2 sm:px-4 py-1.5 rounded-full text-[9px] sm:text-xs uppercase tracking-wider flex items-center gap-1 transition-all text-red-400 hover:text-red-500">
                        <i class="fa-solid fa-calendar-check"></i> <span class="hidden sm:inline">Design.</span>
                        <span class="inline sm:hidden">Des.</span> <!-- Abbreviation for small screens -->
                    </button>
                </div>

                <div class="hidden sm:flex items-center gap-4">
                    <a href="https://instagram.com/reflab25" target="_blank" class="text-slate-400 hover:text-pink-500 transition-colors">
                        <i class="fa-brands fa-instagram text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content-wrapper" class="flex-grow max-w-7xl mx-auto px-2 sm:px-6 lg:px-8 py-6 w-full">

        <div class="grid grid-cols-1 lg:grid-cols-6 gap-6 mb-6">

            <!-- Controls -->
            <div class="lg:col-span-1 space-y-4 sm:space-y-6">
                <div class="glass-panel rounded-xl p-4 sm:p-5 space-y-4 sm:space-y-6">
                    <div>
                        <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2 block">Cerca</label>
                        <div class="group flex items-center w-full bg-slate-900/60 border border-slate-700 rounded-lg focus-within:ring-1 focus-within:ring-yellow-500 transition-all overflow-hidden">
                            <div class="pl-3 py-2 sm:py-2.5 text-slate-500 group-focus-within:text-yellow-500 transition-colors flex-shrink-0">
                                <i class="fa-solid fa-magnifying-glass"></i>
                            </div>
                            <input type="text" id="searchInput" oninput="handleSearch()" placeholder="Cerca..." class="w-full bg-transparent border-none text-white text-xs sm:text-sm p-2 sm:p-2.5 focus:ring-0 outline-none placeholder-slate-500">
                        </div>
                    </div>

                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Stagione</label>
                            <button onclick="toggleAllSeasons()" class="text-[10px] text-yellow-500 hover:text-white uppercase font-bold tracking-wider transition-colors">Tutte</button>
                        </div>
                        <div class="grid grid-cols-2 lg:grid-cols-1 gap-1" id="season-buttons">
                            <!-- Buttons generated by JS or static -->
                            <button onclick="toggleSeason('2025-26')" id="btn-2025-26" class="season-btn active px-3 py-2 rounded-lg text-xs sm:text-sm font-medium text-slate-300 w-full text-left flex justify-between items-center" data-season="2025-26">
                                <span class="font-mono">2025/26</span> <i class="fa-solid fa-check text-xs opacity-0 check-icon"></i>
                            </button>
                            <button onclick="toggleSeason('2024-25')" id="btn-2024-25" class="season-btn px-3 py-2 rounded-lg text-xs sm:text-sm font-medium text-slate-300 w-full text-left flex justify-between items-center" data-season="2024-25">
                                <span class="font-mono">2024/25</span> <i class="fa-solid fa-check text-xs opacity-0 check-icon"></i>
                            </button>
                            <button onclick="toggleSeason('2023-24')" id="btn-2023-24" class="season-btn px-3 py-2 rounded-lg text-xs sm:text-sm font-medium text-slate-300 w-full text-left flex justify-between items-center" data-season="2023-24">
                                <span class="font-mono">2023/24</span> <i class="fa-solid fa-check text-xs opacity-0 check-icon"></i>
                            </button>
                            <button onclick="toggleSeason('2022-23')" id="btn-2022-23" class="season-btn px-3 py-2 rounded-lg text-xs sm:text-sm font-medium text-slate-300 w-full text-left flex justify-between items-center" data-season="2022-23">
                                <span class="font-mono">2022/23</span> <i class="fa-solid fa-check text-xs opacity-0 check-icon"></i>
                            </button>
                            <button onclick="toggleSeason('2021-22')" id="btn-2021-22" class="season-btn px-3 py-2 rounded-lg text-xs sm:text-sm font-medium text-slate-300 w-full text-left flex justify-between items-center" data-season="2021-22">
                                <span class="font-mono">2021/22</span> <i class="fa-solid fa-check text-xs opacity-0 check-icon"></i>
                            </button>
                            <button onclick="toggleSeason('2020-21')" id="btn-2020-21" class="season-btn px-3 py-2 rounded-lg text-xs sm:text-sm font-medium text-slate-300 w-full text-left flex justify-between items-center" data-season="2020-21">
                                <span class="font-mono">2020/21</span> <i class="fa-solid fa-check text-xs opacity-0 check-icon"></i>
                            </button>
                        </div>
                    </div>

                    <div id="stats-controls" class="space-y-4 sm:space-y-5">
                        <div class="flex items-center justify-between py-2 border-t border-white/5">
                            <label class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Nascondi Inattivi</label>
                            <div class="relative inline-block w-9 h-5 align-middle select-none">
                                <input type="checkbox" name="toggle" id="toggleInactive" onclick="toggleInactiveRefs()" class="toggle-checkbox absolute block w-3 h-3 m-1 rounded-full bg-white appearance-none cursor-pointer transition-all duration-300 left-0 top-0 z-10"/>
                                <label for="toggleInactive" class="toggle-label block overflow-hidden h-5 rounded-full bg-slate-700 cursor-pointer border border-slate-600 transition-colors"></label>
                            </div>
                        </div>

                        <div class="bg-slate-900/40 p-3 rounded-lg border border-white/5">
                            <div class="flex justify-between items-center mb-3">
                                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Min. Presenze</span>
                                <span id="minMatchesValue" class="text-yellow-500 font-mono font-medium text-sm">0</span>
                            </div>
                            <input type="range" id="minMatches" min="0" max="10" value="0" step="1" oninput="updateMinMatches(this.value)">
                        </div>
                    </div>
                </div>

                <!-- FIX 3: Hide insights card on small screens -->
                <div id="insights-container" class="flex flex-col gap-3 hidden sm:flex"></div>
            </div>

            <!-- Main Data Table -->
            <div id="main-content-col" class="lg:col-span-4 flex flex-col gap-6">
                <div class="glass-panel rounded-xl overflow-hidden shadow-glass relative min-h-[500px] flex flex-col">

                    <!-- Dynamic Headers -->
                    <div id="playing-time-title" class="hidden w-full relative py-4 sm:py-5 border-b border-white/5 bg-slate-900/30 flex items-center justify-center backdrop-blur-sm flex-col">
                         <div class="w-full flex items-center justify-center relative">
                             <button onclick="switchView('stats')" class="absolute left-2 sm:left-4 text-slate-400 hover:text-white transition-colors flex items-center gap-2 text-[10px] sm:text-xs font-bold uppercase tracking-wider px-2 sm:px-3 py-1.5 rounded-lg border border-transparent hover:border-white/10 hover:bg-white/5">
                                 <i class="fa-solid fa-arrow-left"></i> <span class="hidden sm:inline">Stats</span>
                             </button>
                             <div class="text-center">
                                <h2 class="text-lg sm:text-2xl font-bold text-white tracking-tight">Tempo <span class="text-green-400 font-light">Effettivo</span></h2>
                                <p class="text-slate-500 text-[10px] uppercase tracking-widest mt-0.5 font-medium">Analisi Minutaggio</p>
                            </div>
                             <button onclick="switchView('matches')" class="absolute right-2 sm:right-4 text-slate-400 hover:text-white transition-colors flex items-center gap-2 text-[10px] sm:text-xs font-bold uppercase tracking-wider px-2 sm:px-3 py-1.5 rounded-lg border border-transparent hover:border-white/10 hover:bg-white/5">
                                 <span class="hidden sm:inline">Partite</span> <i class="fa-solid fa-arrow-right"></i>
                             </button>
                         </div>
                    </div>

                    <div id="matches-title" class="hidden w-full relative py-4 sm:py-5 border-b border-white/5 bg-slate-900/30 flex items-center justify-center backdrop-blur-sm flex-col">
                        <div class="w-full flex items-center justify-center relative">
                            <button onclick="switchView('playingTime')" class="absolute left-2 sm:left-4 text-slate-400 hover:text-white transition-colors flex items-center gap-2 text-[10px] sm:text-xs font-bold uppercase tracking-wider px-2 sm:px-3 py-1.5 rounded-lg border border-transparent hover:border-white/10 hover:bg-white/5">
                                 <i class="fa-solid fa-arrow-left"></i> <span class="hidden sm:inline">T. Eff</span>
                             </button>
                             <div class="text-center">
                                <h2 class="text-lg sm:text-2xl font-bold text-white tracking-tight">Elenco <span class="text-blue-400 font-light">Partite</span></h2>
                                <p class="text-slate-500 text-[10px] uppercase tracking-widest mt-0.5 font-medium">Database Completo</p>
                            </div>
                        </div>
                    </div>

                    <!-- Avviso aggiornamento (STATISTICHE e PARTITE) -->
                    <div id="update-alert-2526" class="hidden w-full bg-blue-500/10 border-b border-blue-500/10 p-2 text-center">
                        <p class="text-[10px] sm:text-xs text-blue-300 font-mono"><i class="fa-solid fa-circle-info mr-2"></i>Dati aggiornati alla 12ª giornata.</p>
                    </div>

                    <!-- Main Table -->
                    <div class="overflow-x-auto flex-grow scrollbar-hide">
                        <table class="w-full text-left text-slate-300" id="mainTable">
                            <thead class="text-[9px] sm:text-[10px] md:text-xs text-slate-400 uppercase bg-slate-900/90 border-b border-white/5 sticky top-0 z-40 backdrop-blur-md" id="tableHeader"></thead>
                            <tbody id="tableBody" class="divide-y divide-white/5 font-mono text-[10px] sm:text-xs md:text-sm"></tbody>
                            <!-- FIX: Footer Styling Updated -->
                            <tfoot class="bg-slate-800 border-t-2 border-white/20 font-medium text-white backdrop-blur-md sticky bottom-0 z-40" id="tableFooter"></tfoot>
                        </table>

                        <!-- Empty State for historic data -->
                        <div id="empty-state-msg" class="hidden flex flex-col items-center justify-center h-64 text-slate-500">
                            <i class="fa-solid fa-database text-3xl sm:text-4xl mb-4 opacity-50"></i>
                            <p class="text-xs sm:text-sm uppercase tracking-widest">Dati in arrivo per questa stagione</p>
                        </div>

                        <!-- Historical Data Message (NEW) -->
                        <div id="historical-data-msg" class="hidden flex flex-col items-center justify-center h-80 text-center px-4">
                            <div class="relative mb-6">
                                <i class="fa-solid fa-clock-rotate-left text-4xl sm:text-5xl text-slate-600"></i>
                                <div class="absolute -top-1 -right-1 w-2 h-2 sm:w-3 sm:h-3 bg-yellow-500 rounded-full animate-pulse"></div>
                            </div>
                            <h3 class="text-base sm:text-lg font-bold text-white mb-2 tracking-wide" id="historical-msg-title">Dati Stagione in arrivo</h3>
                            <p class="text-xs sm:text-sm text-slate-400 max-w-sm leading-relaxed">Stiamo elaborando i dati storici per questa stagione. Saranno disponibili a breve.</p>
                        </div>
                    </div>

                    <!-- Disclaimer Footer 25/26 (TEMPO EFFETTIVO e PARTITE) -->
                    <div id="disclaimer-2526" class="hidden w-full border-t border-white/5 bg-slate-900/50 p-3">
                        <div class="flex items-start justify-center gap-2 text-amber-500/90 text-[10px] sm:text-xs bg-amber-500/10 border border-amber-500/10 rounded-md p-2 text-center">
                            <i class="fa-solid fa-triangle-exclamation mt-0.5"></i>
                            <span>Attenzione: non tutti i dati sul tempo effettivo della stagione 2025/26 sono stati comunicati regolarmente dalla Lega Serie A.</span>
                        </div>
                    </div>
                </div>
            </div>

<!-- Designations -->
<div class="hidden lg:block lg:col-span-1 space-y-6">
    <div class="glass-panel rounded-xl p-2 border border-white/30">
        <div class="pb-0.1 border-b border-white/30 mb-2 flex flex-col">
            <h3 class="text-white font-bold text-sm tracking-wide mb-1">DESIGNAZIONI <span class="text-red-600 font-bold"> (Novità)</span></h3>
            <span class="text-yellow-500 font-mono text-[14px] font-bold uppercase tracking-wider">13ª Giornata</span>
        </div>

        <div class="flex flex-col gap-y-1 text-xs"> 
            
            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">COMO-SASSUOLO</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Marchetti</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Ghersini</span></div>
                </div>
            </div>

            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">GENOA-VERONA</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Fabbri</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Mazzoleni</span></div>
                </div>
            </div>
            
            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">PARMA-UDINESE</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Piccinini</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Prontera</span></div>
                </div>
            </div>

            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">JUVENTUS-CAGLIARI</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Crezzini</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Di Bello</span></div>
                </div>
            </div>

            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">MILAN-LAZIO</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Collu</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Di Paolo</span></div>
                </div>
            </div>

            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">LECCE-TORINO</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Mariani</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Marini</span></div>
                </div>
            </div>

            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">PISA-INTER</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Guida</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Paterna</span></div>
                </div>
            </div>

            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">ATALANTA-FIORENTINA</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Marcenaro</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Camplone</span></div>
                </div>
            </div>

            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">ROMA-NAPOLI</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Massa</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Aureliano</span></div>
                </div>
            </div>

            <div class="match-card overflow-hidden rounded-xl hover:bg-white/5 transition-colors border border-[#39FF14]/40">
                <div class="text-black font-bold bg-[#39FF14] text-center py-1">BOLOGNA-CREMONESE</div>
                <div class="p-1.5"> 
                    <div class="flex flex-col items-start text-[11px] mt-0.1">
                        <div class="text-[#39FF14] font-medium text-sm mb-0.2">ARB: Feliciani</div>
                    </div>
                    <div class="text-violet-200 font-medium ">VAR: <span class="text-violet-200 font-medium">Gariglio</span></div>
                </div>
            </div>
        </div>
    </div>
</div>
        </div> <div class=" inset-x-0 bottom-0 border-t border-white/5 pt-6 pb-6 text-center text-slate-500 text-xs bg-slate-950/90 z-40 backdrop-blur-sm">
            <p>Dati elaborati da fonti pubbliche. © 2025 RefereeLab</p>
        </div>
    </main>

    <script>
        // --- DATA SECTION ---

        const MATCHES_DB_2425 = `Genoa-Inter	103,10	46,39	45,0%	29
Parma-Fiorentina	97,04	48,46	49,9%	24
Empoli-Monza	100,37	44,43	44,3%	35
Milan-Torino	101,58	58,27	57,4%	17
Bologna-Udinese	100,25	48,59	48,5%	28
Verona-Napoli	101,32	48,53	47,9%	28
Cagliari-Roma	94,22	53,36	56,6%	22
Lazio-Venezia	96,00	56,00	58,3%	25
Lecce-Atalanta	92,58	54,12	58,5%	34
Juventus-Como	99,04	56,43	57,0%	23
Parma-Milan	98,04	59,00	60,2%	22
Udinese-Lazio	103,14	49,49	48,0%	25
Inter-Lecce	98,08	56,21	57,3%	21
Monza-Genoa	105,55	56,58	53,6%	23
Torino-Atalanta	103,21	51,08	49,5%	25
Fiorentina-Venezia	97,03	55,29	57,0%	34
Napoli-Bologna	101,09	53,23	52,7%	28
Roma-Empoli	97,20	58,22	59,9%	21
Cagliari-Como	100,35	53,12	52,9%	22
Verona-Juventus	97,02	61,58	63,5%	16
Venezia-Torino	99,08	52,45	52,9%	22
Inter-Atalanta 	97,01	53,40	55,0%	21
Bologna-Empoli 	103,12	55,44	53,8%	33
Lecce-Cagliari	100,37	47,36	47,2%	23
Lazio-Milan	97,00	54,06	55,7%	21
Napoli-Parma	109,08	60,21	55,2%	18
Fiorentina-Monza	103,20	54,53	52,8%	32
Genoa-Verona	99,33	51,32	51,7%	24
Juventus-Roma	96,58	58,50	60,6%	23
Udinese-Como	103,30	54,24	52,5%	25
Como-Bologna	103,14	54,03	52,4%	29
Empoli-Juventus	95,14	60,04	63,1%	21
Milan-Venezia	97,55	57,21	58,6%	24
Genoa-Roma	104,11	53,12	51,0%	21
Atalanta-Fiorentina	95,42	51,04	53,5%	31
Torino-Lecce	95,10	54,31	57,1%	26
Cagliari-Napoli	102,10	50,07	49,0%	33
Monza-Inter	95,18	57,28	60,2%	30
Parma-Udinese	96,05	53,01	55,2%	26
Lazio-Verona	96,07	56,25	58,6%	23
Cagliari-Empoli	97,05	48,44	49,9%	36
Verona-Torino	97,05	60,20	62,0%	18
Venezia-Genoa	100,20	48,20	48,1%	21
Juventus-Napoli	96,26	64,10	66,6%	23
Lecce-Parma	98,37	54,32	55,2%	33
Fiorentina-Lazio	97,15	52,35	53,9%	26
Monza-Bologna	95,05	55,34	58,2%	36
Roma-Udinese	95,00	55,33	58,2%	26
Inter-Milan	97,50	55,33	56,7%	17
Atalanta-Como	98,35	58,21	59,2%	29
Milan-Lecce	96,02	55,41	57,7%	13
Udinese-Inter	98,00	61,58	62,8%	19
Genoa-Juventus	95,10	58,44	61,5%	22
Bologna-Atalanta	97,44	57,29	58,8%	28
Torino-Lazio	96,10	57,06	59,4%	23
Como-Verona	96,57	49,47	51,2%	29
Roma-Venezia	96,08	52,36	54,5%	21
Empoli-Fiorentina	94,11	54,28	57,7%	27
Napoli-Monza	95,57	60,33	63,1%	24
Parma-Cagliari	95,58	55,21	57,8%	26
Napoli-Como	96,28	59,25	61,5%	17
Verona-Venezia	95,02	47,29	49,8%	15	
Udinese-Lecce	95,50	55,10	57,7%	28
Atalanta-Genoa	95,55	55,41	58,0%	24
Inter-Torino	98,30	54,09	55,0%	15
Juventus-Cagliari	99,01	60,08	60,7%	23
Bologna-Parma	95,58	54,55	57,1%	31
Lazio-Empoli	100,48	53,07	52,8%	27
Monza-Roma	99,08	56,25	56,8%	29
Fiorentina-Milan	97,26	48,43	49,8%	33
Como-Parma	96,09	60,51	63,0%	24
Genoa-Bologna	95,51	47,58	49,8%	32
Milan-Udinese	106,27	52,59	49,5%	17
Juventus-Lazio	97,31	56,44	58,0%	25
Empoli-Napoli	96,05	51,43	53,5%	27
Lecce-Fiorentina	93,03	53,12	57,1%	22
Venezia-Atalanta	94,10	54,15	57,5%	18
Cagliari-Torino	96,35	52,53	54,5%	17
Roma-Inter	97,00	59,00	60,8%	25
Verona-Monza	94,00	54,17	57,6%	21
Udinese-Cagliari	94,51	54,38	57,5%	22
Torino-Como	97,40	55,42	56,9%	25
Napoli-Lecce	96,27	52,02	54,0%	20
Bologna-Milan	96,21	53,33	55,4%	28
Atalanta-Verona	91,25	58,27	63,9%	18
Parma-Empoli	95,45	55,33	58,0%	29
Lazio-Genoa	96,07	57,36	59,7%	18
Monza-Venezia	95,57	49,01	51,3%	33
Inter-Juventus	95,12	52,00	54,7%	27
Fiorentina-Roma	94,27	55,39	58,8%	24	
Cagliari-Bologna	94,25	55,29	58,7%	35
Lecce-Verona	98,15	49,06	50,0%	35
Milan-Napoli	96,55	60,55	62,7%	20
Empoli-Inter	96,01	55,51	57,8%	25
Venezia-Udinese	97,22	49,10	50,5%	21
Atalanta-Monza	96,20	57,39	59,7%	25
Juventus-Parma	95,30	61,18	64,2%	12
Genoa-Fiorentina	98,09	52,02	53,0%	23
Como-Lazio	97,44	50,20	51,5%	32
Roma-Torino	95,15	59,29	62,3%	26
Bologna-Lecce	95,25	50,36	52,9%	23
Udinese-Juventus	96,07	55,50	57,8%	26
Monza-Milan	98,17	56,22	57,3%	33
Napoli-Atalanta	96,00	62,27	64,9%	18
Torino-Fiorentina	97,17	59,23	61,0%	28
Verona-Roma	97,43	53,58	55,0%	27
Inter-Venezia	99,15	55,55	56,0%	29
Empoli-Como	96,10	54,05	56,2%	26
Parma-Genoa	97,16	51,42	52,9%	23
Lazio-Cagliari	96,13	54,05	56,2%	29
Genoa-Como	98,16	50,21	51,2%	32
Lecce-Empoli	97,00	51,23	52,8%	31
Venezia-Parma	95,15	57,06	60,0%	19
Cagliari-Milan	100,14	54,30	54,2%	18
Juventus-Torino	95,06	55,08	57,9%	21
Atalanta-Udinese	98,40	51,34	52,2%	22
Fiorentina-Verona	96,53	46,44	48,1%	20
Roma-Bologna	98,55	49,51	50,2%	37
Monza-Lazio	97,01	56,45	58,2%	23
Inter-Napoli	95,15	56,03	58,9%	27
Verona-Inter	93,00	65,30	70,2%	19
Milan-Juvenrus	95,40	59,45	62,3%	21
Parma-Atalanta	95,40	66,25	69,4%	14
Genoa-Cagliari	98,00	53,26	54,3%	18
Como-Fiorentina	97,00	55,23	56,9%	26
Torino-Monza	93,12	57,26	61,5%	30
Napoli-Roma	93,51	58,44	62,5%	17
Lazio-Bologna	94,57	55,30	58,5%	28
Empoli-Udinese	95,22	58,51	61,4%	21
Venezia-Lecce	96,01	56,21	58,5%	28
Cagliari-Verona	95,29	50,46	53,0%	22
Como-Monza	96,30	51,14	53,1%	27
Milan-Empoli	95,43	54,43	57,0%	28
Bologna-Venezia	96,14	49,35	51,3%	29
Udinese-Genoa	97,10	57,46	59,2%	24
Parma-Lazio	103,52	55,40	53,5%	30
Torino-Napoli	94,42	59,16	62,7%	24
Fiorentina-Inter	101,09	53,53	53,0%	21
Lecce-Juventus	95,05	62,25	65,5%	17
Roma-Atalanta	95,03	55,10	58,0%	30
Inter-Parma	95,00	55,37	58,3%	11
Atalanta-Milan	97,25	59,24	60,9%	27
Genoa-Torino	96,34	56,35	58,5%	27
Juventus-Bologna	98,03	52,19	53,2%	32
Roma-Lecce	97,28	55,05	56,6%	19
Fiorentina-Cagliari	96,03	53,17	55,4%	29
Verona-Empoli	97,20	54,48	56,0%	31
Venezia-Como	95,28	44,33	46,5%	22
Napoli-Lazio	98,45	58,47	59,4%	28
Monza-Udinese	97,10	53,45	55,0%	28
Empoli-Torino	95,04	49,22	51,8%	22
Cagliari-Atalanta	96,30	57,31	59,5%	26
Udinese-Napoli	97,00	51,56	53,2%	22
Juventus-Venezia	98,50	59,57	60,5%	17
Lecce-Monza	99,07	47,00	47,4%	31
Bologna-Fiorentina	96,02	48,30	50,3%	26
Parma-Verona	95,56	54,08	56,6%	21
Como-Roma	98,32	52,56	53,5%	35
Milan-Genoa	96,57	61,42	63,6%	23
Lazio-Inter	99,10	55,11	55,6%	21
Verona-Milan	99,21	54,44	54,9%	30
Torino-Bologna	101,15	56,57	55,9%	28
Genoa-Napoli	97,03	57,55	59,3%	16
Lecce-Lazio	100,19	56,47	56,4%	25
Roma-Parma	91,06	55,55	61,0%	19
Venezia-Cagliari	96,33	49,18	51,1%	17
Atalanta-Empoli	98,00	54,38	55,5%	26
Monza-Juventus	96,32	61,14	63,5%	20
Fiorentina-Udinese	100,55	53,21	52,9%	24
Inter-Como	94,10	52,23	55,5%	28
Empoli-Genoa	98,00	51,47	52,5%	29
Parma-Monza	100,00	48,53	48,5%	37
Cagliari-Inter	95,15	52,18	54,8%	19
Lazio-Atalanta	96,05	58,07	60,5%	17
Udinese-Torino	97,09	54,20	55,8%	29
Napoli-Venezia	95,30	54,07	56,7%	22
Juventus-Fiorentina	97,05	51,51	53,1%	23
Milan-Roma	96,05	51,06	53,2%	25
Como-Lecce	96,37	52,23	54,2%	27
Bologna-Verona	97,39	46,47	47,7%	33
Venezia-Empoli	94,56	51,16	54,1%	29
Fiorentina-Napoli	95,50	49,34	51,7%	32
Verona-Udinese	96,00	50,49	52,6%	30
Monza-Cagliari	99,18	48,31	48,7%	35
Lecce-Genoa	94,12	54,20	57,6%	26
Torino-Parma	97,10	59,17	60,9%	18
Roma-Lazio	97,15	53,25	54,8%	30
Como-Milan	95,10	50,49	53,1%	28
Atalanta-Juventus	97,45	64,13	65,8%	17
Inter-Bologna	96,05	52,32	54,5%	32
Lazio-Como	95,03	47,58	50,1%	29
Empoli-Lecce	98,34	49,09	49,9%	33
Udinese-Atalanta	97,38	58,41	60,0%	20
Torino-Juventus	96,58	60,08	62,2%	27
Milan-Cagliari	96,38	56,05	58,2%	20
Genoa-Parma	96,37	52,11	54,1%	20
Venezia-Inter	95,18	55,10	57,9%	33
Bologna-Roma	98,34	54,11	55,0%	28
Napoli-Verona	93,00	62,26	66,9%	11
Monza-Fiorentina	97,05	60,55	62,4%	35
Roma-Genoa	96,00	58,40	60,8%	24
Bologna-Monza	97,41	59,30	60,9%	34
Juventus-Milan	95,14	56,11	59,0%	30
Atalanta-Napoli	95,06	57,43	60,4%	27
Fiorentina-Torino	96,47	56,28	58,3%	27
Cagliari-Lecce	95,56	51,45	53,8%	21
Parma-Venezia	97,07	50,03	51,5%	29
Verona-Lazio	94,55	55,10	58,3%	18
Inter-Empoli	95,18	57,07	60,0%	20
Como-Udinese	95,57	51,13	53,5%	26
Torino-Cagliari	95,20	57,17	60,1%	21
Como-Atalanta	97,39	56,26	57,8%	25
Napoli-Juventus	97,37	54,14	55,6%	24
Empoli-Bologna	98,56	46,31	47,0%	38
Milan-Parma	99,11	52,02	52,5%	21
Udinese-Roma	99,57	56,19	56,4%	27
Lecce-Inter	93,56	57,11	61,0%	25
Lazio-Fiorentina	100,15	53,46	53,4%	21
Venezia-Verona	96,56	49,18	50,9%	30
Genoa-Monza	97,00	41,34	42,6%	32
Parma-Lecce	97,15	56,49	58,1%	22
Monza-Verona	95,47	53,12	55,6%	35
Udinese-Venezia	97,41	42,22	43,3%	29
Atalanta-Torino	101,01	63,01	62,4%	17
Bologna-Como	96,40	50,12	52,0%	34
Juventus-Empoli	95,12	45,47	47,8%	27
Fiorentina-Genoa	96,09	47,18	49,1%	31
Milan-Inter	98,05	58,36	59,5%	14
Roma-Napoli	96,44	57,50	59,6%	22
Cagliari-Lazio	96,15	55,09	57,3%	23
Como-Juventus	96,52	50,13	51,9%	30
Verona-Atalanta	93,51	56,03	59,9%	16
Empoli-Milan	98,38	48,47	49,3%	27
Torino-Genoa	98,42	57,33	58,3%	21
Venezia-Roma	95,45	53,23	55,8%	34
Cagliari-Parma	96,34	52,57	54,6%	26
Lazio-Monza	94,15	55,49	58,9%	22
Lecce-Bologna	100,17	52,43	52,3%	30
Napoli-Udinese	97,20	57,54	59,2%	21
Inter-Fiorentina	96,10	54,37	56,6%	31
Bologna-Torino	95,32	46,59	48,9%	24
Atalanta-Cagliari	95,19	64,30	67,5%	18
Lazio-Napoli	94,58	55,22	58,4%	28
Milan-Verona	96,20	49,24	51,2%	29
Fiorentina-Como	98,16	58,37	59,5%	38
Monza-Lecce	95,57	56,57	59,2%	28
Udinese-Empoli	95,06	52,19	54,9%	29
Parma-Roma	97,39	58,43	60,0%	16
Juventus-Inter	94,24	55,49	58,9%	27
Genoa-Venezia	93,59	45,50	48,6%	29
Lecce-Udinese	97,16	54,09	55,7%	26
Parma-Bologna	97,04	52,14	53,7%	27
Venezia-Lazio	96,59	56,03	58,0%	33
Torino-Milan	95,15	55,53	58,4%	19
Inter-Genoa	96,44	58,04	60,2%	21
Como-Napoli	96,45	52,35	54,3%	31
Verona-Fiorentina	98,57	51,57	52,3%	27
Empoli-Atalanta	94,57	51,29	54,2%	21
Cagliari-Juventus	96,00	60,44	63,0%	24
Roma-Monza	93,11	61,54	66,1%	13
Fiorentina-Lecce	98,25	54,37	55,3%	22
Atalanta-Venezia	96,53	59,11	61,2%	26
Napoli-Inter	99,30	52,11	52,5%	22
Udinese-Parma	97,32	57,58	59,2%	22
Monza-Torino	93,56	56,28	60,2%	30
Bologna-Cagliari	96,19	51,33	53,4%	39
Genoa-Empoli	96,53	47,28	49,0%	30
Roma-Como	94,57	61,34	64,9%	24
Milan-Lazio	101,13	57,54	56,9%	20
Juventus-Verona	97,43	55,31	56,8%	22
Cagliari-Genoa	96,07	50,53	52,6%	31
Como-Venezia	96,12	51,43	53,5%	25
Parma-Torino	96,32	46,27	48,0%	31
Lecce-Milan	99,34	52,03	52,4%	20
Inter-Monza	98,52	57,48	58,3%	15
Verona-Bologna	96,23	56,41	58,6%	34
Napoli-Fiorentina	96,52	59,57	61,7%	15
Empoli-Roma	96,05	60,45	62,9%	22
Juventus-Atalanta	94,15	57,31	60,9%	23
Lazio-Udinese	97,05	59,55	61,4%	20
Genoa-Lecce	98,10	51,18	52,2%	22
Monza-Parma	94,56	56,25	59,5%	30
Udinese-Verona	94,02	56,15	59,7%	37
Milan-Como	99,27	51,46	51,8%	28
Torino-Empoli	100,23	46,00	45,9%	21
Venezia-Napoli	100,02	48,55	48,5%	27
Bologna-Lazio	94,55	54,15	57,3%	34
Roma-Cagliari	99,22	60,28	60,8%	16
Fiorentina-Juventus	93,14	52,43	56,3%	22
Atalanta-Inter	103,06	54,31	52,7%	25
Como-Empoli	96,34	52,17	54,2%	27
Venezia-Bologna	95,58	53,24	55,7%	35
Juventus-Genoa	94,56	54,24	57,4%	24
Lecce-Roma	97,25	51,33	52,8%	17
Cagliari-Monza	95,57	50,35	52,7%	28
Fiorentina-Atalanta	97,34	55,08	56,6%	23
Inter-Udinese	98,25	55,26	56,2%	22
Napoli-Milan	97,10	59,08	60,8%	15
Verona-Parma	96,29	51,46	53,4%	20
Lazio-Torino	97,50	54,35	55,7%	29
Genoa-Udinese	96,33	54,22	56,3%	30
Monza-Como	95,52	58,00	60,7%	40
Parma-Inter	97,28	57,35	59,0%	16
Milan-Fiorentina	99,07	53,20	53,7%	24
Lecce-Venezia	95,06	44,36	46,7%	24
Empoli-Cagliari	95,00	45,56	48,0%	24
Torino-Verona	96,20	52,10	54,2%	28
Atalanta-Lazio	98,36	60,27	61,3%	12
Roma-Juventus	94,26	61,47	65,2%	26
Bologna-Napoli	98,46	51,14	51,9%	29
Udinese-Milan	96,01	57,21	59,6%	19
Venezia-Monza	100,45	45,52	45,3%	40
Inter-Cagliari	95,55	61,00	63,8%	18
Juventus-Lecce	96,28	55,04	57,2%	17
Atalanta-Bologna	100,02	52,31	52,3%	29
Fiorentina-Parma	95,10	59,22	62,3%	29
Verona-Genoa	96,18	46,55	48,4%	30
Como-Torino	97,30	55,02	56,5%	25
Lazio-Roma	96,24	49,34	51,3%	24
Napoli-Empoli	94,02	54,09	57,5%	23
Lecce-Como	100,53	46,22	46,0%	32
Monza-Napoli	94,19	56,00	59,5%	29
Roma-Verona	93,58	54,09	57,8%	22
Empoli-Venezia	95,32	44,36	46,5%	33
Bologna-Inter	98,55	50,02	50,8%	33
Milan-Atalanta	95,50	62,56	65,5%	15
Torino-Udinese	95,07	53,25	56,0%	24
Cagliari-Fiorentina	100,56	53,48	53,2%	30
Genoa-Lazio	102,15	55,47	54,3%	26
Parma-Juventus	100,20	58,32	58,2%	19
Atalanta-Lecce	99,02	56,54	57,1%	18
Como-Genoa	96,15	54,58	56,8%	34
Venezia-Milan	98,56	52,47	53,2%	27
Fiorentina-Empoli	99,14	48,14	48,6%	34
Inter-Roma	97,22	58,15	59,8%	20
Juventus-Monza	97,00	55,31	57,0%	22
Napoli-Torino	97,54	58,59	60,1%	18
Udinese-Bologna	95,52	47,37	49,6%	31
Verona-Cagliari	97,01	51,05	52,6%	23
Lazio-Parma	98,08	60,08	61,3%	23
Torino-Venezia	100,00	53,17	53,2%	25
Cagliari-Udinese	97,49	55,29	56,7%	20
Parma-Como	96,02	50,20	52,3%	30
Lecce-Napoli	105,14	58,14	55,3%	15
Inter-Verona	95,25	61,36	64,4%	17
Empoli-Lazio	98,03	55,18	56,3%	24
Monza-Atalanta	94,45	57,35	60,7%	19
Roma-Fiorentina	101,34	63,43	62,6%	17
Bologna-Juventus	98,06	45,42	46,3%	25
Genoa-Milan	98,17	52,54	53,5%	26
Milan-Bologna	97,45	56,48	58,0%	19
Como-Cagliari	100,35	54,24	54,1%	24
Lazio-Juventus	99,22	51,18	51,6%	24
Empoli-Parma	98,00	47,27	48,2%	37
Udinese-Monza	95,23	54,45	57,2%	29
Verona-Lecce	98,03	44,14	45,0%	32
Torino-Inter	99,11	57,18	57,7%	20
Napoli-Genoa	98,25	55,15	56,1%	26
Venezia-Fiorentina	98,32	54,06	55,0%	38
Atalanta-Roma	97,05	51,49	53,1%	28
Genoa-Atalanta	97,16	52,40	53,9%	24
Cagliari-Venezia	98,25	52,10	53,0%	16
Fiorentina-Bologna	98,55	51,27	52,0%	38
Inter-Lazio	102,53	58,13	56,7%	24
Juventus-Udinese	96,37	47,39	49,2%	22
Lecce-Torino	96,47	55,00	57,0%	21
Monza-Empoli	95,12	58,32	61,3%	24
Parma-Napoli	103,36	52,42	50,7%	29
Roma-Milan	96,20	61,26	63,7%	28
Verona-Como	97,07	48,53	50,0%	23
Como-Inter	98,45	60,24	61,2%	19
Napoli-Cagliari	100,40	51,44	51,2%	28
Bologna-Genoa	96,11	46,03	47,9%	36
Milan-Monza	92,19	59,23	64,2%	17
Atalanta-Parma	98,25	58,43	59,5%	14
Empoli-Verona	99,03	43,40	43,8%	39
Lazio-Lecce	99,12	52,01	52,5%	22
Torino-Roma	94,54	57,30	60,6%	26
Udinese-Fiorentina	96,02	57,55	59,9%	21
Venezia-Juventus	98,32	49,56	50,4%	28`;

        // INIEZIONE DEI NUOVI DATI FORNITI DALL'UTENTE
        const MATCHES_DB_2526 = `Genoa-Lecce	95,47	46,53	48,7%	29
Sassuolo-Napoli	97,20	60,05	61,8%	30
Milan-Cremonese	97,21	65,26	67,1%	28
Roma-Bologna	96,35	59,56	61,8%	24
Cagliari-Fiorentina	100,54	49,03	48,8%	32
Como-Lazio	95,46	54,15	56,7%	27
Atalanta-Pisa	96,06	57,39	59,7%	19
Juventus-Parma	96,26	55,01	57,1%	22
Udinese-Verona	94,24	54,35	57,7%	24
Inter-Torino	91,24	52,19	57,2%	20
Cremonese-Sassuolo	98,13	59,20	60,3%	29
Lecce-Milan	100,08	58,39	58,3%	18
Bologna-Como	96,20	55,35	57,5%	32
Parma-Atalanta	97,06	59,53	61,3%	23
Napoli-Cagliari	97,56	64,09	65,7%	28
Pisa-Roma	96,46	59,27	61,4%	24
Genoa-Juventus	98,26	54,37	55,3%	29
Torino-Fiorentina	94,09	51,30	54,5%	34
Inter-Udinese	98,12	57,38	58,5%	22
Lazio-Verona	93,02	59,58	64,1%	27
Cagliari-Parma	101,55	54,11	53,3%	33
Juventus-Inter	97,19	54,23	55,8%	24
Fiorentina-Napoli	99,24	54,04	54,5%	28
Roma-Torino	102,10	56,51	55,3%	29
Atalanta-Lecce	94,30	58,12	61,6%	19
Pisa-Udinese	96,31	58,32	60,6%	28
Sassuolo-Lazio	101,17	63,56	62,8%	26
Milan-Bologna	98,03	59,39	60,6%	32
Verona-Cremonese	97,02	61,52	63,4%	21
Como-Genoa	99,29	57,30	57,7%	31
Lecce-Cagliari	96,37	53,19	55,2%	29
Bologna-Genoa	108,02	53,57	49,6%	27
Verona-Juventus	99,52	54,14	54,4%	28
Udinese-Milan	95,27	65,04	68,3%	16
Lazio-Roma	100,08	51,06	51,0%	36
Cremonese-Parma	100,26	56,21	56,1%	24
Torino-Atalanta	95,17	63,29	66,5%	20
Fiorentina-Como	106,39	58,50	55,0%	35
Inter-Sassuolo	98,24	56,21	57,2%	23
Napoli-Pisa	101,11	57,06	56,4%	27
Como-Cremonese	97,54	ND	ND	33
Juventus-Atalanta	98,52	ND	ND	13
Cagliari-Inter	96,35	ND	ND	27
Sassuolo-Udinese	98,39	ND	ND	27
Pisa-Fiorentina	98,27	ND	ND	30
Roma-Verona	100,00	ND	ND	30
Lecce-Bologna	97,51	ND	ND	26
Milan-Napoli	99,10	ND	ND	13
Parma-Torino	98,49	ND	ND	22
Genoa-Lazio	96,06	ND	ND	34
Verona-Sassuolo	99,27	49,17	49,5%	26
Lazio-Torino	103,57	54,51	52,6%	35
Parma-Lecce	101,04	47,10	46,6%	32
Inter-Cremonese	95,20	55,44	58,2%	17
Atalanta-Como	95,25	56,48	59,3%	29
Udinese-Cagliari	97,10	50,42	51,9%	29
Bologna-Pisa	91,03	51,05	56,1%	28
Fiorentina-Roma	98,08	49,19	50,2%	40
Napoli-Genoa	96,31	ND	ND	31
Juventus-Milan	94,13	57,17	60,7%	23
Lecce-Sassuolo	97,33	ND	ND	30
Pisa-Verona	98,41	52,04	52,9%	22
Torino-Napoli	99,17	60,15	60,7%	18
Roma-Inter	96,40	55,18	57,2%	47
Como-Juventus	98,59	48,03	48,7%	32
Cagliari-Bologna	96,32	50,55	52,5%	37
Genoa-Parma	99,37	53,50	53,8%	28
Atalanta-Lazio	95,15	64,07	67,3%	15
Milan-Fiorentina	98,13	54,05	55,1%	26
Cremonese-Udinese	94,10	49,12	52,2%	29
Milan-Pisa	100,06	56,45	56,4%	29
Parma-Como	98,03	56,10	57,2%	24
Udinese-Lecce	96,22	51,39	53,4%	21
Napoli-Inter	102,58	54,57	53,2%	25
Cremonese-Atalanta	96,00	57,39	59,8%	14
Torino-Genoa	97,28	52,06	53,5%	23
Sassuolo-Roma	98,24	49,54	50,4%	34
Verona-Cagliari	100,04	54,13	54,1%	27
Fiorentina-Bologna	101,03	43,00	42,6%	33
Lazio-Juventus	96,12	54,45	56,6%	29
Lecce-Napoli	99,07	54,46	55,0%	24
Atalanta-Milan	97,51	59,25	60,8%	17
Como-Verona	99,03	53,25	53,8%	32
Juventus-Udinese	102,54	51,31	50,0%	25
Roma-Parma	97,04	53,34	55,0%	17
Bologna-Torino	96,01	57,36	59,7%	31
Genoa-Cremonese	100,41	46,31	46,1%	29
Inter-Fiorentina	95,10	54,25	57,0%	27
Cagliari-Sassuolo	100,29	50,07	49,9%	41
Pisa-Lazio	95,16	57,15	60,1%	28
Udinese-Atalanta	95,30	57,43	60,3%	25
Napoli-Como	98,23	56,49	57,5%	31
Cremonese-Juventus	99,18	58,32	58,8%	24
Verona-Inter	99,00	57,18	57,8%	20
Fiorentina-Lecce	97,15	52,10	53,6%	35
Torino-Pisa	97,32	52,41	53,9%	22
Parma-Bologna	101,04	47,22	46,7%	31
Milan-Roma	97,10	56,38	58,1%	25
Sassuolo-Genoa	99,04	55,16	55,7%	26
Lazio-Cagliari	95,01	57,15	60,2%	26
Pisa-Cremonese	96,03	53,23	55,4%	28
Como-Cagliari	99,11	51,53	52,0%	36
Lecce-Verona	97,28	48,07	49,4%	28
Juventus-Torino	99,50	64,42	64,7%	13
Parma-Milan	95,00	57,59	60,6%	24
Atalanta-Sassuolo	99,06	60,28	60,9%	17
Bologna-Napoli	99,24	54,49	54,9%	29
Genoa-Fiorentina	97,03	46,12	47,5%	35
Roma-Udinese	98,21	58,53	59,6%	27
Inter-Lazio	97,11	59,00	60,8%	37
Cagliari-Genoa	96,36	45,56	47,3%	38
Udinese-Bologna	101,03	46,21	45,7%	35
Fiorentina-Juventus	101,06	55,15	54,6%	29
Napoli-Atalanta	96,16	56,23	58,5%	23
Verona-Parma	98,17	54,51	55,5%	30
Cremonese-Roma	100,43	53,23	53,0%	28
Lazio-Lecce	98,36	59,36	60,4%	21
Inter-MIlan	98,01	60,11	61,3%	16
Torino-Como	96,52	53,33	55,3%	15
Sassuolo-Pisa	98,18	54,38	55,6%	20`;
        // DATI PARTITE ND AGGIUNTI MANUALMENTE
        const EXTRA_MATCHES_2526 = ``;
        
        const PLAYING_TIME_DB = {
            "2025-26": `Massa	46,53
Ayroldi	60,05
Collu	65,26
Zufferli	59,56
Sozza	49,03
Manganiello	54,15
Arena	57,39
Marcenaro	55,01
Tremolada	54,35
La Penna	52,19
Guida	59,20
Marinelli	58,39
Doveri	55,35
Mariani	59,53
Bonacina	64,09
Collu	59,27
Chiffi	54,37
Abisso	51,30
Marchetti	57,38
Crezzini	59,58
Fourneau	54,11
Colombo	54,23
Zufferli	54,04
Ayroldi	56,51
Manganiello	58,12
Massa	58,32
Tremolada	63,56
Marcenaro	59,39
Arena	61,52
Piccinini	57,30
Zufferli	53,19
Collu	53,57
Rapuano	54,14
Doveri	65,04
Sozza	51,06
La Penna	56,21
Colombo	63,29
Bonacina	58,50
Marinelli	56,21
Crezzini	57,06
Fourneau	49,17
Piccinini	54,51
Doveri	47,10
Feliciani	55,44
Zufferli	56,48
Arena	50,42
Abisso	51,05
Colombo	49,19
Guida	57,17
Guida	52,04
Marcenaro	60,15
Massa	55,18
Ayroldi	48,03
Marchetti	50,55
Sozza	53,50
Collu	64,07
Marinelli	54,05
Fabbri	49,12
Zufferli	56,45
Chiffi	56,10
Feliciani	51,39
Mariani	54,57
Arena	57,39
Bonacina	52,06
Manganiello	49,54
Dionisi	54,13
La Penna	43,00
Colombo	54,45
Collu	54,46
Doveri	59,25
Marcenaro	53,25
Di Bello	51,31
Crezzini	53,34
Ayroldi	57,36
Abisso	46,31
Sozza	54,25
Pairetto	50,07
Massa	57,15
Fabbri	57,43
Zufferli	56,49
Chiffi	58,32
Doveri	57,18
Rapuano	52,10
Arena	52,41
Bonacina	47,22
Guida	56,38
Feliciani	55,16
Sacchi	57,15
Marcenaro	53,23
Pezzuto	51,53
Abisso	48,07
Zufferli	64,42
Di Bello	57,59
Crezzini	60,28
Chiffi	54,49
Guida	46,12
Collu	58,53
Manganiello	59,00
La Penna	45,56
Sacchi	46,21
Doveri	55,15
Di Bello	56,23
Pairetto	54,51
Ayroldi	53,23
Arena	59,36
Sozza	60,11
Bonacina	53,33
Di Marco	54,38'
`,
            "2024-25": `Feliciani	46,39
Ayroldi	48,46
Fabbri	44,43
Maresca	58,27
Caputi	48,59
Marchetti	48,53
Marinelli	53,36
Tremolada	56,00
Massa	54,12
Marcenaro	56,43
Sacchi	59,00
Doveri	49,49
Di Marco	56,21
Mariani	56,58
Rapuano	51,08
Sozza	55,29
Pairetto	53,23
Zufferli	58,22
Di Bello	53,12
Giua	61,58
Marcenaro	52,45
Marchetti	53,40
Marinelli	55,44
Fabbri	47,36
Massa	54,06
Tremolada	60,21
Colombo	54,53
Ayroldi	51,32
Guida	58,50
Prontera	54,24
Piccinini	54,03
Di Bello	60,04
Di Marco	57,21
Giua	53,12
Sacchi	51,04
Colombo	54,31
La Penna	50,07
Pairetto	57,28
Abisso	53,01
Zufferli	56,25
Sozza	48,44
Marinelli	60,20
Marchetti	48,20
Doveri	64,10
Guida	54,32
Marcenaro	52,35
Massa	55,34
Feliciani	55,33
Mariani	55,33
Tremolada	58,21
Zufferli	55,41
Sacchi	61,58
Colombo	58,44
Rapuano	57,29
Sozza	57,06
Giua	49,47
Abisso	52,36
Aureliano	54,28
Manganiello	60,33
Fourneau	55,21
Feliciani	59,25
Guida	47,29
Mariani	55,10
Chiffi	55,41
Marcenaro	54,09
Marinelli	60,08
Di Bello	54,55
Ayroldi	53,07
La Penna	56,25
Pairetto	48,43
Fabbri	60,51
Doveri	47,58
Chiffi	52,59
Sacchi	56,44
Abisso	51,43
Fourneau	53,12
Zufferli	54,15
Aureliano	52,53
Massa	59,00
Dionisi	54,17
Manganiello	54,38
Ayroldi	55,42
Tremolada	52,02
Mariani	53,33
Feliciani	58,27
La Penna	55,33
Piccinini	57,36
Rapuano	49,01
Guida	52,00
Sozza	55,39
Fourneau	55,29
Mariani	49,06
Colombo	60,55
Marchetti	55,51
Massa	49,10
Piccinini	57,39
Zufferli	61,18
Chiffi	52,02
Pairetto	50,20
Fabbri	59,29
Collu	50,36
Abisso	55,50
Feliciani	56,22
Doveri	62,27
La Penna	59,23
Marcenaro	53,58
Caputi	55,55
Di Bello	54,05
Guida	51,42
Ayroldi	54,05
Rapuano	50,21
Sacchi	51,23
Chiffi	57,06
Fabbri	54,30
Sozza	55,08
Di Bello	51,34
Zufferli	46,44
Manganiello	49,51
Colombo	56,45
Mariani	56,03
Colombo	65,30
Chiffi	59,45
Manganiello	66,25
Sozza	53,26
Marchetti	55,23
Abisso	57,26
Massa	58,44
Rapuano	55,30
Marinelli	58,51
Pairetto	56,21
Mariani	50,46
Sacchi	51,14
Dionisi	54,43
Massimi	49,35
Aureliano	57,46
Zufferli	55,40
Fabbri	59,16
Doveri	53,53
Rapuano	62,25
Guida	55,10
Abisso	55,37
La Penna	59,24
Marinelli	56,35
Marchetti	52,19
Chiffi	55,05
Piccinini	53,17
Di Bello	54,48
Doveri	44,33
Colombo	58,47
Manganiello	53,45
Bonacina	49,22
Pairetto	57,31
Doveri	51,56
Giua	59,57
Mariani	47,00
Fabbri	48,30
Sozza	54,08
Rapuano	52,56
Guida	61,42
Chiffi	55,11
Marinelli	54,44
Piccinini	56,57
La Penna	57,55
Manganiello	56,47
Di Bello	55,55
Guida	49,18
Feliciani	54,38
Massa	61,14
Marcenaro	53,21
Giua	52,23
Rapuano	51,47
La Penna	48,53
Doveri	52,18
Massa	58,07
Fourneau	54,20
Cosso	54,07
Mariani	51,51
Fabbri	51,06
Piccinini	52,23
Ayroldi	46,47
Sacchi	51,16
Manganiello	49,34
Dionisi	50,49
Di Bello	48,31
Marinelli	54,20
Feliciani	59,17
Pairetto	53,25
Manganiello	50,49
Doveri	64,13
Pairetto	52,32
Tremolada	47,58
Chiffi	49,09
Mariani	58,41
Fabbri	60,08
Fourneau	56,05
Colombo	52,11
Piccinini	55,10
Abisso	54,11
Zufferli	62,26
Dionisi	60,55
Zufferli	58,40
Mariani	59,30
Massa	56,11
Colombo	57,43
Marinelli	56,28
Sacchi	51,45
Fourneau	50,03
Fabbri	55,10
Feliciani	57,07
Cosso	51,13
Bonacina	57,17
Pairetto	56,26
Chiffi	54,14
La Penna	46,31
Abisso	52,02
Sozza	56,19
Marinelli	57,11
Rapuano	53,46
Manganiello	49,18
Doveri	41,34
Sozza	56,49
Massa	53,12
Mariani	42,22
Piccinini	63,01
Massimi	50,12
Zufferli	45,47
Collu	47,18
Chiffi	58,36
Fabbri	57,50
Manganiello	55,09
Abisso	50,13
Sozza	56,03
Pairetto	48,47
Feliciani	57,33
Zufferli	53,23
Di Bello	52,57
Aureliano	55,49
Fourneau	52,43
Marinelli	57,54
La Penna	54,37
Fabbri	46,59
Marchetti	64,30
Massa	55,22
Fourneau	49,24
Piccinini	58,37
Collu	56,57
Doveri	52,19
Chiffi	58,43
Mariani	55,49
Marinelli	45,50
Bonacina	54,09
Abisso	52,14
Marchetti	56,03
Sozza	55,53
Piccinini	58,04
Manganiello	52,35
Di Bello	51,57
Mariani	51,29
Colombo	60,44
Maresca	61,54
Marinelli	54,37
Collu	59,11
Doveri	52,11
Maresca	57,58
Rapuano	56,28
Zufferli	51,33
Massa	47,28
Pairetto	61,34
Manganiello	57,54
Marchetti	55,31
Fabbri	50,53
Ayroldi	51,43
Fourneau	46,27
Doveri	52,03
Zufferli	57,48
Rapuano	56,41
Colombo	59,57
Di Bello	60,45
Sozza	57,31
Piccinini	59,55
Maresca	51,18
Manganiello	56,25
Ayroldi	56,15
Marchetti	51,46
Chiffi	46,00
Mariani	48,55
Colombo	54,15
Piccinini	60,28
Fabbri	52,43
Massa	54,31
Mariani	52,17
Di Bello	53,24
Rapuano	54,24
Manganiello	51,33
Fourneau	50,35
Doveri	55,08
Chiffi	55,26
Sozza	59,08
Sacchi	51,46
Massa	54,35
Perenzoni	54,22
Collu	58,00
Doveri	57,35
Ayroldi	53,20
Piccinini	44,36
La Penna	45,56
Bonacina	52,10
Chiffi	60,27
Colombo	61,47
Massa	51,14
Sacchi	57,21
Maresca	45,52
Di Bello	61,00
Zufferli	55,04
Mariani	52,31
Manganiello	59,22
Marchetti	46,55
Marcenaro	55,02
Sozza	49,34
Fabbri	54,09
Sozza	46,22
La Penna	56,00
Pairetto	54,09
Massa	44,36
Colombo	50,02
Piccinini	62,56
Collu	53,25
Marinelli	53,48
Ayroldi	55,47
Chiffi	58,32
La Penna	56,54
Arena	54,58
Manganiello	52,47
Rapuano	48,14
Fabbri	58,15
Perenzoni	55,31
Mariani	58,59
Maresca	47,37
Abisso	51,05
Sacchi	60,08
Sozza	53,17
Feliciani	55,29
Di Bello	50,20
Massa	58,14
Manganiello	61,36
Colombo	55,18
Pairetto	57,35
Chiffi	63,43
Doveri	45,42
Collu	52,54
Marinelli	56,48
Fourneau	54,24
Massa	51,18
Fabbri	47,27
Crezzini	54,45
Maresca	44,14
La Penna	57,18
Piccinini	55,15
Marchetti	54,06
Sozza	51,49
Ghersini	52,40
Pairetto	52,10
Zufferli	51,27
Chiffi	58,13
Ayroldi	47,39
Rapuano	55,00
Marinelli	58,32
Doveri	52,42
Piccinini	61,26
Abisso	48,53
Massa	60,24
La Penna	51,44
Monaldi	46,03
Rutella	59,23
Marinelli	58,43
Doveri	43,40
Fabbri	52,01
Di Bello	57,30
Marcenaro	57,55
Colombo	49,56`,
            "2023-24": ``, "2022-23": ``, "2021-22": ``, "2020-21": ``
        };
        
        const TOTAL_TIME_DB = `Massa	95,47
Ayroldi	97,20
Collu	97,21
Zufferli	96,35
Sozza	100,54
Manganiello	95,46
Arena	96,06
Marcenaro	96,26
Tremolada	94,24
La Penna	91,24
Guida	98,13
Marinelli	100,08
Doveri	96,20
Mariani	97,06
Bonacina	97,56
Collu	96,46
Chiffi	98,26
Abisso	94,09
Marchetti	98,12
Crezzini	93,02
Fourneau	101,55
Colombo	97,19
Zufferli	99,24
Ayroldi	102,10
Manganiello	94,30
Massa	96,31
Tremolada	101,17
Marcenaro	98,03
Arena	97,02
Piccinini	99,29
Zufferli	96,37
Collu	108,02
Rapuano	99,52
Doveri	95,27
Sozza	100,08
La Penna	100,26
Colombo	95,17
Bonacina	106,39
Marinelli	98,24
Crezzini	101,11
Di Bello	97,54
Sozza	98,52
Piccinini	96,35
Perenzoni	98,39
Manganiello	98,27
Feliciani	100,00
Fourneau	97,51
Chiffi	99,10
Collu	98,49
Ayroldi	96,06
Fourneau	99,27
Piccinini	103,57
Doveri	101,04
Feliciani	95,20
Zufferli	95,25
Arena	97,10
Abisso	91,03
Colombo	98,08
La Penna	96,31
Guida	94,13
Crezzini	97,33
Guida	98,41
Marcenaro	99,17
Massa	96,40
Ayroldi	98,59
Marchetti	96,32
Sozza	99,37
Collu	95,15
Marinelli	98,13
Fabbri	94,10
Zufferli	100,06
Chiffi	98,03
Feliciani	96,22
Mariani	102,58
Arena	96,00
Bonacina	97,28
Manganiello	98,24
Dionisi	100,04
La Penna	101,03
Colombo	96,12
Collu	99,07
Doveri	97,51
Marcenaro	99,03
Di Bello	102,54
Crezzini	97,04
Ayroldi	96,01
Abisso	100,41
Sozza	95,10
Pairetto	100,29
Massa	95,16
Fabbri	95,30
Zufferli	98,23
Chiffi	99,18
Doveri	99,00
Rapuano	97,15
Arena	97,32
Bonacina	101,04
Guida	97,10
Feliciani	99,04
Sacchi	95,01
Marcenaro	96,03
Pezzuto	99,11
Abisso	97,28
Zufferli	99,50
Di Bello	95,00
Crezzini	99,06
Chiffi	99,24
Guida	97,03
Collu	98,21
Manganiello	97,11
La Penna	96,36
Sacchi	101,03
Doveri	101,06
Di Bello	96,16
Pairetto	98,17
Ayroldi	100,43
Arena	98,36
Sozza	98,01
Bonacina	96,52
Di Marco	98,18`;

        // --- STATS DB (IMPORTANTE: INCOLLA QUI IL TUO CODICE con const db = { ... }) ---
        // Il sistema userà questa variabile per le statistiche.
        
        const db = {
            "2025-26": [
                { name: "Luca Zufferli", matches: 7, fouls_avg: 26.71, penalties_ap: 0.57, yellows_ap: 3.00, yellows: 21, reds_ap: 0.00, reds: 0 },
                { name: "Giuseppe Collu", matches: 7, fouls_avg: 23.29, penalties_ap: 0.57, yellows_ap: 4.29, yellows: 30, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 5, fouls_avg: 26.80, penalties_ap: 1.20, yellows_ap: 5.00, yellows: 25, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Doveri", matches: 6, fouls_avg: 24.33, penalties_ap: 0.00, yellows_ap: 4.33, yellows: 26, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Chiffi", matches: 5, fouls_avg: 23.40, penalties_ap: 0.20, yellows_ap: 2.00, yellows: 10, reds_ap: 0.20, reds: 1 },
                { name: "Gianluca Manganiello", matches: 5, fouls_avg: 29.40, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Simone Sozza", matches: 6, fouls_avg: 25.33, penalties_ap: 0.50, yellows_ap: 3.00, yellows: 18, reds_ap: 0.83, reds: 5 },
                { name: "Giovanni Ayroldi", matches: 6, fouls_avg: 31.17, penalties_ap: 0.00, yellows_ap: 4.33, yellows: 26, reds_ap: 0.17, reds: 1 },
                { name: "Matteo Marcenaro", matches: 5, fouls_avg: 26.60, penalties_ap: 0.00, yellows_ap: 4.40, yellows: 22, reds_ap: 0.20, reds: 1 },
                { name: "Valerio Crezzini", matches: 5, fouls_avg: 23.80, penalties_ap: 0.40, yellows_ap: 2.60, yellows: 13, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Arena", matches: 6, fouls_avg: 21.17, penalties_ap: 0.17, yellows_ap: 2.83, yellows: 17, reds_ap: 0.00, reds: 0 },
                { name: "Davide Massa", matches: 4, fouls_avg: 33.00, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 19, reds_ap: 0.00, reds: 0 },
                { name: "Rosario Abisso", matches: 4, fouls_avg: 29.75, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.25, reds: 1 },
                { name: "Federico La Penna", matches: 5, fouls_avg: 29.20, penalties_ap: 0.40, yellows_ap: 3.20, yellows: 16, reds_ap: 0.40, reds: 2 },
                { name: "Andrea Colombo", matches: 4, fouls_avg: 28.25, penalties_ap: 0.25, yellows_ap: 3.75, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Ermanno Feliciani", matches: 4, fouls_avg: 24.25, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Kevin Bonacina", matches: 5, fouls_avg: 26.40, penalties_ap: 0.20, yellows_ap: 3.80, yellows: 19, reds_ap: 0.20, reds: 1 },
                { name: "Marco Di Bello", matches: 4, fouls_avg: 26.25, penalties_ap: 0.75, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                { name: "Marco Piccinini", matches: 3, fouls_avg: 30.67, penalties_ap: 0.33, yellows_ap: 4.00, yellows: 12, reds_ap: 0.33, reds: 1 },
                { name: "Livio Marinelli", matches: 3, fouls_avg: 22.33, penalties_ap: 0.33, yellows_ap: 3.33, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Fourneau", matches: 3, fouls_avg: 28.33, penalties_ap: 0.67, yellows_ap: 5.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Maurizio Mariani", matches: 2, fouls_avg: 24.00, penalties_ap: 1.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Michael Fabbri", matches: 2, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Rapuano", matches: 2, fouls_avg: 31.50, penalties_ap: 0.50, yellows_ap: 5.50, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Marchetti", matches: 2, fouls_avg: 29.50, penalties_ap: 0.50, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Paride Tremolada", matches: 2, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Luca Pairetto", matches: 2, fouls_avg: 35.50, penalties_ap: 0.00, yellows_ap: 7.50, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 1, fouls_avg: 36.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Juan Luca Sacchi", matches: 2, fouls_avg: 30.50, penalties_ap: 0.50, yellows_ap: 1.50, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 1, fouls_avg: 28.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Perenzoni", matches: 1, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 1, fouls_avg: 20.00, penalties_ap: 1.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 }
            ],
            "2024-25": [
                { name: "Davide Massa", matches: 19, fouls_avg: 25.74, penalties_ap: 0.16, yellows_ap: 4.21, yellows: 80, reds_ap: 0.26, reds: 5 },
                { name: "Maurizio Mariani", matches: 18, fouls_avg: 25.94, penalties_ap: 0.11, yellows_ap: 3.72, yellows: 67, reds_ap: 0.17, reds: 3 },
                { name: "Michael Fabbri", matches: 18, fouls_avg: 24.89, penalties_ap: 0.06, yellows_ap: 3.89, yellows: 70, reds_ap: 0.33, reds: 6 },
                { name: "Daniele Doveri", matches: 18, fouls_avg: 24.11, penalties_ap: 0.22, yellows_ap: 2.50, yellows: 45, reds_ap: 0.11, reds: 2 },
                { name: "Daniele Chiffi", matches: 17, fouls_avg: 20.29, penalties_ap: 0.29, yellows_ap: 3.71, yellows: 63, reds_ap: 0.18, reds: 3 },
                { name: "Gianluca Manganiello", matches: 17, fouls_avg: 25.59, penalties_ap: 0.24, yellows_ap: 3.24, yellows: 55, reds_ap: 0.18, reds: 3 },
                { name: "Livio Marinelli", matches: 17, fouls_avg: 24.18, penalties_ap: 0.29, yellows_ap: 2.88, yellows: 49, reds_ap: 0.18, reds: 3 },
                { name: "Simone Sozza", matches: 17, fouls_avg: 24.00, penalties_ap: 0.59, yellows_ap: 3.53, yellows: 60, reds_ap: 0.06, reds: 1 },
                { name: "Marco Piccinini", matches: 16, fouls_avg: 24.00, penalties_ap: 0.19, yellows_ap: 3.81, yellows: 61, reds_ap: 0.06, reds: 1 },
                { name: "Andrea Colombo", matches: 16, fouls_avg: 25.19, penalties_ap: 0.13, yellows_ap: 4.13, yellows: 66, reds_ap: 0.13, reds: 2 },
                { name: "Marco Di Bello", matches: 15, fouls_avg: 26.20, penalties_ap: 0.27, yellows_ap: 2.60, yellows: 39, reds_ap: 0.13, reds: 2 },
                { name: "Luca Zufferli", matches: 15, fouls_avg: 22.80, penalties_ap: 0.20, yellows_ap: 2.73, yellows: 41, reds_ap: 0.20, reds: 3 },
                { name: "Luca Pairetto", matches: 14, fouls_avg: 26.57, penalties_ap: 0.29, yellows_ap: 4.14, yellows: 58, reds_ap: 0.50, reds: 7 },
                { name: "Federico La Penna", matches: 14, fouls_avg: 27.71, penalties_ap: 0.43, yellows_ap: 4.36, yellows: 61, reds_ap: 0.07, reds: 1 },
                { name: "Antonio Rapuano", matches: 14, fouls_avg: 27.93, penalties_ap: 0.14, yellows_ap: 4.50, yellows: 63, reds_ap: 0.43, reds: 6 },
                { name: "Rosario Abisso", matches: 12, fouls_avg: 24.42, penalties_ap: 0.50, yellows_ap: 3.83, yellows: 46, reds_ap: 0.17, reds: 2 },
                { name: "Matteo Marchetti", matches: 12, fouls_avg: 26.83, penalties_ap: 0.08, yellows_ap: 4.00, yellows: 48, reds_ap: 0.25, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 11, fouls_avg: 24.27, penalties_ap: 0.09, yellows_ap: 3.36, yellows: 37, reds_ap: 0.18, reds: 2 },
                { name: "Francesco Fourneau", matches: 11, fouls_avg: 27.55, penalties_ap: 0.27, yellows_ap: 4.18, yellows: 46, reds_ap: 0.09, reds: 1 },
                { name: "Giovanni Ayroldi", matches: 11, fouls_avg: 26.91, penalties_ap: 0.36, yellows_ap: 5.73, yellows: 63, reds_ap: 0.55, reds: 6 },
                { name: "Ermanno Feliciani", matches: 10, fouls_avg: 22.90, penalties_ap: 0.40, yellows_ap: 2.50, yellows: 25, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 8, fouls_avg: 22.63, penalties_ap: 0.25, yellows_ap: 3.88, yellows: 31, reds_ap: 0.25, reds: 2 },
                { name: "Matteo Marcenaro", matches: 8, fouls_avg: 22.88, penalties_ap: 0.50, yellows_ap: 5.00, yellows: 40, reds_ap: 0.38, reds: 3 },
                { name: "Fabio Maresca", matches: 7, fouls_avg: 25.43, penalties_ap: 0.29, yellows_ap: 4.43, yellows: 31, reds_ap: 0.14, reds: 1 },
                { name: "Giuseppe Collu", matches: 7, fouls_avg: 28.29, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 28, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Giua", matches: 5, fouls_avg: 22.20, penalties_ap: 0.60, yellows_ap: 3.60, yellows: 18, reds_ap: 0.20, reds: 1 },
                { name: "Paride Tremolada", matches: 5, fouls_avg: 24.20, penalties_ap: 0.60, yellows_ap: 4.20, yellows: 21, reds_ap: 0.40, reds: 2 },
                { name: "Gianluca Aureliano", matches: 4, fouls_avg: 22.50, penalties_ap: 0.25, yellows_ap: 2.75, yellows: 11, reds_ap: 0.25, reds: 1 },
                { name: "Federico Dionisi", matches: 4, fouls_avg: 28.50, penalties_ap: 0.25, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                { name: "Kevin Bonacina", matches: 4, fouls_avg: 24.25, penalties_ap: 0.50, yellows_ap: 3.00, yellows: 12, reds_ap: 0.50, reds: 2 },
                { name: "Luca Massimi", matches: 2, fouls_avg: 31.50, penalties_ap: 1.00, yellows_ap: 4.50, yellows: 9, reds_ap: 0.50, reds: 1 },
                { name: "Francesco Cosso", matches: 2, fouls_avg: 24.00, penalties_ap: 0.50, yellows_ap: 2.50, yellows: 5, reds_ap: 1.00, reds: 2 },
                { name: "Daniele Perenzoni", matches: 2, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.50, reds: 1 },
                { name: "Maria Ferrieri Caputi", matches: 2, fouls_avg: 32.00, penalties_ap: 1.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 2, fouls_avg: 22.50, penalties_ap: 1.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.50, reds: 1 },
                { name: "Davide Ghersini", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 0.00, yellows: 0, reds_ap: 0.00, reds: 0 },
                { name: "Alessandro Prontera", matches: 1, fouls_avg: 25.00, penalties_ap: 1.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Rutella", matches: 1, fouls_avg: 17.00, penalties_ap: 0.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Marco Monaldi", matches: 1, fouls_avg: 36.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Valerio Crezzini", matches: 1, fouls_avg: 29.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 5, reds_ap: 0.00, reds: 0 }
            ],
            "2023-24": [
                { name: "Marco Guida", matches: 17, fouls_avg: 23.59, penalties_ap: 0.47, yellows_ap: 4.00, yellows: 68, reds_ap: 0.06, reds: 1 },
                { name: "Daniele Doveri", matches: 17, fouls_avg: 24.47, penalties_ap: 0.18, yellows_ap: 3.24, yellows: 55, reds_ap: 0.35, reds: 6 },
                { name: "Daniele Orsato", matches: 16, fouls_avg: 23.38, penalties_ap: 0.31, yellows_ap: 4.69, yellows: 75, reds_ap: 0.19, reds: 3 },
                { name: "Davide Massa", matches: 16, fouls_avg: 26.06, penalties_ap: 0.31, yellows_ap: 5.06, yellows: 81, reds_ap: 0.00, reds: 0 },
                { name: "Fabio Maresca", matches: 16, fouls_avg: 25.50, penalties_ap: 0.25, yellows_ap: 5.69, yellows: 91, reds_ap: 0.06, reds: 1 },
                { name: "Andrea Colombo", matches: 16, fouls_avg: 24.19, penalties_ap: 0.19, yellows_ap: 5.38, yellows: 86, reds_ap: 0.38, reds: 6 },
                { name: "Maurizio Mariani", matches: 15, fouls_avg: 23.80, penalties_ap: 0.33, yellows_ap: 3.80, yellows: 57, reds_ap: 0.27, reds: 4 },
                { name: "Federico La Penna", matches: 15, fouls_avg: 24.07, penalties_ap: 0.40, yellows_ap: 4.60, yellows: 69, reds_ap: 0.13, reds: 2 },
                { name: "Juan Luca Sacchi", matches: 15, fouls_avg: 25.60, penalties_ap: 0.40, yellows_ap: 4.40, yellows: 66, reds_ap: 0.07, reds: 1 },
                { name: "Antonio Rapuano", matches: 15, fouls_avg: 25.40, penalties_ap: 0.40, yellows_ap: 3.93, yellows: 59, reds_ap: 0.27, reds: 4 },
                { name: "Luca Pairetto", matches: 14, fouls_avg: 23.36, penalties_ap: 0.50, yellows_ap: 4.14, yellows: 58, reds_ap: 0.00, reds: 0 },
                { name: "Michael Fabbri", matches: 13, fouls_avg: 24.31, penalties_ap: 0.31, yellows_ap: 3.23, yellows: 42, reds_ap: 0.15, reds: 2 },
                { name: "Ermanno Feliciani", matches: 13, fouls_avg: 22.38, penalties_ap: 0.23, yellows_ap: 3.08, yellows: 40, reds_ap: 0.08, reds: 1 },
                { name: "Gianluca Aureliano", matches: 12, fouls_avg: 25.50, penalties_ap: 0.50, yellows_ap: 4.25, yellows: 51, reds_ap: 0.17, reds: 2 },
                { name: "Gianluca Manganiello", matches: 12, fouls_avg: 22.33, penalties_ap: 0.25, yellows_ap: 3.67, yellows: 44, reds_ap: 0.25, reds: 3 },
                { name: "Marco Piccinini", matches: 12, fouls_avg: 23.17, penalties_ap: 0.50, yellows_ap: 3.83, yellows: 46, reds_ap: 0.17, reds: 2 },
                { name: "Matteo Marcenaro", matches: 12, fouls_avg: 22.58, penalties_ap: 0.33, yellows_ap: 4.83, yellows: 58, reds_ap: 0.25, reds: 3 },
                { name: "Marco Di Bello", matches: 11, fouls_avg: 23.18, penalties_ap: 0.45, yellows_ap: 4.18, yellows: 46, reds_ap: 0.45, reds: 5 },
                { name: "Antonio Giua", matches: 11, fouls_avg: 23.00, penalties_ap: 0.27, yellows_ap: 3.64, yellows: 40, reds_ap: 0.27, reds: 3 },
                { name: "Simone Sozza", matches: 11, fouls_avg: 26.36, penalties_ap: 0.82, yellows_ap: 4.36, yellows: 48, reds_ap: 0.18, reds: 2 },
                { name: "Matteo Marchetti", matches: 11, fouls_avg: 23.27, penalties_ap: 0.18, yellows_ap: 3.00, yellows: 33, reds_ap: 0.09, reds: 1 },
                { name: "Daniele Chiffi", matches: 9, fouls_avg: 22.22, penalties_ap: 0.11, yellows_ap: 4.00, yellows: 36, reds_ap: 0.11, reds: 1 },
                { name: "Alessandro Prontera", matches: 9, fouls_avg: 22.22, penalties_ap: 0.67, yellows_ap: 3.78, yellows: 34, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 9, fouls_avg: 27.89, penalties_ap: 0.11, yellows_ap: 3.22, yellows: 29, reds_ap: 0.11, reds: 1 },
                { name: "Livio Marinelli", matches: 8, fouls_avg: 24.38, penalties_ap: 0.25, yellows_ap: 4.50, yellows: 36, reds_ap: 0.50, reds: 4 },
                { name: "Luca Massimi", matches: 8, fouls_avg: 25.13, penalties_ap: 0.25, yellows_ap: 3.75, yellows: 30, reds_ap: 0.13, reds: 1 },
                { name: "Giovanni Ayroldi", matches: 8, fouls_avg: 26.13, penalties_ap: 0.38, yellows_ap: 5.25, yellows: 42, reds_ap: 0.38, reds: 3 },
                { name: "Maria Ferrieri Caputi", matches: 8, fouls_avg: 23.13, penalties_ap: 0.38, yellows_ap: 4.13, yellows: 33, reds_ap: 0.38, reds: 3 },
                { name: "Rosario Abisso", matches: 7, fouls_avg: 23.86, penalties_ap: 0.43, yellows_ap: 5.29, yellows: 37, reds_ap: 0.14, reds: 1 },
                { name: "Luca Zufferli", matches: 6, fouls_avg: 22.00, penalties_ap: 0.17, yellows_ap: 2.50, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Fourneau", matches: 5, fouls_avg: 21.80, penalties_ap: 0.40, yellows_ap: 3.60, yellows: 18, reds_ap: 0.20, reds: 1 },
                { name: "Alberto Santoro", matches: 3, fouls_avg: 26.67, penalties_ap: 0.33, yellows_ap: 5.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Paride Tremolada", matches: 3, fouls_avg: 25.67, penalties_ap: 0.67, yellows_ap: 4.33, yellows: 13, reds_ap: 0.00, reds: 0 },
                { name: "Giuseppe Collu", matches: 2, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 6, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 2, fouls_avg: 21.00, penalties_ap: 0.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Davide Ghersini", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 1.00, reds: 1 },
                { name: "Francesco Cosso", matches: 1, fouls_avg: 20.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 2, reds_ap: 0.00, reds: 0 }
            ],
            "2022-23": [
                 { name: "Daniele Orsato", matches: 15, fouls_avg: 21.40, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 45, reds_ap: 0.07, reds: 1 },
                 { name: "Fabio Maresca", matches: 15, fouls_avg: 25.60, penalties_ap: 0.00, yellows_ap: 5.33, yellows: 80, reds_ap: 0.20, reds: 3 },
                 { name: "Daniele Chiffi", matches: 15, fouls_avg: 23.47, penalties_ap: 0.00, yellows_ap: 4.47, yellows: 67, reds_ap: 0.20, reds: 3 },
                 { name: "Maurizio Mariani", matches: 14, fouls_avg: 24.07, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 63, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Doveri", matches: 14, fouls_avg: 25.43, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 49, reds_ap: 0.21, reds: 3 },
                 { name: "Davide Massa", matches: 14, fouls_avg: 27.64, penalties_ap: 0.00, yellows_ap: 6.21, yellows: 87, reds_ap: 0.29, reds: 4 },
                 { name: "Antonio Rapuano", matches: 14, fouls_avg: 22.43, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 63, reds_ap: 0.21, reds: 3 },
                 { name: "Livio Marinelli", matches: 14, fouls_avg: 24.07, penalties_ap: 0.00, yellows_ap: 3.36, yellows: 47, reds_ap: 0.21, reds: 3 },
                 { name: "Michael Fabbri", matches: 12, fouls_avg: 23.17, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 57, reds_ap: 0.33, reds: 4 },
                 { name: "Luca Pairetto", matches: 12, fouls_avg: 26.08, penalties_ap: 0.00, yellows_ap: 4.42, yellows: 53, reds_ap: 0.17, reds: 2 },
                 { name: "Giovanni Ayroldi", matches: 12, fouls_avg: 27.50, penalties_ap: 0.00, yellows_ap: 5.25, yellows: 63, reds_ap: 0.08, reds: 1 },
                 { name: "Andrea Colombo", matches: 12, fouls_avg: 22.83, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 57, reds_ap: 0.00, reds: 0 },
                 { name: "Matteo Marcenaro", matches: 12, fouls_avg: 23.42, penalties_ap: 0.00, yellows_ap: 4.83, yellows: 58, reds_ap: 0.50, reds: 6 },
                 { name: "Marco Di Bello", matches: 11, fouls_avg: 28.55, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 55, reds_ap: 0.18, reds: 2 },
                 { name: "Antonio Giua", matches: 11, fouls_avg: 23.64, penalties_ap: 0.00, yellows_ap: 5.18, yellows: 57, reds_ap: 0.36, reds: 4 },
                 { name: "Simone Sozza", matches: 11, fouls_avg: 26.09, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 55, reds_ap: 0.00, reds: 0 },
                 { name: "Matteo Marchetti", matches: 11, fouls_avg: 27.45, penalties_ap: 0.00, yellows_ap: 4.09, yellows: 45, reds_ap: 0.27, reds: 3 },
                 { name: "Massimiliano Irrati", matches: 10, fouls_avg: 23.70, penalties_ap: 0.00, yellows_ap: 5.10, yellows: 51, reds_ap: 0.20, reds: 2 },
                 { name: "Rosario Abisso", matches: 10, fouls_avg: 24.60, penalties_ap: 0.00, yellows_ap: 3.90, yellows: 39, reds_ap: 0.30, reds: 3 },
                 { name: "Francesco Fourneau", matches: 10, fouls_avg: 24.20, penalties_ap: 0.00, yellows_ap: 4.70, yellows: 47, reds_ap: 0.00, reds: 0 },
                 { name: "Luca Massimi", matches: 10, fouls_avg: 22.70, penalties_ap: 0.00, yellows_ap: 4.10, yellows: 41, reds_ap: 0.40, reds: 4 },
                 { name: "Juan Luca Sacchi", matches: 9, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 3.22, yellows: 29, reds_ap: 0.22, reds: 2 },
                 { name: "Marco Piccinini", matches: 9, fouls_avg: 25.33, penalties_ap: 0.00, yellows_ap: 4.44, yellows: 40, reds_ap: 0.00, reds: 0 },
                 { name: "Federico Dionisi", matches: 9, fouls_avg: 28.11, penalties_ap: 0.00, yellows_ap: 4.56, yellows: 41, reds_ap: 0.11, reds: 1 },
                 { name: "Gianluca Aureliano", matches: 8, fouls_avg: 24.25, penalties_ap: 0.00, yellows_ap: 3.13, yellows: 25, reds_ap: 0.13, reds: 1 },
                 { name: "Paolo Valeri", matches: 7, fouls_avg: 26.86, penalties_ap: 0.00, yellows_ap: 4.57, yellows: 32, reds_ap: 0.14, reds: 1 },
                 { name: "Davide Ghersini", matches: 7, fouls_avg: 23.00, penalties_ap: 0.00, yellows_ap: 4.14, yellows: 29, reds_ap: 0.29, reds: 2 },
                 { name: "Federico La Penna", matches: 7, fouls_avg: 25.14, penalties_ap: 0.00, yellows_ap: 3.86, yellows: 27, reds_ap: 0.00, reds: 0 },
                 { name: "Alessandro Prontera", matches: 7, fouls_avg: 26.29, penalties_ap: 0.00, yellows_ap: 4.43, yellows: 31, reds_ap: 0.14, reds: 1 },
                 { name: "Alberto Santoro", matches: 7, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 4.86, yellows: 34, reds_ap: 0.14, reds: 1 },
                 { name: "Gianluca Manganiello", matches: 6, fouls_avg: 21.17, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 21, reds_ap: 0.00, reds: 0 },
                 { name: "Marco Guida", matches: 5, fouls_avg: 23.20, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                 { name: "Ivano Pezzuto", matches: 5, fouls_avg: 23.80, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                 { name: "Francesco Cosso", matches: 5, fouls_avg: 22.20, penalties_ap: 0.00, yellows_ap: 3.40, yellows: 17, reds_ap: 0.40, reds: 2 },
                 { name: "Ermanno Feliciani", matches: 5, fouls_avg: 22.40, penalties_ap: 0.00, yellows_ap: 3.80, yellows: 19, reds_ap: 0.00, reds: 0 },
                 { name: "Niccolò Baroni", matches: 4, fouls_avg: 26.25, penalties_ap: 0.00, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                 { name: "Manuel Volpi", matches: 4, fouls_avg: 26.75, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 16, reds_ap: 0.00, reds: 0 },
                 { name: "Giacomo Camplone", matches: 4, fouls_avg: 23.75, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.50, reds: 2 },
                 { name: "Luca Zufferli", matches: 3, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 9, reds_ap: 0.00, reds: 0 },
                 { name: "Maria Ferrieri Caputi", matches: 3, fouls_avg: 23.67, penalties_ap: 0.00, yellows_ap: 2.33, yellows: 7, reds_ap: 0.00, reds: 0 },
                 { name: "Marco Serra", matches: 2, fouls_avg: 28.00, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.50, reds: 1 },
                 { name: "Daniele Perenzoni", matches: 2, fouls_avg: 28.50, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Minelli", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Paterna", matches: 1, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 2.00, reds: 2 },
                 { name: "Francesco Meraviglia", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 }
            ],
            "2021-22": [
                { name: "Daniele Doveri", matches: 17, fouls_avg: 26.82, penalties_ap: 0.35, yellows_ap: 3.47, yellows: 59, reds_ap: 0.18, reds: 3 },
                { name: "Marco Di Bello", matches: 17, fouls_avg: 27.18, penalties_ap: 0.47, yellows_ap: 4.29, yellows: 73, reds_ap: 0.24, reds: 4 },
                { name: "Fabio Maresca", matches: 16, fouls_avg: 24.75, penalties_ap: 0.38, yellows_ap: 4.50, yellows: 72, reds_ap: 0.31, reds: 5 },
                { name: "Daniele Chiffi", matches: 16, fouls_avg: 24.88, penalties_ap: 0.31, yellows_ap: 3.63, yellows: 58, reds_ap: 0.19, reds: 3 },
                { name: "Daniele Orsato", matches: 15, fouls_avg: 28.00, penalties_ap: 0.27, yellows_ap: 5.87, yellows: 88, reds_ap: 0.13, reds: 2 },
                { name: "Maurizio Mariani", matches: 14, fouls_avg: 28.79, penalties_ap: 0.21, yellows_ap: 4.86, yellows: 68, reds_ap: 0.36, reds: 5 },
                { name: "Marco Guida", matches: 14, fouls_avg: 27.14, penalties_ap: 0.29, yellows_ap: 4.79, yellows: 67, reds_ap: 0.21, reds: 3 },
                { name: "Davide Massa", matches: 14, fouls_avg: 26.29, penalties_ap: 0.14, yellows_ap: 4.21, yellows: 59, reds_ap: 0.36, reds: 5 },
                { name: "Livio Marinelli", matches: 14, fouls_avg: 21.86, penalties_ap: 0.29, yellows_ap: 3.93, yellows: 55, reds_ap: 0.00, reds: 0 },
                { name: "Simone Sozza", matches: 14, fouls_avg: 26.43, penalties_ap: 0.29, yellows_ap: 4.36, yellows: 61, reds_ap: 0.21, reds: 3 },
                { name: "Rosario Abisso", matches: 13, fouls_avg: 25.92, penalties_ap: 0.46, yellows_ap: 4.69, yellows: 61, reds_ap: 0.31, reds: 4 },
                { name: "Paolo Valeri", matches: 12, fouls_avg: 30.25, penalties_ap: 0.42, yellows_ap: 5.00, yellows: 60, reds_ap: 0.17, reds: 2 },
                { name: "Michael Fabbri", matches: 12, fouls_avg: 23.67, penalties_ap: 0.17, yellows_ap: 3.67, yellows: 44, reds_ap: 0.50, reds: 6 },
                { name: "Luca Pairetto", matches: 12, fouls_avg: 26.58, penalties_ap: 0.92, yellows_ap: 4.33, yellows: 52, reds_ap: 0.25, reds: 3 },
                { name: "Gianluca Manganiello", matches: 12, fouls_avg: 24.08, penalties_ap: 0.17, yellows_ap: 3.50, yellows: 42, reds_ap: 0.17, reds: 2 },
                { name: "Massimiliano Irrati", matches: 11, fouls_avg: 27.00, penalties_ap: 0.64, yellows_ap: 5.64, yellows: 62, reds_ap: 0.27, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 11, fouls_avg: 25.55, penalties_ap: 0.09, yellows_ap: 3.45, yellows: 38, reds_ap: 0.27, reds: 3 },
                { name: "Francesco Fourneau", matches: 11, fouls_avg: 27.45, penalties_ap: 0.36, yellows_ap: 4.73, yellows: 52, reds_ap: 0.27, reds: 3 },
                { name: "Luca Massimi", matches: 11, fouls_avg: 29.27, penalties_ap: 0.18, yellows_ap: 4.27, yellows: 47, reds_ap: 0.27, reds: 3 },
                { name: "Giovanni Ayroldi", matches: 11, fouls_avg: 29.82, penalties_ap: 0.18, yellows_ap: 5.36, yellows: 59, reds_ap: 0.18, reds: 2 },
                { name: "Alessandro Prontera", matches: 10, fouls_avg: 26.70, penalties_ap: 0.50, yellows_ap: 4.70, yellows: 47, reds_ap: 0.40, reds: 4 },
                { name: "Antonio Rapuano", matches: 9, fouls_avg: 26.22, penalties_ap: 0.44, yellows_ap: 4.11, yellows: 37, reds_ap: 0.56, reds: 5 },
                { name: "Davide Ghersini", matches: 8, fouls_avg: 21.38, penalties_ap: 0.63, yellows_ap: 3.25, yellows: 26, reds_ap: 0.13, reds: 1 },
                { name: "Gianluca Aureliano", matches: 8, fouls_avg: 29.63, penalties_ap: 0.75, yellows_ap: 5.13, yellows: 41, reds_ap: 0.25, reds: 2 },
                { name: "Marco Piccinini", matches: 8, fouls_avg: 26.00, penalties_ap: 0.38, yellows_ap: 4.25, yellows: 34, reds_ap: 0.50, reds: 4 },
                { name: "Matteo Marchetti", matches: 8, fouls_avg: 26.13, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 36, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 7, fouls_avg: 31.14, penalties_ap: 0.14, yellows_ap: 4.86, yellows: 34, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 7, fouls_avg: 26.86, penalties_ap: 0.43, yellows_ap: 3.57, yellows: 25, reds_ap: 0.43, reds: 3 },
                { name: "Antonio Giua", matches: 6, fouls_avg: 25.67, penalties_ap: 0.50, yellows_ap: 5.33, yellows: 32, reds_ap: 0.17, reds: 1 },
                { name: "Manuel Volpi", matches: 6, fouls_avg: 31.17, penalties_ap: 0.50, yellows_ap: 6.17, yellows: 37, reds_ap: 0.33, reds: 2 },
                { name: "Piero Giacomelli", matches: 5, fouls_avg: 29.60, penalties_ap: 0.40, yellows_ap: 4.60, yellows: 23, reds_ap: 0.00, reds: 0 },
                { name: "Marco Serra", matches: 5, fouls_avg: 24.80, penalties_ap: 1.00, yellows_ap: 5.20, yellows: 26, reds_ap: 0.20, reds: 1 },
                { name: "Lorenzo Maggioni", matches: 4, fouls_avg: 29.00, penalties_ap: 0.50, yellows_ap: 5.00, yellows: 20, reds_ap: 0.25, reds: 1 },
                { name: "Giacomo Camplone", matches: 3, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 3.67, yellows: 11, reds_ap: 0.67, reds: 2 },
                { name: "Andrea Colombo", matches: 3, fouls_avg: 25.33, penalties_ap: 0.00, yellows_ap: 5.33, yellows: 16, reds_ap: 0.33, reds: 1 },
                { name: "Matteo Marcenaro", matches: 3, fouls_avg: 28.33, penalties_ap: 0.33, yellows_ap: 4.67, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Valerio Marini", matches: 2, fouls_avg: 28.50, penalties_ap: 1.50, yellows_ap: 5.50, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Santoro", matches: 2, fouls_avg: 25.50, penalties_ap: 0.00, yellows_ap: 2.50, yellows: 5, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Gariglio", matches: 2, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Cosso", matches: 2, fouls_avg: 25.00, penalties_ap: 1.00, yellows_ap: 5.00, yellows: 10, reds_ap: 1.00, reds: 2 },
                { name: "Antonio Di Martino", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Niccolò Baroni", matches: 1, fouls_avg: 23.00, penalties_ap: 2.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Paterna", matches: 1, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Meraviglia", matches: 1, fouls_avg: 29.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Gianpiero Miele", matches: 1, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 }
            ],
            "2020-21": [
                { name: "Maurizio Mariani", matches: 18, fouls_avg: 27.11, penalties_ap: 0.50, yellows_ap: 3.67, yellows: 66, reds_ap: 0.11, reds: 2 },
                { name: "Daniele Doveri", matches: 17, fouls_avg: 29.06, penalties_ap: 0.29, yellows_ap: 4.06, yellows: 69, reds_ap: 0.00, reds: 0 },
                { name: "Davide Massa", matches: 17, fouls_avg: 27.76, penalties_ap: 0.35, yellows_ap: 4.47, yellows: 76, reds_ap: 0.24, reds: 4 },
                { name: "Marco Di Bello", matches: 17, fouls_avg: 27.41, penalties_ap: 0.47, yellows_ap: 4.65, yellows: 79, reds_ap: 0.18, reds: 3 },
                { name: "Piero Giacomelli", matches: 17, fouls_avg: 29.65, penalties_ap: 0.65, yellows_ap: 4.59, yellows: 78, reds_ap: 0.06, reds: 1 },
                { name: "Gianpaolo Calvarese", matches: 16, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 3.50, yellows: 56, reds_ap: 0.31, reds: 5 },
                { name: "Daniele Chiffi", matches: 16, fouls_avg: 27.75, penalties_ap: 0.31, yellows_ap: 3.56, yellows: 57, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Orsato", matches: 15, fouls_avg: 29.07, penalties_ap: 0.13, yellows_ap: 5.13, yellows: 77, reds_ap: 0.13, reds: 2 },
                { name: "Luca Pairetto", matches: 15, fouls_avg: 28.67, penalties_ap: 0.47, yellows_ap: 3.80, yellows: 57, reds_ap: 0.40, reds: 6 },
                { name: "Michael Fabbri", matches: 14, fouls_avg: 23.57, penalties_ap: 0.36, yellows_ap: 4.57, yellows: 64, reds_ap: 0.21, reds: 3 },
                { name: "Fabio Maresca", matches: 14, fouls_avg: 26.64, penalties_ap: 0.07, yellows_ap: 6.00, yellows: 84, reds_ap: 0.29, reds: 4 },
                { name: "Paolo Valeri", matches: 13, fouls_avg: 27.00, penalties_ap: 0.38, yellows_ap: 4.38, yellows: 57, reds_ap: 0.23, reds: 3 },
                { name: "Rosario Abisso", matches: 13, fouls_avg: 27.23, penalties_ap: 0.62, yellows_ap: 4.31, yellows: 56, reds_ap: 0.31, reds: 4 },
                { name: "Marco Piccinini", matches: 13, fouls_avg: 27.85, penalties_ap: 0.38, yellows_ap: 3.62, yellows: 47, reds_ap: 0.08, reds: 1 },
                { name: "Fabrizio Pasqua", matches: 12, fouls_avg: 25.00, penalties_ap: 0.25, yellows_ap: 3.42, yellows: 41, reds_ap: 0.25, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 12, fouls_avg: 25.75, penalties_ap: 0.33, yellows_ap: 4.17, yellows: 50, reds_ap: 0.08, reds: 1 },
                { name: "Massimiliano Irrati", matches: 11, fouls_avg: 27.73, penalties_ap: 0.09, yellows_ap: 4.55, yellows: 50, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 10, fouls_avg: 27.70, penalties_ap: 0.50, yellows_ap: 4.20, yellows: 42, reds_ap: 0.30, reds: 3 },
                { name: "Federico La Penna", matches: 10, fouls_avg: 28.00, penalties_ap: 0.40, yellows_ap: 4.80, yellows: 48, reds_ap: 0.40, reds: 4 },
                { name: "Gianluca Manganiello", matches: 10, fouls_avg: 25.40, penalties_ap: 0.20, yellows_ap: 3.00, yellows: 30, reds_ap: 0.10, reds: 1 },
                { name: "Francesco Fourneau", matches: 9, fouls_avg: 29.00, penalties_ap: 0.67, yellows_ap: 5.56, yellows: 50, reds_ap: 0.22, reds: 2 },
                { name: "Valerio Marini", matches: 7, fouls_avg: 30.57, penalties_ap: 0.71, yellows_ap: 4.29, yellows: 30, reds_ap: 0.00, reds: 0 },
                { name: "Giovanni Ayroldi", matches: 7, fouls_avg: 26.00, penalties_ap: 0.57, yellows_ap: 3.86, yellows: 27, reds_ap: 0.43, reds: 3 },
                { name: "Gianluca Aureliano", matches: 6, fouls_avg: 26.17, penalties_ap: 0.67, yellows_ap: 5.50, yellows: 33, reds_ap: 0.00, reds: 0 },
                { name: "Livio Marinelli", matches: 6, fouls_avg: 23.83, penalties_ap: 0.17, yellows_ap: 4.00, yellows: 24, reds_ap: 0.17, reds: 1 },
                { name: "Antonio Giua", matches: 6, fouls_avg: 31.00, penalties_ap: 0.33, yellows_ap: 3.83, yellows: 23, reds_ap: 0.33, reds: 2 },
                { name: "Simone Sozza", matches: 6, fouls_avg: 25.00, penalties_ap: 0.17, yellows_ap: 3.33, yellows: 20, reds_ap: 0.33, reds: 2 },
                { name: "Ivano Pezzuto", matches: 5, fouls_avg: 28.40, penalties_ap: 0.80, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Alessandro Prontera", matches: 5, fouls_avg: 28.60, penalties_ap: 0.40, yellows_ap: 3.40, yellows: 17, reds_ap: 0.40, reds: 2 },
                { name: "Manuel Volpi", matches: 5, fouls_avg: 32.20, penalties_ap: 0.40, yellows_ap: 3.20, yellows: 16, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 5, fouls_avg: 29.40, penalties_ap: 0.40, yellows_ap: 4.40, yellows: 22, reds_ap: 0.00, reds: 0 },
                { name: "Davide Ghersini", matches: 4, fouls_avg: 25.75, penalties_ap: 1.00, yellows_ap: 4.50, yellows: 18, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Di Martino", matches: 4, fouls_avg: 28.75, penalties_ap: 0.25, yellows_ap: 4.75, yellows: 19, reds_ap: 0.75, reds: 3 },
                { name: "Antonio Rapuano", matches: 4, fouls_avg: 27.50, penalties_ap: 0.50, yellows_ap: 4.75, yellows: 19, reds_ap: 0.00, reds: 0 },
                { name: "Luca Massimi", matches: 4, fouls_avg: 31.25, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 18, reds_ap: 0.25, reds: 1 },
                { name: "Eugenio Abbattista", matches: 3, fouls_avg: 26.33, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 15, reds_ap: 0.33, reds: 1 },
                { name: "Marco Serra", matches: 2, fouls_avg: 33.00, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 9, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Paterna", matches: 2, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Santoro", matches: 2, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Gariglio", matches: 2, fouls_avg: 25.00, penalties_ap: 0.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Marchetti", matches: 2, fouls_avg: 32.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Riccardo Ros", matches: 1, fouls_avg: 37.00, penalties_ap: 1.00, yellows_ap: 6.00, yellows: 6, reds_ap: 1.00, reds: 1 },
                { name: "Lorenzo Maggioni", matches: 1, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Giacomo Camplone", matches: 1, fouls_avg: 20.00, penalties_ap: 1.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Meraviglia", matches: 1, fouls_avg: 22.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 1.00, reds: 1 }
            ],
        };

        // -----------------------
        // --- LOGIC SECTION ---
        // -----------------------
        let currentView = 'stats';

        let activeSeasons = ['2025-26'];

        let sortColumn = 'matches';
        let sortDirection = 'desc';
        let minMatchesFilter = 0;
        let hideInactive = false;

        const REFEREES_2425 = ["Feliciani", "Ayroldi", "Fabbri", "Maresca", "Caputi", "Marchetti", "Marinelli", "Tremolada", "Massa", "Marcenaro", "Sacchi", "Doveri", "Di Marco", "Mariani", "Rapuano", "Sozza", "Pairetto", "Zufferli", "Di Bello", "Giua", "Colombo", "Guida", "Prontera", "Piccinini", "La Penna", "Abisso", "Aureliano", "Manganiello", "Fourneau", "Chiffi", "Dionisi", "Collu", "Massimi", "Bonacina", "Cosso", "Perenzoni", "Ghersini", "Monaldi", "Rutella"];
        const REFEREES_2526 = ["Massa", "Ayroldi", "Collu", "Zufferli", "Sozza", "Manganiello", "Arena", "Marcenaro", "Tremolada", "La Penna", "Guida", "Marinelli", "Doveri", "Mariani", "Bonacina", "Chiffi", "Abisso", "Marchetti", "Crezzini", "Fourneau", "Colombo", "Piccinini", "Rapuano", "Feliciani", "Fabbri", "Dionisi", "Di Bello", "Pairetto", "Sacchi", "Pezzuto", "Di Marco", "Galipò", "Perenzoni", "Ghersini", "Rutella", "Camplone", "Monaldi", "Cosso", "Santoro", "Scatena"];

        const ACTIVE_EXCEPTIONS = ["Maresca", "Caputi", "Ferrieri Caputi"];
        const HISTORICAL_SURNAMES = ["Irrati", "Orsato", "Valeri", "Pasqua", "Calvarese", "Giacomelli"];

        // --- Parsing Functions (IMPROVED for TIME FORMATS) ---

        function parseTimeStr(str) {
            if(!str || str.trim().toUpperCase() === 'ND') return NaN;
            const clean = str.replace(/[^\d,\.]/g, '').replace(',', '.');
            const parts = clean.split('.');
            let m = parseInt(parts[0]) || 0;
            let s = parts.length > 1 ? parseInt(parts[1]) : 0;
            return (m * 60) + s;
        }

        function formatSecondsToTime(totalSeconds) {
            if(isNaN(totalSeconds)) return "ND";
            if(!totalSeconds && totalSeconds !== 0) return "00'00''";
            const m = Math.floor(totalSeconds / 60);
            const s = Math.round(totalSeconds % 60);
            return `${m}'${s.toString().padStart(2, '0')}''`;
        }

        function parseItalianFloat(str) {
            if(!str || str.trim().toUpperCase() === 'ND') return NaN;
            return parseFloat(str.replace(',', '.').replace('%', ''));
        }

        function isRefereeActive(name) {
            const searchName = name.toUpperCase();
            if (activeSeasons.includes('2025-26')) {
                 if (REFEREES_2526.some(surname => searchName.includes(surname.toUpperCase()))) return true;
                 if (ACTIVE_EXCEPTIONS.some(ex => searchName.includes(ex.toUpperCase()))) return true;
            }
            if (!activeSeasons.includes('2025-26') && activeSeasons.includes('2024-25')) {
                 if (REFEREES_2425.some(surname => searchName.includes(surname.toUpperCase()))) return true;
            }
            return REFEREES_2526.some(surname => searchName.includes(surname.toUpperCase())) ||
                   ACTIVE_EXCEPTIONS.some(ex => searchName.includes(ex.toUpperCase()));
        }

        // Helper to format Name SURNAME (Robust Fix)
        function formatRefereeNameHTML(fullName) {
            const upperName = fullName.toUpperCase();
            // Combine all potential surnames
            const allSurnames = [...REFEREES_2526, ...REFEREES_2425, ...ACTIVE_EXCEPTIONS, ...HISTORICAL_SURNAMES];

            // Find surnames that match at the END of the string or as a separate word
            const matches = allSurnames.filter(s => {
                const sUp = s.toUpperCase();
                // Check if name ENDS with SURNAME or contains SURNAME preceded by space
                return upperName.endsWith(" " + sUp) || upperName === sUp || upperName.includes(" " + sUp + " ");
            });

            // If multiple matches (e.g. Di Bello), take longest
            const match = matches.sort((a, b) => b.length - a.length)[0];

            let surname = "";
            let firstname = "";

            if (match) {
                // Split based on the found surname
                const idx = upperName.lastIndexOf(match.toUpperCase());
                surname = fullName.substring(idx);
                firstname = fullName.substring(0, idx).trim();
            } else {
                // Fallback: Last word is surname
                const parts = fullName.split(' ');
                surname = parts.pop();
                firstname = parts.join(' ');
            }

            // Title case firstname
            const formattedFirst = firstname.toLowerCase().split(' ').map(word =>
                word.charAt(0).toUpperCase() + word.slice(1)
            ).join(' ');

            return `<span class="font-sans font-normal text-slate-400 capitalize">${formattedFirst}</span> <span class="font-sans font-bold text-white uppercase">${surname}</span>`;
        }

        function parseMatchesDB(dbString, season) {
            if(!dbString) return [];

            // Ritorna lista vuota se la stringa è vuota, per evitare di processare una riga vuota
            if (dbString.trim() === '') return [];

            return dbString.trim().split('\n').map(line => {
                // FIX: Rendi il parsing robusto: usa espressione regolare per split su tabulazioni multiple
                const p = line.trim().split(/\t+/);

                // Il formato dei dati è: [Partita] [T.Tot] [T.Eff] [%] [Falli]
                // Questo richiede almeno 5 colonne. Se non ci sono 5 colonne, la riga viene ignorata.
                if (p.length < 5) return null;

                const matchName = p[0].trim();
                const tSec = parseTimeStr(p[1]);
                const eSec = parseTimeStr(p[2]);

                // Conversione robusta della percentuale e dei falli
                const ratioVal = parseItalianFloat(p[3]);
                const fouls = parseInt(p[4]) || 0;

                // Le colonne per Gialli, Rossi e Rigori non sono presenti nel formato 5-colonne
                const yellows = p.length > 5 ? (parseInt(p[5]) || 0) : 0;
                const reds = p.length > 6 ? (parseInt(p[6]) || 0) : 0;
                const pens = p.length > 7 ? (parseItalianFloat(p[7]) || 0) : 0;

                return {
                    match: matchName, totalTimeSec: tSec, effectiveTimeSec: eSec,
                    fouls: fouls, yellows: yellows, reds: reds, pens: pens,
                    ratio: ratioVal, season: season, rawTotal: p[1], rawEff: p[2]
                };
            }).filter(x => x);
        }

        function parsePlayingTimeDB(dbString, season) {
             if(!dbString) return [];

             // Ritorna lista vuota se la stringa è vuota
             if (dbString.trim() === '') return [];

             return dbString.trim().split('\n').map(line => {
                 const p = line.split('\t');
                 if (p.length < 2) return null;
                 // Modified to read a 3rd column (Total Time) if present
                 return {
                     season: season,
                     referee: p[0].trim(),
                     effectiveTimeSec: parseTimeStr(p[1]),
                     totalTimeSec: p.length > 2 ? parseTimeStr(p[2]) : NaN
                 };
             }).filter(x => x);
        }

        // --- Data Processing (UNCHANGED) ---

        function processStatsData() {
            let statsMap = new Map();
            const sourceDB = (typeof db !== 'undefined') ? db : STATS_DB;

            activeSeasons.forEach(season => {
                if (sourceDB[season] && sourceDB[season].length > 0) {
                    sourceDB[season].forEach(m => {
                        if (!statsMap.has(m.name)) {
                            statsMap.set(m.name, {
                                name: m.name, matches: 0, fouls: 0, yellows: 0, reds: 0, pens: 0, isInactive: false,
                                w_avgFouls: 0, w_avgYellows: 0, w_avgReds: 0, w_avgPens: 0
                            });
                        }
                        let r = statsMap.get(m.name);
                        r.matches += m.matches;
                        r.yellows += m.yellows;
                        r.reds += m.reds;
                        r.w_avgFouls += m.fouls_avg * m.matches;
                        r.w_avgYellows += m.yellows_ap * m.matches;
                        r.w_avgReds += m.reds_ap * m.matches;
                        r.w_avgPens += m.penalties_ap * m.matches;
                    });
                }
                else {
                    const refData = parsePlayingTimeDB(PLAYING_TIME_DB[season], season);
                    if(refData.length > 0) { }
                }
            });

            return Array.from(statsMap.values()).map(r => {
                r.avgFouls = r.matches ? (r.w_avgFouls / r.matches) : 0;
                r.avgYellows = r.matches ? (r.w_avgYellows / r.matches) : 0;
                r.avgReds = r.matches ? (r.w_avgReds / r.matches) : 0;
                r.avgPens = r.matches ? (r.w_avgPens / r.matches) : 0;
                r.isInactive = !isRefereeActive(r.name);
                return r;
            });
        }

        function processPlayingTimeViewData() {
            let statsMap = new Map();
            // L'analisi del tempo effettivo si basa sui dati in PLAYING_TIME_DB e MATCHES_DB.

            // 1. Raccogli tutti i match data rilevanti (usato per l'abbinamento)
            let allMatchData = [];
            activeSeasons.forEach(s => {
                let db = null;
                if(s === '2025-26') db = MATCHES_DB_2526 + EXTRA_MATCHES_2526;
                else if(s === '2024-25') db = MATCHES_DB_2425;
                if(db) allMatchData = allMatchData.concat(parseMatchesDB(db, s));
            });

            // 2. Processa le righe di presenza (refData)
            activeSeasons.forEach(season => {
                const refData = parsePlayingTimeDB(PLAYING_TIME_DB[season], season);

                // Set per tracciare le partite già assegnate (per evitare duplicati)
                const assignedMatches = new Set();

                refData.forEach(entry => {
                    if (!statsMap.has(entry.referee)) {
                        statsMap.set(entry.referee, {
                            name: entry.referee,
                            matches: 0,
                            totalEffectiveSec: 0,
                            totalTotalSec: 0,
                            validEffMatches: 0,
                            validTotMatches: 0,
                            matchList: [],
                            has2526: false
                        });
                    }
                    let r = statsMap.get(entry.referee);
                    r.matches++; // Count the match even if ND

                    if(!isNaN(entry.effectiveTimeSec)) {
                        r.totalEffectiveSec += entry.effectiveTimeSec;
                        r.validEffMatches++;
                    }

                    if(season === '2025-26') r.has2526 = true;

                    let match = null;
                    const TOLERANCE = 2; // Tolerance for time matching (in seconds)

                    // --- LOGICA DI ABBINAMENTO MIGLIORATA (GREEDY) ---

                    // Filtra matchData per escludere partite già assegnate E PER STAGIONE
                    const unassignedMatchesSeason = allMatchData.filter(m => !assignedMatches.has(m.match) && m.season === season);

                    // 1. Primo tentativo: Match esatto su Tempo Effettivo (se valido)
                    if (!isNaN(entry.effectiveTimeSec)) {
                         match = unassignedMatchesSeason.find(m => Math.abs(m.effectiveTimeSec - entry.effectiveTimeSec) < 1);
                    }

                    // 2. Secondo tentativo: Match su Tempo Totale (Fallback)
                    if (!match && !isNaN(entry.totalTimeSec)) {
                         const entryHasND = isNaN(entry.effectiveTimeSec);

                         // Trova candidati con lo stesso Tempo Totale (tolleranza 2 secondi)
                         const candidates = unassignedMatchesSeason.filter(m => Math.abs(m.totalTimeSec - entry.totalTimeSec) < TOLERANCE);

                         if (candidates.length > 0) {
                             if (entryHasND) {
                                 // Se l'arbitro ha ND, dai priorità ASSOLUTA a partite che hanno ND nel tempo effettivo
                                 match = candidates.find(m => isNaN(m.effectiveTimeSec));
                             }
                             // Se non c'è match ND o se l'arbitro aveva tempo effettivo valido ma non trovato, prendi il miglior candidato per tempo totale
                             if (!match) match = candidates[0];
                         }
                    }

                    if(match) {
                         r.matchList.push(match); // <-- Se trova la partita, la aggiunge alla lista dell'arbitro
                         assignedMatches.add(match.match); // Marca la partita come assegnata

                         if(!isNaN(match.totalTimeSec)) {
                             r.totalTotalSec += match.totalTimeSec;
                             r.validTotMatches++;
                         }
                    } else {
                        // Fallback logic for unmatched referee presence row
                        let manualTotal = !isNaN(entry.totalTimeSec) ? entry.totalTimeSec : NaN;
                        if(!isNaN(manualTotal)) {
                            r.totalTotalSec += manualTotal;
                            r.validTotMatches++;
                        }

                        r.matchList.push({
                            match: "Dettaglio non disp.",
                            season: season,
                            effectiveTimeSec: entry.effectiveTimeSec,
                            totalTimeSec: manualTotal,
                            fouls: 0, yellows: 0, reds: 0, pens: 0, ratio: NaN // Dati fittizi per mantenere la struttura
                        });
                    }
                });
            });

            return Array.from(statsMap.values()).map(r => {
                // Calculate averages based on VALID counts only
                r.avgEffSec = r.validEffMatches ? (r.totalEffectiveSec / r.validEffMatches) : 0;
                r.avgTotSec = r.validTotMatches ? (r.totalTotalSec / r.validTotMatches) : 0;
                return r;
            });
        }

        function processMatchesViewData() {
            let all = [];
            activeSeasons.forEach(s => {
                let db = null;
                if(s === '2025-26') {
                    db = MATCHES_DB_2526 + EXTRA_MATCHES_2526;
                }
                else if(s === '2024-25') db = MATCHES_DB_2425;

                // Chiama parseMatchesDB che è uniforme per entrambe le stagioni
                if(db) all = all.concat(parseMatchesDB(db, s));
            });
            return all;
        }

        // FUNZIONE UNICA DI AGGREGAZIONE E ROUTER
        function aggregateData() {
            let result = [];

            // 1. Reset UI States
            document.getElementById('stats-controls').classList.add('hidden');
            document.getElementById('playing-time-title').classList.add('hidden');
            document.getElementById('matches-title').classList.add('hidden');
            document.getElementById('disclaimer-2526').classList.add('hidden');
            document.getElementById('update-alert-2526').classList.add('hidden');
            document.getElementById('empty-state-msg').classList.add('hidden');
            document.getElementById('historical-data-msg').classList.add('hidden');
            document.getElementById('mainTable').classList.remove('hidden');

            const is2526Active = activeSeasons.includes('2025-26');
            const historicalSeasons = ['2020-21', '2021-22', '2022-23', '2023-24'];
            const isOnlyHistorical = activeSeasons.every(s => historicalSeasons.includes(s)) && activeSeasons.length > 0;

            // 2. Data Processing based on View
            if (currentView === 'stats') {
                document.getElementById('stats-controls').classList.remove('hidden');
                if(is2526Active) document.getElementById('update-alert-2526').classList.remove('hidden');
                result = processStatsData();

                // Dynamic Filter Update (only for Stats)
                if(result.length > 0) {
                    const maxMatches = Math.max(...result.map(r => r.matches));
                    const slider = document.getElementById('minMatches');
                    slider.max = maxMatches;
                    if(parseInt(slider.value) > maxMatches) {
                        slider.value = 0;
                        updateMinMatches(0);
                        minMatchesFilter = 0;
                        document.getElementById('minMatchesValue').innerText = 0;
                    }
                }

                // FILTRI PER STATS (APPLICATI SOLO QUI)
                result = result.filter(r => r.matches >= minMatchesFilter);
                if(hideInactive) result = result.filter(r => !r.isInactive);
            }
            else if (currentView === 'playingTime') {
                document.getElementById('playing-time-title').classList.remove('hidden');
                if(is2526Active) document.getElementById('disclaimer-2526').classList.remove('hidden');
                if (isOnlyHistorical) {
                    document.getElementById('mainTable').classList.add('hidden');
                    document.getElementById('historical-data-msg').classList.remove('hidden');
                    document.getElementById('historical-msg-title').innerText = `Dati Stagione ${activeSeasons.join(', ')} in arrivo`;
                    renderTable([]); // Reset table
                    return;
                }

                result = processPlayingTimeViewData();
            }
            else if (currentView === 'matches') {
                document.getElementById('matches-title').classList.remove('hidden');
                if(is2526Active) {
                     document.getElementById('disclaimer-2526').classList.remove('hidden');
                     document.getElementById('update-alert-2526').classList.remove('hidden');
                }
                if (isOnlyHistorical) {
                    document.getElementById('mainTable').classList.add('hidden');
                    document.getElementById('historical-data-msg').classList.remove('hidden');
                    document.getElementById('historical-msg-title').innerText = `Dati Stagione ${activeSeasons.join(', ')} in arrivo`;
                    renderTable([]); // Reset table
                    return;
                }

                result = processMatchesViewData();
            }

            // 3. Search Filter Logic (APPLICATO A TUTTE LE VISTE SUL CAMPO PERTINENTE)
            const searchInput = document.getElementById('searchInput');
            if(currentView === 'matches') searchInput.placeholder = "es. inter-milan";
            else searchInput.placeholder = "Cerca...";

            const q = searchInput.value.toLowerCase();
            if(q && result.length > 0) {
                if(currentView === 'matches') result = result.filter(r => r.match.toLowerCase().includes(q));
                else result = result.filter(r => r.name.toLowerCase().includes(q));
            }

            // 4. Sorting
            if (result.length > 0) {
                result.sort((a, b) => {
                    let va = a[sortColumn], vb = b[sortColumn];
                    if (typeof va === 'string') return sortDirection === 'asc' ? va.localeCompare(vb) : vb.localeCompare(va);
                    return sortDirection === 'desc' ? vb - va : va - vb;
                });
            }

            // 5. Render
            renderTable(result);
            if(currentView === 'stats') renderStatsInsights(result);
            else if(currentView === 'matches') renderMatchesInsights(result);
            // Non c'è bisogno di un 'else' qui, perché il container viene aggiornato solo per stats e matches
        }

        // --- Render ---
        function renderTable(data) {
            const thead = document.getElementById('tableHeader');
            const tbody = document.getElementById('tableBody');
            const tfoot = document.getElementById('tableFooter');

            // RESET COMPLETO DELLA TABELLA PRIMA DI OGNI NUOVO RENDERING
            thead.innerHTML = ''; tbody.innerHTML = ''; tfoot.innerHTML = '';

            if(data.length === 0) {
                document.getElementById('empty-state-msg').classList.remove('hidden');
                document.getElementById('mainTable').classList.add('hidden');
                return;
            }
            document.getElementById('empty-state-msg').classList.add('hidden');
            document.getElementById('mainTable').classList.remove('hidden');


            if (currentView === 'stats') {
                // STATS VIEW RENDERING
                thead.innerHTML = `<tr>
                    <th class="p-2 sm:p-4 sticky-col-head cursor-pointer hover:text-white" onclick="handleSort('name')">Arbitro</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-white text-lime-400 font-bold" onclick="handleSort('matches')">Presenze</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-red-400 text-red-400" onclick="handleSort('avgFouls')">Falli/P</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-yellow-400 text-yellow-400" onclick="handleSort('yellows')">Gialli Tot</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-yellow-600 text-yellow-600" onclick="handleSort('avgYellows')">Gialli/P</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-red-500 text-red-500" onclick="handleSort('reds')">Rossi Tot</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-red-700 text-red-700" onclick="handleSort('avgReds')">Rossi/P</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-white" onclick="handleSort('avgPens')">Rigori/P</th>
                </tr>`;

                let totMatches = 0, totYellows = 0, totReds = 0;
                let totalFouls = 0, totalPens = 0;

                data.forEach((r, i) => {
                    totMatches += r.matches;
                    totYellows += r.yellows;
                    totReds += r.reds;
                    totalFouls += r.avgFouls * r.matches;
                    totalPens += r.avgPens * r.matches;

                    const row = document.createElement('tr');
                    const inactiveStyle = r.isInactive ? 'opacity-60' : '';
                    row.className = `border-b border-white/5 ${inactiveStyle}`;
                    row.innerHTML = `
                        <td class="p-2 sm:p-4 sticky-col-body font-sans text-white tracking-wide">
                            ${formatRefereeNameHTML(r.name)}
                        </td>
                        <td class="p-2 sm:p-4 text-center font-mono text-lime-400 font-bold">${r.matches}</td>
                        <td class="p-2 sm:p-4 text-center font-mono font-medium text-red-300">${r.avgFouls.toFixed(2)}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-yellow-400 font-bold">${r.yellows}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-yellow-600">${r.avgYellows.toFixed(2)}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-red-500 font-bold">${r.reds}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-red-700">${r.avgReds.toFixed(2)}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-slate-500">${r.avgPens.toFixed(2)}</td>
                    `;
                    tbody.appendChild(row);
                });

                const globalAvgFouls = totalFouls / (totMatches || 1);
                const globalAvgYellows = totYellows / (totMatches || 1);
                const globalAvgReds = totReds / (totMatches || 1);
                const globalAvgPens = totalPens / (totMatches || 1);

                tfoot.innerHTML = `
                    <tr class="text-[9px] sm:text-xs uppercase tracking-widest bg-slate-800 border-t-2 border-white/20">
                        <td class="p-2 sm:p-4 font-bold text-white sticky-col-body">Totali / Medie</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-lime-400 font-bold">${totMatches}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-white">${globalAvgFouls.toFixed(2)}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-yellow-400 font-bold">${totYellows}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-yellow-600">${globalAvgYellows.toFixed(2)}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-red-500 font-bold">${totReds}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-red-700">${globalAvgReds.toFixed(2)}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-slate-400">${globalAvgPens.toFixed(2)}</td>
                    </tr>
                `;
            }
            else if (currentView === 'playingTime') {
                // PLAYING TIME VIEW RENDERING
                const showTotalTime = activeSeasons.includes('2025-26') || activeSeasons.includes('2024-25');

                thead.innerHTML = `<tr>
                    <th class="p-2 sm:p-4 sticky-col-head w-1/4 cursor-pointer hover:text-white" onclick="handleSort('name')">Arbitro</th>
                    <th class="p-2 sm:p-4 text-center w-24 cursor-pointer hover:text-white" onclick="handleSort('matches')">Partite</th>
                    <th class="p-2 sm:p-4 text-right cursor-pointer hover:text-white text-green-400" onclick="handleSort('avgEffSec')">Media T.E.</th>
                    ${showTotalTime ? `<th class="p-2 sm:p-4 text-right text-blue-400 cursor-pointer hover:text-white" onclick="handleSort('avgTotSec')">Media T. Tot</th>` : ''}
                    <th class="p-2 sm:p-4 text-center w-8 sm:w-10"></th>
                </tr>`;

                let sumMatches = 0, sumEffSec = 0, sumTotSec = 0;
                let validEffCount = 0, validTotCount = 0;

                data.forEach((r, i) => {
                    sumMatches += r.matches;
                    sumEffSec += r.totalEffectiveSec;
                    sumTotSec += r.totalTotalSec;
                    validEffCount += r.validEffMatches;
                    validTotCount += r.validTotMatches;

                    const tr = document.createElement('tr');
                    tr.className = "border-b border-white/5 cursor-pointer hover:bg-white/5 group";
                    tr.onclick = () => toggleDetails(i);
                    tr.innerHTML = `
                        <td class="p-2 sm:p-2.5 sticky-col-body font-sans text-white tracking-wide">
                            ${formatRefereeNameHTML(r.name)}
                        </td>
                        <td class="p-2 sm:p-2.5 text-center font-mono text-slate-300">${r.matches}</td>
                        <td class="p-2 sm:p-2.5 text-right font-mono font-medium text-green-400">${formatSecondsToTime(r.avgEffSec)}</td>
                        ${showTotalTime ? `<td class="p-2 sm:p-2.5 text-right font-mono text-blue-400">${formatSecondsToTime(r.avgTotSec)}</td>` : ''}
                        <td class="p-2 sm:p-2.5 text-center text-slate-500 group-hover:text-white"><i class="fa-solid fa-chevron-down text-[10px] sm:text-xs transition-transform" id="icon-${i}"></i></td>
                    `;
                    tbody.appendChild(tr);

                    const detailsTr = document.createElement('tr');
                    detailsTr.id = `details-${i}`;
                    detailsTr.className = "details-row";
                    const colSpan = showTotalTime ? 5 : 4;
                    let matchesHtml = r.matchList.map(m => {
                        // FIX: Center ND values
                        const effDisplay = formatSecondsToTime(m.effectiveTimeSec);
                        const totDisplay = formatSecondsToTime(m.totalTimeSec);
                        const effClass = effDisplay === 'ND' ? "text-center text-slate-500" : "text-right text-green-400 font-medium";
                        const totClass = totDisplay === 'ND' ? "text-center text-slate-500" : "text-right text-blue-400";

                        return `
                        <div class="flex justify-between items-center py-2 border-b border-white/5 last:border-0 text-[10px] sm:text-xs">
                            <span class="text-white w-1/3 font-bold truncate pr-2">${m.match}</span>
                            <span class="text-slate-500 font-mono w-14 sm:w-16">${m.season}</span>
                            <span class="${effClass} font-mono w-16 sm:w-20">${effDisplay === 'ND' ? 'ND' : 'Eff: ' + effDisplay}</span>
                            <span class="${totClass} font-mono w-16 sm:w-20">${totDisplay === 'ND' ? 'ND' : 'Tot: ' + totDisplay}</span>
                        </div>
                    `}).join('');

                    detailsTr.innerHTML = `
                        <td colspan="${colSpan}" class="p-0">
                            <div class="bg-slate-900/50 p-2 sm:p-4 shadow-inner">
                                <h4 class="text-[9px] sm:text-[10px] uppercase font-bold text-slate-500 mb-2 tracking-widest">Dettaglio Partite</h4>
                                ${matchesHtml || '<span class="text-slate-600 text-xs italic">Nessun dettaglio partita disponibile.</span>'}
                            </div>
                        </td>
                    `;
                    tbody.appendChild(detailsTr);
                });

                const globalAvgEffSec = validEffCount > 0 ? (sumEffSec / validEffCount) : 0;
                const globalAvgTotSec = validTotCount > 0 ? (sumTotSec / validTotCount) : 0;

                tfoot.innerHTML = `
                    <tr class="text-[9px] sm:text-xs uppercase tracking-widest bg-slate-800 border-t-2 border-white/20">
                        <td class="p-2 sm:p-4 font-bold text-white sticky-col-body">Totali / Medie</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-white">${sumMatches}</td>
                        <td class="p-2 sm:p-4 text-right font-mono text-green-300">${formatSecondsToTime(globalAvgEffSec)}</td>
                        ${showTotalTime ? `<td class="p-2 sm:p-4 text-right font-mono text-blue-300">${formatSecondsToTime(globalAvgTotSec)}</td>` : ''}
                        <td class="p-2 sm:p-4 text-center font-mono text-white"></td>
                    </tr>
                `;

            }
            else { // Matches View RENDERING
                thead.innerHTML = `<tr>
                    <th class="p-2 sm:p-4 sticky-col-head cursor-pointer hover:text-white" onclick="handleSort('match')">Partita</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-white" onclick="handleSort('season')">Stagione</th>
                    <th class="p-2 sm:p-4 text-right text-blue-400 cursor-pointer hover:text-white" onclick="handleSort('totalTimeSec')">T. Totale</th>
                    <th class="p-2 sm:p-4 text-right text-green-400 cursor-pointer hover:text-white" onclick="handleSort('effectiveTimeSec')">T. Effettivo</th>
                    <th class="p-2 sm:p-4 text-center cursor-pointer hover:text-white" onclick="handleSort('ratio')">%</th>
                    <th class="p-2 sm:p-4 text-center text-red-500 cursor-pointer hover:text-white" onclick="handleSort('fouls')">Falli</th>
                </tr>`;

                let sumTotSec = 0, sumEffSec = 0, sumFouls = 0, sumRatio = 0;
                let validTotCount = 0, validEffCount = 0, validRatioCount = 0;

                data.forEach(r => {
                    if(!isNaN(r.totalTimeSec)) { sumTotSec += r.totalTimeSec; validTotCount++; }
                    if(!isNaN(r.effectiveTimeSec)) { sumEffSec += r.effectiveTimeSec; validEffCount++; }
                    sumFouls += r.fouls;
                    if(!isNaN(r.ratio)) { sumRatio += r.ratio; validRatioCount++; }
                    const displayRatio = isNaN(r.ratio) ? "ND" : `${r.ratio}%`;
                    const displayEff = formatSecondsToTime(r.effectiveTimeSec);
                    const displayTot = formatSecondsToTime(r.totalTimeSec);

                    // FIX: Center ND values in T. Effettivo
                    const effClass = displayEff === 'ND'
                        ? "text-center text-slate-500"
                        : "text-right text-green-400 font-medium";

                    const tr = document.createElement('tr');
                    tr.className = "border-b border-white/5 hover:bg-white/5";
                    tr.innerHTML = `
                        <td class="p-2 sm:p-4 sticky-col-body font-sans font-bold text-white uppercase tracking-wide truncate max-w-[150px] sm:max-w-none">${r.match}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-slate-500">${r.season}</td>
                        <td class="p-2 sm:p-4 text-right font-mono text-blue-400 font-medium">${displayTot}</td>
                        <td class="p-2 sm:p-4 font-mono ${effClass}">${displayEff}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-slate-400">${displayRatio}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-red-500 font-bold">${r.fouls}</td>
                    `;
                    tbody.appendChild(tr);
                });

                const count = data.length || 1;
                const avgRatio = validRatioCount > 0 ? (sumRatio/validRatioCount) : 0;
                const avgTotSec = validTotCount > 0 ? (sumTotSec/validTotCount) : 0;
                const avgEffSec = validEffCount > 0 ? (sumEffSec/validEffCount) : 0;

                tfoot.innerHTML = `
                    <tr class="text-[9px] sm:text-xs uppercase tracking-widest bg-slate-800 border-t-2 border-white/20">
                        <td class="p-2 sm:p-4 font-bold text-white sticky-col-body">Medie Partite Visibili</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-white">-</td>
                        <td class="p-2 sm:p-4 text-right font-mono text-blue-300">${formatSecondsToTime(avgTotSec)}</td>
                        <td class="p-2 sm:p-4 text-right font-mono text-green-300">${formatSecondsToTime(avgEffSec)}</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-white">${avgRatio.toFixed(1)}%</td>
                        <td class="p-2 sm:p-4 text-center font-mono text-red-300">${(sumFouls/count).toFixed(1)}</td>
                    </tr>
                `;
            }
        }

        function toggleDetails(index) {
            const row = document.getElementById(`details-${index}`);
            const icon = document.getElementById(`icon-${index}`);
            if(row.classList.contains('open')) {
                row.classList.remove('open');
                icon.style.transform = 'rotate(0deg)';
            } else {
                row.classList.add('open');
                icon.style.transform = 'rotate(180deg)';
            }
        }

        function handleSort(col) {
            if (sortColumn === col) sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            else { sortColumn = col; sortDirection = 'desc'; }
            aggregateData();
        }

        function switchView(view) {
            currentView = view;
            document.querySelectorAll('.nav-switcher-btn').forEach(b => b.classList.remove('active'));
            if(view === 'stats') document.getElementById('nav-stats').classList.add('active');
            if(view === 'playingTime') document.getElementById('nav-time').classList.add('active');
            if(view === 'matches') document.getElementById('nav-matches').classList.add('active');

            // Imposta l'ordinamento iniziale per la nuova vista (NON AGGREGA QUI)
            if(view === 'stats') { sortColumn = 'matches'; sortDirection = 'desc'; }
            else if(view === 'playingTime') { sortColumn = 'avgEffSec'; sortDirection = 'desc'; }
            else if(view === 'matches') { sortColumn = 'match'; sortDirection = 'asc'; }

            // Ricarica i dati per la nuova vista (chiamata pulita ad aggregateData)
            aggregateData();
        }

        function toggleSeason(s) {
            if(activeSeasons.includes(s)) activeSeasons = activeSeasons.filter(x => x !== s);
            else activeSeasons.push(s);
            updateSeasonButtonsUI();
            aggregateData();
        }

        function toggleAllSeasons() {
            const all = ['2025-26','2024-25','2023-24','2022-23','2021-22','2020-21'];
            activeSeasons = activeSeasons.length === all.length ? [] : [...all];
            updateSeasonButtonsUI();
            aggregateData();
        }

        function updateSeasonButtonsUI() {
            ['2025-26','2024-25','2023-24','2022-23','2021-22','2020-21'].forEach(s => {
                const btn = document.getElementById(`btn-${s}`);
                const icon = btn.querySelector('.check-icon');
                if(activeSeasons.includes(s)) {
                    btn.classList.add('active'); icon.classList.remove('opacity-0');
                } else {
                    btn.classList.remove('active'); icon.classList.add('opacity-0');
                }
            });
        }

        function updateMinMatches(val) {
            minMatchesFilter = parseInt(val);
            document.getElementById('minMatchesValue').innerText = val;
            aggregateData();
        }

        function toggleInactiveRefs() {
            hideInactive = document.getElementById('toggleInactive').checked;
            aggregateData();
        }

        function handleSearch() { aggregateData(); }

        function renderStatsInsights(data) {
             const c = document.getElementById('insights-container');
             c.innerHTML = `
                <div class="glass-panel p-4 rounded-xl border-l-4 border-yellow-500">
                    <div class="text-[10px] uppercase tracking-widest text-slate-500 font-bold mb-1">Arbitri Visualizzati</div>
                    <div class="text-xl sm:text-2xl text-white font-mono font-medium">${data.length}</div>
                </div>
             `;
        }

        function renderMatchesInsights(data) {
             const c = document.getElementById('insights-container');
             c.innerHTML = `
                <div class="glass-panel p-4 rounded-xl border-l-4 border-blue-500">
                    <div class="text-[10px] uppercase tracking-widest text-slate-500 font-bold mb-1">Partite Selezionate</div>
                    <div class="text-xl sm:text-2xl text-white font-mono font-medium">${data.length}</div>
                </div>
             `;
        }

        function toggleDesignationsModal(shouldOpen) {
            const modal = document.getElementById('designations-modal');
            if (shouldOpen) {
                modal.classList.add('open');
                document.body.style.overflow = 'hidden'; // Evita lo scroll del contenuto principale
            } else {
                modal.classList.remove('open');
                document.body.style.overflow = ''; // Ripristina lo scroll
            }
        }


        window.onload = function() {
            updateSeasonButtonsUI();
            aggregateData();
        };
    </script>
</body>
</html>
