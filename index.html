<!DOCTYPE html>
<html lang="it" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RefereeLab - Analytics</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        dark: {
                            900: '#0B0F19', // Deep Midnight
                            800: '#111827',
                            700: '#1F2937',
                        },
                        gold: {
                            400: '#FACC15',
                            500: '#EAB308',
                            600: '#CA8A04',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { 
            background-color: #050505;
            background-image: 
                radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
                radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
            background-attachment: fixed;
            background-size: cover;
        }
        
        /* Glassmorphism Utilities */
        .glass-panel {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .glass-header {
            background: rgba(11, 15, 25, 0.85);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #4b5563; }

        /* Season Button Styling */
        .season-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .season-btn.active {
            background: linear-gradient(135deg, #EAB308 0%, #CA8A04 100%);
            color: #000;
            border-color: transparent;
            box-shadow: 0 0 15px rgba(234, 179, 8, 0.3);
        }
        .season-btn:hover:not(.active) {
            background: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.3);
        }

        /* Slider Styling */
        input[type=range] {
            -webkit-appearance: none; 
            background: transparent; 
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: #EAB308;
            cursor: pointer;
            margin-top: -7px;
            box-shadow: 0 0 10px rgba(234, 179, 8, 0.5);
            transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #374151;
            border-radius: 2px;
        }

        /* Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #ef4444; /* Red for hiding */
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #ef4444;
        }
        
        /* Table Transitions */
        tr { transition: background-color 0.2s ease, transform 0.1s ease; }

        /* Expandable Row Animation */
        .details-row {
            transition: all 0.3s ease-in-out;
            opacity: 0;
            visibility: hidden;
            max-height: 0;
            display: none; 
        }
        .details-row.open {
            opacity: 1;
            visibility: visible;
            max-height: 500px; /* Arbitrary large height for animation */
            display: table-row;
        }
        
        .view-title {
            text-shadow: 0 0 20px rgba(234, 179, 8, 0.3);
        }

        /* Nav Switcher */
        .nav-switcher-btn {
            transition: all 0.3s ease;
        }
        .nav-switcher-btn.active {
            background-color: #EAB308;
            color: black;
            font-weight: 700;
        }
        .nav-switcher-btn:not(.active) {
            color: #94a3b8;
        }
        .nav-switcher-btn:not(.active):hover {
            color: white;
        }

        /* STICKY COLUMN CSS - Optimized for Mobile */
        .sticky-col-head {
            position: sticky;
            left: 0;
            z-index: 30 !important;
            background-color: #0f172a; /* Matches header bg */
        }
        
        .sticky-col-body {
            position: sticky;
            left: 0;
            z-index: 20;
            background-color: #050505; /* Matches body main bg to cover scrolling content */
            border-right: 1px solid rgba(255,255,255,0.05);
        }
        
        /* Slight shadow only on the right edge to show separation when scrolling */
        .sticky-col-head::after, .sticky-col-body::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 5px;
            background: linear-gradient(to right, rgba(0,0,0,0.2), transparent);
            pointer-events: none;
        }

        /* Tooltip custom style */
        [title] {
            position: relative;
            cursor: help;
        }

    </style>
</head>
<body class="text-slate-200 font-sans antialiased min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="glass-header sticky top-0 z-50 border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                
                <!-- Logo -->
                <div class="flex items-center gap-3 cursor-pointer flex-shrink-0" onclick="window.location.reload()">
                    <div class="bg-gradient-to-br from-yellow-400 to-yellow-600 p-2 rounded-lg shadow-lg shadow-yellow-500/20">
                        <i class="fa-solid fa-whistle text-xl text-black"></i>
                    </div>
                    <div class="flex flex-col md:block hidden">
                        <span class="font-bold text-2xl tracking-tight text-white leading-none">Referee<span class="text-yellow-500">Lab</span></span>
                    </div>
                </div>
                
                <!-- Center Navigation Switcher -->
                <div class="flex items-center bg-slate-900/80 rounded-full p-1 border border-white/10 mx-2 overflow-x-auto">
                    <button onclick="switchView('stats')" id="nav-stats" class="nav-switcher-btn active px-4 py-1.5 rounded-full text-xs uppercase tracking-wider flex items-center gap-2 whitespace-nowrap">
                        <i class="fa-solid fa-chart-simple"></i> <span class="hidden sm:inline">Statistiche</span>
                    </button>
                    <button onclick="switchView('playingTime')" id="nav-time" class="nav-switcher-btn px-4 py-1.5 rounded-full text-xs uppercase tracking-wider flex items-center gap-2 whitespace-nowrap">
                        <i class="fa-solid fa-stopwatch"></i> <span class="hidden sm:inline">Tempo Effettivo</span>
                        <span class="sm:hidden">T. Eff.</span>
                    </button>
                    <button onclick="switchView('matches')" id="nav-matches" class="nav-switcher-btn px-4 py-1.5 rounded-full text-xs uppercase tracking-wider flex items-center gap-2 whitespace-nowrap">
                        <i class="fa-solid fa-futbol"></i> <span>Partite</span>
                    </button>
                </div>

                <!-- Social -->
                <div class="flex items-center gap-6 flex-shrink-0">
                    <a href="https://instagram.com/reflab25" target="_blank" class="flex items-center gap-2 px-3 md:px-4 py-2 rounded-full bg-white/5 hover:bg-gradient-to-r hover:from-pink-500 hover:to-purple-600 hover:text-white transition-all duration-300 group border border-white/10">
                        <i class="fa-brands fa-instagram text-xl group-hover:scale-110 transition-transform"></i>
                        <span class="text-sm font-medium hidden md:inline">@reflab25</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-2 sm:px-6 lg:px-8 py-4 sm:py-8 w-full">
        
        <!-- Main Grid Layout -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6">
            
            <!-- Left Column: Controls & Insights -->
            <div class="lg:col-span-1 space-y-6">
                
                <!-- Controls Panel -->
                <div class="glass-panel rounded-2xl p-5 h-fit space-y-6">
                    
                    <!-- Common Controls (Always Visible) -->
                    <div id="common-controls" class="space-y-6">
                        <!-- Cerca Arbitro / Partita -->
                        <div>
                            <label class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 block" id="searchLabel">Cerca</label>
                            <div class="relative">
                                <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-500"></i>
                                <input type="text" id="searchInput" oninput="handleSearch()" placeholder="Nome arbitro..." 
                                    class="bg-slate-900/50 border border-white/10 text-white text-sm rounded-xl focus:ring-yellow-500 focus:border-yellow-500 block w-full pl-10 p-3 transition-all placeholder-slate-600 hover:bg-slate-900/80">
                            </div>
                        </div>

                        <!-- Stagioni -->
                        <div>
                            <label class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 block">Stagione</label>
                            <div class="flex flex-col gap-2" id="season-buttons">
                                <button onclick="toggleSeason('2025-26')" id="btn-2025-26" class="season-btn active px-4 py-2 rounded-lg text-sm font-bold border border-white/10 text-slate-300 w-full text-left flex justify-between items-center" data-season="2025-26">
                                    2025/2026 <i class="fa-solid fa-check opacity-0 check-icon"></i>
                                </button>
                                <button onclick="toggleSeason('2024-25')" id="btn-2024-25" class="season-btn px-4 py-2 rounded-lg text-sm font-bold border border-white/10 text-slate-300 w-full text-left flex justify-between items-center" data-season="2024-25">
                                    2024/2025 <i class="fa-solid fa-check opacity-0 check-icon"></i>
                                </button>
                                <button onclick="toggleSeason('2023-24')" id="btn-2023-24" class="season-btn px-4 py-2 rounded-lg text-sm font-bold border border-white/10 text-slate-300 w-full text-left flex justify-between items-center" data-season="2023-24">
                                    2023/2024 <i class="fa-solid fa-check opacity-0 check-icon"></i>
                                </button>
                                <button onclick="toggleSeason('2022-23')" id="btn-2022-23" class="season-btn px-4 py-2 rounded-lg text-sm font-bold border border-white/10 text-slate-300 w-full text-left flex justify-between items-center" data-season="2022-23">
                                    2022/2023 <i class="fa-solid fa-check opacity-0 check-icon"></i>
                                </button>
                                <button onclick="toggleSeason('2021-22')" id="btn-2021-22" class="season-btn px-4 py-2 rounded-lg text-sm font-bold border border-white/10 text-slate-300 w-full text-left flex justify-between items-center" data-season="2021-22">
                                    2021/2022 <i class="fa-solid fa-check opacity-0 check-icon"></i>
                                </button>
                                <button onclick="toggleSeason('2020-21')" id="btn-2020-21" class="season-btn px-4 py-2 rounded-lg text-sm font-bold border border-white/10 text-slate-300 w-full text-left flex justify-between items-center" data-season="2020-21">
                                    2020/2021 <i class="fa-solid fa-check opacity-0 check-icon"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Only Controls -->
                    <div id="stats-controls" class="space-y-6">
                        <!-- Filtro Inattivi -->
                        <div class="flex items-center justify-between">
                            <label class="text-xs font-bold text-slate-400 uppercase tracking-wider">Nascondi Inattivi (*)</label>
                            <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                <input type="checkbox" name="toggle" id="toggleInactive" onclick="toggleInactiveRefs()" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-300 left-0 border-slate-600"/>
                                <label for="toggleInactive" class="toggle-label block overflow-hidden h-5 rounded-full bg-slate-700 cursor-pointer"></label>
                            </div>
                        </div>

                        <!-- Slider Presenze -->
                        <div class="bg-slate-900/40 p-4 rounded-xl border border-white/5">
                            <div class="flex justify-between items-center mb-3">
                                <div class="flex items-center gap-2">
                                    <i class="fa-solid fa-filter text-yellow-500"></i>
                                    <span class="text-xs font-bold text-slate-300 uppercase tracking-wider">Min. Presenze</span>
                                </div>
                                <span id="minMatchesValue" class="bg-yellow-500/10 text-yellow-500 border border-yellow-500/20 font-mono font-bold px-2 py-0.5 rounded text-sm">0</span>
                            </div>
                            <div class="relative w-full h-6 flex items-center px-1">
                                <input type="range" id="minMatches" min="0" max="10" value="0" step="1" class="w-full z-20 relative" oninput="updateMinMatches(this.value)">
                            </div>
                            <div class="flex justify-between text-[10px] text-slate-500 font-mono mt-1">
                                <span>0</span>
                                <span id="maxMatchesLabel">MAX</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Playing Time / Matches Controls -->
                    <div id="extra-controls" class="hidden space-y-6">
                        <!-- Placeholders if needed -->
                    </div>
                </div>
                
                <!-- Top Insights Cards (Only for Stats view) -->
                <div id="insights-container" class="flex flex-col gap-4">
                    <!-- Populated by JS -->
                </div>

            </div>

            <!-- Right Column: Content Area -->
            <div class="lg:col-span-3 flex flex-col gap-6">

                <!-- Data Table Container -->
                <div class="glass-panel rounded-2xl overflow-hidden shadow-2xl border border-slate-700 relative min-h-[400px] flex flex-col">
                    
                    <!-- Playing Time Title (Hidden by default) -->
                    <div id="playing-time-title" class="hidden w-full text-center py-6 border-b border-white/10 bg-slate-900/50">
                        <h2 class="text-2xl md:text-3xl font-bold text-white tracking-tight view-title">
                            TEMPO <span class="text-green-400">EFFETTIVO</span>
                        </h2>
                        <p class="text-slate-400 text-xs uppercase tracking-widest mt-2 font-semibold">Media minuti giocati per partita</p>
                    </div>
                    
                    <!-- Matches Title (Hidden by default) -->
                    <div id="matches-title" class="hidden w-full text-center py-6 border-b border-white/10 bg-slate-900/50">
                        <h2 class="text-2xl md:text-3xl font-bold text-white tracking-tight view-title">
                            ELENCO <span class="text-blue-400">PARTITE</span>
                        </h2>
                        <p class="text-slate-400 text-xs uppercase tracking-widest mt-2 font-semibold">Dettaglio Tempo di Gioco</p>
                    </div>

                    <div class="overflow-x-auto flex-grow">
                        <table class="w-full text-sm text-left text-slate-300" id="mainTable">
                            <thead class="text-[10px] sm:text-xs text-slate-400 uppercase bg-slate-950/50 border-b border-white/10 sticky top-0 z-40 backdrop-blur-md" id="tableHeader">
                                <!-- Headers populated by JS based on view -->
                            </thead>
                            <tbody id="tableBody" class="divide-y divide-slate-700">
                                <!-- Rows populated by JS -->
                            </tbody>
                            <tfoot class="bg-slate-950/80 border-t border-slate-700 font-bold text-white" id="tableFooter">
                                 <!-- Footer populated by JS -->
                            </tfoot>
                        </table>
                    </div>

                    <!-- Disclaimer per 2025/26 -->
                    <div id="disclaimer-2526" class="hidden w-full border-t border-white/10 bg-slate-900/30 p-4">
                        <p class="bg-yellow-500/10 border border-yellow-500/20 text-yellow-200 text-xs p-3 rounded-lg flex items-center justify-center gap-2 text-center">
                            <i class="fa-solid fa-triangle-exclamation text-yellow-500 flex-shrink-0"></i>
                            <span>Attenzione: i dati sul tempo effettivo della stagione 2025/26 non sono completi in quanto non comunicati regolarmente dalla Lega Serie A.</span>
                        </p>
                    </div>
                    
                    <!-- Disclaimer Aggiornamento (per Partite 25/26) -->
                    <div id="disclaimer-update" class="hidden w-full border-t border-white/10 bg-slate-900/30 p-4">
                        <p class="bg-blue-500/10 border border-blue-500/20 text-blue-200 text-xs p-3 rounded-lg flex items-center justify-center gap-2 text-center">
                            <i class="fa-solid fa-circle-check text-blue-500 flex-shrink-0"></i>
                            <span>Dati aggiornati all'11 giornata.</span>
                        </p>
                    </div>
                </div>

            </div>
        </div>
        
       
        <div class="mt-2 text-center">
            <p class="text-xs text-slate-500">Â© 2025 RefereeLab. Tutti i diritti riservati.</p>
        </div>

    </main>

    <script>
        // --- RAW DATA ---
        const RAW_LOOKUP_2526 = `Genoa-Lecce	Massa	46,53
Sassuolo-Napoli	Ayroldi	60,05
Milan-Cremonese	Collu	65,26
Roma-Bologna	Zufferli	59,56
Cagliari-Fiorentina	Sozza	49,03
Como-Lazio	Manganiello	54,15
Atalanta-Pisa	Arena	57,39
Juventus-Parma	Marcenaro	55,01
Udinese-Verona	Tremolada	54,35
Inter-Torino	La Penna	52,19
Cremonese-Sassuolo	Guida	59,20
Lecce-Milan	Marinelli	58,39
Bologna-Como	Doveri	55,35
Parma-Atalanta	Mariani	59,53
Napoli-Cagliari	Bonacina	64,09
Pisa-Roma	Collu	59,27
Genoa-Juventus	Chiffi	54,37
Torino-Fiorentina	Abisso	51,30
Inter-Udinese	Marchetti	57,38
Lazio-Verona	Crezzini	59,58
Cagliari-Parma	Fourneau	54,11
Juventus-Inter	Colombo	54,23
Fiorentina-Napoli	Zufferli	54,04
Roma-Torino	Ayroldi	56,51
Atalanta-Lecce	Manganiello	58,12
Pisa-Udinese	Massa	58,32
Sassuolo-Lazio	Tremolada	63,56
Milan-Bologna	Marcenaro	59,39
Verona-Cremonese	Arena	61,52
Como-Genoa	Piccinini	57,30
Lecce-Cagliari	Zufferli	53,19
Bologna-Genoa	Collu	53,57
Verona-Juventus	Rapuano	54,14
Udinese-Milan	Doveri	65,04
Lazio-Roma	Sozza	51,06
Cremonese-Parma	La Penna	56,21
Torino-Atalanta	Colombo	63,29
Fiorentina-Como	Bonacina	58,50
Inter-Sassuolo	Marinelli	56,21
Napoli-Pisa	Crezzini	57,06
Verona-Sassuolo	Fourneau	49,17
Lazio-Torino	Piccinini	54,51
Parma-Lecce	Doveri	47,10
Inter-Cremonese	Feliciani	55,44
Atalanta-Como	Zufferli	56,48
Udinese-Cagliari	Arena	50,42
Bologna-Pisa	Abisso	51,05
Fiorentina-Roma	Colombo	49,19
Juventus-Milan	Guida	57,17
Pisa-Verona	Guida	52,04
Torino-Napoli	Marcenaro	60,15
Roma-Inter	Massa	55,18
Como-Juventus	Ayroldi	48,03
Cagliari-Bologna	Marchetti	50,55
Genoa-Parma	Sozza	53,50
Atalanta-Lazio	Collu	64,07
Milan-Fiorentina	Marinelli	54,05
Cremonese-Udinese	Fabbri	49,12
Milan-Pisa	Zufferli	56,45
Parma-Como	Chiffi	56,10
Udinese-Lecce	Feliciani	51,39
Napoli-Inter	Mariani	54,57
Cremonese-Atalanta	Arena	57,39
Torino-Genoa	Bonacina	52,06
Sassuolo-Roma	Manganiello	49,54
Verona-Cagliari	Dionisi	54,13
Fiorentina-Bologna	La Penna	43,00
Lazio-Juventus	Colombo	54,45
Lecce-Napoli	Collu	54,46
Atalanta-Milan	Doveri	59,25
Como-Verona	Marcenaro	53,25
Juventus-Udinese	Di Bello	51,31
Roma-Parma	Crezzini	53,34
Bologna-Torino	Ayroldi	57,36
Genoa-Cremonese	Abisso	46,31
Inter-Fiorentina	Sozza	54,25
Cagliari-Sassuolo	Pairetto	50,07
Pisa-Lazio	Massa	57,15
Udinese-Atalanta	Fabbri	57,43
Napoli-Como	Zufferli	56,49
Cremonese-Juventus	Chiffi	58,32
Verona-Inter	Doveri	57,18
Fiorentina-Lecce	Rapuano	52,10
Torino-Pisa	Arena	52,41
Parma-Bologna	Bonacina	47,22
Milan-Roma	Guida	56,38
Sassuolo-Genoa	Feliciani	55,16
Lazio-Cagliari	Sacchi	57,15
Pisa-Cremonese	Marcenaro	53,23
Como-Cagliari	Pezzuto	51,53
Lecce-Verona	Abisso	48,07
Juventus-Torino	Zufferli	64,42
Parma-Milan	Di Bello	57,59
Atalanta-Sassuolo	Crezzini	60,28
Bologna-Napoli	Chiffi	54,49
Genoa-Fiorentina	Guida	46,12
Roma-Udinese	Collu	58,53
Inter-Lazio	Manganiello	59,00`;

        const RAW_LOOKUP_2425 = `Genoa-Inter	Feliciani	103,10	46,39
Parma-Fiorentina	Ayroldi	97,04	48,46
Empoli-Monza	Fabbri	100,37	44,43
Milan-Torino	Maresca	101,58	58,27
Bologna-Udinese	Caputi	100,25	48,59
Verona-Napoli	Marchetti	101,32	48,53
Cagliari-Roma	Marinelli	94,22	53,36
Lazio-Venezia	Tremolada	96,00	56,00
Lecce-Atalanta	Massa	92,58	54,12
Juventus-Como	Marcenaro	99,04	56,43
Parma-Milan	Sacchi	98,04	59,00
Udinese-Lazio	Doveri	103,14	49,49
Inter-Lecce	Di Marco	98,08	56,21
Monza-Genoa	Mariani	105,55	56,58
Torino-Atalanta	Rapuano	103,21	51,08
Fiorentina-Venezia	Sozza	97,03	55,29
Napoli-Bologna	Pairetto	101,09	53,23
Roma-Empoli	Zufferli	97,20	58,22
Cagliari-Como	Di Bello	100,35	53,12
Verona-Juventus	Giua	97,02	61,58
Venezia-Torino	Marcenaro	99,08	52,45
Inter-Atalanta 	Marchetti	97,01	53,40
Bologna-Empoli 	Marinelli	103,12	55,44
Lecce-Cagliari	Fabbri	100,37	47,36
Lazio-Milan	Massa	97,00	54,06
Napoli-Parma	Tremolada	109,08	60,21
Fiorentina-Monza	Colombo	103,20	54,53
Genoa-Verona	Ayroldi	99,33	51,32
Juventus-Roma	Guida	96,58	58,50
Udinese-Como	Prontera	103,30	54,24
Como-Bologna	Piccinini	103,14	54,03
Empoli-Juventus	Di Bello	95,14	60,04
Milan-Venezia	Di Marco	97,55	57,21
Genoa-Roma	Giua	104,11	53,12
Atalanta-Fiorentina	Sacchi	95,42	51,04
Torino-Lecce	Colombo	95,10	54,31
Cagliari-Napoli	La Penna	102,10	50,07
Monza-Inter	Pairetto	95,18	57,28
Parma-Udinese	Abisso	96,05	53,01
Lazio-Verona	Zufferli	96,07	56,25
Cagliari-Empoli	Sozza	97,05	48,44
Verona-Torino	Marinelli	97,05	60,20
Venezia-Genoa	Marchetti	100,20	48,20
Juventus-Napoli	Doveri	96,26	64,10
Lecce-Parma	Guida	98,37	54,32
Fiorentina-Lazio	Marcenaro	97,15	52,35
Monza-Bologna	Massa	95,05	55,34
Roma-Udinese	Feliciani	95,00	55,33
Inter-Milan	Mariani	97,50	55,33
Atalanta-Como	Tremolada	98,35	58,21
Milan-Lecce	Zufferli	96,02	55,41
Udinese-Inter	Sacchi	98,00	61,58
Genoa-Juventus	Colombo	95,10	58,44
Bologna-Atalanta	Rapuano	97,44	57,29
Torino-Lazio	Sozza	96,10	57,06
Como-Verona	Giua	96,57	49,47
Roma-Venezia	Abisso	96,08	52,36
Empoli-Fiorentina	Aureliano	94,11	54,28
Napoli-Monza	Manganiello	95,57	60,33
Parma-Cagliari	Fourneau	95,58	55,21
Napoli-Como	Feliciani	96,28	59,25
Verona-Venezia	Guida	95,02	47,29
Udinese-Lecce	Mariani	95,50	55,10
Atalanta-Genoa	Chiffi	95,55	55,41
Inter-Torino	Marcenaro	98,30	54,09
Juventus-Cagliari	Marinelli	99,01	60,08
Bologna-Parma	Di Bello	95,58	54,55
Lazio-Empoli	Ayroldi	100,48	53,07
Monza-Roma	La Penna	99,08	56,25
Fiorentina-Milan	Pairetto	97,26	48,43
Como-Parma	Fabbri	96,09	60,51
Genoa-Bologna	Doveri	95,51	47,58
Milan-Udinese	Chiffi	106,27	52,59
Juventus-Lazio	Sacchi	97,31	56,44
Empoli-Napoli	Abisso	96,05	51,43
Lecce-Fiorentina	Fourneau	93,03	53,12
Venezia-Atalanta	Zufferli	94,10	54,15
Cagliari-Torino	Aureliano	96,35	52,53
Roma-Inter	Massa	97,00	59,00
Verona-Monza	Dionisi	94,00	54,17
Udinese-Cagliari	Manganiello	94,51	54,38
Torino-Como	Ayroldi	97,40	55,42
Napoli-Lecce	Tremolada	96,27	52,02
Bologna-Milan	Mariani	96,21	53,33
Atalanta-Verona	Feliciani	91,25	58,27
Parma-Empoli	La Penna	95,45	55,33
Lazio-Genoa	Piccinini	96,07	57,36
Monza-Venezia	Rapuano	95,57	49,01
Inter-Juventus	Guida	95,12	52,00
Fiorentina-Roma	Sozza	94,27	55,39
Cagliari-Bologna	Fourneau	94,25	55,29
Lecce-Verona	Mariani	98,15	49,06
Milan-Napoli	Colombo	96,55	60,55
Empoli-Inter	Marchetti	96,01	55,51
Venezia-Udinese	Massa	97,22	49,10
Atalanta-Monza	Piccinini	96,20	57,39
Juventus-Parma	Zufferli	95,30	61,18
Genoa-Fiorentina	Chiffi	98,09	52,02
Como-Lazio	Pairetto	97,44	50,20
Roma-Torino	Fabbri	95,15	59,29
Bologna-Lecce	Collu	95,25	50,36
Udinese-Juventus	Abisso	96,07	55,50
Monza-Milan	Feliciani	98,17	56,22
Napoli-Atalanta	Doveri	96,00	62,27
Torino-Fiorentina	La Penna	97,17	59,23
Verona-Roma	Marcenaro	97,43	53,58
Inter-Venezia	Caputi	99,15	55,55
Empoli-Como	Di Bello	96,10	54,05
Parma-Genoa	Guida	97,16	51,42
Lazio-Cagliari	Ayroldi	96,13	54,05
Genoa-Como	Rapuano	98,16	50,21
Lecce-Empoli	Sacchi	97,00	51,23
Venezia-Parma	Chiffi	95,15	57,06
Cagliari-Milan	Fabbri	100,14	54,30
Juventus-Torino	Sozza	95,06	55,08
Atalanta-Udinese	Di Bello	98,40	51,34
Fiorentina-Verona	Zufferli	96,53	46,44
Roma-Bologna	Manganiello	98,55	49,51
Monza-Lazio	Colombo	97,01	56,45
Inter-Napoli	Mariani	95,15	56,03
Verona-Inter	Colombo	93,00	65,30
Milan-Juvenrus	Chiffi	95,40	59,45
Parma-Atalanta	Manganiello	95,40	66,25
Genoa-Cagliari	Sozza	98,00	53,26
Como-Fiorentina	Marchetti	97,00	55,23
Torino-Monza	Abisso	93,12	57,26
Napoli-Roma	Massa	93,51	58,44
Lazio-Bologna	Rapuano	94,57	55,30
Empoli-Udinese	Marinelli	95,22	58,51
Venezia-Lecce	Pairetto	96,01	56,21
Cagliari-Verona	Mariani	95,29	50,46
Como-Monza	Sacchi	96,30	51,14
Milan-Empoli	Dionisi	95,43	54,43
Bologna-Venezia	Massimi	96,14	49,35
Udinese-Genoa	Aureliano	97,10	57,46
Parma-Lazio	Zufferli	103,52	55,40
Torino-Napoli	Fabbri	94,42	59,16
Fiorentina-Inter	Doveri	101,09	53,53
Lecce-Juventus	Rapuano	95,05	62,25
Roma-Atalanta	Guida	95,03	55,10
Inter-Parma	Abisso	95,00	55,37
Atalanta-Milan	La Penna	97,25	59,24
Genoa-Torino	Marinelli	96,34	56,35
Juventus-Bologna	Marchetti	98,03	52,19
Roma-Lecce	Chiffi	97,28	55,05
Fiorentina-Cagliari	Piccinini	96,03	53,17
Verona-Empoli	Di Bello	97,20	54,48
Venezia-Como	Doveri	95,28	44,33
Napoli-Lazio	Colombo	98,45	58,47
Monza-Udinese	Manganiello	97,10	53,45
Empoli-Torino	Bonacina	95,04	49,22
Cagliari-Atalanta	Pairetto	96,30	57,31
Udinese-Napoli	Doveri	97,00	51,56
Juventus-Venezia	Giua	98,50	59,57
Lecce-Monza	Mariani	99,07	47,00
Bologna-Fiorentina	Fabbri	96,02	48,30
Parma-Verona	Sozza	95,56	54,08
Como-Roma	Rapuano	98,32	52,56
Milan-Genoa	Guida	96,57	61,42
Lazio-Inter	Chiffi	99,10	55,11
Verona-Milan	Marinelli	99,21	54,44
Torino-Bologna	Piccinini	101,15	56,57
Genoa-Napoli	La Penna	97,03	57,55
Lecce-Lazio	Manganiello	100,19	56,47
Roma-Parma	Di Bello	91,06	55,55
Venezia-Cagliari	Guida	96,33	49,18
Atalanta-Empoli	Feliciani	98,00	54,38
Monza-Juventus	Massa	96,32	61,14
Fiorentina-Udinese	Marcenaro	100,55	53,21
Inter-Como	Giua	94,10	52,23
Empoli-Genoa	Rapuano	98,00	51,47
Parma-Monza	La Penna	100,00	48,53
Cagliari-Inter	Doveri	95,15	52,18
Lazio-Atalanta	Massa	96,05	58,07
Udinese-Torino	Fourneau	97,09	54,20
Napoli-Venezia	Cosso	95,30	54,07
Juventus-Fiorentina	Mariani	97,05	51,51
Milan-Roma	Fabbri	96,05	51,06
Como-Lecce	Piccinini	96,37	52,23
Bologna-Verona	Ayroldi	97,39	46,47
Venezia-Empoli	Sacchi	94,56	51,16
Fiorentina-Napoli	Manganiello	95,50	49,34
Verona-Udinese	Dionisi	96,00	50,49
Monza-Cagliari	Di Bello	99,18	48,31
Lecce-Genoa	Marinelli	94,12	54,20
Torino-Parma	Feliciani	97,10	59,17
Roma-Lazio	Pairetto	97,15	53,25
Como-Milan	Manganiello	95,10	50,49
Atalanta-Juventus	Doveri	97,45	64,13
Inter-Bologna	Pairetto	96,05	52,32
Lazio-Como	Tremolada	95,03	47,58
Lecce-Empoli	Chiffi	98,34	49,09
Udinese-Atalanta	Mariani	97,38	58,41
Torino-Juventus	Fabbri	96,58	60,08
Milan-Cagliari	Fourneau	96,38	56,05
Genoa-Parma	Colombo	96,37	52,11
Venezia-Inter	Piccinini	95,18	55,10
Bologna-Roma	Abisso	98,34	54,11
Napoli-Verona	Zufferli	93,00	62,26
Monza-Fiorentina	Dionisi	97,05	60,55
Roma-Genoa	Zufferli	96,00	58,40
Bologna-Monza	Mariani	97,41	59,30
Juventus-Milan	Massa	95,14	56,11
Atalanta-Napoli	Colombo	95,06	57,43
Fiorentina-Torino	Marinelli	96,47	56,28
Cagliari-Lecce	Sacchi	95,56	51,45
Parma-Venezia	Fourneau	97,07	50,03
Verona-Lazio	Fabbri	94,55	55,10
Inter-Empoli	Feliciani	95,18	57,07
Como-Udinese	Cosso	95,57	51,13
Torino-Cagliari	Bonacina	95,20	57,17
Como-Atalanta	Pairetto	97,39	56,26
Napoli-Juventus	Chiffi	97,37	54,14
Empoli-Bologna	La Penna	98,56	46,31
Milan-Parma	Abisso	99,11	52,02
Udinese-Roma	Sozza	99,57	56,19
Lecce-Inter	Marinelli	93,56	57,11
Lazio-Fiorentina	Rapuano	100,15	53,46
Venezia-Verona	Manganiello	96,56	49,18
Genoa-Monza	Doveri	97,00	41,34
Parma-Lecce	Sozza	97,15	56,49
Monza-Verona	Massa	95,47	53,12
Udinese-Venezia	Mariani	97,41	42,22
Atalanta-Torino	Piccinini	101,01	63,01
Bologna-Como	Massimi	96,40	50,12
Juventus-Empoli	Zufferli	95,12	45,47
Fiorentina-Genoa	Collu	96,09	47,18
Milan-Inter	Chiffi	98,05	58,36
Roma-Napoli	Fabbri	96,44	57,50
Cagliari-Lazio	Manganiello	96,15	55,09
Como-Juventus	Abisso	96,52	50,13
Verona-Atalanta	Sozza	93,51	56,03
Empoli-Milan	Pairetto	98,38	48,47
Torino-Genoa	Feliciani	98,42	57,33
Venezia-Roma	Zufferli	95,45	53,23
Cagliari-Parma	Di Bello	96,34	52,57
Lazio-Monza	Aureliano	94,15	55,49
Lecce-Bologna	Fourneau	100,17	52,43
Napoli-Udinese	Marinelli	97,20	57,54
Inter-Fiorentina	La Penna	96,10	54,37
Bologna-Torino	Fabbri	95,32	46,59
Atalanta-Cagliari	Marchetti	95,19	64,30
Lazio-Napoli	Massa	94,58	55,22
Milan-Verona	Fourneau	96,20	49,24
Fiorentina-Como	Piccinini	98,16	58,37
Monza-Lecce	Collu	95,57	56,57
Udinese-Empoli	Doveri	95,06	52,19
Parma-Roma	Chiffi	97,39	58,43
Juventus-Inter	Mariani	94,24	55,49
Genoa-Venezia	Marinelli	93,59	45,50
Lecce-Udinese	Bonacina	97,16	54,09
Parma-Bologna	Abisso	97,04	52,14
Venezia-Lazio	Marchetti	96,59	56,03
Torino-Milan	Sozza	95,15	55,53
Inter-Genoa	Piccinini	96,44	58,04
Como-Napoli	Manganiello	96,45	52,35
Verona-Fiorentina	Di Bello	98,57	51,57
Empoli-Atalanta	Mariani	94,57	51,29
Cagliari-Juventus	Colombo	96,00	60,44
Roma-Monza	Maresca	93,11	61,54
Fiorentina-Lecce	Marinelli	98,25	54,37
Atalanta-Venezia	Collu	96,53	59,11
Napoli-Inter	Doveri	99,30	52,11
Udinese-Parma	Maresca	97,32	57,58
Monza-Torino	Rapuano	93,56	56,28
Bologna-Cagliari	Zufferli	96,19	51,33
Genoa-Empoli	Massa	96,53	47,28
Roma-Como	Pairetto	94,57	61,34
Milan-Lazio	Manganiello	101,13	57,54
Juventus-Verona	Marchetti	97,43	55,31
Cagliari-Genoa	Fabbri	96,07	50,53
Como-Venezia	Ayroldi	96,12	51,43
Parma-Torino	Fourneau	96,32	46,27
Lecce-Milan	Doveri	99,34	52,03
Inter-Monza	Zufferli	98,52	57,48
Verona-Bologna	Rapuano	96,23	56,41
Napoli-Fiorentina	Colombo	96,52	59,57
Empoli-Roma	Di Bello	96,05	60,45
Juventus-Atalanta	Sozza	94,15	57,31
Lazio-Udinese	Piccinini	97,05	59,55
Genoa-Lecce	Maresca	98,10	51,18
Monza-Parma	Manganiello	94,56	56,25
Udinese-Verona	Ayroldi	94,02	56,15
Milan-Como	Marchetti	99,27	51,46
Torino-Empoli	Chiffi	100,23	46,00
Venezia-Napoli	Mariani	100,02	48,55
Bologna-Lazio	Colombo	94,55	54,15
Roma-Cagliari	Piccinini	99,22	60,28
Fiorentina-Juventus	Fabbri	93,14	52,43
Atalanta-Inter	Massa	103,06	54,31
Como-Empoli	Mariani	96,34	52,17
Venezia-Bologna	Di Bello	95,58	53,24
Juventus-Genoa	Rapuano	94,56	54,24
Lecce-Roma	Manganiello	97,25	51,33
Cagliari-Monza	Fourneau	95,57	50,35
Fiorentina-Atalanta	Doveri	97,34	55,08
Inter-Udinese	Chiffi	98,25	55,26
Napoli-Milan	Sozza	97,10	59,08
Verona-Parma	Sacchi	96,29	51,46
Lazio-Torino	Massa	97,50	54,35
Genoa-Udinese	Perenzoni	96,33	54,22
Monza-Como	Collu	95,52	58,00
Parma-Inter	Doveri	97,28	57,35
Milan-Fiorentina	Ayroldi	99,07	53,20
Lecce-Venezia	Piccinini	95,06	44,36
Empoli-Cagliari	La Penna	95,00	45,56
Torino-Verona	Bonacina	96,20	52,10
Atalanta-Lazio	Chiffi	98,36	60,27
Roma-Juventus	Colombo	94,26	61,47
Bologna-Napoli	Massa	98,46	51,14
Udinese-Milan	Sacchi	96,01	57,21
Venezia-Monza	Maresca	100,45	45,52
Inter-Cagliari	Di Bello	95,55	61,00
Juventus-Lecce	Zufferli	96,28	55,04
Atalanta-Bologna	Mariani	100,02	52,31
Fiorentina-Parma	Manganiello	95,10	59,22
Verona-Genoa	Marchetti	96,18	46,55
Como-Torino	Marcenaro	97,30	55,02
Lazio-Roma	Sozza	96,24	49,34
Napoli-Empoli	Fabbri	94,02	54,09
Lecce-Como	Sozza	100,53	46,22
Monza-Napoli	La Penna	94,19	56,00
Roma-Verona	Pairetto	93,58	54,09
Empoli-Venezia	Massa	95,32	44,36
Bologna-Inter	Colombo	98,55	50,02
Milan-Atalanta	Piccinini	95,50	62,56
Torino-Udinese	Collu	95,07	53,25
Cagliari-Fiorentina	Marinelli	100,56	53,48
Genoa-Lazio	Ayroldi	102,15	55,47
Parma-Juventus	Chiffi	100,20	58,32
Atalanta-Lecce	La Penna	99,02	56,54
Como-Genoa	Arena	96,15	54,58
Venezia-Milan	Manganiello	98,56	52,47
Fiorentina-Empoli	Rapuano	99,14	48,14
Inter-Roma	Fabbri	97,22	58,15
Juventus-Monza	Perenzoni	97,00	55,31
Napoli-Torino	Mariani	97,54	58,59
Udinese-Bologna	Maresca	95,52	47,37
Verona-Cagliari	Abisso	97,01	51,05
Lazio-Parma	Sacchi	98,08	60,08
Torino-Venezia	Sozza	100,00	53,17
Cagliari-Udinese	Feliciani	97,49	55,29
Parma-Como	Di Bello	96,02	50,20
Lecce-Napoli	Massa	105,14	58,14
Inter-Verona	Manganiello	95,25	61,36
Empoli-Lazio	Colombo	98,03	55,18
Monza-Atalanta	Pairetto	94,45	57,35
Roma-Fiorentina	Chiffi	101,34	63,43
Bologna-Juventus	Doveri	98,06	45,42
Genoa-Milan	Collu	98,17	52,54
Milan-Bologna	Marinelli	97,45	56,48
Como-Cagliari	Fourneau	100,35	54,24
Lazio-Juventus	Massa	99,22	51,18
Empoli-Parma	Fabbri	98,00	47,27
Udinese-Monza	Crezzini	95,23	54,45
Verona-Lecce	Maresca	98,03	44,14
Torino-Inter	La Penna	99,11	57,18
Napoli-Genoa	Piccinini	98,25	55,15
Venezia-Fiorentina	Marchetti	98,32	54,06
Atalanta-Roma	Sozza	97,05	51,49
Genoa-Atalanta	Ghersini	97,16	52,40
Cagliari-Venezia	Pairetto	98,25	52,10
Fiorentina-Bologna	Zufferli	98,55	51,27
Inter-Lazio	Chiffi	102,53	58,13
Juventus-Udinese	Ayroldi	96,37	47,39
Lecce-Torino	Rapuano	96,47	55,00
Monza-Empoli	Marinelli	95,12	58,32
Parma-Napoli	Doveri	103,36	52,42
Roma-Milan	Piccinini	96,20	61,26
Verona-Como	Abisso	97,07	48,53
Como-Inter	Massa	98,45	60,24
Napoli-Cagliari	La Penna	100,40	51,44
Bologna-Genoa	Monaldi	96,11	46,03
Milan-Monza	Rutella	92,19	59,23
Atalanta-Parma	Marinelli	98,25	58,43
Empoli-Verona	Doveri	99,03	43,40
Lazio-Lecce	Fabbri	99,12	52,01
Torino-Roma	Di Bello	94,54	57,30
Udinese-Fiorentina	Marcenaro	57,55	57,55
Venezia-Juventus	Colombo	49,56	49,56`;

        // Old MATCHES_DB can be kept for Partite view if needed, 
        // but we will derive Referee stats from RAW_LOOKUP above.
        const MATCHES_DB_2526 = `Genoa-Lecce	95,47	46,53	48,7%
Sassuolo-Napoli	97,20	60,05	61,8%
Milan-Cremonese	97,21	65,26	67,1%
Roma-Bologna	96,35	59,56	61,8%
Cagliari-Fiorentina	100,54	49,03	48,8%
Como-Lazio	95,46	54,15	56,7%
Atalanta-Pisa	96,06	57,39	59,7%
Juventus-Parma	96,26	55,01	57,1%
Udinese-Verona	94,24	54,35	57,7%
Inter-Torino	91,24	52,19	57,2%
Cremonese-Sassuolo	98,13	59,20	60,3%
Lecce-Milan	100,08	58,39	58,3%
Bologna-Como	96,20	55,35	57,5%
Parma-Atalanta	97,06	59,53	61,3%
Napoli-Cagliari	97,56	64,09	65,7%
Pisa-Roma	96,46	59,27	61,4%
Genoa-Juventus	98,26	54,37	55,3%
Torino-Fiorentina	94,09	51,30	54,5%
Inter-Udinese	98,12	57,38	58,5%
Lazio-Verona	93,02	59,58	64,1%
Cagliari-Parma	101,55	54,11	53,3%
Juventus-Inter	97,19	54,23	55,8%
Fiorentina-Napoli	99,24	54,04	54,5%
Roma-Torino	102,10	56,51	55,3%
Atalanta-Lecce	94,30	58,12	61,6%
Pisa-Udinese	96,31	58,32	60,6%
Sassuolo-Lazio	101,17	63,56	62,8%
Milan-Bologna	98,03	59,39	60,6%
Verona-Cremonese	97,02	61,52	63,4%
Como-Genoa	99,29	57,30	57,7%
Lecce-Cagliari	96,37	53,19	55,2%
Bologna-Genoa	108,02	53,57	49,6%
Verona-Juventus	99,52	54,14	54,4%
Udinese-Milan	95,27	65,04	68,3%
Lazio-Roma	100,08	51,06	51,0%
Cremonese-Parma	100,26	56,21	56,1%
Torino-Atalanta	95,17	63,29	66,5%
Fiorentina-Como	106,39	58,50	55,0%
Inter-Sassuolo	98,24	56,21	57,2%
Napoli-Pisa	101,11	57,06	56,4%
Como-Cremonese	97,54	ND	ND
Juventus-Atalanta	98,52	ND	ND
Cagliari-Inter	96,35	ND	ND
Sassuolo-Udinese	98,39	ND	ND
Pisa-Fiorentina	98,27	ND	ND
Roma-Verona	100,00	ND	ND
Lecce-Bologna	97,51	ND	ND
Milan-Napoli	99,10	ND	ND
Parma-Torino	98,49	ND	ND
Genoa-Lazio	96,06	ND	ND
Verona-Sassuolo	99,27	49,17	49,5%
Lazio-Torino	103,57	54,51	52,6%
Parma-Lecce	101,04	47,10	46,6%
Inter-Cremonese	95,20	55,44	58,2%
Atalanta-Como	95,25	56,48	59,3%
Udinese-Cagliari	97,10	50,42	51,9%
Bologna-Pisa	91,03	51,05	56,1%
Fiorentina-Roma	98,08	49,19	50,2%
Napoli-Genoa	96,31	ND	ND
Juventus-Milan	94,13	57,17	60,7%
Lecce-Sassuolo	97,33	ND	ND
Pisa-Verona	98,41	52,04	52,9%
Torino-Napoli	99,17	60,15	60,7%
Roma-Inter	96,40	55,18	57,2%
Como-Juventus	98,59	48,03	48,7%
Cagliari-Bologna	96,32	50,55	52,5%
Genoa-Parma	99,37	53,50	53,8%
Atalanta-Lazio	95,15	64,07	67,3%
Milan-Fiorentina	98,13	54,05	55,1%
Cremonese-Udinese	94,10	49,12	52,2%
Milan-Pisa	100,06	56,45	56,4%
Parma-Como	98,03	56,10	57,2%
Udinese-Lecce	96,22	51,39	53,4%
Napoli-Inter	102,58	54,57	53,2%
Cremonese-Atalanta	96,00	57,39	59,8%
Torino-Genoa	97,28	52,06	53,5%
Sassuolo-Roma	98,24	49,54	50,4%
Verona-Cagliari	100,04	54,13	54,1%
Fiorentina-Bologna	101,03	43,00	42,6%
Lazio-Juventus	96,12	54,45	56,6%
Lecce-Napoli	99,07	54,46	55,0%
Atalanta-Milan	97,51	59,25	60,8%
Como-Verona	99,03	53,25	53,8%
Juventus-Udinese	102,54	51,31	50,0%
Roma-Parma	97,04	53,34	55,0%
Bologna-Torino	96,01	57,36	59,7%
Genoa-Cremonese	100,41	46,31	46,1%
Inter-Fiorentina	95,10	54,25	57,0%
Cagliari-Sassuolo	100,29	50,07	49,9%
Pisa-Lazio	95,16	57,15	60,1%
Udinese-Atalanta	95,30	57,43	60,3%
Napoli-Como	98,23	56,49	57,5%
Cremonese-Juventus	99,18	58,32	58,8%
Verona-Inter	99,00	57,18	57,8%
Fiorentina-Lecce	97,15	52,10	53,6%
Torino-Pisa	97,32	52,41	53,9%
Parma-Bologna	101,04	47,22	46,7%
Milan-Roma	97,10	56,38	58,1%
Sassuolo-Genoa	99,04	55,16	55,7%
Lazio-Cagliari	95,01	57,15	60,2%
Pisa-Cremonese	96,03	53,23	55,4%
Como-Cagliari	99,11	51,53	52,0%
Lecce-Verona	97,28	48,07	49,4%
Juventus-Torino	99,50	64,42	64,7%
Parma-Milan	95,00	57,59	60,6%
Atalanta-Sassuolo	99,06	60,28	60,9%
Bologna-Napoli	99,24	54,49	54,9%
Genoa-Fiorentina	97,03	46,12	47,5%
Roma-Udinese	98,21	58,53	59,6%
Inter-Lazio	97,11	59,00	60,8%`;

        // Kept for legacy support if needed
        const MATCHES_DB_2425 = `Genoa-Inter	103,10	46,39	45,0%
Parma-Fiorentina	97,04	48,46	49,9%
Empoli-Monza	100,37	44,43	44,3%
Milan-Torino	101,58	58,27	57,4%
Bologna-Udinese	100,25	48,59	48,5%
Verona-Napoli	101,32	48,53	47,9%
Cagliari-Roma	94,22	53,36	56,6%
Lazio-Venezia	96,00	56,00	58,3%
Lecce-Atalanta	92,58	54,12	58,5%
Juventus-Como	99,04	56,43	57,0%
Parma-Milan	98,04	59,00	60,2%
Udinese-Lazio	103,14	49,49	48,0%
Inter-Lecce	98,08	56,21	57,3%
Monza-Genoa	105,55	56,58	53,6%
Torino-Atalanta	103,21	51,08	49,5%
Fiorentina-Venezia	97,03	55,29	57,0%
Napoli-Bologna	101,09	53,23	52,7%
Roma-Empoli	97,20	58,22	59,9%
Cagliari-Como	100,35	53,12	52,9%
Verona-Juventus	97,02	61,58	63,5%
Venezia-Torino	99,08	52,45	52,9%
Inter-Atalanta 	97,01	53,40	55,0%
Bologna-Empoli 	103,12	55,44	53,8%
Lecce-Cagliari	100,37	47,36	47,2%
Lazio-Milan	97,00	54,06	55,7%
Napoli-Parma	109,08	60,21	55,2%
Fiorentina-Monza	103,20	54,53	52,8%
Genoa-Verona	99,33	51,32	51,7%
Juventus-Roma	96,58	58,50	60,6%
Udinese-Como	103,30	54,24	52,5%
Como-Bologna	103,14	54,03	52,4%
Empoli-Juventus	95,14	60,04	63,1%
Milan-Venezia	97,55	57,21	58,6%
Genoa-Roma	104,11	53,12	51,0%
Atalanta-Fiorentina	95,42	51,04	53,5%
Torino-Lecce	95,10	54,31	57,1%
Cagliari-Napoli	102,10	50,07	49,0%
Monza-Inter	95,18	57,28	60,2%
Parma-Udinese	96,05	53,01	55,2%
Lazio-Verona	96,07	56,25	58,6%
Cagliari-Empoli	97,05	48,44	49,9%
Verona-Torino	97,05	60,20	62,0%
Venezia-Genoa	100,20	48,20	48,1%
Juventus-Napoli	96,26	64,10	66,6%
Lecce-Parma	98,37	54,32	55,2%
Fiorentina-Lazio	97,15	52,35	53,9%
Monza-Bologna	95,05	55,34	58,2%
Roma-Udinese	95,00	55,33	58,2%
Inter-Milan	97,50	55,33	56,7%
Atalanta-Como	98,35	58,21	59,2%
Milan-Lecce	96,02	55,41	57,7%
Udinese-Inter	98,00	61,58	62,8%
Genoa-Juventus	95,10	58,44	61,5%
Bologna-Atalanta	97,44	57,29	58,8%
Torino-Lazio	96,10	57,06	59,4%
Como-Verona	96,57	49,47	51,2%
Roma-Venezia	96,08	52,36	54,5%
Empoli-Fiorentina	94,11	54,28	57,7%
Napoli-Monza	95,57	60,33	63,1%
Parma-Cagliari	95,58	55,21	57,8%
Napoli-Como	96,28	59,25	61,5%
Verona-Venezia	95,02	47,29	49,8%
Udinese-Lecce	95,50	55,10	57,7%
Atalanta-Genoa	95,55	55,41	58,0%
Inter-Torino	98,30	54,09	55,0%
Juventus-Cagliari	99,01	60,08	60,7%
Bologna-Parma	95,58	54,55	57,1%
Lazio-Empoli	100,48	53,07	52,8%
Monza-Roma	99,08	56,25	56,8%
Fiorentina-Milan	97,26	48,43	49,8%
Como-Parma	96,09	60,51	63,0%
Genoa-Bologna	95,51	47,58	49,8%
Milan-Udinese	106,27	52,59	49,5%
Juventus-Lazio	97,31	56,44	58,0%
Empoli-Napoli	96,05	51,43	53,5%
Lecce-Fiorentina	93,03	53,12	57,1%
Venezia-Atalanta	94,10	54,15	57,5%
Cagliari-Torino	96,35	52,53	54,5%
Roma-Inter	97,00	59,00	60,8%
Verona-Monza	94,00	54,17	57,6%
Udinese-Cagliari	94,51	54,38	57,5%
Torino-Como	97,40	55,42	56,9%
Napoli-Lecce	96,27	52,02	54,0%
Bologna-Milan	96,21	53,33	55,4%
Atalanta-Verona	91,25	58,27	63,9%
Parma-Empoli	95,45	55,33	58,0%
Lazio-Genoa	96,07	57,36	59,7%
Monza-Venezia	95,57	49,01	51,3%
Inter-Juventus	95,12	52,00	54,7%
Fiorentina-Roma	94,27	55,39	58,8%
Cagliari-Bologna	94,25	55,29	58,7%
Lecce-Verona	98,15	49,06	50,0%
Milan-Napoli	96,55	60,55	62,7%
Empoli-Inter	96,01	55,51	57,8%
Venezia-Udinese	97,22	49,10	50,5%
Atalanta-Monza	96,20	57,39	59,7%
Juventus-Parma	95,30	61,18	64,2%
Genoa-Fiorentina	98,09	52,02	53,0%
Como-Lazio	97,44	50,20	51,5%
Roma-Torino	95,15	59,29	62,3%
Bologna-Lecce	95,25	50,36	52,9%
Udinese-Juventus	96,07	55,50	57,8%
Monza-Milan	98,17	56,22	57,3%
Napoli-Atalanta	96,00	62,27	64,9%
Torino-Fiorentina	97,17	59,23	61,0%
Verona-Roma	97,43	53,58	55,0%
Inter-Venezia	99,15	55,55	56,0%
Empoli-Como	96,10	54,05	56,2%
Parma-Genoa	97,16	51,42	52,9%
Lazio-Cagliari	96,13	54,05	56,2%
Genoa-Como	98,16	50,21	51,2%
Lecce-Empoli	97,00	51,23	52,8%
Venezia-Parma	95,15	57,06	60,0%
Cagliari-Milan	100,14	54,30	54,2%
Juventus-Torino	95,06	55,08	57,9%
Atalanta-Udinese	98,40	51,34	52,2%
Fiorentina-Verona	96,53	46,44	48,1%
Roma-Bologna	98,55	49,51	50,2%
Monza-Lazio	97,01	56,45	58,2%
Inter-Napoli	95,15	56,03	58,9%
Verona-Inter	93,00	65,30	70,2%
Milan-Juvenrus	95,40	59,45	62,3%
Parma-Atalanta	95,40	66,25	69,4%
Genoa-Cagliari	98,00	53,26	54,3%
Como-Fiorentina	97,00	55,23	56,9%
Torino-Monza	93,12	57,26	61,5%
Napoli-Roma	93,51	58,44	62,5%
Lazio-Bologna	94,57	55,30	58,5%
Empoli-Udinese	95,22	58,51	61,4%
Venezia-Lecce	96,01	56,21	58,5%
Cagliari-Verona	95,29	50,46	53,0%
Como-Monza	96,30	51,14	53,1%
Milan-Empoli	95,43	54,43	57,0%
Bologna-Venezia	96,14	49,35	51,3%
Udinese-Genoa	97,10	57,46	59,2%
Parma-Lazio	103,52	55,40	53,5%
Torino-Napoli	94,42	59,16	62,7%
Fiorentina-Inter	101,09	53,53	53,0%
Lecce-Juventus	95,05	62,25	65,5%
Roma-Atalanta	95,03	55,10	58,0%
Inter-Parma	95,00	55,37	58,3%
Atalanta-Milan	97,25	59,24	60,9%
Genoa-Torino	96,34	56,35	58,5%
Juventus-Bologna	98,03	52,19	53,2%
Roma-Lecce	97,28	55,05	56,6%
Fiorentina-Cagliari	96,03	53,17	55,4%
Verona-Empoli	97,20	54,48	56,0%
Venezia-Como	95,28	44,33	46,5%
Napoli-Lazio	98,45	58,47	59,4%
Monza-Udinese	97,10	53,45	55,0%
Empoli-Torino	95,04	49,22	51,8%
Cagliari-Atalanta	96,30	57,31	59,5%
Udinese-Napoli	97,00	51,56	53,2%
Juventus-Venezia	98,50	59,57	60,5%
Lecce-Monza	99,07	47,00	47,4%
Bologna-Fiorentina	96,02	48,30	50,3%
Parma-Verona	95,56	54,08	56,6%
Como-Roma	98,32	52,56	53,5%
Milan-Genoa	96,57	61,42	63,6%
Lazio-Inter	99,10	55,11	55,6%
Verona-Milan	99,21	54,44	54,9%
Torino-Bologna	101,15	56,57	55,9%
Genoa-Napoli	97,03	57,55	59,3%
Lecce-Lazio	100,19	56,47	56,4%
Roma-Parma	91,06	55,55	61,0%
Venezia-Cagliari	96,33	49,18	51,1%
Atalanta-Empoli	98,00	54,38	55,5%
Monza-Juventus	96,32	61,14	63,5%
Fiorentina-Udinese	100,55	53,21	52,9%
Inter-Como	94,10	52,23	55,5%
Empoli-Genoa	98,00	51,47	52,5%
Parma-Monza	100,00	48,53	48,5%
Cagliari-Inter	95,15	52,18	54,8%
Lazio-Atalanta	96,05	58,07	60,5%
Udinese-Torino	97,09	54,20	55,8%
Napoli-Venezia	95,30	54,07	56,7%
Juventus-Fiorentina	97,05	51,51	53,1%
Milan-Roma	96,05	51,06	53,2%
Como-Lecce	96,37	52,23	54,2%
Bologna-Verona	97,39	46,47	47,7%
Venezia-Empoli	94,56	51,16	54,1%
Fiorentina-Napoli	95,50	49,34	51,7%
Verona-Udinese	96,00	50,49	52,6%
Monza-Cagliari	99,18	48,31	48,7%
Lecce-Genoa	94,12	54,20	57,6%
Torino-Parma	97,10	59,17	60,9%
Roma-Lazio	97,15	53,25	54,8%
Como-Milan	95,10	50,49	53,1%
Atalanta-Juventus	97,45	64,13	65,8%
Inter-Bologna	96,05	52,32	54,5%
Lazio-Como	95,03	47,58	50,1%
Lecce-Empoli	98,34	49,09	49,9%
Udinese-Atalanta	97,38	58,41	60,0%
Torino-Juventus	96,58	60,08	62,2%
Milan-Cagliari	96,38	56,05	58,2%
Genoa-Parma	96,37	52,11	54,1%
Venezia-Inter	95,18	55,10	57,9%
Bologna-Roma	98,34	54,11	55,0%
Napoli-Verona	93,00	62,26	66,9%
Monza-Fiorentina	97,05	60,55	62,4%
Roma-Genoa	96,00	58,40	60,8%
Bologna-Monza	97,41	59,30	60,9%
Juventus-Milan	95,14	56,11	59,0%
Atalanta-Napoli	95,06	57,43	60,4%
Fiorentina-Torino	96,47	56,28	58,3%
Cagliari-Lecce	95,56	51,45	53,8%
Parma-Venezia	97,07	50,03	51,5%
Verona-Lazio	94,55	55,10	58,3%
Inter-Empoli	95,18	57,07	60,0%
Como-Udinese	95,57	51,13	53,5%
Torino-Cagliari	95,20	57,17	60,1%
Como-Atalanta	97,39	56,26	57,8%
Napoli-Juventus	97,37	54,14	55,6%
Empoli-Bologna	98,56	46,31	47,0%
Milan-Parma	99,11	52,02	52,5%
Udinese-Roma	99,57	56,19	56,4%
Lecce-Inter	93,56	57,11	61,0%
Lazio-Fiorentina	100,15	53,46	53,4%
Venezia-Verona	96,56	49,18	50,9%
Genoa-Monza	97,00	41,34	42,6%
Parma-Lecce	97,15	56,49	58,1%
Monza-Verona	95,47	53,12	55,6%
Udinese-Venezia	97,41	42,22	43,3%
Atalanta-Torino	101,01	63,01	62,4%
Bologna-Como	96,40	50,12	52,0%
Juventus-Empoli	95,12	45,47	47,8%
Fiorentina-Genoa	96,09	47,18	49,1%
Milan-Inter	98,05	58,36	59,5%
Roma-Napoli	96,44	57,50	59,6%
Cagliari-Lazio	96,15	55,09	57,3%
Como-Juventus	96,52	50,13	51,9%
Verona-Atalanta	93,51	56,03	59,9%
Empoli-Milan	98,38	48,47	49,3%
Torino-Genoa	98,42	57,33	58,3%
Venezia-Roma	95,45	53,23	55,8%
Cagliari-Parma	96,34	52,57	54,6%
Lazio-Monza	94,15	55,49	58,9%
Lecce-Bologna	100,17	52,43	52,3%
Napoli-Udinese	97,20	57,54	59,2%
Inter-Fiorentina	96,10	54,37	56,6%
Bologna-Torino	95,32	46,59	48,9%
Atalanta-Cagliari	95,19	64,30	67,5%
Lazio-Napoli	94,58	55,22	58,4%
Milan-Verona	96,20	49,24	51,2%
Fiorentina-Como	98,16	58,37	59,5%
Monza-Lecce	95,57	56,57	59,2%
Udinese-Empoli	95,06	52,19	54,9%
Parma-Roma	97,39	58,43	60,0%
Juventus-Inter	94,24	55,49	58,9%
Genoa-Venezia	93,59	45,50	48,6%
Lecce-Udinese	97,16	54,09	55,7%
Parma-Bologna	97,04	52,14	53,7%
Venezia-Lazio	96,59	56,03	58,0%
Torino-Milan	95,15	55,53	58,4%
Inter-Genoa	96,44	58,04	60,2%
Como-Napoli	96,45	52,35	54,3%
Verona-Fiorentina	98,57	51,57	52,3%
Empoli-Atalanta	94,57	51,29	54,2%
Cagliari-Juventus	96,00	60,44	63,0%
Roma-Monza	93,11	61,54	66,1%
Fiorentina-Lecce	98,25	54,37	55,3%
Atalanta-Venezia	96,53	59,11	61,2%
Napoli-Inter	99,30	52,11	52,5%
Udinese-Parma	97,32	57,58	59,2%
Monza-Torino	93,56	56,28	60,2%
Bologna-Cagliari	96,19	51,33	53,4%
Genoa-Empoli	96,53	47,28	49,0%
Roma-Como	94,57	61,34	64,9%
Milan-Lazio	101,13	57,54	56,9%
Juventus-Verona	97,43	55,31	56,8%
Cagliari-Genoa	96,07	50,53	52,6%
Como-Venezia	96,12	51,43	53,5%
Parma-Torino	96,32	46,27	48,0%
Lecce-Milan	99,34	52,03	52,4%
Inter-Monza	98,52	57,48	58,3%
Verona-Bologna	96,23	56,41	58,6%
Napoli-Fiorentina	96,52	59,57	61,7%
Empoli-Roma	96,05	60,45	62,9%
Juventus-Atalanta	94,15	57,31	60,9%
Lazio-Udinese	97,05	59,55	61,4%
Genoa-Lecce	98,10	51,18	52,2%
Monza-Parma	94,56	56,25	59,5%
Udinese-Verona	94,02	56,15	59,7%
Milan-Como	99,27	51,46	51,8%
Torino-Empoli	100,23	46,00	45,9%
Venezia-Napoli	100,02	48,55	48,5%
Bologna-Lazio	94,55	54,15	57,3%
Roma-Cagliari	99,22	60,28	60,8%
Fiorentina-Juventus	93,14	52,43	56,3%
Atalanta-Inter	103,06	54,31	52,7%
Como-Empoli	96,34	52,17	54,2%
Venezia-Bologna	95,58	53,24	55,7%
Juventus-Genoa	94,56	54,24	57,4%
Lecce-Roma	97,25	51,33	52,8%
Cagliari-Monza	95,57	50,35	52,7%
Fiorentina-Atalanta	97,34	55,08	56,6%
Inter-Udinese	98,25	55,26	56,2%
Napoli-Milan	97,10	59,08	60,8%
Verona-Parma	96,29	51,46	53,4%
Lazio-Torino	97,50	54,35	55,7%
Genoa-Udinese	96,33	54,22	56,3%
Monza-Como	95,52	58,00	60,7%
Parma-Inter	97,28	57,35	59,0%
Milan-Fiorentina	99,07	53,20	53,7%
Lecce-Venezia	95,06	44,36	46,7%
Empoli-Cagliari	95,00	45,56	48,0%
Torino-Verona	96,20	52,10	54,2%
Atalanta-Lazio	98,36	60,27	61,3%
Roma-Juventus	94,26	61,47	65,2%
Bologna-Napoli	98,46	51,14	51,9%
Udinese-Milan	96,01	57,21	59,6%
Venezia-Monza	100,45	45,52	45,3%
Inter-Cagliari	95,55	61,00	63,8%
Juventus-Lecce	96,28	55,04	57,2%
Atalanta-Bologna	100,02	52,31	52,3%
Fiorentina-Parma	95,10	59,22	62,3%
Verona-Genoa	96,18	46,55	48,4%
Como-Torino	97,30	55,02	56,5%
Lazio-Roma	96,24	49,34	51,3%
Napoli-Empoli	94,02	54,09	57,5%
Lecce-Como	100,53	46,22	46,0%
Monza-Napoli	94,19	56,00	59,5%
Roma-Verona	93,58	54,09	57,8%
Empoli-Venezia	95,32	44,36	46,5%
Bologna-Inter	98,55	50,02	50,8%
Milan-Atalanta	95,50	62,56	65,5%
Torino-Udinese	95,07	53,25	56,0%
Cagliari-Fiorentina	100,56	53,48	53,2%
Genoa-Lazio	102,15	55,47	54,3%
Parma-Juventus	100,20	58,32	58,2%
Atalanta-Lecce	99,02	56,54	57,1%
Como-Genoa	96,15	54,58	56,8%
Venezia-Milan	98,56	52,47	53,2%
Fiorentina-Empoli	99,14	48,14	48,6%
Inter-Roma	97,22	58,15	59,8%
Juventus-Monza	97,00	55,31	57,0%
Napoli-Torino	97,54	58,59	60,1%
Udinese-Bologna	95,52	47,37	49,6%
Verona-Cagliari	97,01	51,05	52,6%
Lazio-Parma	98,08	60,08	61,3%
Torino-Venezia	100,00	53,17	53,2%
Cagliari-Udinese	97,49	55,29	56,7%
Parma-Como	96,02	50,20	52,3%
Lecce-Napoli	105,14	58,14	55,3%
Inter-Verona	95,25	61,36	64,4%
Empoli-Lazio	98,03	55,18	56,3%
Monza-Atalanta	94,45	57,35	60,7%
Roma-Fiorentina	101,34	63,43	62,6%
Bologna-Juventus	98,06	45,42	46,3%
Genoa-Milan	98,17	52,54	53,5%
Milan-Bologna	97,45	56,48	58,0%
Como-Cagliari	100,35	54,24	54,1%
Lazio-Juventus	99,22	51,18	51,6%
Empoli-Parma	98,00	47,27	48,2%
Udinese-Monza	95,23	54,45	57,2%
Verona-Lecce	98,03	44,14	45,0%
Torino-Inter	99,11	57,18	57,7%
Napoli-Genoa	98,25	55,15	56,1%
Venezia-Fiorentina	98,32	54,06	55,0%
Atalanta-Roma	97,05	51,49	53,1%
Genoa-Atalanta	97,16	52,40	53,9%
Cagliari-Venezia	98,25	52,10	53,0%
Fiorentina-Bologna	98,55	51,27	52,0%
Inter-Lazio	102,53	58,13	56,7%
Juventus-Udinese	96,37	47,39	49,2%
Lecce-Torino	96,47	55,00	57,0%
Monza-Empoli	95,12	58,32	61,3%
Parma-Napoli	103,36	52,42	50,7%
Roma-Milan	96,20	61,26	63,7%
Verona-Como	97,07	48,53	50,0%
Como-Inter	98,45	60,24	61,2%
Napoli-Cagliari	100,40	51,44	51,2%
Bologna-Genoa	96,11	46,03	47,9%
Milan-Monza	92,19	59,23	64,2%
Atalanta-Parma	98,25	58,43	59,5%
Empoli-Verona	99,03	43,40	43,8%
Lazio-Lecce	99,12	52,01	52,5%
Torino-Roma	94,54	57,30	60,6%
Udinese-Fiorentina	96,02	57,55	59,9%
Venezia-Juventus	98,32	49,56	50,4%`;

        const TOTAL_TIME_DB = `Massa	95,47
Ayroldi	97,20
Collu	97,21
Zufferli	96,35
Sozza	100,54
Manganiello	95,46
Arena	96,06
Marcenaro	96,26
Tremolada	94,24
La Penna	91,24
Guida	98,13
Marinelli	100,08
Doveri	96,20
Mariani	97,06
Bonacina	97,56
Collu	96,46
Chiffi	98,26
Abisso	94,09
Marchetti	98,12
Crezzini	93,02
Fourneau	101,55
Colombo	97,19
Zufferli	99,24
Ayroldi	102,10
Manganiello	94,30
Massa	96,31
Tremolada	101,17
Marcenaro	98,03
Arena	97,02
Piccinini	99,29
Zufferli	96,37
Collu	108,02
Rapuano	99,52
Doveri	95,27
Sozza	100,08
La Penna	100,26
Colombo	95,17
Bonacina	106,39
Marinelli	98,24
Crezzini	101,11
Di Bello	97,54
Sozza	98,52
Piccinini	96,35
Perenzoni	98,39
Manganiello	98,27
Feliciani	100,00
Fourneau	97,51
Chiffi	99,10
Collu	98,49
Ayroldi	96,06
Fourneau	99,27
Piccinini	103,57
Doveri	101,04
Feliciani	95,20
Zufferli	95,25
Arena	97,10
Abisso	91,03
Colombo	98,08
La Penna	96,31
Guida	94,13
Crezzini	97,33
Guida	98,41
Marcenaro	99,17
Massa	96,40
Ayroldi	98,59
Marchetti	96,32
Sozza	99,37
Collu	95,15
Marinelli	98,13
Fabbri	94,10
Zufferli	100,06
Chiffi	98,03
Feliciani	96,22
Mariani	102,58
Arena	96,00
Bonacina	97,28
Manganiello	98,24
Dionisi	100,04
La Penna	101,03
Colombo	96,12
Collu	99,07
Doveri	97,51
Marcenaro	99,03
Di Bello	102,54
Crezzini	97,04
Ayroldi	96,01
Abisso	100,41
Sozza	95,10
Pairetto	100,29
Massa	95,16
Fabbri	95,30
Zufferli	98,23
Chiffi	99,18
Doveri	99,00
Rapuano	97,15
Arena	97,32
Bonacina	101,04
Guida	97,10
Feliciani	99,04
Sacchi	95,01
Marcenaro	96,03
Pezzuto	99,11
Abisso	97,28
Zufferli	99,50
Di Bello	95,00
Crezzini	99,06
Chiffi	99,24
Guida	97,03
Collu	98,21
Manganiello	97,11`;

        const db = {
            "2025-26": [
                { name: "Luca Zufferli", matches: 7, fouls_avg: 26.71, penalties_ap: 0.57, yellows_ap: 3.00, yellows: 21, reds_ap: 0.00, reds: 0 },
                { name: "Giuseppe Collu", matches: 7, fouls_avg: 23.29, penalties_ap: 0.57, yellows_ap: 4.29, yellows: 30, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 5, fouls_avg: 26.80, penalties_ap: 1.20, yellows_ap: 5.00, yellows: 25, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Doveri", matches: 5, fouls_avg: 23.40, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Chiffi", matches: 5, fouls_avg: 23.40, penalties_ap: 0.20, yellows_ap: 2.00, yellows: 10, reds_ap: 0.20, reds: 1 },
                { name: "Gianluca Manganiello", matches: 5, fouls_avg: 29.40, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Simone Sozza", matches: 5, fouls_avg: 27.20, penalties_ap: 0.40, yellows_ap: 3.00, yellows: 15, reds_ap: 1.00, reds: 5 },
                { name: "Giovanni Ayroldi", matches: 5, fouls_avg: 31.80, penalties_ap: 0.00, yellows_ap: 4.40, yellows: 22, reds_ap: 0.20, reds: 1 },
                { name: "Matteo Marcenaro", matches: 5, fouls_avg: 26.60, penalties_ap: 0.00, yellows_ap: 4.40, yellows: 22, reds_ap: 0.20, reds: 1 },
                { name: "Valerio Crezzini", matches: 5, fouls_avg: 23.80, penalties_ap: 0.40, yellows_ap: 2.60, yellows: 13, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Arena", matches: 5, fouls_avg: 21.20, penalties_ap: 0.20, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Davide Massa", matches: 4, fouls_avg: 33.00, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 19, reds_ap: 0.00, reds: 0 },
                { name: "Rosario Abisso", matches: 4, fouls_avg: 29.75, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.25, reds: 1 },
                { name: "Federico La Penna", matches: 4, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 2.75, yellows: 11, reds_ap: 0.25, reds: 1 },
                { name: "Andrea Colombo", matches: 4, fouls_avg: 28.25, penalties_ap: 0.25, yellows_ap: 3.75, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Ermanno Feliciani", matches: 4, fouls_avg: 24.25, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Kevin Bonacina", matches: 4, fouls_avg: 29.25, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 18, reds_ap: 0.25, reds: 1 },
                { name: "Marco Di Bello", matches: 3, fouls_avg: 27.33, penalties_ap: 1.00, yellows_ap: 4.67, yellows: 14, reds_ap: 0.33, reds: 1 },
                { name: "Marco Piccinini", matches: 3, fouls_avg: 30.67, penalties_ap: 0.33, yellows_ap: 4.00, yellows: 12, reds_ap: 0.33, reds: 1 },
                { name: "Livio Marinelli", matches: 3, fouls_avg: 22.33, penalties_ap: 0.33, yellows_ap: 3.33, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Fourneau", matches: 3, fouls_avg: 28.33, penalties_ap: 0.67, yellows_ap: 5.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Maurizio Mariani", matches: 2, fouls_avg: 24.00, penalties_ap: 1.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Michael Fabbri", matches: 2, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Rapuano", matches: 2, fouls_avg: 31.50, penalties_ap: 0.50, yellows_ap: 5.50, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Marchetti", matches: 2, fouls_avg: 29.50, penalties_ap: 0.50, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Paride Tremolada", matches: 2, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Luca Pairetto", matches: 1, fouls_avg: 41.00, penalties_ap: 0.00, yellows_ap: 8.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 1, fouls_avg: 36.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Juan Luca Sacchi", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 2, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 1, fouls_avg: 28.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Perenzoni", matches: 1, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 }
            ],
            "2024-25": [
                { name: "Davide Massa", matches: 19, fouls_avg: 25.74, penalties_ap: 0.16, yellows_ap: 4.21, yellows: 80, reds_ap: 0.26, reds: 5 },
                { name: "Maurizio Mariani", matches: 18, fouls_avg: 25.94, penalties_ap: 0.11, yellows_ap: 3.72, yellows: 67, reds_ap: 0.17, reds: 3 },
                { name: "Michael Fabbri", matches: 18, fouls_avg: 24.89, penalties_ap: 0.06, yellows_ap: 3.89, yellows: 70, reds_ap: 0.33, reds: 6 },
                { name: "Daniele Doveri", matches: 18, fouls_avg: 24.11, penalties_ap: 0.22, yellows_ap: 2.50, yellows: 45, reds_ap: 0.11, reds: 2 },
                { name: "Daniele Chiffi", matches: 17, fouls_avg: 20.29, penalties_ap: 0.29, yellows_ap: 3.71, yellows: 63, reds_ap: 0.18, reds: 3 },
                { name: "Gianluca Manganiello", matches: 17, fouls_avg: 25.59, penalties_ap: 0.24, yellows_ap: 3.24, yellows: 55, reds_ap: 0.18, reds: 3 },
                { name: "Livio Marinelli", matches: 17, fouls_avg: 24.18, penalties_ap: 0.29, yellows_ap: 2.88, yellows: 49, reds_ap: 0.18, reds: 3 },
                { name: "Simone Sozza", matches: 17, fouls_avg: 24.00, penalties_ap: 0.59, yellows_ap: 3.53, yellows: 60, reds_ap: 0.06, reds: 1 },
                { name: "Marco Piccinini", matches: 16, fouls_avg: 24.00, penalties_ap: 0.19, yellows_ap: 3.81, yellows: 61, reds_ap: 0.06, reds: 1 },
                { name: "Andrea Colombo", matches: 16, fouls_avg: 25.19, penalties_ap: 0.13, yellows_ap: 4.13, yellows: 66, reds_ap: 0.13, reds: 2 },
                { name: "Marco Di Bello", matches: 15, fouls_avg: 26.20, penalties_ap: 0.27, yellows_ap: 2.60, yellows: 39, reds_ap: 0.13, reds: 2 },
                { name: "Luca Zufferli", matches: 15, fouls_avg: 22.80, penalties_ap: 0.20, yellows_ap: 2.73, yellows: 41, reds_ap: 0.20, reds: 3 },
                { name: "Luca Pairetto", matches: 14, fouls_avg: 26.57, penalties_ap: 0.29, yellows_ap: 4.14, yellows: 58, reds_ap: 0.50, reds: 7 },
                { name: "Federico La Penna", matches: 14, fouls_avg: 27.71, penalties_ap: 0.43, yellows_ap: 4.36, yellows: 61, reds_ap: 0.07, reds: 1 },
                { name: "Antonio Rapuano", matches: 14, fouls_avg: 27.93, penalties_ap: 0.14, yellows_ap: 4.50, yellows: 63, reds_ap: 0.43, reds: 6 },
                { name: "Rosario Abisso", matches: 12, fouls_avg: 24.42, penalties_ap: 0.50, yellows_ap: 3.83, yellows: 46, reds_ap: 0.17, reds: 2 },
                { name: "Matteo Marchetti", matches: 12, fouls_avg: 26.83, penalties_ap: 0.08, yellows_ap: 4.00, yellows: 48, reds_ap: 0.25, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 11, fouls_avg: 24.27, penalties_ap: 0.09, yellows_ap: 3.36, yellows: 37, reds_ap: 0.18, reds: 2 },
                { name: "Francesco Fourneau", matches: 11, fouls_avg: 27.55, penalties_ap: 0.27, yellows_ap: 4.18, yellows: 46, reds_ap: 0.09, reds: 1 },
                { name: "Giovanni Ayroldi", matches: 11, fouls_avg: 26.91, penalties_ap: 0.36, yellows_ap: 5.73, yellows: 63, reds_ap: 0.55, reds: 6 },
                { name: "Ermanno Feliciani", matches: 10, fouls_avg: 22.90, penalties_ap: 0.40, yellows_ap: 2.50, yellows: 25, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 8, fouls_avg: 22.63, penalties_ap: 0.25, yellows_ap: 3.88, yellows: 31, reds_ap: 0.25, reds: 2 },
                { name: "Matteo Marcenaro", matches: 8, fouls_avg: 22.88, penalties_ap: 0.50, yellows_ap: 5.00, yellows: 40, reds_ap: 0.38, reds: 3 },
                { name: "Fabio Maresca", matches: 7, fouls_avg: 25.43, penalties_ap: 0.29, yellows_ap: 4.43, yellows: 31, reds_ap: 0.14, reds: 1 },
                { name: "Giuseppe Collu", matches: 7, fouls_avg: 28.29, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 28, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Giua", matches: 5, fouls_avg: 22.20, penalties_ap: 0.60, yellows_ap: 3.60, yellows: 18, reds_ap: 0.20, reds: 1 },
                { name: "Paride Tremolada", matches: 5, fouls_avg: 24.20, penalties_ap: 0.60, yellows_ap: 4.20, yellows: 21, reds_ap: 0.40, reds: 2 },
                { name: "Gianluca Aureliano", matches: 4, fouls_avg: 22.50, penalties_ap: 0.25, yellows_ap: 2.75, yellows: 11, reds_ap: 0.25, reds: 1 },
                { name: "Federico Dionisi", matches: 4, fouls_avg: 28.50, penalties_ap: 0.25, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                { name: "Kevin Bonacina", matches: 4, fouls_avg: 24.25, penalties_ap: 0.50, yellows_ap: 3.00, yellows: 12, reds_ap: 0.50, reds: 2 },
                { name: "Luca Massimi", matches: 2, fouls_avg: 31.50, penalties_ap: 1.00, yellows_ap: 4.50, yellows: 9, reds_ap: 0.50, reds: 1 },
                { name: "Francesco Cosso", matches: 2, fouls_avg: 24.00, penalties_ap: 0.50, yellows_ap: 2.50, yellows: 5, reds_ap: 1.00, reds: 2 },
                { name: "Daniele Perenzoni", matches: 2, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.50, reds: 1 },
                { name: "Maria Ferrieri Caputi", matches: 2, fouls_avg: 32.00, penalties_ap: 1.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 2, fouls_avg: 22.50, penalties_ap: 1.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.50, reds: 1 },
                { name: "Davide Ghersini", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 0.00, yellows: 0, reds_ap: 0.00, reds: 0 },
                { name: "Alessandro Prontera", matches: 1, fouls_avg: 25.00, penalties_ap: 1.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Rutella", matches: 1, fouls_avg: 17.00, penalties_ap: 0.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Marco Monaldi", matches: 1, fouls_avg: 36.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Valerio Crezzini", matches: 1, fouls_avg: 29.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 5, reds_ap: 0.00, reds: 0 }
            ],
            "2023-24": [
                { name: "Marco Guida", matches: 17, fouls_avg: 23.59, penalties_ap: 0.47, yellows_ap: 4.00, yellows: 68, reds_ap: 0.06, reds: 1 },
                { name: "Daniele Doveri", matches: 17, fouls_avg: 24.47, penalties_ap: 0.18, yellows_ap: 3.24, yellows: 55, reds_ap: 0.35, reds: 6 },
                { name: "Daniele Orsato", matches: 16, fouls_avg: 23.38, penalties_ap: 0.31, yellows_ap: 4.69, yellows: 75, reds_ap: 0.19, reds: 3 },
                { name: "Davide Massa", matches: 16, fouls_avg: 26.06, penalties_ap: 0.31, yellows_ap: 5.06, yellows: 81, reds_ap: 0.00, reds: 0 },
                { name: "Fabio Maresca", matches: 16, fouls_avg: 25.50, penalties_ap: 0.25, yellows_ap: 5.69, yellows: 91, reds_ap: 0.06, reds: 1 },
                { name: "Andrea Colombo", matches: 16, fouls_avg: 24.19, penalties_ap: 0.19, yellows_ap: 5.38, yellows: 86, reds_ap: 0.38, reds: 6 },
                { name: "Maurizio Mariani", matches: 15, fouls_avg: 23.80, penalties_ap: 0.33, yellows_ap: 3.80, yellows: 57, reds_ap: 0.27, reds: 4 },
                { name: "Federico La Penna", matches: 15, fouls_avg: 24.07, penalties_ap: 0.40, yellows_ap: 4.60, yellows: 69, reds_ap: 0.13, reds: 2 },
                { name: "Juan Luca Sacchi", matches: 15, fouls_avg: 25.60, penalties_ap: 0.40, yellows_ap: 4.40, yellows: 66, reds_ap: 0.07, reds: 1 },
                { name: "Antonio Rapuano", matches: 15, fouls_avg: 25.40, penalties_ap: 0.40, yellows_ap: 3.93, yellows: 59, reds_ap: 0.27, reds: 4 },
                { name: "Luca Pairetto", matches: 14, fouls_avg: 23.36, penalties_ap: 0.50, yellows_ap: 4.14, yellows: 58, reds_ap: 0.00, reds: 0 },
                { name: "Michael Fabbri", matches: 13, fouls_avg: 24.31, penalties_ap: 0.31, yellows_ap: 3.23, yellows: 42, reds_ap: 0.15, reds: 2 },
                { name: "Ermanno Feliciani", matches: 13, fouls_avg: 22.38, penalties_ap: 0.23, yellows_ap: 3.08, yellows: 40, reds_ap: 0.08, reds: 1 },
                { name: "Gianluca Aureliano", matches: 12, fouls_avg: 25.50, penalties_ap: 0.50, yellows_ap: 4.25, yellows: 51, reds_ap: 0.17, reds: 2 },
                { name: "Gianluca Manganiello", matches: 12, fouls_avg: 22.33, penalties_ap: 0.25, yellows_ap: 3.67, yellows: 44, reds_ap: 0.25, reds: 3 },
                { name: "Marco Piccinini", matches: 12, fouls_avg: 23.17, penalties_ap: 0.50, yellows_ap: 3.83, yellows: 46, reds_ap: 0.17, reds: 2 },
                { name: "Matteo Marcenaro", matches: 12, fouls_avg: 22.58, penalties_ap: 0.33, yellows_ap: 4.83, yellows: 58, reds_ap: 0.25, reds: 3 },
                { name: "Marco Di Bello", matches: 11, fouls_avg: 23.18, penalties_ap: 0.45, yellows_ap: 4.18, yellows: 46, reds_ap: 0.45, reds: 5 },
                { name: "Antonio Giua", matches: 11, fouls_avg: 23.00, penalties_ap: 0.27, yellows_ap: 3.64, yellows: 40, reds_ap: 0.27, reds: 3 },
                { name: "Simone Sozza", matches: 11, fouls_avg: 26.36, penalties_ap: 0.82, yellows_ap: 4.36, yellows: 48, reds_ap: 0.18, reds: 2 },
                { name: "Matteo Marchetti", matches: 11, fouls_avg: 23.27, penalties_ap: 0.18, yellows_ap: 3.00, yellows: 33, reds_ap: 0.09, reds: 1 },
                { name: "Daniele Chiffi", matches: 9, fouls_avg: 22.22, penalties_ap: 0.11, yellows_ap: 4.00, yellows: 36, reds_ap: 0.11, reds: 1 },
                { name: "Alessandro Prontera", matches: 9, fouls_avg: 22.22, penalties_ap: 0.67, yellows_ap: 3.78, yellows: 34, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 9, fouls_avg: 27.89, penalties_ap: 0.11, yellows_ap: 3.22, yellows: 29, reds_ap: 0.11, reds: 1 },
                { name: "Livio Marinelli", matches: 8, fouls_avg: 24.38, penalties_ap: 0.25, yellows_ap: 4.50, yellows: 36, reds_ap: 0.50, reds: 4 },
                { name: "Luca Massimi", matches: 8, fouls_avg: 25.13, penalties_ap: 0.25, yellows_ap: 3.75, yellows: 30, reds_ap: 0.13, reds: 1 },
                { name: "Giovanni Ayroldi", matches: 8, fouls_avg: 26.13, penalties_ap: 0.38, yellows_ap: 5.25, yellows: 42, reds_ap: 0.38, reds: 3 },
                { name: "Maria Ferrieri Caputi", matches: 8, fouls_avg: 23.13, penalties_ap: 0.38, yellows_ap: 4.13, yellows: 33, reds_ap: 0.38, reds: 3 },
                { name: "Rosario Abisso", matches: 7, fouls_avg: 23.86, penalties_ap: 0.43, yellows_ap: 5.29, yellows: 37, reds_ap: 0.14, reds: 1 },
                { name: "Luca Zufferli", matches: 6, fouls_avg: 22.00, penalties_ap: 0.17, yellows_ap: 2.50, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Fourneau", matches: 5, fouls_avg: 21.80, penalties_ap: 0.40, yellows_ap: 3.60, yellows: 18, reds_ap: 0.20, reds: 1 },
                { name: "Alberto Santoro", matches: 3, fouls_avg: 26.67, penalties_ap: 0.33, yellows_ap: 5.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Paride Tremolada", matches: 3, fouls_avg: 25.67, penalties_ap: 0.67, yellows_ap: 4.33, yellows: 13, reds_ap: 0.00, reds: 0 },
                { name: "Giuseppe Collu", matches: 2, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 6, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 2, fouls_avg: 21.00, penalties_ap: 0.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Davide Ghersini", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 1.00, reds: 1 },
                { name: "Francesco Cosso", matches: 1, fouls_avg: 20.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 2, reds_ap: 0.00, reds: 0 }
            ],
            "2022-23": [
                 { name: "Daniele Orsato", matches: 15, fouls_avg: 21.40, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 45, reds_ap: 0.07, reds: 1 },
                 { name: "Fabio Maresca", matches: 15, fouls_avg: 25.60, penalties_ap: 0.00, yellows_ap: 5.33, yellows: 80, reds_ap: 0.20, reds: 3 },
                 { name: "Daniele Chiffi", matches: 15, fouls_avg: 23.47, penalties_ap: 0.00, yellows_ap: 4.47, yellows: 67, reds_ap: 0.20, reds: 3 },
                 { name: "Maurizio Mariani", matches: 14, fouls_avg: 24.07, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 63, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Doveri", matches: 14, fouls_avg: 25.43, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 49, reds_ap: 0.21, reds: 3 },
                 { name: "Davide Massa", matches: 14, fouls_avg: 27.64, penalties_ap: 0.00, yellows_ap: 6.21, yellows: 87, reds_ap: 0.29, reds: 4 },
                 { name: "Antonio Rapuano", matches: 14, fouls_avg: 22.43, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 63, reds_ap: 0.21, reds: 3 },
                 { name: "Livio Marinelli", matches: 14, fouls_avg: 24.07, penalties_ap: 0.00, yellows_ap: 3.36, yellows: 47, reds_ap: 0.21, reds: 3 },
                 { name: "Michael Fabbri", matches: 12, fouls_avg: 23.17, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 57, reds_ap: 0.33, reds: 4 },
                 { name: "Luca Pairetto", matches: 12, fouls_avg: 26.08, penalties_ap: 0.00, yellows_ap: 4.42, yellows: 53, reds_ap: 0.17, reds: 2 },
                 { name: "Giovanni Ayroldi", matches: 12, fouls_avg: 27.50, penalties_ap: 0.00, yellows_ap: 5.25, yellows: 63, reds_ap: 0.08, reds: 1 },
                 { name: "Andrea Colombo", matches: 12, fouls_avg: 22.83, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 57, reds_ap: 0.00, reds: 0 },
                 { name: "Matteo Marcenaro", matches: 12, fouls_avg: 23.42, penalties_ap: 0.00, yellows_ap: 4.83, yellows: 58, reds_ap: 0.50, reds: 6 },
                 { name: "Marco Di Bello", matches: 11, fouls_avg: 28.55, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 55, reds_ap: 0.18, reds: 2 },
                 { name: "Antonio Giua", matches: 11, fouls_avg: 23.64, penalties_ap: 0.00, yellows_ap: 5.18, yellows: 57, reds_ap: 0.36, reds: 4 },
                 { name: "Simone Sozza", matches: 11, fouls_avg: 26.09, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 55, reds_ap: 0.00, reds: 0 },
                 { name: "Matteo Marchetti", matches: 11, fouls_avg: 27.45, penalties_ap: 0.00, yellows_ap: 4.09, yellows: 45, reds_ap: 0.27, reds: 3 },
                 { name: "Massimiliano Irrati", matches: 10, fouls_avg: 23.70, penalties_ap: 0.00, yellows_ap: 5.10, yellows: 51, reds_ap: 0.20, reds: 2 },
                 { name: "Rosario Abisso", matches: 10, fouls_avg: 24.60, penalties_ap: 0.00, yellows_ap: 3.90, yellows: 39, reds_ap: 0.30, reds: 3 },
                 { name: "Francesco Fourneau", matches: 10, fouls_avg: 24.20, penalties_ap: 0.00, yellows_ap: 4.70, yellows: 47, reds_ap: 0.00, reds: 0 },
                 { name: "Luca Massimi", matches: 10, fouls_avg: 22.70, penalties_ap: 0.00, yellows_ap: 4.10, yellows: 41, reds_ap: 0.40, reds: 4 },
                 { name: "Juan Luca Sacchi", matches: 9, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 3.22, yellows: 29, reds_ap: 0.22, reds: 2 },
                 { name: "Marco Piccinini", matches: 9, fouls_avg: 25.33, penalties_ap: 0.00, yellows_ap: 4.44, yellows: 40, reds_ap: 0.00, reds: 0 },
                 { name: "Federico Dionisi", matches: 9, fouls_avg: 28.11, penalties_ap: 0.00, yellows_ap: 4.56, yellows: 41, reds_ap: 0.11, reds: 1 },
                 { name: "Gianluca Aureliano", matches: 8, fouls_avg: 24.25, penalties_ap: 0.00, yellows_ap: 3.13, yellows: 25, reds_ap: 0.13, reds: 1 },
                 { name: "Paolo Valeri", matches: 7, fouls_avg: 26.86, penalties_ap: 0.00, yellows_ap: 4.57, yellows: 32, reds_ap: 0.14, reds: 1 },
                 { name: "Davide Ghersini", matches: 7, fouls_avg: 23.00, penalties_ap: 0.00, yellows_ap: 4.14, yellows: 29, reds_ap: 0.29, reds: 2 },
                 { name: "Federico La Penna", matches: 7, fouls_avg: 25.14, penalties_ap: 0.00, yellows_ap: 3.86, yellows: 27, reds_ap: 0.00, reds: 0 },
                 { name: "Alessandro Prontera", matches: 7, fouls_avg: 26.29, penalties_ap: 0.00, yellows_ap: 4.43, yellows: 31, reds_ap: 0.14, reds: 1 },
                 { name: "Alberto Santoro", matches: 7, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 4.86, yellows: 34, reds_ap: 0.14, reds: 1 },
                 { name: "Gianluca Manganiello", matches: 6, fouls_avg: 21.17, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 21, reds_ap: 0.00, reds: 0 },
                 { name: "Marco Guida", matches: 5, fouls_avg: 23.20, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                 { name: "Ivano Pezzuto", matches: 5, fouls_avg: 23.80, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                 { name: "Francesco Cosso", matches: 5, fouls_avg: 22.20, penalties_ap: 0.00, yellows_ap: 3.40, yellows: 17, reds_ap: 0.40, reds: 2 },
                 { name: "Ermanno Feliciani", matches: 5, fouls_avg: 22.40, penalties_ap: 0.00, yellows_ap: 3.80, yellows: 19, reds_ap: 0.00, reds: 0 },
                 { name: "NiccolÃ² Baroni", matches: 4, fouls_avg: 26.25, penalties_ap: 0.00, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                 { name: "Manuel Volpi", matches: 4, fouls_avg: 26.75, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 16, reds_ap: 0.00, reds: 0 },
                 { name: "Giacomo Camplone", matches: 4, fouls_avg: 23.75, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.50, reds: 2 },
                 { name: "Luca Zufferli", matches: 3, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 9, reds_ap: 0.00, reds: 0 },
                 { name: "Maria Ferrieri Caputi", matches: 3, fouls_avg: 23.67, penalties_ap: 0.00, yellows_ap: 2.33, yellows: 7, reds_ap: 0.00, reds: 0 },
                 { name: "Marco Serra", matches: 2, fouls_avg: 28.00, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.50, reds: 1 },
                 { name: "Daniele Perenzoni", matches: 2, fouls_avg: 28.50, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Minelli", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Paterna", matches: 1, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 2.00, reds: 2 },
                 { name: "Francesco Meraviglia", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 }
            ],
            "2021-22": [
                { name: "Daniele Doveri", matches: 17, fouls_avg: 26.82, penalties_ap: 0.35, yellows_ap: 3.47, yellows: 59, reds_ap: 0.18, reds: 3 },
                { name: "Marco Di Bello", matches: 17, fouls_avg: 27.18, penalties_ap: 0.47, yellows_ap: 4.29, yellows: 73, reds_ap: 0.24, reds: 4 },
                { name: "Fabio Maresca", matches: 16, fouls_avg: 24.75, penalties_ap: 0.38, yellows_ap: 4.50, yellows: 72, reds_ap: 0.31, reds: 5 },
                { name: "Daniele Chiffi", matches: 16, fouls_avg: 24.88, penalties_ap: 0.31, yellows_ap: 3.63, yellows: 58, reds_ap: 0.19, reds: 3 },
                { name: "Daniele Orsato", matches: 15, fouls_avg: 28.00, penalties_ap: 0.27, yellows_ap: 5.87, yellows: 88, reds_ap: 0.13, reds: 2 },
                { name: "Maurizio Mariani", matches: 14, fouls_avg: 28.79, penalties_ap: 0.21, yellows_ap: 4.86, yellows: 68, reds_ap: 0.36, reds: 5 },
                { name: "Marco Guida", matches: 14, fouls_avg: 27.14, penalties_ap: 0.29, yellows_ap: 4.79, yellows: 67, reds_ap: 0.21, reds: 3 },
                { name: "Davide Massa", matches: 14, fouls_avg: 26.29, penalties_ap: 0.14, yellows_ap: 4.21, yellows: 59, reds_ap: 0.36, reds: 5 },
                { name: "Livio Marinelli", matches: 14, fouls_avg: 21.86, penalties_ap: 0.29, yellows_ap: 3.93, yellows: 55, reds_ap: 0.00, reds: 0 },
                { name: "Simone Sozza", matches: 14, fouls_avg: 26.43, penalties_ap: 0.29, yellows_ap: 4.36, yellows: 61, reds_ap: 0.21, reds: 3 },
                { name: "Rosario Abisso", matches: 13, fouls_avg: 25.92, penalties_ap: 0.46, yellows_ap: 4.69, yellows: 61, reds_ap: 0.31, reds: 4 },
                { name: "Paolo Valeri", matches: 12, fouls_avg: 30.25, penalties_ap: 0.42, yellows_ap: 5.00, yellows: 60, reds_ap: 0.17, reds: 2 },
                { name: "Michael Fabbri", matches: 12, fouls_avg: 23.67, penalties_ap: 0.17, yellows_ap: 3.67, yellows: 44, reds_ap: 0.50, reds: 6 },
                { name: "Luca Pairetto", matches: 12, fouls_avg: 26.58, penalties_ap: 0.92, yellows_ap: 4.33, yellows: 52, reds_ap: 0.25, reds: 3 },
                { name: "Gianluca Manganiello", matches: 12, fouls_avg: 24.08, penalties_ap: 0.17, yellows_ap: 3.50, yellows: 42, reds_ap: 0.17, reds: 2 },
                { name: "Massimiliano Irrati", matches: 11, fouls_avg: 27.00, penalties_ap: 0.64, yellows_ap: 5.64, yellows: 62, reds_ap: 0.27, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 11, fouls_avg: 25.55, penalties_ap: 0.09, yellows_ap: 3.45, yellows: 38, reds_ap: 0.27, reds: 3 },
                { name: "Francesco Fourneau", matches: 11, fouls_avg: 27.45, penalties_ap: 0.36, yellows_ap: 4.73, yellows: 52, reds_ap: 0.27, reds: 3 },
                { name: "Luca Massimi", matches: 11, fouls_avg: 29.27, penalties_ap: 0.18, yellows_ap: 4.27, yellows: 47, reds_ap: 0.27, reds: 3 },
                { name: "Giovanni Ayroldi", matches: 11, fouls_avg: 29.82, penalties_ap: 0.18, yellows_ap: 5.36, yellows: 59, reds_ap: 0.18, reds: 2 },
                { name: "Alessandro Prontera", matches: 10, fouls_avg: 26.70, penalties_ap: 0.50, yellows_ap: 4.70, yellows: 47, reds_ap: 0.40, reds: 4 },
                { name: "Antonio Rapuano", matches: 9, fouls_avg: 26.22, penalties_ap: 0.44, yellows_ap: 4.11, yellows: 37, reds_ap: 0.56, reds: 5 },
                { name: "Davide Ghersini", matches: 8, fouls_avg: 21.38, penalties_ap: 0.63, yellows_ap: 3.25, yellows: 26, reds_ap: 0.13, reds: 1 },
                { name: "Gianluca Aureliano", matches: 8, fouls_avg: 29.63, penalties_ap: 0.75, yellows_ap: 5.13, yellows: 41, reds_ap: 0.25, reds: 2 },
                { name: "Marco Piccinini", matches: 8, fouls_avg: 26.00, penalties_ap: 0.38, yellows_ap: 4.25, yellows: 34, reds_ap: 0.50, reds: 4 },
                { name: "Matteo Marchetti", matches: 8, fouls_avg: 26.13, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 36, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 7, fouls_avg: 31.14, penalties_ap: 0.14, yellows_ap: 4.86, yellows: 34, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 7, fouls_avg: 26.86, penalties_ap: 0.43, yellows_ap: 3.57, yellows: 25, reds_ap: 0.43, reds: 3 },
                { name: "Antonio Giua", matches: 6, fouls_avg: 25.67, penalties_ap: 0.50, yellows_ap: 5.33, yellows: 32, reds_ap: 0.17, reds: 1 },
                { name: "Manuel Volpi", matches: 6, fouls_avg: 31.17, penalties_ap: 0.50, yellows_ap: 6.17, yellows: 37, reds_ap: 0.33, reds: 2 },
                { name: "Piero Giacomelli", matches: 5, fouls_avg: 29.60, penalties_ap: 0.40, yellows_ap: 4.60, yellows: 23, reds_ap: 0.00, reds: 0 },
                { name: "Marco Serra", matches: 5, fouls_avg: 24.80, penalties_ap: 1.00, yellows_ap: 5.20, yellows: 26, reds_ap: 0.20, reds: 1 },
                { name: "Lorenzo Maggioni", matches: 4, fouls_avg: 29.00, penalties_ap: 0.50, yellows_ap: 5.00, yellows: 20, reds_ap: 0.25, reds: 1 },
                { name: "Giacomo Camplone", matches: 3, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 3.67, yellows: 11, reds_ap: 0.67, reds: 2 },
                { name: "Andrea Colombo", matches: 3, fouls_avg: 25.33, penalties_ap: 0.00, yellows_ap: 5.33, yellows: 16, reds_ap: 0.33, reds: 1 },
                { name: "Matteo Marcenaro", matches: 3, fouls_avg: 28.33, penalties_ap: 0.33, yellows_ap: 4.67, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Valerio Marini", matches: 2, fouls_avg: 28.50, penalties_ap: 1.50, yellows_ap: 5.50, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Santoro", matches: 2, fouls_avg: 25.50, penalties_ap: 0.00, yellows_ap: 2.50, yellows: 5, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Gariglio", matches: 2, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Cosso", matches: 2, fouls_avg: 25.00, penalties_ap: 1.00, yellows_ap: 5.00, yellows: 10, reds_ap: 1.00, reds: 2 },
                { name: "Antonio Di Martino", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "NiccolÃ² Baroni", matches: 1, fouls_avg: 23.00, penalties_ap: 2.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Paterna", matches: 1, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Meraviglia", matches: 1, fouls_avg: 29.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Gianpiero Miele", matches: 1, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 }
            ],
            "2020-21": [
                { name: "Maurizio Mariani", matches: 18, fouls_avg: 27.11, penalties_ap: 0.50, yellows_ap: 3.67, yellows: 66, reds_ap: 0.11, reds: 2 },
                { name: "Daniele Doveri", matches: 17, fouls_avg: 29.06, penalties_ap: 0.29, yellows_ap: 4.06, yellows: 69, reds_ap: 0.00, reds: 0 },
                { name: "Davide Massa", matches: 17, fouls_avg: 27.76, penalties_ap: 0.35, yellows_ap: 4.47, yellows: 76, reds_ap: 0.24, reds: 4 },
                { name: "Marco Di Bello", matches: 17, fouls_avg: 27.41, penalties_ap: 0.47, yellows_ap: 4.65, yellows: 79, reds_ap: 0.18, reds: 3 },
                { name: "Piero Giacomelli", matches: 17, fouls_avg: 29.65, penalties_ap: 0.65, yellows_ap: 4.59, yellows: 78, reds_ap: 0.06, reds: 1 },
                { name: "Gianpaolo Calvarese", matches: 16, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 3.50, yellows: 56, reds_ap: 0.31, reds: 5 },
                { name: "Daniele Chiffi", matches: 16, fouls_avg: 27.75, penalties_ap: 0.31, yellows_ap: 3.56, yellows: 57, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Orsato", matches: 15, fouls_avg: 29.07, penalties_ap: 0.13, yellows_ap: 5.13, yellows: 77, reds_ap: 0.13, reds: 2 },
                { name: "Luca Pairetto", matches: 15, fouls_avg: 28.67, penalties_ap: 0.47, yellows_ap: 3.80, yellows: 57, reds_ap: 0.40, reds: 6 },
                { name: "Michael Fabbri", matches: 14, fouls_avg: 23.57, penalties_ap: 0.36, yellows_ap: 4.57, yellows: 64, reds_ap: 0.21, reds: 3 },
                { name: "Fabio Maresca", matches: 14, fouls_avg: 26.64, penalties_ap: 0.07, yellows_ap: 6.00, yellows: 84, reds_ap: 0.29, reds: 4 },
                { name: "Paolo Valeri", matches: 13, fouls_avg: 27.00, penalties_ap: 0.38, yellows_ap: 4.38, yellows: 57, reds_ap: 0.23, reds: 3 },
                { name: "Rosario Abisso", matches: 13, fouls_avg: 27.23, penalties_ap: 0.62, yellows_ap: 4.31, yellows: 56, reds_ap: 0.31, reds: 4 },
                { name: "Marco Piccinini", matches: 13, fouls_avg: 27.85, penalties_ap: 0.38, yellows_ap: 3.62, yellows: 47, reds_ap: 0.08, reds: 1 },
                { name: "Fabrizio Pasqua", matches: 12, fouls_avg: 25.00, penalties_ap: 0.25, yellows_ap: 3.42, yellows: 41, reds_ap: 0.25, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 12, fouls_avg: 25.75, penalties_ap: 0.33, yellows_ap: 4.17, yellows: 50, reds_ap: 0.08, reds: 1 },
                { name: "Massimiliano Irrati", matches: 11, fouls_avg: 27.73, penalties_ap: 0.09, yellows_ap: 4.55, yellows: 50, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 10, fouls_avg: 27.70, penalties_ap: 0.50, yellows_ap: 4.20, yellows: 42, reds_ap: 0.30, reds: 3 },
                { name: "Federico La Penna", matches: 10, fouls_avg: 28.00, penalties_ap: 0.40, yellows_ap: 4.80, yellows: 48, reds_ap: 0.40, reds: 4 },
                { name: "Gianluca Manganiello", matches: 10, fouls_avg: 25.40, penalties_ap: 0.20, yellows_ap: 3.00, yellows: 30, reds_ap: 0.10, reds: 1 },
                { name: "Francesco Fourneau", matches: 9, fouls_avg: 29.00, penalties_ap: 0.67, yellows_ap: 5.56, yellows: 50, reds_ap: 0.22, reds: 2 },
                { name: "Valerio Marini", matches: 7, fouls_avg: 30.57, penalties_ap: 0.71, yellows_ap: 4.29, yellows: 30, reds_ap: 0.00, reds: 0 },
                { name: "Giovanni Ayroldi", matches: 7, fouls_avg: 26.00, penalties_ap: 0.57, yellows_ap: 3.86, yellows: 27, reds_ap: 0.43, reds: 3 },
                { name: "Gianluca Aureliano", matches: 6, fouls_avg: 26.17, penalties_ap: 0.67, yellows_ap: 5.50, yellows: 33, reds_ap: 0.00, reds: 0 },
                { name: "Livio Marinelli", matches: 6, fouls_avg: 23.83, penalties_ap: 0.17, yellows_ap: 4.00, yellows: 24, reds_ap: 0.17, reds: 1 },
                { name: "Antonio Giua", matches: 6, fouls_avg: 31.00, penalties_ap: 0.33, yellows_ap: 3.83, yellows: 23, reds_ap: 0.33, reds: 2 },
                { name: "Simone Sozza", matches: 6, fouls_avg: 25.00, penalties_ap: 0.17, yellows_ap: 3.33, yellows: 20, reds_ap: 0.33, reds: 2 },
                { name: "Ivano Pezzuto", matches: 5, fouls_avg: 28.40, penalties_ap: 0.80, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Alessandro Prontera", matches: 5, fouls_avg: 28.60, penalties_ap: 0.40, yellows_ap: 3.40, yellows: 17, reds_ap: 0.40, reds: 2 },
                { name: "Manuel Volpi", matches: 5, fouls_avg: 32.20, penalties_ap: 0.40, yellows_ap: 3.20, yellows: 16, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 5, fouls_avg: 29.40, penalties_ap: 0.40, yellows_ap: 4.40, yellows: 22, reds_ap: 0.00, reds: 0 },
                { name: "Davide Ghersini", matches: 4, fouls_avg: 25.75, penalties_ap: 1.00, yellows_ap: 4.50, yellows: 18, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Di Martino", matches: 4, fouls_avg: 28.75, penalties_ap: 0.25, yellows_ap: 4.75, yellows: 19, reds_ap: 0.75, reds: 3 },
                { name: "Antonio Rapuano", matches: 4, fouls_avg: 27.50, penalties_ap: 0.50, yellows_ap: 4.75, yellows: 19, reds_ap: 0.00, reds: 0 },
                { name: "Luca Massimi", matches: 4, fouls_avg: 31.25, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 18, reds_ap: 0.25, reds: 1 },
                { name: "Eugenio Abbattista", matches: 3, fouls_avg: 26.33, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 15, reds_ap: 0.33, reds: 1 },
                { name: "Marco Serra", matches: 2, fouls_avg: 33.00, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 9, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Paterna", matches: 2, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Santoro", matches: 2, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Gariglio", matches: 2, fouls_avg: 25.00, penalties_ap: 0.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Marchetti", matches: 2, fouls_avg: 32.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Riccardo Ros", matches: 1, fouls_avg: 37.00, penalties_ap: 1.00, yellows_ap: 6.00, yellows: 6, reds_ap: 1.00, reds: 1 },
                { name: "Lorenzo Maggioni", matches: 1, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Giacomo Camplone", matches: 1, fouls_avg: 20.00, penalties_ap: 1.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Meraviglia", matches: 1, fouls_avg: 22.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 1.00, reds: 1 }
            ],
        };

        // State
        let activeSeasons = ['2025-26']; 
        let currentSort = { key: 'matches', order: 'desc' };
        let aggregatedData = [];
        let minMatchesFilter = 0;
        let currentView = 'stats'; // 'stats' or 'playingTime'
        let hideInactive = false; // Filter for inactive refs
        let playingTimeSort = { column: null, order: 'asc' };
        let matchesSort = { column: null, order: 'asc' };

        // --- FUNCTIONS ---
        function updateMinMatches(val) {
            minMatchesFilter = parseInt(val);
            document.getElementById('minMatchesValue').innerText = val;
            updateRefereesTable();
            updateInsights();
        }
        
        function sortData(key) {
            if (currentSort.key === key) {
                currentSort.order = currentSort.order === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.key = key;
                currentSort.order = 'desc';
            }
            updateRefereesTable();
        }

        function toggleDetails(id) {
             const row = document.getElementById(id);
             const icon = document.getElementById('icon-' + id);
             if (row.classList.contains('open')) {
                 row.classList.remove('open');
                 icon.style.transform = 'rotate(0deg)';
             } else {
                 row.classList.add('open');
                 icon.style.transform = 'rotate(180deg)';
             }
        }

        function processPlayingTimeData() {
            const stats = {};
            const isSeason2526 = activeSeasons.includes('2025-26');
            const isSeason2425 = activeSeasons.includes('2024-25');

            // Toggle Disclaimer Visibility
            const disclaimer = document.getElementById('disclaimer-2526');
            if (isSeason2526) {
                disclaimer.classList.remove('hidden');
            } else {
                disclaimer.classList.add('hidden');
            }

            // Helper to parse time (46,53 -> seconds)
            const parseTime = (timeStr) => {
                if (!timeStr || timeStr === 'ND') return 0;
                const [min, sec] = timeStr.replace('.', ',').split(',').map(Number);
                if (isNaN(min)) return 0;
                return min * 60 + (sec || 0);
            };
            
            const formatTime = (seconds) => {
                const m = Math.floor(seconds / 60);
                const s = Math.round(seconds % 60);
                return `${m}'${s.toString().padStart(2, '0')}''`;
            };

            // Process 2025-26 Data (Format: Match Referee Time)
            if (isSeason2526) {
                const lines = RAW_LOOKUP_2526.trim().split('\n');
                lines.forEach(line => {
                    // Split by tab or spaces, but careful about match names
                    // Based on user input, lines are: "Genoa-Lecce\tMassa\t46,53"
                    const parts = line.split(/\t+/); 
                    if (parts.length < 3) return; // skip malformed

                    const matchName = parts[0].trim();
                    const refName = parts[1].trim();
                    const timeStr = parts[2].trim();

                    const seconds = parseTime(timeStr);
                    if (seconds === 0) return;

                    if (!stats[refName]) stats[refName] = createRefStat(refName);
                    
                    stats[refName].effSecondsAccumulated += seconds;
                    stats[refName].effCount += 1;
                    stats[refName].effMatches.push({
                        timeFormatted: formatTime(seconds),
                        matchName: matchName
                    });
                });
                
                // Add Total Time stats separately from TOTAL_TIME_DB since lookup doesn't have it
                // We use TOTAL_TIME_DB for averages but matches list will be empty for total time column in this specific view mode unless linked
                const totalTimeLines = TOTAL_TIME_DB.trim().split('\n');
                totalTimeLines.forEach(line => {
                     const parts = line.trim().split(/\t+/);
                     if (parts.length < 2) return;
                     const refName = parts[0].trim(); // "Massa"
                     // Note: This TOTAL_TIME_DB format name might differ slightly (e.g. first name)? 
                     // The provided DB has just surname usually. "Massa 95,47"
                     // We try to match existing stats entry by surname
                     
                     // Find matching key in stats
                     let foundKey = Object.keys(stats).find(k => k.includes(refName));
                     if (!foundKey) return;

                     const timeStr = parts[1].trim();
                     const seconds = parseTime(timeStr);
                     
                     // This DB is average per match or total? 
                     // Looking at values: "95,47". This looks like a single match value or average.
                     // If it's a list of all matches, we accumulate.
                     // The TOTAL_TIME_DB variable in previous code was just list of values?
                     // Ah, the previous TOTAL_TIME_DB was a list of "Referee Time" lines.
                     // Let's assume it is all matches.
                     
                     stats[foundKey].totalGameSecondsAccumulated += seconds;
                     stats[foundKey].totalGameCount += 1;
                     // We don't have match name here easily, so we leave matches list empty for Total Time or just put the time
                     stats[foundKey].totalGameMatches.push({
                         timeFormatted: formatTime(seconds),
                         matchName: "" // No match name available in this specific DB file
                     });
                });
            }

            // Process 2024-25 Data (Format: Match Referee TotalTime EffTime)
            if (isSeason2425) {
                 const lines = RAW_LOOKUP_2425.trim().split('\n');
                 lines.forEach(line => {
                    const parts = line.split(/\t+/);
                    if (parts.length < 4) return;

                    const matchName = parts[0].trim();
                    // Ref name sometimes has trailing spaces
                    const refName = parts[1].trim(); 
                    const totalTimeStr = parts[2].trim();
                    const effTimeStr = parts[3].trim();

                    const effSec = parseTime(effTimeStr);
                    const totalSec = parseTime(totalTimeStr);

                    if (!stats[refName]) stats[refName] = createRefStat(refName);

                    if (effSec > 0) {
                        stats[refName].effSecondsAccumulated += effSec;
                        stats[refName].effCount += 1;
                        stats[refName].effMatches.push({
                            timeFormatted: formatTime(effSec),
                            matchName: matchName
                        });
                    }
                    
                    if (totalSec > 0) {
                        stats[refName].totalGameSecondsAccumulated += totalSec;
                        stats[refName].totalGameCount += 1;
                         stats[refName].totalGameMatches.push({
                            timeFormatted: formatTime(totalSec),
                            matchName: matchName
                        });
                    }
                 });
            }

            // Convert stats object to array
            const data = Object.values(stats).map(s => {
                const avgEffSeconds = s.effCount > 0 ? s.effSecondsAccumulated / s.effCount : 0;
                const avgTotSeconds = s.totalGameCount > 0 ? s.totalGameSecondsAccumulated / s.totalGameCount : 0;

                return {
                    name: s.name,
                    avgEffFormatted: formatTime(avgEffSeconds),
                    avgEffSeconds: avgEffSeconds,
                    matches: s.effMatches, // Array of objects {timeFormatted, matchName}
                    matchCount: s.effCount,
                    avgTotFormatted: s.totalGameCount > 0 ? formatTime(avgTotSeconds) : "-",
                    avgTotSeconds: avgTotSeconds,
                    totalMatches: s.totalGameMatches
                };
            });
            
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();
            const filteredData = data.filter(r => r.name.toLowerCase().includes(searchQuery));

            renderPlayingTimeTable(filteredData, isSeason2526);
        }

        function createRefStat(name) {
            return {
                name: name,
                effSecondsAccumulated: 0,
                effCount: 0,
                effMatches: [],
                totalGameSecondsAccumulated: 0,
                totalGameCount: 0,
                totalGameMatches: []
            };
        }

        // --- UTILS ---
        function formatName(fullName, isInactive) {
            const parts = fullName.trim().split(' ');
            if (parts.length < 2) return fullName;
            const firstName = parts.shift();
            const surname = parts.join(' ');
            const asterisk = isInactive ? '<span class="text-red-500 ml-1 text-lg leading-none">*</span>' : '';
            return `<div class="flex items-center"><span class="font-bold text-white text-base uppercase leading-tight">${surname}</span> <span class="text-slate-400 font-normal text-xs ml-1">${firstName}</span>${asterisk}</div>`;
        }
        
        function getSurname(fullName) {
             const parts = fullName.trim().split(' ');
             if (parts.length < 2) return fullName;
             const firstName = parts.shift();
             return parts.join(' ').toLowerCase();
        }

        function toggleInactiveRefs() {
            hideInactive = document.getElementById('toggleInactive').checked;
            aggregateData();
        }

        function sortPlayingTime(columnIndex, isNumeric = false) {
            const tbody = document.getElementById("tableBody");
            const mainRows = Array.from(tbody.querySelectorAll("tr:not(.details-row)"));

            if (playingTimeSort.column === columnIndex) {
                playingTimeSort.order = playingTimeSort.order === "asc" ? "desc" : "asc";
            } else {
                playingTimeSort.column = columnIndex;
                playingTimeSort.order = "asc";
            }

            const multiplier = playingTimeSort.order === "asc" ? 1 : -1;

            mainRows.sort((a, b) => {
                if (!a.children[columnIndex] || !b.children[columnIndex]) return 0;

                let A = a.children[columnIndex].innerText.trim();
                let B = b.children[columnIndex].innerText.trim();

                if (isNumeric) {
                    if(A.includes("'")) {
                         const [minA, secA] = A.replace("''", "").split("'").map(Number);
                         const [minB, secB] = B.replace("''", "").split("'").map(Number);
                         A = (minA || 0) * 60 + (secA || 0);
                         B = (minB || 0) * 60 + (secB || 0);
                    } else {
                         A = parseFloat(A.replace(',', '.'));
                         B = parseFloat(B.replace(',', '.'));
                    }
                    return (A - B) * multiplier;
                } else {
                    return A.localeCompare(B) * multiplier;
                }
            });

            mainRows.forEach(row => {
                tbody.appendChild(row);
                const detailsId = row.getAttribute('data-details-id');
                if (detailsId && document.getElementById(detailsId)) {
                    tbody.appendChild(document.getElementById(detailsId));
                }
            });
        }

        // --- RENDERERS ---

        function updateRefereesTable() {
            document.getElementById('tableHeader').innerHTML = `
                <tr>
                    <th scope="col" class="px-2 py-3 sm:px-6 sm:py-4 font-bold cursor-pointer hover:text-white transition group sticky-col-head" onclick="sortData('name')">
                        Arbitro <i class="fa-solid fa-sort ml-1 opacity-30 group-hover:opacity-100 transition-opacity"></i>
                    </th>
                    <th scope="col" class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center cursor-pointer hover:text-white transition group" onclick="sortData('matches')">
                        <span class="sm:hidden">Pres</span><span class="hidden sm:inline">PRESENZE</span> <i class="fa-solid fa-sort ml-1 opacity-30 group-hover:opacity-100 transition-opacity"></i>
                    </th>
                    <th scope="col" class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center cursor-pointer hover:text-white transition group" onclick="sortData('fouls_avg')">
                        <span class="sm:hidden">Fal/P</span><span class="hidden sm:inline">Falli/P</span> <i class="fa-solid fa-sort ml-1 opacity-30 group-hover:opacity-100 transition-opacity"></i>
                    </th>
                    <th scope="col" class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-yellow-500 cursor-pointer hover:text-yellow-300 transition group" onclick="sortData('yellows')">
                        <span class="sm:hidden">Gialli</span><span class="hidden sm:inline">GIALLI TOT</span> <i class="fa-solid fa-sort ml-1 opacity-30 group-hover:opacity-100 transition-opacity"></i>
                    </th>
                    <th scope="col" class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-yellow-500 cursor-pointer hover:text-yellow-300 transition group" onclick="sortData('yellows_ap')">
                        <span class="sm:hidden">G/P</span><span class="hidden sm:inline">Gialli/P</span> <i class="fa-solid fa-sort ml-1 opacity-30 group-hover:opacity-100 transition-opacity"></i>
                    </th>
                    <th scope="col" class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-red-500 cursor-pointer hover:text-red-400 transition group" onclick="sortData('reds')">
                        <span class="sm:hidden">Rossi</span><span class="hidden sm:inline">ROSSI TOT</span> <i class="fa-solid fa-sort ml-1 opacity-30 group-hover:opacity-100 transition-opacity"></i>
                    </th>
                    <th scope="col" class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-red-500 cursor-pointer hover:text-red-400 transition group" onclick="sortData('reds_ap')">
                        <span class="sm:hidden">R/P</span><span class="hidden sm:inline">Rossi/P</span> <i class="fa-solid fa-sort ml-1 opacity-30 group-hover:opacity-100 transition-opacity"></i>
                    </th>
                    <th scope="col" class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center cursor-pointer hover:text-white transition group" onclick="sortData('penalties_ap')">
                        <span class="sm:hidden">Rig/P</span><span class="hidden sm:inline">Rigori/P</span> <i class="fa-solid fa-sort ml-1 opacity-30 group-hover:opacity-100 transition-opacity"></i>
                    </th>
                </tr>
            `;

            const tbody = document.getElementById('tableBody');
            const sortKey = currentSort.key;
            const sortOrder = currentSort.order;
            
            let filtered = aggregatedData.filter(r => r.matches >= minMatchesFilter);

            let sorted = [...filtered].sort((a, b) => {
                let valA = a[sortKey];
                let valB = b[sortKey];
                if (sortKey === 'name') {
                     valA = getSurname(a.name);
                     valB = getSurname(b.name);
                } else if (typeof valA === 'string') {
                     valA = valA.toLowerCase();
                     valB = valB.toLowerCase();
                }
                if (valA < valB) return sortOrder === 'asc' ? -1 : 1;
                if (valA > valB) return sortOrder === 'asc' ? 1 : -1;
                return 0;
            });

            const maxMatches = Math.max(...sorted.map(r => r.matches)) || 1;
            const maxFouls = Math.max(...sorted.map(r => r.fouls_avg)) || 1;
            const minFoulsBarBase = Math.min(...sorted.map(r => r.penalties_ap)) || 0;
            const maxYellowsAp = Math.max(...sorted.map(r => r.yellows_ap)) || 1;
            const maxRedsAp = Math.max(...sorted.map(r => r.reds_ap)) || 1;
            const maxPensAp = Math.max(...sorted.map(r => r.penalties_ap)) || 1;

            tbody.innerHTML = '';
            
            let totalMatches = 0;
            let totalYellows = 0;
            let totalReds = 0;
            let weightedFouls = 0;
            let weightedPens = 0;
            
            sorted.forEach(ref => {
                totalMatches += ref.matches;
                totalYellows += ref.yellows;
                totalReds += ref.reds;
                weightedFouls += (ref.fouls_avg * ref.matches);
                weightedPens += (ref.penalties_ap * ref.matches);

                const matchPercent = (ref.matches / maxMatches) * 100;
                
                let foulsPercent = 0;
                if (maxFouls > minFoulsBarBase) {
                     foulsPercent = ((ref.fouls_avg - minFoulsBarBase) / (maxFouls - minFoulsBarBase)) * 100;
                } else {
                     foulsPercent = 100;
                }
                if (ref.fouls_avg > 0 && foulsPercent < 5) foulsPercent = 5;
                
                const yellowsPercent = (ref.yellows_ap / maxYellowsAp) * 100;
                const redsPercent = maxRedsAp > 0 ? (ref.reds_ap / maxRedsAp) * 100 : 0;
                const pensPercent = maxPensAp > 0 ? (ref.penalties_ap / maxPensAp) * 100 : 0;
                
                const row = `
                    <tr class="hover:bg-white/5 group transition-colors">
                        <td class="px-2 py-2 sm:px-6 sm:py-3 whitespace-nowrap sticky-col-body">
                             ${formatName(ref.name, ref.isInactive)}
                        </td>
                        <td class="px-1 py-2 sm:px-4 sm:py-3 text-center">
                            <div class="flex flex-col justify-center items-center">
                                <span class="text-sm sm:text-lg font-bold text-white mb-0.5 sm:mb-1">${ref.matches}</span>
                                <div class="w-[30px] sm:w-full sm:max-w-[60px] bg-slate-800 rounded-full h-1">
                                    <div class="h-1 rounded-full" style="width: ${matchPercent}%; background: linear-gradient(90deg, #ef4444, #22c55e);"></div>
                                </div>
                            </div>
                        </td>
                        <td class="px-1 py-2 sm:px-4 sm:py-3 text-center">
                            <div class="flex flex-col justify-center items-center">
                                <span class="text-slate-300 font-mono text-xs sm:text-sm mb-0.5 sm:mb-1">${ref.fouls_avg.toFixed(2)}</span>
                                <div class="w-[25px] sm:w-full sm:max-w-[50px] bg-slate-800 rounded-full h-1">
                                    <div class="h-1 rounded-full" style="width: ${foulsPercent}%; background: linear-gradient(90deg, #3b82f6, #a855f7);"></div>
                                </div>
                            </div>
                        </td>
                        
                        <td class="px-1 py-2 sm:px-4 sm:py-3 text-center font-bold text-yellow-500 text-xs sm:text-base">${ref.yellows}</td>

                        <td class="px-1 py-2 sm:px-4 sm:py-3 text-center">
                            <div class="flex flex-col justify-center items-center">
                                <span class="font-bold text-yellow-500 font-mono text-xs sm:text-sm mb-0.5 sm:mb-1">${ref.yellows_ap.toFixed(2)}</span>
                                <div class="w-[25px] sm:w-full sm:max-w-[50px] bg-slate-800 rounded-full h-1">
                                    <div class="h-1 rounded-full" style="width: ${yellowsPercent}%; background: linear-gradient(90deg, #fef08a, #eab308);"></div>
                                </div>
                            </div>
                        </td>

                        <td class="px-1 py-2 sm:px-4 sm:py-3 text-center font-bold text-red-500 text-xs sm:text-base">${ref.reds}</td>

                        <td class="px-1 py-2 sm:px-4 sm:py-3 text-center">
                            <div class="flex flex-col justify-center items-center">
                                <span class="font-bold text-red-500 font-mono text-xs sm:text-sm mb-0.5 sm:mb-1">${ref.reds_ap.toFixed(2)}</span>
                                <div class="w-[25px] sm:w-full sm:max-w-[50px] bg-slate-800 rounded-full h-1">
                                    <div class="h-1 rounded-full" style="width: ${redsPercent}%; background: linear-gradient(90deg, #fca5a5, #ef4444);"></div>
                                </div>
                            </div>
                        </td>
                        
                        <td class="px-1 py-2 sm:px-4 sm:py-3 text-center">
                             <div class="flex flex-col justify-center items-center">
                                <span class="text-blue-400 font-mono text-xs sm:text-sm mb-0.5 sm:mb-1">${ref.penalties_ap.toFixed(2)}</span>
                                <div class="w-[25px] sm:w-full sm:max-w-[50px] bg-slate-800 rounded-full h-1">
                                    <div class="h-1 rounded-full" style="width: ${pensPercent}%; background: linear-gradient(90deg, #60a5fa, #3b82f6);"></div>
                                </div>
                            </div>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });

            const avgFouls = totalMatches > 0 ? (weightedFouls / totalMatches).toFixed(2) : "0.00";
            const avgPens = totalMatches > 0 ? (weightedPens / totalMatches).toFixed(2) : "0.00";
            const avgYellowsAp = totalMatches > 0 ? (totalYellows / totalMatches).toFixed(2) : "0.00";
            const avgRedsAp = totalMatches > 0 ? (totalReds / totalMatches).toFixed(2) : "0.00";

            const tfoot = document.getElementById('tableFooter');
            tfoot.innerHTML = `
                <tr>
                    <td class="px-2 py-3 sm:px-6 sm:py-4 text-right uppercase tracking-wider text-slate-500 text-[10px] sm:text-xs sticky-col-body">Totale</td>
                    <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-sm sm:text-xl text-white">${totalMatches}</td>
                    <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-slate-400 text-xs sm:text-sm">${avgFouls}</td>
                    <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-yellow-500 text-sm sm:text-lg">${totalYellows}</td>
                    <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-yellow-500 text-xs sm:text-sm">${avgYellowsAp}</td>
                    <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-red-500 text-sm sm:text-lg">${totalReds}</td>
                    <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-red-500 text-xs sm:text-sm">${avgRedsAp}</td>
                    <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-blue-400 text-xs sm:text-sm">${avgPens}</td>
                </tr>
            `;
        }

        function renderPlayingTimeTable(data, showTotalTime) {
            const thead = document.getElementById('tableHeader');
            const tbody = document.getElementById('tableBody');
            const tfoot = document.getElementById('tableFooter');

            let headerHTML = `
                <tr>
                    <th class="px-2 py-3 sm:px-6 sm:py-4 font-bold text-white cursor-pointer sticky-col-head" onclick="sortPlayingTime(0)">Arbitro</th>
                    <th class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-white cursor-pointer" onclick="sortPlayingTime(1, true)"><span class="sm:hidden">T. Eff</span><span class="hidden sm:inline">Tempo Effettivo Medio</span></th>
            `;
            
            if (showTotalTime) {
                headerHTML += `<th class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-white cursor-pointer" onclick="sortPlayingTime(2, true)"><span class="sm:hidden">T. Tot</span><span class="hidden sm:inline">Tempo Totale Medio</span></th>`;
                headerHTML += `<th class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-white cursor-pointer" onclick="sortPlayingTime(3, true)"><span class="sm:hidden">Part</span><span class="hidden sm:inline">Partite</span></th></tr>`;
            } else {
                headerHTML += `<th class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-white cursor-pointer" onclick="sortPlayingTime(2, true)"><span class="sm:hidden">Part</span><span class="hidden sm:inline">Partite</span></th></tr>`;
            }
            
            thead.innerHTML = headerHTML;

            // Default Sort
            data.sort((a, b) => b.avgEffSeconds - a.avgEffSeconds);

            tbody.innerHTML = '';
            
            if (data.length === 0) {
                const colSpan = showTotalTime ? 4 : 3;
                tbody.innerHTML = `<tr><td colspan="${colSpan}" class="text-center py-8 text-slate-500">Nessun dato disponibile.</td></tr>`;
                tfoot.innerHTML = '';
                return;
            }

            data.forEach((ref, index) => {
                const rowId = `details-${index}`;
                let mainRowHTML = `
                    <tr class="hover:bg-white/5 transition-colors cursor-pointer border-b border-slate-800" onclick="toggleDetails('${rowId}')" data-details-id="${rowId}">
                        <td class="px-2 py-3 sm:px-6 sm:py-4 font-bold text-white uppercase flex items-center gap-2 sticky-col-body">
                            ${ref.name}
                            <i class="fa-solid fa-chevron-down text-xs text-slate-500 transition-transform" id="icon-${rowId}"></i>
                        </td>
                        <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-sm sm:text-lg font-mono text-green-400 font-bold shadow-green-500/10 drop-shadow-sm">${ref.avgEffFormatted}</td>
                `;
                
                if (showTotalTime) {
                     mainRowHTML += `<td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-sm sm:text-lg font-mono text-blue-400 font-bold">${ref.avgTotFormatted}</td>`;
                }
                
                mainRowHTML += `<td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-slate-400 text-xs sm:text-base">${ref.matchCount}</td></tr>`;

                // Render List with correct match association
                const matchList = ref.matches.map(m => `<span class="bg-slate-800 px-2 py-1 rounded text-xs font-mono border border-slate-700 text-green-300 cursor-help hover:bg-slate-700 transition-colors" title="${m.matchName}">${m.timeFormatted}</span>`).join('');
                
                let totalMatchList = "";
                if(showTotalTime && ref.totalMatches.length > 0) {
                    totalMatchList = ref.totalMatches.map(m => {
                        const titleAttr = m.matchName ? `title="${m.matchName}" class="cursor-help"` : "";
                        return `<span class="bg-slate-800 px-2 py-1 rounded text-xs font-mono border border-slate-700 text-blue-300 ${titleAttr}">${m.timeFormatted}</span>`;
                    }).join('');
                }
                
                const colSpan = showTotalTime ? 4 : 3;
                
                let detailsContent = `
                    <div class="flex flex-col gap-2">
                        <div class="flex flex-wrap gap-2 items-center">
                            <span class="text-[10px] sm:text-xs text-green-500 uppercase font-bold mr-2 w-16 sm:w-24">Effettivo:</span>
                            ${matchList}
                        </div>
                `;
                
                if (showTotalTime) {
                    detailsContent += `
                        <div class="flex flex-wrap gap-2 items-center border-t border-white/5 pt-2">
                             <span class="text-[10px] sm:text-xs text-blue-500 uppercase font-bold mr-2 w-16 sm:w-24">Totale:</span>
                             ${totalMatchList}
                        </div>
                    `;
                }
                
                detailsContent += `</div>`;

                const detailsRow = `
                    <tr id="${rowId}" class="details-row bg-slate-900/50">
                        <td colspan="${colSpan}" class="px-2 sm:px-6 py-4">
                            ${detailsContent}
                        </td>
                    </tr>
                `;

                tbody.innerHTML += mainRowHTML + detailsRow;
            });
            tfoot.innerHTML = '';
        }
        
        // --- MATCHES LOGIC ---
        function processMatchesData() {
            const isSeason2526 = activeSeasons.includes('2025-26');
            
            // Show Update Disclaimer for 25/26
            const disclaimer = document.getElementById('disclaimer-update');
            if (isSeason2526) {
                disclaimer.classList.remove('hidden');
            } else {
                disclaimer.classList.add('hidden');
            }

            let data = [];
            let rawLines = [];

            if (activeSeasons.includes('2025-26') && typeof MATCHES_DB_2526 !== 'undefined') {
                 rawLines = rawLines.concat(MATCHES_DB_2526.trim().split('\n'));
            }
            if (activeSeasons.includes('2024-25') && typeof MATCHES_DB_2425 !== 'undefined') {
                 rawLines = rawLines.concat(MATCHES_DB_2425.trim().split('\n'));
            }
            
            data = rawLines.map(line => {
                const parts = line.split('\t');
                if (parts.length < 3) return null;
                
                const matchName = parts[0].trim();
                const totalTimeStr = parts[1].trim();
                const effTimeStr = parts[2].trim();
                let percStr = parts.length > 3 ? parts[3].trim().replace('%', '') : '0';

                // Auto-calculate percentage if missing or if inserting fresh raw data without it
                if (percStr === '0' || !parts[3]) {
                     if(effTimeStr !== 'ND' && totalTimeStr !== 'ND') {
                         const tot = parseTimeToSeconds(totalTimeStr);
                         const eff = parseTimeToSeconds(effTimeStr);
                         if(tot > 0) {
                             percStr = ((eff / tot) * 100).toFixed(1);
                         }
                     }
                }
                
                const totalSec = parseTimeToSeconds(totalTimeStr);
                const effSec = effTimeStr === 'ND' ? 0 : parseTimeToSeconds(effTimeStr);
                const perc = effTimeStr === 'ND' ? 0 : parseFloat(percStr.replace(',', '.'));
                
                const displayPerc = effTimeStr === 'ND' ? 'ND' : percStr + '%';

                return {
                    match: matchName,
                    totalTimeDisplay: formatTimeDisplay(totalTimeStr), 
                    totalTimeRaw: totalTimeStr,
                    effTimeRaw: effTimeStr,
                    effTimeDisplay: effTimeStr === 'ND' ? 'ND' : formatTimeDisplay(effTimeStr),
                    percRaw: displayPerc,
                    
                    sortTotal: totalSec,
                    sortEff: effSec,
                    sortPerc: perc
                };
            }).filter(x => x !== null);

            // Search Filter
            const query = document.getElementById('searchInput').value.toLowerCase();
            if (query) {
                data = data.filter(d => d.match.toLowerCase().includes(query));
            }

            renderMatchesTable(data);
        }

        function parseTimeToSeconds(timeStr) {
            if(timeStr === 'ND') return 0;
            const parts = timeStr.replace('.', ',').split(',');
            const min = parseInt(parts[0]) || 0;
            const sec = parseInt(parts[1]) || 0;
            return min * 60 + sec;
        }

        function formatTimeDisplay(timeStr) {
            if(timeStr === 'ND') return 'ND';
            const parts = timeStr.replace('.', ',').split(',');
            return `${parts[0]}'${parts[1] || '00'}''`;
        }

        function sortMatches(columnIndex, isNumeric) {
            matchesSort.column = columnIndex;
            matchesSort.order = matchesSort.order === 'asc' ? 'desc' : 'asc';
            processMatchesData(); // Re-render
        }

        function renderMatchesTable(data) {
            const thead = document.getElementById('tableHeader');
            const tbody = document.getElementById('tableBody');
            const tfoot = document.getElementById('tableFooter');

            // Custom Sort Logic applied here before render
            if (matchesSort.column !== null) {
                const colMap = ['match', 'sortTotal', 'sortEff', 'sortPerc'];
                const key = colMap[matchesSort.column];
                const mult = matchesSort.order === 'asc' ? 1 : -1;
                
                data.sort((a, b) => {
                    if (typeof a[key] === 'string') {
                        return a[key].localeCompare(b[key]) * mult;
                    } else {
                        return (a[key] - b[key]) * mult;
                    }
                });
            }

            thead.innerHTML = `
                <tr>
                    <th class="px-2 py-3 sm:px-6 sm:py-4 font-bold text-white cursor-pointer sticky-col-head" onclick="sortMatches(0, false)">Partita <i class="fa-solid fa-sort ml-1 opacity-50"></i></th>
                    <th class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-blue-400 cursor-pointer" onclick="sortMatches(1, true)"><span class="sm:hidden">T. Tot</span><span class="hidden sm:inline">Tempo Totale</span> <i class="fa-solid fa-sort ml-1 opacity-50"></i></th>
                    <th class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-green-400 cursor-pointer" onclick="sortMatches(2, true)"><span class="sm:hidden">T. Eff</span><span class="hidden sm:inline">Tempo Effettivo</span> <i class="fa-solid fa-sort ml-1 opacity-50"></i></th>
                    <th class="px-1 py-3 sm:px-4 sm:py-4 font-bold text-center text-yellow-400 cursor-pointer" onclick="sortMatches(3, true)">% <i class="fa-solid fa-sort ml-1 opacity-50"></i></th>
                </tr>
            `;

            tbody.innerHTML = '';

            if (data.length === 0) {
                tbody.innerHTML = `<tr><td colspan="4" class="text-center py-8 text-slate-500">Nessun dato disponibile.</td></tr>`;
                tfoot.innerHTML = '';
                return;
            }

            data.forEach(row => {
                const tr = `
                    <tr class="hover:bg-white/5 transition-colors border-b border-slate-800">
                        <td class="px-2 py-3 sm:px-6 sm:py-4 font-bold text-white uppercase sticky-col-body text-xs sm:text-sm">
                            ${row.match}
                        </td>
                        <td class="px-1 py-3 sm:px-4 sm:py-4 text-center font-mono text-blue-300 text-sm sm:text-base">
                            ${row.totalTimeDisplay}
                        </td>
                        <td class="px-1 py-3 sm:px-4 sm:py-4 text-center font-mono text-green-300 font-bold text-sm sm:text-base">
                            ${row.effTimeDisplay}
                        </td>
                        <td class="px-1 py-3 sm:px-4 sm:py-4 text-center font-bold text-yellow-500 text-sm sm:text-base">
                            ${row.percRaw}
                        </td>
                    </tr>
                `;
                tbody.innerHTML += tr;
            });
            
            // Footer stats (exclude ND)
            const validData = data.filter(d => d.sortEff > 0);
            if (validData.length > 0) {
                let avgEffSec = validData.reduce((a,b) => a + b.sortEff, 0) / validData.length;
                let avgTotSec = validData.reduce((a,b) => a + b.sortTotal, 0) / validData.length;
                let avgPerc = validData.reduce((a,b) => a + b.sortPerc, 0) / validData.length;
                
                const formatSec = (s) => {
                     const m = Math.floor(s/60);
                     const sec = Math.round(s%60);
                     return `${m}'${sec.toString().padStart(2,'0')}''`;
                };

                tfoot.innerHTML = `
                    <tr>
                        <td class="px-2 py-3 sm:px-6 sm:py-4 text-right text-xs sm:text-sm text-slate-500 uppercase sticky-col-body">Media</td>
                        <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-blue-400 font-mono text-sm sm:text-base">${formatSec(avgTotSec)}</td>
                        <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-green-400 font-mono text-sm sm:text-base">${formatSec(avgEffSec)}</td>
                        <td class="px-1 py-3 sm:px-4 sm:py-4 text-center text-yellow-400 font-bold text-sm sm:text-base">${avgPerc.toFixed(1)}%</td>
                    </tr>
                `;
            } else {
                tfoot.innerHTML = '';
            }
        }

        // --- LOGIC ---
        function switchView(view) {
            currentView = view;
            const statsControls = document.getElementById('stats-controls');
            const extraControls = document.getElementById('extra-controls'); 
            const insightsContainer = document.getElementById('insights-container');
            const playingTimeTitle = document.getElementById('playing-time-title');
            const matchesTitle = document.getElementById('matches-title');
            const commonControls = document.getElementById('common-controls');
            const seasonBtns = commonControls.querySelectorAll('.season-btn');
            const searchLabel = document.getElementById('searchLabel');
            const searchInput = document.getElementById('searchInput');
            
            // Nav Switcher Buttons
            const btnStats = document.getElementById('nav-stats');
            const btnTime = document.getElementById('nav-time');
            const btnMatches = document.getElementById('nav-matches');

            // Reset active states
            btnStats.classList.remove('active');
            btnTime.classList.remove('active');
            btnMatches.classList.remove('active');
            
            // Reset Season Buttons Display
            seasonBtns.forEach(btn => btn.style.display = 'flex');

            // Hide Disclaimers
            document.getElementById('disclaimer-2526').classList.add('hidden');
            document.getElementById('disclaimer-update').classList.add('hidden');

            if (view === 'playingTime') {
                statsControls.classList.add('hidden');
                extraControls.classList.remove('hidden');
                insightsContainer.classList.add('hidden');
                playingTimeTitle.classList.remove('hidden');
                matchesTitle.classList.add('hidden');
                
                btnTime.classList.add('active');
                searchLabel.innerText = "Cerca Arbitro";
                searchInput.placeholder = "Nome arbitro...";
                
                // Season Logic: 24/25 & 25/26 only, Single Select
                seasonBtns.forEach(btn => {
                    const season = btn.dataset.season;
                    if (season !== '2025-26' && season !== '2024-25') btn.style.display = 'none';
                });
                if (activeSeasons.length !== 1 || !['2025-26', '2024-25'].includes(activeSeasons[0])) {
                     activeSeasons = ['2025-26'];
                     updateSeasonButtonsUI();
                }
                processPlayingTimeData();

            } else if (view === 'matches') {
                statsControls.classList.add('hidden');
                extraControls.classList.add('hidden'); 
                insightsContainer.classList.add('hidden');
                playingTimeTitle.classList.add('hidden');
                matchesTitle.classList.remove('hidden');
                
                btnMatches.classList.add('active');
                searchLabel.innerText = "Cerca Partita";
                searchInput.placeholder = "Es. Inter-Juve...";

                // Season Logic: 24/25 & 25/26 only, Single Select
                seasonBtns.forEach(btn => {
                    const season = btn.dataset.season;
                    if (season !== '2025-26' && season !== '2024-25') btn.style.display = 'none';
                });
                if (activeSeasons.length !== 1 || !['2025-26', '2024-25'].includes(activeSeasons[0])) {
                     activeSeasons = ['2025-26'];
                     updateSeasonButtonsUI();
                }
                processMatchesData();

            } else {
                // Stats View
                statsControls.classList.remove('hidden');
                extraControls.classList.add('hidden');
                insightsContainer.classList.remove('hidden');
                playingTimeTitle.classList.add('hidden');
                matchesTitle.classList.add('hidden');
                
                btnStats.classList.add('active');
                searchLabel.innerText = "Cerca Arbitro";
                searchInput.placeholder = "Nome arbitro...";
                
                aggregateData();
            }
        }
        
        function updateSeasonButtonsUI() {
            const buttons = document.querySelectorAll('.season-btn');
            buttons.forEach(btn => {
                const season = btn.dataset.season;
                if (activeSeasons.includes(season)) {
                    btn.classList.add('active');
                    btn.querySelector('.check-icon').classList.remove('opacity-0');
                } else {
                    btn.classList.remove('active');
                    btn.querySelector('.check-icon').classList.add('opacity-0');
                }
            });
        }

        function toggleSeason(season) {
            if (currentView === 'playingTime' || currentView === 'matches') {
                // Exclusive selection
                activeSeasons = [season];
                updateSeasonButtonsUI();
                if(currentView === 'playingTime') processPlayingTimeData();
                if(currentView === 'matches') processMatchesData();
            } else {
                // Multi selection for Stats
                const btn = document.getElementById(`btn-${season}`);
                if (activeSeasons.includes(season)) {
                    if (activeSeasons.length > 1) {
                        activeSeasons = activeSeasons.filter(s => s !== season);
                    }
                } else {
                    activeSeasons.push(season);
                }
                updateSeasonButtonsUI();
                aggregateData();
            }
        }

        // --- UTILS ---
        function updateDynamicControls() {
            const maxMatchesInSet = Math.max(...aggregatedData.map(r => r.matches)) || 1;
            const rangeInput = document.getElementById('minMatches');
            
            if (rangeInput.max != maxMatchesInSet) {
                 rangeInput.max = maxMatchesInSet;
                 document.getElementById('maxMatchesLabel').innerText = maxMatchesInSet;
            }
            
            if (minMatchesFilter > maxMatchesInSet) {
                minMatchesFilter = maxMatchesInSet;
                rangeInput.value = minMatchesFilter;
                document.getElementById('minMatchesValue').innerText = minMatchesFilter;
            }
        }

        function updateInsights() {
            const data = aggregatedData.filter(r => r.matches >= minMatchesFilter);
            if (data.length === 0) {
                document.getElementById('insights-container').innerHTML = '';
                return;
            }

            const getTop = (data, key, isDesc) => {
                const sorted = [...data].sort((a,b) => isDesc ? b[key] - a[key] : a[key] - b[key]);
                const topVal = sorted[0][key];
                return sorted.filter(r => r[key] === topVal);
            };

            const strictest = getTop(data, 'yellows_ap', true);
            const lenient = getTop(data, 'fouls_avg', false);
            const workhorse = getTop(data, 'matches', true);

            const createCard = (title, icon, colorClass, referees, statLabel) => {
                const statValue = referees.length > 0 ? (statLabel.includes('Presenze') ? referees[0].matches : (statLabel.includes('Falli') ? referees[0].fouls_avg.toFixed(2) : referees[0].yellows_ap.toFixed(2))) : '-';
                const namesHtml = referees.map(r => `<div class="text-lg font-bold text-white leading-tight truncate">${formatName(r.name, r.isInactive)}</div>`).join('');

                return `
                <div class="glass-panel p-4 rounded-xl border-l-4 ${colorClass} flex items-center justify-between group hover:bg-white/5 transition-colors">
                    <div class="overflow-hidden">
                        <p class="text-xs text-slate-400 uppercase tracking-wider font-bold mb-1">${title}</p>
                        <div class="flex flex-col gap-1 max-h-24 overflow-y-auto custom-scrollbar">
                            ${namesHtml}
                        </div>
                        <p class="text-xs text-slate-500 mt-1">${statLabel}: <span class="text-white font-mono">${statValue}</span></p>
                    </div>
                    <div class="h-10 w-10 rounded-full bg-white/5 flex items-center justify-center group-hover:scale-110 transition-transform flex-shrink-0 ml-2">
                        <i class="${icon} text-lg ${colorClass.replace('border-', 'text-')}"></i>
                    </div>
                </div>
            `};

            document.getElementById('insights-container').innerHTML = `
                ${createCard('IL PiÃ¹ Severo', 'fa-solid fa-square-full', 'border-yellow-500', strictest, 'Gialli/Partita')}
                ${createCard('IL Meno Falloso', 'fa-regular fa-flag', 'border-green-500', lenient, 'Falli/Partita')}
                ${createCard('IL PiÃ¹ Presente', 'fa-solid fa-stopwatch', 'border-blue-500', workhorse, 'Presenze')}
            `;
        }

        function aggregateData() {
            if (currentView === 'playingTime') {
                processPlayingTimeData();
                return; 
            }
            if (currentView === 'matches') {
                processMatchesData();
                return;
            }

            let map = {};
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();
            
            // Active Referees Logic
            // Base set from 2025-26 matches
            const activeRefereesSet = new Set(db['2025-26'] ? db['2025-26'].map(r => r.name) : []);
            // Force Maresca active as requested
            activeRefereesSet.add("Fabio Maresca");

            activeSeasons.forEach(season => {
                const seasonData = db[season];
                if (!seasonData) return;

                seasonData.forEach(ref => {
                    if (!map[ref.name]) {
                        map[ref.name] = {
                            name: ref.name,
                            matches: 0,
                            yellows: 0,
                            reds: 0,
                            w_fouls: 0,
                            w_penalties: 0,
                            w_yellows_ap: 0,
                            w_reds_ap: 0,
                            isInactive: !activeRefereesSet.has(ref.name)
                        };
                    }
                    
                    const entry = map[ref.name];
                    entry.matches += ref.matches;
                    entry.yellows += ref.yellows;
                    entry.reds += ref.reds;
                    entry.w_fouls += (ref.fouls_avg * ref.matches);
                    entry.w_penalties += (ref.penalties_ap * ref.matches);
                    entry.w_yellows_ap += (ref.yellows_ap * ref.matches);
                    entry.w_reds_ap += (ref.reds_ap * ref.matches);
                });
            });

            let result = Object.values(map).map(entry => {
                const m = entry.matches;
                return {
                    name: entry.name,
                    matches: m,
                    yellows: entry.yellows,
                    reds: entry.reds,
                    fouls_avg: m > 0 ? entry.w_fouls / m : 0,
                    penalties_ap: m > 0 ? entry.w_penalties / m : 0,
                    yellows_ap: m > 0 ? entry.w_yellows_ap / m : 0,
                    reds_ap: m > 0 ? entry.w_reds_ap / m : 0,
                    isInactive: entry.isInactive
                };
            });
            
            // Filters
            if (searchQuery) {
                result = result.filter(r => r.name.toLowerCase().includes(searchQuery));
            }
            if (hideInactive) {
                result = result.filter(r => !r.isInactive);
            }

            aggregatedData = result;
            updateDynamicControls();
            updateRefereesTable();
            updateInsights();
        }

        window.handleSearch = function() {
            if (currentView === 'playingTime') processPlayingTimeData();
            else if (currentView === 'matches') processMatchesData();
            else aggregateData();
        };
        window.switchView = switchView;
        window.toggleSeason = toggleSeason;
        window.updateMinMatches = updateMinMatches;
        window.aggregateData = aggregateData;
        window.sortData = sortData;
        window.toggleInactiveRefs = toggleInactiveRefs;
        window.onload = aggregateData;

    </script>
</body>
</html>
