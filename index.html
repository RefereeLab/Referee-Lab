<!DOCTYPE html>
<html lang="it" class="dark">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYY47HJGR6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-PYY47HJGR6');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RefereeLab - Analytics Pro</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        slate: { 850: '#151e2e', 900: '#0f172a', 950: '#020617' },
                        brand: { gold: '#EAB308', dark: '#0B1120' }
                    },
                    boxShadow: {
                        'card': '0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px -1px rgba(0, 0, 0, 0.2)',
                        'glow': '0 0 15px rgba(234, 179, 8, 0.15)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.4s ease-out forwards',
                        'flash': 'flash 1s infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(5px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        flash: {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.3' },
                        }
                    }
                }
            }
        }


    </script>

    <style>
        /* Base Reset & Typography */
html, body {
    overflow-x: clip; /* 'clip' Ã¨ meglio di 'hidden' per sticky */
    background-color: #020617;
    color: #cbd5e1;
}
        /* Soft background accents */
        .aurora-blob {
            position: fixed;
            filter: blur(70px);
            opacity: 0.12;
            pointer-events: none;
            z-index: -1;
        }
        .aurora-blob:nth-child(1) { top: 10%; left: 8%; width: 320px; height: 320px; background: radial-gradient(circle, #eab308, transparent 55%); animation: float 10s ease-in-out infinite; }
        .aurora-blob:nth-child(2) { top: 20%; right: 5%; width: 380px; height: 380px; background: radial-gradient(circle, #38bdf8, transparent 55%); animation: float 12s ease-in-out infinite reverse; }
        .aurora-blob:nth-child(3) { bottom: 5%; left: 30%; width: 420px; height: 420px; background: radial-gradient(circle, #a855f7, transparent 55%); animation: float 14s ease-in-out infinite; }
        @keyframes float {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-12px) scale(1.03); }
        }
        /* Background Texture */
        body::before {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(15, 23, 42, 0.95), rgba(2, 6, 23, 0.98)),
                url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23334155' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            z-index: -1; pointer-events: none;
        }

        /* Pro UI Cards */
        .pro-card {
            background-color: #0f172a;
            border: 1px solid #1e293b;
            box-shadow:
                0 8px 18px -10px rgba(0, 0, 0, 0.45),
                0 0 0 1px rgba(234, 179, 8, 0.04),
                0 0 26px -12px rgba(234, 179, 8, 0.4);
            transition: transform 0.2s ease, box-shadow 0.25s ease, border-color 0.2s ease;
        }

        .pro-card:hover {
            transform: translateY(-2px);
            border-color: rgba(234, 179, 8, 0.35);
            box-shadow:
                0 12px 32px -14px rgba(0, 0, 0, 0.65),
                0 0 0 1px rgba(234, 179, 8, 0.12),
                0 0 42px -12px rgba(234, 179, 8, 0.55);
        }
        
        .pro-header {
            background-color: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid #1e293b;
        }

/* Sidebar sticky SEMPRE (su desktop) */
@media (min-width: 1024px) {
    #sidebar-filters {
        position: sticky;
        top: 6rem;          /* distanza dal top (regola in base all'altezza della navbar) */
        align-self: flex-start; /* Fondamentale: impedisce alla sidebar di allungarsi */
        z-index: 30;        /* Assicura che stia sopra al contenuto ma sotto ai modali */
        max-height: calc(100vh - 7rem); /* Opzionale: se la sidebar Ã¨ molto lunga, permette lo scroll interno */
        overflow-y: auto;   /* Opzionale: abilita lo scroll se il contenuto Ã¨ troppo lungo */
    }
}
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; border: 2px solid #020617; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Micro interactions */
        .fade-in-soft {
            animation: fadeInSoft 0.32s ease-out;
        }

        .view-transitioning {
            position: relative;
            overflow: hidden;
            animation: viewLift 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .view-transitioning::before {
            content: '';
            position: absolute;
            inset: -20%;
            background: radial-gradient(circle at 20% 20%, rgba(234, 179, 8, 0.12), transparent 45%),
                        radial-gradient(circle at 80% 0%, rgba(59, 130, 246, 0.08), transparent 50%);
            opacity: 0;
            animation: viewPulseGlow 0.7s ease forwards;
            pointer-events: none;
        }

        .view-transitioning::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(120deg, transparent 40%, rgba(255,255,255,0.06), transparent 60%);
            transform: translateX(-120%);
            opacity: 0;
            animation: viewSweep 0.75s ease forwards;
            pointer-events: none;
        }

        @keyframes fadeInSoft {
            0% { opacity: 0; transform: translateY(8px) scale(0.995); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes viewLift {
            0% { opacity: 0.35; filter: blur(8px); transform: translateY(12px) scale(0.985); }
            60% { filter: blur(0); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes viewPulseGlow {
            0% { opacity: 0.35; transform: scale(0.96); }
            100% { opacity: 0; transform: scale(1.08); }
        }

        @keyframes viewSweep {
            0% { opacity: 0; transform: translateX(-120%); }
            25% { opacity: 0.45; }
            100% { opacity: 0; transform: translateX(120%); }
        }

        .interactive-surface {
            position: relative;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.25s ease, background 0.3s ease;
            will-change: transform, box-shadow;
            isolation: isolate;
        }

        .interactive-surface::before {
            content: "";
            position: absolute;
            inset: -120%;
            background: radial-gradient(circle, rgba(234, 179, 8, 0.16), transparent 50%);
            opacity: 0;
            transform: scale(0.5);
            transition: opacity 0.35s ease, transform 0.35s ease;
            pointer-events: none;
            z-index: 0;
        }

        .interactive-surface:active {
            transform: translateY(1px) scale(0.995);
        }

        .interactive-surface.click-energize {
            box-shadow: 0 10px 30px -16px rgba(234, 179, 8, 0.6), 0 0 0 2px rgba(234, 179, 8, 0.16);
            transform: translateY(-1px) scale(1.01);
        }

        .interactive-surface.click-energize::before {
            opacity: 1;
            transform: scale(1);
        }

        .ripple {
            position: absolute;
            border-radius: 9999px;
            transform: scale(0);
            animation: ripple 520ms ease-out;
            background: radial-gradient(circle at center, rgba(250, 204, 21, 0.45), rgba(234, 179, 8, 0.25));
            pointer-events: none;
            mix-blend-mode: screen;
        }

        @keyframes ripple {
            to { transform: scale(3.5); opacity: 0; }
        }

        .quiz-option {
            transition: transform 0.18s ease, box-shadow 0.2s ease, background-color 0.2s ease, border-color 0.2s ease;
        }

        .quiz-option:hover {
            transform: translateY(-2px) scale(1.005);
            box-shadow: 0 12px 22px -16px rgba(0, 0, 0, 0.65);
        }

        .quiz-option.correct {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.18), rgba(34, 197, 94, 0.12));
            border-color: rgba(34, 197, 94, 0.6);
            color: #bbf7d0;
        }

        .quiz-option.wrong {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.18), rgba(248, 113, 113, 0.12));
            border-color: rgba(248, 113, 113, 0.5);
            color: #fecdd3;
        }

        /* Navigation Pills (Restored Style) */
        .nav-pills-container {
            display: flex;
            align-items: center;
            padding: 4px;
            border-radius: 9999px;
            border: 1px solid rgba(234, 179, 8, 0.5); /* Yellow border */
            background-color: rgba(15, 23, 42, 0.5);
        }
        
        .nav-pill {
            padding: 6px 16px;
            border-radius: 9999px;
            font-size: 0.75rem; /* text-xs */
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #94a3b8;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

/* Stile per i loghi nel grafico Radar */
.chart-team-logo {
    position: absolute;
    width: 24px;   /* Dimensione logo */
    height: 24px;
    object-fit: contain;
    transform: translate(-50%, -50%); /* Centra l'immagine sul punto esatto */
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5)); /* Ombra per staccare dal fondo */
    z-index: 10;
    transition: all 0.3s ease;
    pointer-events: none; /* Lascia passare il click al grafico sotto */
}

/* Container relativo per permettere il posizionamento assoluto dei loghi */
#chart-top-flop {
    position: relative; 
}
        
        .nav-pill:hover { color: #fff; }

        .nav-pill.active {
            background-color: #EAB308;
            color: #020617;
            box-shadow: 0 0 10px rgba(234, 179, 8, 0.3);
        }

        .nav-pill-boost {
            animation: navBoost 0.6s ease;
            box-shadow: 0 10px 25px rgba(234, 179, 8, 0.25), 0 0 20px rgba(234, 179, 8, 0.2);
            transform: translateY(-1px) scale(1.01);
        }

        @keyframes navBoost {
            0% { transform: translateY(0) scale(1); box-shadow: 0 0 0 rgba(234, 179, 8, 0.0); }
            35% { transform: translateY(-2px) scale(1.03); }
            100% { transform: translateY(-1px) scale(1.01); box-shadow: 0 10px 25px rgba(234, 179, 8, 0.25), 0 0 20px rgba(234, 179, 8, 0.2); }
        }

        .nav-pill:not(.active) {
            background: linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0));
        }

        /* Season Selector */
        .season-item {
            border-left: 2px solid transparent;
            transition: all 0.2s;
        }
        .season-item:hover { background-color: #1e293b; color: white; }
        .season-item.active {
            background-color: #1e293b;
            border-left-color: #EAB308;
            color: #EAB308;
        }
        
        /* CORREZIONE 2: Stile per la scritta "SOON" */
        .coming-soon-label {
            /* Meno oscurata: uso text-slate-400 anzichÃ© text-slate-600 */
            color: #94a3b8 !important; 
            /* Rimuovo la classe hidden per gestirne la visibilitÃ  solo tramite JS/opacitÃ  */
        }
        
        .season-item[title]:hover span.coming-soon-label {
            opacity: 1; /* Assicura che la label non si oscuri sull'hover */
        }

        /* Toggle stagioni per i grafici (scheda Grafici) */
        .analytics-season-chip {
            background-color: rgba(15, 23, 42, 0.7);
            border: 1px solid #1e293b;
            color: #cbd5e1;
            font-size: 0.7rem;
            font-weight: 600;
            padding: 6px 10px;
            border-radius: 9999px;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .analytics-season-chip.active {
            background-color: rgba(234, 179, 8, 0.15);
            border-color: rgba(234, 179, 8, 0.6);
            color: #fefce8;
            box-shadow: 0 0 0 1px rgba(234, 179, 8, 0.2);
        }

        .analytics-season-chip:focus-visible {
            outline: 2px solid #eab308;
            outline-offset: 2px;
        }

        .analytics-anchor-btn {
            background: linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0));
            border: 1px solid #1e293b;
            color: #e2e8f0;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 10px 12px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
            width: 100%;
        }

        .analytics-anchor-btn:hover {
            border-color: rgba(234, 179, 8, 0.35);
            color: #fff;
            box-shadow: 0 0 0 1px rgba(234, 179, 8, 0.08);
            transform: translateY(-1px);
        }

        .analytics-anchor-btn i {
            color: #eab308;
        }

.pro-table th {
    background-color: #111827;
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: 600;
    padding: 6px 8px; 
    border-bottom: 1px solid #1e293b;
    white-space: nowrap;
}
.pro-table td {
    padding: 6px 8px;
    border-bottom: 1px solid #1e293b;
    font-size: 0.85rem;
}        .pro-table tr:last-child td { border-bottom: none; }
        /* Table Styling */
        .pro-table tr:hover td { background-color: #1e293b; }

:root {
    --players-rank-col-width: 3rem;
}

.players-table th,
.players-table td {
    text-align: center;
    box-sizing: border-box;
}

/* Column sizing */
.players-table td:first-child,
.players-table th:first-child,
.players-rank-col {
    min-width: var(--players-rank-col-width);
    width: var(--players-rank-col-width);
}

.players-table td:nth-child(2),
.players-table th:nth-child(2) {
    min-width: 8.5rem;
    max-width: 10rem;
}

.players-table td:nth-child(2),
.players-table th:nth-child(2) {
    text-align: left;
}

.players-table th {
    font-size: 0.65rem;
}

.players-table td {
    font-size: 0.8rem;
}

        /* Players table separators */
#players-table tbody tr:not(:last-child) td {
    border-bottom: 1px solid rgba(148, 163, 184, 0.35);
}
        
        .sticky-head { position: sticky; top: 0; z-index: 20; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .sticky-col { position: sticky; left: 0; z-index: 10; background-color: #0f172a; border-right: 1px solid #1e293b; }
        .sticky-col-name { left: var(--players-rank-col-width); z-index: 11; }
        #players-table th.sticky-col, #players-table th.sticky-col-name { background-color: #111827; }
        #players-table td.sticky-col, #players-table td.sticky-col-name { background-color: #0f172a; }
        .pro-table tr:hover .sticky-col, .pro-table tr:hover .sticky-col-name { background-color: #1e293b; }

@media (max-width: 640px) {
    :root {
        --players-rank-col-width: 2.4rem;
    }

    .players-table td:nth-child(2),
    .players-table th:nth-child(2) {
        max-width: 9rem;
    }
}
        /* Footer Special Style */
        #tableFooter tr td {
            border-top: 2px solid #EAB308;
            background-color: #1e293b; /* Slate 800 */
            color: #fff;
            font-weight: 800; /* Extra bold */
        }
        #tableFooter tr .sticky-col {
            background-color: #1e293b;
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        /* Average Row Style */
        .avg-row td {
            background-color: #1e293b;
            border-top: 2px solid #64748b;
            font-weight: 700;
            color: #e2e8f0;
        }
        .avg-row .sticky-col {
            background-color: #1e293b;
        }

        /* Range Input */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb { 
            -webkit-appearance: none; height: 14px; width: 14px; 
            border-radius: 50%; background: #EAB308; cursor: pointer; margin-top: -5px; 
            box-shadow: 0 0 0 2px #0f172a;
        }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px; }

        /* Mobile Modal Transition */
        #designations-modal { transition: opacity 0.3s ease, visibility 0.3s; opacity: 0; visibility: hidden; }
        #designations-modal.open { opacity: 1; visibility: visible; }
        .modal-content { transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        #designations-modal.open .modal-content { transform: translateX(0); }

        /* Custom Dropdown for Charts */
        .chart-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2394a3b8' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-appearance: none;
            appearance: none;
        }
        
        /* Badge New */
        .badge-new {
            font-size: 0.6rem;
            padding: 2px 6px;
            border-radius: 4px;
            background-color: #ef4444;
            color: white;
            font-weight: 800;
            margin-left: 6px;
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.4);
            animation: pulse-slow 3s infinite;
        }

        .season-new-badge {
            font-size: 0.55rem;
            padding: 2px 6px;
            border-radius: 9999px;
            background: linear-gradient(120deg, #fbbf24, #f97316, #ef4444);
            color: #0f172a;
            font-weight: 900;
            letter-spacing: 0.05em;
            box-shadow: 0 0 12px rgba(234, 179, 8, 0.45);
        }


.quadrant-mini {
    width: 28px;
    height: 28px;
    border: 1px solid #475569; /* slate-600 */
    position: relative;
    border-radius: 4px;
    background: #0f172a; /* stessa card */
    flex-shrink: 0;
    aspect-ratio: 1 / 1;
    overflow: hidden;
}

.quadrant-mini::before, 
.quadrant-mini::after {
    content: "";
    position: absolute;
    background: #475569;
}

.quadrant-mini::before {
    width: 1px;
    height: 100%;
    left: 50%;
    top: 0;
}

.quadrant-mini::after {
    height: 1px;
    width: 100%;
    left: 0;
    top: 50%;
}

.quadrant-dot {
    width: 6px;
    height: 6px;
    background: #eab308; /* default: yellow */
    border-radius: 50%;
    position: absolute;
}

.quadrant-fill {
    position: absolute;
    opacity: 0.35; /* come nei quadranti grandi */
}


        /* Legend Item */
        .legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.7rem; color: #94a3b8; }
        .legend-color { width: 10px; height: 10px; border-radius: 2px; }

        /* Comparison Chips */
        .ref-chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 9999px;
            background-color: rgba(234, 179, 8, 0.1);
            border: 1px solid rgba(234, 179, 8, 0.3);
            color: #EAB308;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .ref-chip button {
            color: #EAB308;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        .ref-chip button:hover { opacity: 1; }

        .feedback-toggle {
            position: fixed;
            bottom: 18px;
            left: 10px;
            right: auto;
            background: linear-gradient(135deg, #eab308, #facc15);
            color: #0f172a;
            border-radius: 9999px;
            padding: 4px 6px;
            font-weight: 800;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 20px 35px -18px rgba(234, 179, 8, 0.7);
            border: 1px solid rgba(234, 179, 8, 0.6);
            transition: transform 0.18s ease, box-shadow 0.25s ease;
            z-index: 60;
        }

        .feedback-toggle:hover { transform: translateY(-2px) scale(1.02); box-shadow: 0 25px 45px -22px rgba(234, 179, 8, 0.9); }

        #feedback-panel {
            position: fixed;
            bottom: 90px;
            left: 20px;
            right: auto;
            width: min(340px, calc(100vw - 40px));
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(234, 179, 8, 0.25);
            box-shadow: 0 20px 60px -28px rgba(0, 0, 0, 0.7), 0 0 0 1px rgba(234, 179, 8, 0.05);
            border-radius: 16px;
            overflow: hidden;
            transform: translateY(20px);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.25s ease, transform 0.25s ease, visibility 0.25s;
            z-index: 60;
        }

        #feedback-panel[data-open="true"] {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        #feedback-overlay {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at 80% 90%, rgba(234, 179, 8, 0.12), transparent 35%), rgba(2, 6, 23, 0.6);
            backdrop-filter: blur(2px);
            z-index: 50;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
        }

        #feedback-overlay[data-open="true"] {
            opacity: 1;
            visibility: visible;
        }

        /* Mobile Optimizations */
        @media (max-width: 640px) {
.pro-table th, .pro-table td {
    padding: 6px 8px; /* <--- MODIFICATO: da 10px a 6px */
    font-size: 0.75rem; 
}            .pro-table th {
                font-size: 0.65rem;
            }
            .pro-card {
                padding: 12px; /* Less padding in cards */
            }
            main {
                padding-left: 1rem;
                padding-right: 1rem;
            }
        }
        
        /* Utilities */
        .text-xxs { font-size: 0.65rem; line-height: 1rem; }
        
        /* Tooltip Container */
        .tooltip { position: relative; display: inline-block; cursor: help; }
        /* Modifica Tooltip Teams: Posizione piÃ¹ bassa e z-index piÃ¹ alto */
        .tooltip .tooltiptext, .tooltip:focus .tooltiptext, .tooltip:active .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #0f172a;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 200; /* Aumentato per evitare sovrapposizione con l'header sticky */
            bottom: 110%; /* Abbassato da 125% per evitare sovrapposizione */
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid #334155;
            font-size: 0.7rem;
            font-weight: normal;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            text-transform: none;
            line-height: 1.4;
            pointer-events: none;
        }
        .tooltip:hover .tooltiptext, .tooltip:focus .tooltiptext, .tooltip:active .tooltiptext { visibility: visible; opacity: 1; pointer-events: auto; }
        
        /* Contenitore per i quadranti DIV (Nuova Soluzione) */
.overlay-quadranti {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 5 !important; /* Sopra la plot area ma sotto i marker */
}

.overlay-quadranti .quadrant {
    position: absolute;
    opacity: 0.22; /* PiÃ¹ visibile */
}        
        .quadrant {
            position: absolute;
            width: 50%;
            height: 50%;
            opacity: 0.18;
            /* I colori sono iniettati via JS */
        }

/* Testo leggibile e bianco per i range della color scale */
.apexcharts-legend-text {
    fill: #ffffff !important;         /* testo SVG */
    color: #ffffff !important;        /* testo HTML fallback */
    opacity: 0.8 !important;            /* ðŸ”¥ niente trasparenza */
}

/* Quadratini legenda con opacitÃ  piena */
.apexcharts-legend-marker {
    opacity: 1 !important;
}

/* Alcune versioni usano <span> dentro il gruppo legenda */
.apexcharts-legend-text span {
    color: #ffffff !important;
    opacity: 1 !important;
}

/* Rende bianchi anche i numeri eventuali dei valori colorScale */
.apexcharts-legend-series {
    opacity: 0.8 !important;
}


<style>
/* Mobile: heatmap scrollabile orizzontalmente */
.heatmap-wrapper {
    overflow-x: auto;
    overflow-y: hidden;
    padding-bottom: 8px;
    position: relative;
}

/* Rimuove compressione forzata */
.heatmap-wrapper > div {
    min-width: 600px; /* <= regolabile: 38 colonne * ~24px */
}

/* Mantiene leggibili le squadre */
@media (max-width: 768px) {
    .heatmap-wrapper {
        margin-left: -10px;
        margin-right: -10px;
        padding-left: 10px;
    }
}
</style>


<style>
/* blocca le squadre sulla sinistra */
.apexcharts-yaxis text {
    position: sticky;
    left: 0;
    background: #0f172a; /* colore sfondo tuo */
    padding-right: 6px;
    z-index: 10;
}
</style>

<style>

/* SCROLL ORIZZONTALE MOBILE */
.heatmap-wrapper {
    overflow-x: auto;
    overflow-y: hidden;
    width: 100%;
    -webkit-overflow-scrolling: touch;
}

/* forza larghezza del grafico */
#chart-team-heatmap {
    min-width: 700px;  /* = stessa larghezza settata in ApexCharts */
}

.heatmap-highlight {
    position: absolute;
    border: 1px solid rgba(234, 179, 8, 0.35);
    background: radial-gradient(circle at center, rgba(234, 179, 8, 0.18), rgba(234, 179, 8, 0.06));
    box-shadow: 0 10px 40px -25px rgba(234, 179, 8, 0.65);
    opacity: 0;
    transition: opacity 0.18s ease, transform 0.18s ease;
}

.heatmap-highlight[data-visible="true"] {
    opacity: 1;
    transform: translateZ(0);
}

.heatmap-highlight-row {
    pointer-events: none;
}

.heatmap-highlight-col {
    pointer-events: none;
}

/* Mantiene leggibili le squadre (fisso a sinistra) */
.apexcharts-yaxis text {
    position: sticky;
    left: 0;
    background: #0f172a;
    padding-right: 6px;
    z-index: 10;
}

</style>


</head>
<body class="flex flex-col min-h-screen">

    <!-- Ambient background glow -->
    <div class="aurora-blob" aria-hidden="true"></div>
    <div class="aurora-blob" aria-hidden="true"></div>
    <div class="aurora-blob" aria-hidden="true"></div>

    <!-- Scroll To Top -->
    <button id="scroll-to-top" onclick="scrollToTop()" class="fixed bottom-6 right-6 z-50 w-10 h-10 rounded bg-slate-800 text-yellow-500 shadow-lg flex items-center justify-center hover:bg-slate-700 transition-all border border-slate-700 opacity-0 pointer-events-none data-[visible=true]:opacity-100 data-[visible=true]:pointer-events-auto">
        <i class="fa-solid fa-arrow-up"></i>
    </button>

    <!-- Designations Trigger (Mobile Floating) -->
    <button onclick="toggleDesignationsModal(true)" class="lg:hidden fixed bottom-4 left-4 z-50 w-12 h-12 rounded-full bg-slate-800 border border-slate-700 text-yellow-500 flex items-center justify-center shadow-lg active:scale-95">
        <i class="fa-regular fa-calendar-check text-base"></i>
    </button>

    <!-- Designations Modal (Mobile) -->
    <div id="designations-modal" class="fixed inset-0 z-[60] bg-black/60 backdrop-blur-sm lg:hidden">
        <div class="modal-content absolute top-0 right-0 w-[85%] max-w-sm h-full bg-[#0f172a] shadow-2xl border-l border-slate-800 flex flex-col">
            <div class="h-16 flex items-center justify-between px-5 border-b border-slate-800 bg-[#0b1120]">
                <h2 class="text-white font-bold tracking-tight flex items-center gap-2">
                </h2>
                <button onclick="toggleDesignationsModal(false)" class="w-8 h-8 flex items-center justify-center rounded-full bg-slate-800 text-slate-400 hover:text-white">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="flex-grow overflow-y-auto p-5 space-y-4">
                 <!-- Mobile Designations Content -->
                 <div class="pro-card rounded-lg p-4 border-l-4 border-yellow-500">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <span class="block text-xs font-bold text-slate-400 uppercase tracking-wider">Giornata in corso</span>
                            <span class="text-lg font-bold text-white">15Âª Giornata</span>
                        </div>
                        <span class="bg-red-500/10 text-red-400 text-[10px] px-2 py-0.5 rounded border border-red-500/30 font-bold uppercase">LIVE</span>
                    </div>

                    <div class="space-y-3">
                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>LECCE - PISA</span>
                                <span class="text-slate-500">VEN 20:45</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">SACCHI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">MAGGIONI</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>TORINO - CREMONESE</span>
                                <span class="text-slate-500">SAB 15:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">MARINELLI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">MERAVIGLIA</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>PARMA - LAZIO</span>
                                <span class="text-slate-500">SAB 18:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">MARCHETTI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">AURELIANO</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>ATALANTA - CAGLIARI</span>
                                <span class="text-slate-500">SAB 20:45</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">DI MARCO</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">MARINI</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>MILAN - SASSUOLO</span>
                                <span class="text-slate-500">DOM 12:30</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">CREZZINI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">PRONTERA</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>FIORENTINA - VERONA</span>
                                <span class="text-slate-500">DOM 15:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">COLOMBO</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">GARIGLIO</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>UDINESE - NAPOLI</span>
                                <span class="text-slate-500">DOM 15:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">SOZZA</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">GHERSINI</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>GENOA - INTER</span>
                                <span class="text-slate-500">DOM 18:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">DOVERI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">CAMPLONE</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>BOLOGNA - JUVENTUS</span>
                                <span class="text-slate-500">DOM 20:45</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">MASSA</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">MARIANI</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>ROMA - COMO</span>
                                <span class="text-slate-500">LUN 20:45</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-green-500 uppercase font-bold">Arbitro</span>
                                <span class="text-green-400 font-mono font-bold">FELICIANI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-violet-400 uppercase w-8">Var</span>
                                <span class="text-violet-400 font-mono">MAZZOLENI</span>
                            </div>
                        </div>


                    </div>
                 </div>
            </div>
        </div>
    </div>

    <!-- Navbar Pro (FIXED) -->
    <nav class="pro-header fixed top-0 w-full z-50">
        <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <!-- Logo & Brand -->
                <div class="flex items-center gap-2 cursor-pointer mr-2" onclick="window.location.reload()">
<div class="w-3 h-10 sm:w-9 sm:h-9 rounded bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center text-slate-900 shadow-glow">
    <i class="fa-solid fa-whistle text-base sm:text-lg rotate-[-15deg]"></i>
</div>
                    <div class="flex flex-col justify-center">
                        <span class="font-bold text-lg leading-none tracking-tight text-white">Referee<span class="text-yellow-500">Lab</span></span>
                        <span class="text-[10px] uppercase tracking-[0.25em] text-slate-500 font-semibold">Analytics Pro</span>
                    </div>
                </div>

                <!-- Desktop Nav Tabs -->
                <div class="hidden md:flex items-center h-full">
                    <div class="nav-pills-container">
                        <button onclick="switchView('stats')" id="nav-stats" class="nav-pill active">
                            <i class="fa-solid fa-chart-bar mr-2"></i>Statistiche
                        </button>
                        <button onclick="switchView('playingTime')" id="nav-time" class="nav-pill">
                            <i class="fa-solid fa-stopwatch mr-2"></i>Tempo Effettivo
                        </button>
                        <button onclick="switchView('matches')" id="nav-matches" class="nav-pill">
                            <i class="fa-solid fa-list mr-2"></i>Database
                        </button>
                        <button onclick="switchView('teams')" id="nav-teams" class="nav-pill">
                            <i class="fa-solid fa-shield-halved mr-2"></i>Squadre
                        </button>
                        <!-- GRAFICI moved to end with BADGE -->
                        <button onclick="switchView('analytics')" id="nav-analytics" class="nav-pill flex items-center">
                            <i class="fa-solid fa-chart-pie mr-2"></i>Grafici <span class="badge-new">NEW</span>
                        </button>
                        <button onclick="switchView('players')" id="nav-players" class="nav-pill">
                            <i class="fa-solid fa-user mr-2"></i>Giocatori 25/26
                        </button>
                        <button onclick="switchView('quiz')" id="nav-quiz" class="nav-pill">
                            <i class="fa-solid fa-circle-question mr-2"></i>Quiz
                        </button>

                    </div>
                </div>

                <!-- Mobile & Actions -->
                <div class="flex items-center gap-3">
                    <!-- Mobile View Switcher -->
                    <div class="md:hidden flex bg-slate-800 rounded-lg p-1 border border-slate-700">
                        <button onclick="switchView('stats')" id="mob-nav-stats" class="p-2 rounded text-yellow-500 bg-slate-700"><i class="fa-solid fa-chart-bar"></i></button>
                        <button onclick="switchView('playingTime')" id="mob-nav-time" class="p-2 rounded text-slate-400"><i class="fa-solid fa-stopwatch"></i></button>
                        <button onclick="switchView('matches')" id="mob-nav-matches" class="p-2 rounded text-slate-400"><i class="fa-solid fa-list"></i></button>
                        <button onclick="switchView('teams')" id="mob-nav-teams" class="p-2 rounded text-slate-400"><i class="fa-solid fa-shield-halved"></i></button>
                        <button onclick="switchView('analytics')" id="mob-nav-analytics" class="p-2 rounded text-slate-400 relative">
                            <i class="fa-solid fa-chart-pie"></i>
                            <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                        </button>
                        <button onclick="switchView('players')" id="mob-nav-players" class="p-2 rounded text-slate-400">
                            <i class="fa-solid fa-user"></i>
                        </button>
                        <button onclick="switchView('quiz')" id="mob-nav-quiz" class="p-2 rounded text-slate-400">
                            <i class="fa-solid fa-circle-question"></i>
                        </button>

                    </div>

                    <div class="h-6 w-px bg-slate-800 hidden md:block"></div>
                    
                    <!-- Instagram Button -->
                    <a href="https://instagram.com/reflab25" target="_blank" class="hidden md:flex text-slate-400 hover:text-pink-500 transition-colors transform hover:scale-110 duration-200">
                        <i class="fa-brands fa-instagram text-xl"></i>

                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Wrapper -->
    <main class="flex-grow w-full max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-8">
        
        <!-- Page Header / Breadcrumb -->
        <div class="flex flex-col sm:flex-row sm:items-end justify-between gap-4 mb-2">
            <div class="space-y-2">
                <div class="flex items-center justify-between sm:justify-start gap-3">
                    <nav class="flex text-xs text-slate-500">
                        <span>Dashboard</span>
                        <span class="mx-2">/</span>
                        <span class="text-slate-300 font-medium" id="breadcrumb-current">Overview</span>
                    </nav>
                    <button onclick="toggleDesignationsModal(true)" class="sm:hidden inline-flex items-center gap-2 px-3 py-1.5 text-[11px] font-semibold text-yellow-400 bg-slate-800/70 border border-yellow-500/30 rounded-md shadow-md active:scale-95 transition" aria-label="Apri designazioni">
                        <i class="fa-regular fa-calendar-check text-sm"></i>
                        <span>Designazioni</span>
                    </button>
                </div>
                <h1 class="text-xl sm:text-3xl font-bold text-white tracking-tight hidden" id="page-title"></h1>
            </div>
            <div class="flex items-center gap-3 text-xs text-slate-400 bg-slate-900/50 px-3 py-1.5 rounded border border-slate-800">
                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                Database aggiornato: <span class="text-white font-mono">14Âª Giornata</span>
            </div>
        </div>

<div id="layout-grid" class="grid grid-cols-1 lg:grid-cols-12 gap-8">

    <aside id="sidebar-filters" class="lg:col-span-3 space-y-6 lg:self-start">
        <div id="global-search-container" class="pro-card rounded-lg p-1">
            <div class="relative">
                <i class="fa-solid fa-magnifying-glass absolute left-3 top-3 text-slate-500 text-sm"></i>
                <input type="text" id="searchInput" oninput="debounceAggregate()" placeholder="Cerca arbitro..." class="w-full bg-slate-900 text-sm text-white pl-10 pr-4 py-2.5 rounded border border-transparent focus:border-yellow-500 focus:ring-0 outline-none transition-colors placeholder-slate-600">
            </div>
        </div>

        <div id="season-selector-card" class="pro-card rounded-lg overflow-hidden">
            <div class="p-3 bg-slate-800/50 border-b border-slate-800 flex justify-between items-center">
                <h3 class="text-xs font-bold uppercase tracking-wider text-slate-400">Stagione</h3>
                <button onclick="toggleAllSeasons()" class="text-xs text-yellow-500 hover:text-yellow-400 font-medium">Reset</button>
            </div>
            
            <button onclick="toggleSeasonDropdown()" class="w-full lg:hidden flex justify-between items-center p-3 text-sm text-slate-300 hover:bg-slate-800 border-b border-slate-800">
                <span>Seleziona Stagioni</span>
                <i id="season-toggle-icon" class="fa-solid fa-chevron-down text-xs transition-transform"></i>
            </button>

            <div id="season-dropdown-content" class="season-dropdown-content lg:max-h-none lg:block bg-slate-900">
                <div class="flex flex-col p-2 space-y-1">
                    <button onclick="toggleSeason('2025-26')" id="btn-2025-26" class="season-item active w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left group">
                        <span class="font-mono">2025/26</span>
                        <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-100"></i>
                    </button>
                    
                    <div class="pt-2 mt-2 border-t border-slate-800">
                        <p class="px-3 text-[10px] text-slate-600 uppercase font-bold mb-1">Archivio</p>
                        
                        <button onclick="toggleSeason('2024-25')" id="btn-2024-25" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left group text-slate-500">
                            <span class="font-mono">2024-25</span>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                        
                        <button onclick="toggleSeason('2023-24')" id="btn-2023-24" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left text-slate-500">
                            <div class="flex items-center gap-2">
                                <span class="font-mono">2023-24</span>
                                <span class="season-new-badge hidden">NEW</span>
                            </div>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                        <button onclick="toggleSeason('2022-23')" id="btn-2022-23" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left text-slate-500">
                            <div class="flex items-center gap-2">
                                <span class="font-mono">2022-23</span>
                                <span class="season-new-badge hidden">NEW</span>
                            </div>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                        <button onclick="toggleSeason('2021-22')" id="btn-2021-22" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left text-slate-500" title="dati in arrivo">
                            <span class="font-mono">2021-22</span>
                            <span class="text-[9px] bg-slate-800 px-1.5 rounded coming-soon-label">SOON</span>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                        <button onclick="toggleSeason('2020-21')" id="btn-2020-21" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left text-slate-500" title="dati in arrivo">
                            <span class="font-mono">2020-21</span>
                            <span class="text-[9px] bg-slate-800 px-1.5 rounded coming-soon-label">SOON</span>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="stats-controls" class="pro-card rounded-lg p-4 space-y-2">
            <h3 class="text-xs font-bold uppercase tracking-wider text-slate-400 border-b border-slate-800 pb-2">Filtri Dati</h3>
            
            <div id="min-matches-container">
                <div class="flex justify-between items-center mb-2">
                    <label class="text-xs text-slate-400">Presenze minime</label>
                    <span id="minMatchesValue" class="text-xs font-mono text-yellow-500 bg-yellow-500/10 px-1.5 rounded border border-yellow-500/20">0</span>
                    <span id="minMatchesValue_mobile" class="hidden">0</span>
                </div>
                <input type="range" id="minMatches" min="0" max="10" value="0" step="1" oninput="updateMinMatches(this.value)" class="w-full">
                <input type="range" id="minMatches_mobile" class="hidden" oninput="updateMinMatches(this.value)">
            </div>

            <div id="active-filter-container" class="flex items-center justify-between pt-1 border-t border-slate-800 mt-2">
                <span class="text-xs text-slate-400">Solo arbitri attivi</span>
                <label class="relative inline-flex items-center cursor-pointer scale-75 origin-right">
                    <input type="checkbox" id="toggleInactive" onclick="toggleInactiveRefs()" class="sr-only peer">
                    <div class="w-9 h-5 bg-slate-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-yellow-600 peer-checked:after:bg-white"></div>
                </label>
            </div>

            <div id="matches-filters-container" class="hidden space-y-4 pt-2">
                <div class="space-y-1">
                    <label class="text-[10px] uppercase text-slate-500 font-bold tracking-wider">Tempo Totale (min)</label>
                    <div class="flex gap-2">
                        <input type="number" id="filterMinTot" min="90" oninput="debounceAggregate()" placeholder="Min" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                        <input type="number" id="filterMaxTot" oninput="debounceAggregate()" placeholder="Max" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                    </div>
                </div>
                <div class="space-y-1">
                    <label class="text-[10px] uppercase text-slate-500 font-bold tracking-wider">Tempo Effettivo (min)</label>
                    <div class="flex gap-2">
                         <input type="number" id="filterMinEff" oninput="debounceAggregate()" placeholder="Min" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                         <input type="number" id="filterMaxEff" oninput="debounceAggregate()" placeholder="Max" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                    </div>
                </div>
                <div class="space-y-1">
                    <label class="text-[10px] uppercase text-slate-500 font-bold tracking-wider">Falli</label>
                    <div class="flex gap-2">
                         <input type="number" id="filterMinFls" oninput="debounceAggregate()" placeholder="Min" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                         <input type="number" id="filterMaxFls" oninput="debounceAggregate()" placeholder="Max" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="hidden lg:block bg-blue-500/5 border border-blue-500/10 rounded-lg p-4">
            <div class="flex gap-3">
                <i class="fa-solid fa-circle-info text-blue-400 mt-0.5"></i>
                <p class="text-xs text-blue-200/80 leading-relaxed">
                    I dati <span class="text-white font-bold">2025-26</span> sono aggiornati alla fine di ogni giornata.
                </p>
            </div>
        </div>

        <div id="analytics-shortcuts-card" class="hidden pro-card rounded-lg p-4 space-y-4 lg:sticky lg:top-24">
            <div class="space-y-1">
                <div class="text-[10px] uppercase tracking-[0.16em] text-slate-500 font-bold">Vai al grafico</div>
                <p class="text-xs text-slate-400">Shortcut rapidi per raggiungere ogni visual senza scroll infinito.</p>
            </div>
            <div class="flex flex-wrap gap-2">
                <button class="analytics-anchor-btn" onclick="scrollToAnalyticsSection('analytics-section-efftot')">
                    <i class="fa-solid fa-arrow-down"></i> Tempo Effettivo vs Totale
                </button>
                <button class="analytics-anchor-btn" onclick="scrollToAnalyticsSection('analytics-section-radar')">
                    <i class="fa-solid fa-arrow-down"></i> Profilo Arbitro
                </button>
                <button class="analytics-anchor-btn" onclick="scrollToAnalyticsSection('analytics-section-severity')">
                    <i class="fa-solid fa-arrow-down"></i> Indice di SeveritÃ 
                </button>
                <button class="analytics-anchor-btn" onclick="scrollToAnalyticsSection('analytics-section-eff')">
                    <i class="fa-solid fa-arrow-down"></i> Distribuzione Tempo Effettivo
                </button>
                <button class="analytics-anchor-btn" onclick="scrollToAnalyticsSection('analytics-section-teamradar')">
                    <i class="fa-solid fa-arrow-down"></i> Radar Ritmo Squadre
                </button>
                <button class="analytics-anchor-btn" onclick="scrollToAnalyticsSection('analytics-section-fouls')">
                    <i class="fa-solid fa-arrow-down"></i> Falli medi/giornata
                </button>
                <button class="analytics-anchor-btn" onclick="scrollToAnalyticsSection('analytics-section-heatmap')">
                    <i class="fa-solid fa-arrow-down"></i> Heatmaps
                </button>
            </div>
        </div>
    </aside>

    <div id="main-content" class="lg:col-span-9 flex flex-col gap-6">

        <div id="update-alert-2526" class="hidden"></div>
        <div id="disclaimer-2526" class="hidden"></div>
        <div id="playing-time-title" class="hidden"></div>
        <div id="matches-title" class="hidden"></div>
        <div id="insights-container" class="hidden"></div>


<!-- ===============================
     PLAYERS VIEW (GIOCATORI 25/26)
=============================== -->
<div id="players-view" class="hidden space-y-6 animate-fade-in">

    <h2 class="text-xl font-bold text-slate-200 mb-4">
        Giocatori â€” Stagione 25/26
    </h2>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <div class="lg:col-span-3 space-y-4">
            <div class="pro-card rounded-lg p-4">
                <div class="flex items-center justify-between text-xs text-slate-400 mb-2">
                    <span>Min. presenze (90')</span>
                    <span id="playersMinMatchesValue" class="font-mono text-yellow-500 bg-yellow-500/10 px-1.5 rounded border border-yellow-500/20">0</span>
                </div>
                <input type="range" id="playersMinMatches" min="0" max="10" step="1" value="0" oninput="updatePlayersMinMatches(this.value)" class="w-full">
                <button id="players-presence-threshold" type="button" class="mt-3 w-full px-3 py-2 rounded border border-slate-700 text-xs font-semibold text-slate-200 hover:border-yellow-500 hover:text-yellow-400 transition" onclick="toggleLowPresenceExclusion()">
                    Escludi chi Ã¨ sotto il 30% delle presenze
                </button>
            </div>

            <div class="pro-card rounded-lg p-4">
                <label for="players-search" class="text-xs uppercase text-slate-500 font-bold tracking-wider">Ricerca giocatore</label>
                <div class="relative mt-2">
                    <i class="fa-solid fa-magnifying-glass absolute left-3 top-3 text-slate-500 text-sm"></i>
                    <input id="players-search"
                           type="text"
                           placeholder="Cerca giocatore..."
                           oninput="renderPlayersTable()"
                           class="w-full pl-10 pr-3 py-2 rounded bg-slate-900 border border-slate-700 text-slate-200 focus:border-yellow-500 focus:ring-0 outline-none">
                </div>

                <div class="mt-4">
                    <div class="flex items-center justify-between">
                        <p class="text-xs uppercase text-slate-500 font-bold tracking-wider">Filtra per ruolo</p>
                        <button type="button" onclick="selectAllPlayerRoles()" class="text-[11px] text-yellow-400 hover:text-yellow-300 font-semibold px-2 py-1 rounded border border-yellow-500/30 bg-yellow-500/10">
                            Tutti
                        </button>
                    </div>
                    <div class="grid grid-cols-2 gap-2 mt-2 text-sm text-slate-200">
                        <label class="flex items-center gap-2 text-orange-400">
                            <input type="checkbox" id="role-filter-por" class="rounded border-slate-700 bg-slate-900 text-orange-400 focus:ring-orange-400" onchange="togglePlayerRole('POR')" checked>
                            <span>POR</span>
                        </label>
                        <label class="flex items-center gap-2 text-green-400">
                            <input type="checkbox" id="role-filter-df" class="rounded border-slate-700 bg-slate-900 text-green-400 focus:ring-green-400" onchange="togglePlayerRole('DF')" checked>
                            <span>DIF</span>
                        </label>
                        <label class="flex items-center gap-2 text-blue-400">
                            <input type="checkbox" id="role-filter-cc" class="rounded border-slate-700 bg-slate-900 text-blue-400 focus:ring-blue-400" onchange="togglePlayerRole('CC')" checked>
                            <span>CC</span>
                        </label>
                        <label class="flex items-center gap-2 text-red-400">
                            <input type="checkbox" id="role-filter-att" class="rounded border-slate-700 bg-slate-900 text-red-400 focus:ring-red-400" onchange="togglePlayerRole('ATT')" checked>
                            <span>ATT</span>
                        </label>
                    </div>
                </div>

                <div class="mt-4 relative" id="players-team-filter-container">
                    <label for="players-team-trigger" class="text-xs uppercase text-slate-500 font-bold tracking-wider">Filtra per squadra</label>
                    <button id="players-team-trigger" type="button" class="mt-2 w-full bg-slate-900 border border-slate-700 text-sm text-slate-200 rounded px-3 py-2 flex items-center justify-between focus:border-yellow-500 focus:ring-0 outline-none" onclick="togglePlayersTeamDropdown()">
                        <span id="players-team-trigger-label">Tutte le squadre</span>
                        <i class="fa-solid fa-chevron-down text-slate-500 text-xs"></i>
                    </button>
                    <div id="players-team-dropdown" class="absolute mt-1 w-full bg-slate-900 border border-slate-700 rounded shadow-card max-h-64 overflow-y-auto hidden z-20">
                        <div class="p-2 text-[11px] text-slate-400 border-b border-slate-800">Seleziona una o piÃ¹ squadre</div>
                        <div id="players-team-options" class="max-h-52 overflow-y-auto"></div>
                    </div>
                </div>
            </div>

            <div class="pro-card rounded-lg p-4">
                <div class="flex items-center justify-between border-b border-slate-800 pb-2 mb-3">
                    <div>
                        <p class="text-xs uppercase text-slate-500 font-bold tracking-wider">Confronta giocatori</p>
                        <p class="text-[11px] text-slate-400">Seleziona due nomi per confrontare le metriche.</p>
                    </div>
                    <i class="fa-solid fa-code-compare text-yellow-400"></i>
                </div>

                <div class="space-y-3">
                    <div class="space-y-1">
                        <label for="player-compare-1" class="text-[11px] text-slate-400">Giocatore A</label>
                        <input id="player-compare-1" list="players-compare-options" type="text" placeholder="Digita un nome" oninput="handlePlayerComparisonInput(1, this.value)" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-xs text-white focus:border-yellow-500 focus:ring-0 outline-none" />
                    </div>
                    <div class="space-y-1">
                        <label for="player-compare-2" class="text-[11px] text-slate-400">Giocatore B</label>
                        <input id="player-compare-2" list="players-compare-options" type="text" placeholder="Digita un nome" oninput="handlePlayerComparisonInput(2, this.value)" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-xs text-white focus:border-yellow-500 focus:ring-0 outline-none" />
                    </div>

                    <datalist id="players-compare-options"></datalist>

                    <div class="overflow-hidden rounded border border-slate-800">
                        <table class="w-full text-[11px] text-slate-300" id="players-comparison-table"></table>
                    </div>
                </div>
            </div>
        </div>

                <div class="lg:col-span-9">
            <div class="pro-card rounded-lg overflow-hidden">
                <div class="flex items-center justify-between px-4 py-3 bg-slate-800 border-b border-slate-700/70">
                    <h3 class="text-lg font-extrabold text-white flex items-center gap-3">
                        <span>Giocatori</span>
                    </h3>
                    <div class="flex items-center gap-2 text-xs">
                        <button type="button" class="px-3 py-1 rounded border border-slate-600 text-slate-300 hover:border-yellow-500 hover:text-yellow-400 transition" data-mode="per90" onclick="setPlayersStatMode('per90')">
                            Medie 90'
                        </button>
                        <button type="button" class="px-3 py-1 rounded border border-slate-600 text-slate-300 hover:border-yellow-500 hover:text-yellow-400 transition" data-mode="total" onclick="setPlayersStatMode('total')">
                            Valori totali
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-[11px] text-slate-300 pro-table players-table text-center" id="players-table">
                                                <thead class="bg-slate-800 text-slate-300">
                            <tr>
                                <th class="p-2 sticky-col players-rank-col" title="Posizione in classifica dinamica rispetto all'ordinamento scelto">#</th>
                                <th class="p-2 cursor-pointer select-none text-left whitespace-nowrap sticky-col sticky-col-name" data-sort-col="name" onclick="handlePlayersSort('name')" title="Cognome in evidenza e nome completo del giocatore">
                                    <span class="players-col-label">Giocatore</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="n90" onclick="handlePlayersSort('n90')" title="Numero di presenze espresse come partite intere da 90 minuti">
                                    <span class="players-col-label" data-label-per90="P" data-label-total="P">P</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="yellow" onclick="handlePlayersSort('yellow')" title="Cartellini gialli ricevuti">
                                    <span class="players-col-label" data-label-per90="Gialli" data-label-total="Gialli Tot">Gialli</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="fouls" onclick="handlePlayersSort('fouls')" title="Falli commessi">
                                    <span class="players-col-label" data-label-per90="Falli C." data-label-total="Falli C. Tot">Falli C.</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="fouled" onclick="handlePlayersSort('fouled')" title="Falli subiti">
                                    <span class="players-col-label" data-label-per90="Falli S." data-label-total="Falli S. Tot">Falli S.</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="crosses" onclick="handlePlayersSort('crosses')" title="Cross tentati">
                                    <span class="players-col-label" data-label-per90="Cross" data-label-total="Cross Tot">Cross</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="passCompleted" onclick="handlePlayersSort('passCompleted')" title="Passaggi completati">
                                    <span class="players-col-label" data-label-per90="PassC" data-label-total="PassC Tot">PassC</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="passAttempted" onclick="handlePlayersSort('passAttempted')" title="Passaggi tentati">
                                    <span class="players-col-label" data-label-per90="PassT" data-label-total="PassT Tot">PassT</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="passPct" onclick="handlePlayersSort('passPct')" title="Percentuale di precisione sui passaggi">
                                    <span class="players-col-label">% Pass</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="shotsPer90" onclick="handlePlayersSort('shotsPer90')" title="Tiri totali">
                                    <span class="players-col-label" data-label-per90="Tiri/90" data-label-total="Tiri Tot">Tiri/90</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>

                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="shotsOnTargetPer90"onclick="handlePlayersSort('shotsOnTargetPer90')" title="Tiri in porta">
                                    <span class="players-col-label" data-label-per90="TiriP/90" data-label-total="TiriP Tot">TiriP/90</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="players-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

        <div id="quiz-view" class="hidden space-y-6 animate-fade-in">
            <div class="pro-card rounded-lg p-4 space-y-4">
                <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-3 border-b border-slate-800 pb-3">
                    <div>
                        <h2 class="text-xl font-bold text-white">Quiz â€” Cultura arbitri</h2>
                        <p class="text-[11px] text-slate-400">Metti alla prova la tua conoscenza con domande ispirate alle statistiche e ai protagonisti di RefereeLab.</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="text-xs text-slate-400 bg-slate-900 px-3 py-1.5 rounded border border-slate-800">
                            <span class="font-semibold text-yellow-400">Punteggio:</span>
                            <span id="quiz-score" class="font-mono text-white ml-1">0 / 10</span>
                        </div>
                        <button id="quiz-refresh" class="interactive-surface flex items-center gap-2 bg-yellow-500 text-slate-900 font-semibold text-sm px-4 py-2 rounded-lg shadow-glow hover:bg-yellow-400">
                            <i class="fa-solid fa-rotate"></i> Nuovo quiz
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 gap-3 text-xs text-slate-400">
                    <div class="flex items-center gap-3">
                        <div class="flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-900 border border-slate-800">
                            <span class="w-2 h-2 rounded-full bg-yellow-400 animate-pulse"></span>
                            <span>10 domande casuali da un pool di 100+</span>
                        </div>
                        <div class="px-3 py-1.5 rounded-full bg-slate-900 border border-slate-800 flex items-center gap-2">
                            <i class="fa-solid fa-bolt text-yellow-500"></i>
                            <span>Feedback immediato su ogni risposta</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="quiz-questions" class="grid grid-cols-1 lg:grid-cols-2 gap-4"></div>

        </div>
        <div id="analytics-view" class="hidden space-y-6 animate-fade-in">
            <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                <div>
                    <h2 class="text-lg font-bold text-white">Analytics â€” Arbitri & Squadre</h2>
                    <p class="text-[11px] text-slate-400 max-w-xl">Analizza ritmo, severitÃ  e profili arbitro con i grafici interattivi qui sotto.</p>
                </div>
                <div class="flex items-center gap-3">
                    <div class="text-[10px] font-bold uppercase tracking-[0.28em] text-slate-500">Vista</div>
                    <div class="flex bg-slate-900 rounded-full p-1 border border-slate-800 shadow-inner">
                        <button id="analytics-mode-refs" type="button" onclick="setAnalyticsViewMode('refs')" class="px-4 py-2 rounded-full text-xs font-semibold bg-yellow-500 text-slate-900 shadow-glow transition-colors">Arbitri/Squadre</button>
                        <button id="analytics-mode-players" type="button" onclick="setAnalyticsViewMode('players')" class="px-4 py-2 rounded-full text-xs font-semibold bg-slate-900 text-slate-300 border border-slate-700 transition-colors">Giocatori</button>
                    </div>
                </div>
            </div>

            <div id="analytics-refs-wrapper" class="space-y-6">

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div id="analytics-section-efftot" class="pro-card rounded-lg p-4 lg:col-span-2">
                    <div class="flex flex-wrap items-start justify-between gap-3 mb-4 border-b border-slate-800 pb-2">
                        <h3 class="text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2">
                            <i class="fa-solid fa-stopwatch text-yellow-500"></i> Tempo Effettivo vs Totale
                        </h3>
                        <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-effTot">
                            <span class="text-slate-400">Stagioni:</span>
                            <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('effTot','2025-26', this)">25/26</button>
                            <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('effTot','2024-25', this)">24/25</button>
                            <button type="button" class="analytics-season-chip" data-season="2023-24" onclick="toggleAnalyticsSeason('effTot','2023-24', this)">23/24</button>
                            <button type="button" class="analytics-season-chip" data-season="2022-23" onclick="toggleAnalyticsSeason('effTot','2022-23', this)">22/23</button>
                        </div>
                        <div class="relative w-full sm:w-64 lg:w-72">

                            <i class="fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-slate-500 text-xs"></i>
                            <input type="text" id="analyticsSearchEffTot" oninput="debounceRenderAnalytics()" placeholder="Filtra per squadra..." class="w-full bg-slate-900 text-xs text-white pl-8 pr-2 py-1.5 rounded border border-slate-700 focus:border-yellow-500 focus:ring-0 outline-none placeholder-slate-600">
                        </div>
                    </div>
                    <div id="chart-eff-total" class="w-full h-[350px] relative"></div>
                    <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-[11px] text-slate-300">
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="left:0; top:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Spezzettato</span><br>Basso Tempo Effettivo nonostante una durata molto lunga</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="right:0; top:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Intenso</span><br>Alto Tempo Effettivo in una partita molto lunga</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="left:0; bottom:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Lento</span><br>Basso Tempo Effettivo e durata partita breve</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="right:0; bottom:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">FluiditÃ </span><br>Alto Tempo Effettivo, poche interruzioni (Tempo Totale basso)</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div id="analytics-section-radar" class="pro-card rounded-lg p-4">
                    <div class="flex flex-col gap-2 mb-4 border-b border-slate-800 pb-2">
                        <h3 class="text-sm font-bold text-white uppercase tracking-wider flex flex-wrap gap-2 items-center justify-between">
                            <span class="flex items-center gap-2"><i class="fa-solid fa-fingerprint text-blue-500"></i> Profilo Arbitro</span>
                            <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-refRadar">
                                <span class="text-slate-400">Stagioni:</span>
                                <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('refRadar','2025-26', this)">25/26</button>
                                <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('refRadar','2024-25', this)">24/25</button>
                                <button type="button" class="analytics-season-chip" data-season="2023-24" onclick="toggleAnalyticsSeason('refRadar','2023-24', this)">23/24</button>
                                <button type="button" class="analytics-season-chip" data-season="2022-23" onclick="toggleAnalyticsSeason('refRadar','2022-23', this)">22/23</button>
                            </div>
                        </h3>
                        <div class="flex flex-col gap-2 w-full">
                            <div class="flex gap-2">
                                <select id="radar-ref-select" class="chart-select bg-slate-900 text-xs text-white border border-slate-700 rounded pl-3 pr-8 py-1.5 focus:border-yellow-500 outline-none cursor-pointer flex-grow">
                                    <option value="">Seleziona arbitro da aggiungere...</option>
                                </select>
                                <button onclick="addRefereeToRadar()" class="bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold text-xs px-3 py-1.5 rounded transition-colors">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                            <div id="radar-chips-container" class="flex flex-wrap gap-2 min-h-[28px]">
                                <span class="text-[10px] text-slate-500 italic py-1">Aggiungi fino a 10 arbitri per il confronto...</span>
                            </div>
                            <div class="flex justify-between items-center mt-1 pt-2 border-t border-slate-800">
                                <button onclick="loadPresetRadarRefs()" class="mt-2 w-full bg-blue-600/20 text-blue-400 text-[11px] py-1.5 rounded border border-blue-600/30 hover:bg-blue-600/30 transition">
                                    Carica i 10 arbitri della 15^ giornata
                                </button>
                                <button onclick="resetRadar()" class="text-[10px] text-slate-400 hover:text-white underline">Reset Confronto</button>
                                <span id="radar-count" class="text-[10px] text-slate-500">0/10</span>
                            </div>
                        </div>
                    </div>
                    <div id="chart-radar" class="w-full h-[550px] flex items-center justify-center"></div>
                    <p class="text-[10px] text-slate-400 italic mt-3 text-center">
                        Clicca sul nome dell'arbitro nella legenda per nasconderne/mostrarne il grafico.
                    </p>
                </div>

                <div id="analytics-section-severity" class="pro-card rounded-lg p-4 relative">
                    <h3 class="text-sm font-bold text-white uppercase tracking-wider mb-4 border-b border-slate-800 pb-2 flex flex-wrap gap-3 items-center justify-between">
                        <span class="flex items-center gap-2"><i class="fa-solid fa-crosshairs text-yellow-500"></i> Indice di SeveritÃ  (Falli vs Cartellini)</span>
                        <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-severity">
                            <span class="text-slate-400">Stagioni:</span>
                            <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('severity','2025-26', this)">25/26</button>
                            <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('severity','2024-25', this)">24/25</button>
                            <button type="button" class="analytics-season-chip" data-season="2023-24" onclick="toggleAnalyticsSeason('severity','2023-24', this)">23/24</button>
                            <button type="button" class="analytics-season-chip" data-season="2022-23" onclick="toggleAnalyticsSeason('severity','2022-23', this)">22/23</button>
                        </div>
                        <div class="relative w-full sm:w-1/3 min-w-[180px]">
                            <i class="fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-slate-500 text-xs"></i>
                            <input type="text" id="analyticsSearchSeverity" oninput="debounceRenderAnalytics()" placeholder="Filtra per arbitro..." class="w-full bg-slate-900 text-xs text-white pl-8 pr-2 py-1.5 rounded border border-slate-700 focus:border-yellow-500 focus:ring-0 outline-none placeholder-slate-600">
                        </div>
                    </h3>

                    <div id="analytics-min-matches-container" class="space-y-2 mb-4">
                        <div class="flex justify-between items-center">
                            <label class="text-xs text-slate-400">Min. Presenze Arbitro</label>
                            <span id="analyticsMinMatchesValue" class="text-xs font-mono text-yellow-500 bg-yellow-500/10 px-1.5 rounded border border-yellow-500/20">0</span>
                        </div>
                        <input type="range" id="analyticsMinMatches" min="0" max="10" value="0" step="1" oninput="updateAnalyticsMinMatches(this.value)" class="w-full">
                    </div>
                    <div id="chart-scatter" class="w-full h-[350px] relative"></div>

                    <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-[11px] text-slate-300">
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="left:0; top:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Chirurgici</span><br>Pochi falli, molti cartellini</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="right:0; top:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Rigidi</span><br>Molti falli e molti cartellini</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="left:0; bottom:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Inglesi</span><br>Pochi falli e pochi cartellini</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="right:0; bottom:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Gestori</span><br>Molti falli, pochi cartellini</p>
                        </div>
                    </div>
                </div>

            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div id="analytics-section-eff" class="pro-card rounded-lg p-4">
                    <div class="flex flex-wrap items-center justify-between gap-3 mb-4 border-b border-slate-800 pb-2">
                        <h3 class="text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2">
                            <i class="fa-solid fa-chart-column text-indigo-400"></i> Distribuzione Tempo Effettivo
                        </h3>
                        <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-eff">
                            <span class="text-slate-400">Stagioni:</span>
                            <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('eff','2025-26', this)">25/26</button>
                            <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('eff','2024-25', this)">24/25</button>
                            <button type="button" class="analytics-season-chip" data-season="2023-24" onclick="toggleAnalyticsSeason('eff','2023-24', this)">23/24</button>
                            <button type="button" class="analytics-season-chip" data-season="2022-23" onclick="toggleAnalyticsSeason('eff','2022-23', this)">22/23</button>
                        </div>
                    </div>

                    <div id="chart-eff-distribution" class="w-full h-[350px]"></div>
                    <p class="text-[10px] text-slate-400 mt-2 italic">
                        Indica quante partite rientrano in ogni fascia di minutaggio reale.
                    </p>
                </div>

                <div id="analytics-section-teamradar" class="pro-card rounded-lg p-4">
                    <div class="flex flex-wrap items-center justify-between gap-3 mb-4 border-b border-slate-800 pb-2">
                        <h3 class="text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2">
                            <i class="fa-solid fa-bullseye text-pink-500"></i> Radar: Ritmo Squadre
                        </h3>
                        <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-teamRadar">
                            <span class="text-slate-400">Stagioni:</span>
                            <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('teamRadar','2025-26', this)">25/26</button>
                            <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('teamRadar','2024-25', this)">24/25</button>
                            <button type="button" class="analytics-season-chip" data-season="2023-24" onclick="toggleAnalyticsSeason('teamRadar','2023-24', this)">23/24</button>
                            <button type="button" class="analytics-season-chip" data-season="2022-23" onclick="toggleAnalyticsSeason('teamRadar','2022-23', this)">22/23</button>
                        </div>
                    </div>

                    <div id="chart-top-flop" class="w-full h-[350px] flex justify-center items-center"></div>
                    <p class="text-[10px] text-slate-400 mt-2 italic text-center">
                        Confronto volumetrico: Spicchi grandi = PiÃ¹ tempo effettivo.
                    </p>
                </div>
            </div>


            <div id="analytics-section-fouls" class="pro-card rounded-lg p-4">
                <div class="flex flex-wrap items-center justify-between gap-3 mb-4 border-b border-slate-800 pb-2">
                    <h3 class="text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2">
                        <i class="fa-solid fa-bars-progress text-emerald-400"></i> Falli medi per giornata (dalla stagione 2022/23)
                    </h3>
                    <div class="flex items-center gap-3 text-[11px] text-slate-300">
                        <span class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-fuchsia-400"></span>2022/23</span>
                        <span class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-emerald-400"></span>2023/24</span>
                        <span class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-blue-400"></span>2024/25</span>
                        <span class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-amber-300"></span>2025/26</span>
                    </div>
                </div>
                <div id="chart-fouls-matchday" class="w-full h-[440px]"></div>
                <div class="mt-3 flex flex-col gap-2 md:flex-row md:items-start md:justify-between md:gap-4">
                    <div id="chart-fouls-matchday-legend" class="flex flex-col gap-2 text-[11px] text-slate-200"></div>
                    <p class="text-[10px] text-slate-400 italic md:text-right">
                        Ogni barra rappresenta la media di falli a partita per ogni giornata
                    </p>
                </div>
            </div>

<!-- HEATMAP SQUADRE (SELETTORI STAGIONE + METRICA) -->
<div id="analytics-section-heatmap" class="mt-10 w-full">
    <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-4">
        <h3 id="heatmap-title" class="text-lg font-bold text-slate-200 flex items-center gap-2">
            Heatmap Squadre â€” Stagione 2024/25
        </h3>

        <div class="flex flex-wrap gap-3 items-center text-xs">
            <div class="flex items-center gap-2">
                <label for="heatmap-season" class="text-slate-400 hidden sm:inline">Stagione:</label>
                <select id="heatmap-season" class="bg-slate-800 border border-slate-700 text-slate-100 text-xs rounded px-2 py-1">
                    <option value="2024-25" selected>2024/25</option>
                    <option value="2023-24">2023/24</option>
                    <option value="2022-23">2022/23</option>
                </select>
            </div>

            <!-- Selettore metrica heatmap -->
            <div class="flex items-center gap-2">
                <label for="heatmap-metric" class="text-slate-400 hidden sm:inline">Metrica:</label>
                <select id="heatmap-metric"
                        class="bg-slate-800 border border-slate-700 text-slate-100 text-xs rounded px-2 py-1">
                    <option value="eff" selected>Tempo effettivo</option>
                    <option value="fouls">Falli fischiati</option>
                </select>
            </div>
        </div>
    </div>

    <div class="heatmap-wrapper relative">
        <div id="heatmap-hover-layer" class="hidden absolute inset-0 pointer-events-none">
            <div id="heatmap-hover-row" class="heatmap-highlight heatmap-highlight-row"></div>
            <div id="heatmap-hover-col" class="heatmap-highlight heatmap-highlight-col"></div>
        </div>
        <div id="chart-team-heatmap"></div>
    </div>

    <div id="heatmap-focus-card" class="hidden mt-3">
        <div class="pro-card rounded-lg border border-slate-800 p-3 flex items-start justify-between gap-3">
            <div>
                <div class="text-[10px] uppercase tracking-[0.08em] text-slate-400 font-semibold mb-1">Focus cella</div>
                <div id="heatmap-focus-title" class="text-sm font-semibold text-white">Passa il mouse sulla heatmap</div>
                <div id="heatmap-focus-subtitle" class="text-[11px] text-slate-400">Hover o clic per vedere match e valore.</div>
            </div>
            <div class="text-right text-[11px] space-y-1 min-w-[120px]">
                <div id="heatmap-focus-team" class="text-slate-200 font-semibold">â€”</div>
                <div id="heatmap-focus-match" class="text-slate-400">â€”</div>
                <div id="heatmap-focus-value" class="text-yellow-400 font-mono">â€”</div>
            </div>
        </div>
    </div>
    </div>
            </div>

            <div id="analytics-players-wrapper" class="hidden space-y-6">
                <div class="pro-card rounded-lg p-4 space-y-4">
                    <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-3 border-b border-slate-800 pb-3">
                        <div class="flex items-center gap-2 text-sm font-bold text-white uppercase tracking-wider">
                            <i class="fa-solid fa-bullseye text-yellow-400"></i>
                            <span>Scatter â€” Tiri Giocatori</span>
                        </div>
                        <div class="flex flex-wrap items-center gap-2 text-xs">
                            <span class="text-slate-400">Mostrati solo giocatori con almeno il 30% delle presenze:</span>
                            <div class="flex items-center gap-2">
                                <button type="button" class="player-scatter-role-toggle px-3 py-1 rounded-full border border-slate-700 bg-slate-900/40 text-slate-200 font-semibold" data-role="DF" onclick="togglePlayerScatterRole('DF')">
                                    Difensori
                                </button>
                                <button type="button" class="player-scatter-role-toggle px-3 py-1 rounded-full border border-slate-700 bg-slate-900/40 text-slate-200 font-semibold" data-role="CC" onclick="togglePlayerScatterRole('CC')">
                                    Centrocampisti
                                </button>
                                <button type="button" class="player-scatter-role-toggle px-3 py-1 rounded-full border border-slate-700 bg-slate-900/40 text-slate-200 font-semibold" data-role="ATT" onclick="togglePlayerScatterRole('ATT')">
                                    Attaccanti
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
                        <div class="lg:col-span-3">
                            <div id="chart-player-scatter" class="w-full h-[460px]"></div>
                        </div>
                        <div id="player-scatter-focus" class="pro-card rounded-lg border border-slate-800 p-4 space-y-2 bg-slate-900/60">
                            <div class="text-[10px] uppercase tracking-[0.16em] text-slate-400 font-semibold">Focus giocatore</div>
                            <div id="scatter-focus-name" class="text-lg font-bold text-white">Passa sopra un punto o clicca</div>
                            <div id="scatter-focus-team" class="text-sm text-slate-300">â€”</div>
                            <div id="scatter-focus-role" class="text-sm text-slate-300">Ruolo: â€”</div>
                            <div id="scatter-focus-shots" class="text-sm text-slate-200">Tiri/90: â€”</div>
                            <div id="scatter-focus-on-target" class="text-sm text-slate-200">Tiri in porta/90: â€”</div>
                            <button type="button" onclick="resetScatterFocus()" class="mt-1 text-[11px] text-yellow-400 hover:text-yellow-300 underline">Reset selezione</button>
                        </div>
                    </div>
                    <p class="text-[10px] text-slate-400 italic">Passa il mouse o tocca un punto per evidenziare i tiri/90 e i tiri in porta/90 dei giocatori filtrati per ruolo.</p>
                </div>
            </div>

        </div>


        <div id="table-view" class="pro-card rounded-lg overflow-hidden flex flex-col min-h-[600px] relative">
            <div id="empty-state-msg" class="hidden absolute inset-0 z-30 bg-slate-900/80 backdrop-blur-sm flex flex-col items-center justify-start pt-20">
                <div class="w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mb-4 border border-slate-700">
                    <i class="fa-solid fa-filter text-slate-500 text-2xl"></i>
                </div>
                <h3 class="text-white font-bold text-lg">Nessun dato trovato</h3>
                <p class="text-slate-400 text-sm mt-1">Prova a modificare i filtri di ricerca.</p>
            </div>
            <div id="historical-data-msg" class="hidden absolute inset-0 z-30 bg-slate-900 flex flex-col items-center justify-start pt-20 text-center">
                 <i class="fa-solid fa-circle-notch fa-spin text-3xl text-yellow-500 mb-4"></i>
                 <h3 class="text-white font-bold text-lg mb-2" id="historical-msg-title">Dati Stagione in fase di caricamento...</h3>
                 <p class="text-slate-400 text-sm">Stiamo elaborando i dati storici per le stagioni selezionate.</p>
            </div>
            <div class="overflow-x-auto flex-grow">
                <table class="w-full text-left pro-table" id="mainTable">
                    <thead id="tableHeader" class="sticky-head text-slate-500"></thead>
                    <tbody id="tableBody" class="font-mono text-sm text-slate-200"></tbody>
                    <tfoot id="tableFooter" class="sticky bottom-0 z-20 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.3)]"></tfoot>
                </table>
            </div>
        </div>

        <div class="flex flex-col sm:flex-row justify-between items-center text-xs text-slate-600 border-t border-slate-800 pt-6 mt-2 pb-8">
            <p>Â© 2025 RefereeLab Analytics v2.0</p>
            <div class="flex gap-4 mt-2 sm:mt-0">
                <span>Fonte Dati: Pubblica</span>
                <span>Non affiliato AIA/FIGC</span>
            </div>
        </div>
        <div class="text-center text-[10px] text-slate-700 uppercase tracking-widest pb-4">
            Dati elaborati da fonti pubbliche. Non affiliato con AIA/FIGC.
        </div>

    </div>
</div>

<div class="hidden lg:block fixed bottom-8 right-8 w-72 z-40">
     <div class="pro-card rounded-lg shadow-2xl border border-slate-700 overflow-hidden">
        <div class="bg-slate-900 p-3 flex justify-between items-center border-b border-slate-800 cursor-pointer hover:bg-slate-800 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden')">
            <h3 class="text-xs font-bold text-white flex items-center gap-2">
                <span class="w-2 h-2 bg-red-500 rounded-full animate-flash"></span>
                SCOPRI LE ULTIME DESIGNAZIONI !
            </h3>
            <i class="fa-solid fa-chevron-down text-slate-500 text-xs"></i>
        </div>
        <div class="p-0 max-h-64 overflow-y-auto hidden">
            <div class="p-3 space-y-2">
                <div class="text-[10px] text-yellow-500 font-bold uppercase tracking-wider mb-2">15Âª Giornata</div>
                
                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>LECCE - PISA</span>
                        <span class="text-[10px] text-slate-500">ven 20:45</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Sacchi </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Maggioni </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>TORINO - CREMONESE</span>
                        <span class="text-[10px] text-slate-500">sab 15:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Marinelli </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Meraviglia </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>PARMA - LAZIO</span>
                        <span class="text-[10px] text-slate-500">sab 18:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Marchetti </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Aureliano </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>ATALANTA - CAGLIARI</span>
                        <span class="text-[10px] text-slate-500">sab 20:45</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Di Marco </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Marini </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>MILAN - SASSUOLO</span>
                        <span class="text-[10px] text-slate-500">dom 12:30</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Crezzini </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Prontera </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>FIORENTINA - VERONA</span>
                        <span class="text-[10px] text-slate-500">dom 15:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Colombo </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Gariglio </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>UDINESE - NAPOLI</span>
                        <span class="text-[10px] text-slate-500">dom 15:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Sozza </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Ghersini </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>GENOA - INTER</span>
                        <span class="text-[10px] text-slate-500">dom 18:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Doveri </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Camplone </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>BOLOGNA - JUVENTUS</span>
                        <span class="text-[10px] text-slate-500">dom 20:45</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Massa </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Mariani </span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>ROMA - COMO</span>
                        <span class="text-[10px] text-slate-500">lun 20:45</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Feliciani </span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Mazzoleni </span>
                    </div>
                </div>

            </div>
        </div>
     </div>
</div>
    </main>

    <!-- Feedback widget -->
    <div id="feedback-overlay" onclick="toggleFeedbackPanel(false)"></div>

    <div id="feedback-panel" data-open="false" class="pro-card">
        <div class="flex items-start gap-3 p-4 border-b border-slate-800 bg-slate-900/70">
            <div class="w-10 h-10 rounded-full bg-yellow-500/15 border border-yellow-500/40 flex items-center justify-center text-yellow-400 shadow-glow">
                <i class="fa-solid fa-sparkles"></i>
            </div>
            <div class="flex-1">
                <p class="text-white font-semibold leading-tight">Segnala un errore o richiedi una statistica/grafico</p>
                <p class="text-xs text-slate-400 mt-1">Il messaggio verrÃ  inviato direttamente via email al team RefereeLab.</p>
            </div>
            <button onclick="toggleFeedbackPanel(false)" class="text-slate-500 hover:text-white">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>

        <div class="p-4 space-y-4">
            <div>
                <label for="feedback-email" class="block text-xs font-semibold text-slate-300 mb-2">La tua email</label>
                <input id="feedback-email" type="email" class="w-full bg-slate-900 border border-slate-800 rounded-lg text-sm text-white p-3 focus:border-yellow-500 focus:ring-0" placeholder="nome@esempio.com" />
            </div>

            <div>
                <label for="feedback-text" class="block text-xs font-semibold text-slate-300 mb-2">Il tuo messaggio</label>
                <textarea id="feedback-text" rows="4" class="w-full bg-slate-900 border border-slate-800 rounded-lg text-sm text-white p-3 focus:border-yellow-500 focus:ring-0" placeholder="Segnalazioni, bug, idee, richieste..."></textarea>
            </div>

            <div class="flex items-center justify-between text-xs text-slate-500">
                <span class="flex items-center gap-2"><span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span> Tempo medio di risposta: entro 24h</span>
                <a href="mailto:ref-lab@referee-lab.com" class="flex items-center gap-1 text-yellow-400 hover:text-yellow-300">
                    <i class="fa-regular fa-envelope"></i> ref-lab@referee-lab.com
                </a>
            </div>

            <div class="p-3 rounded-lg bg-slate-900/60 border border-slate-800 text-[9px] text-slate-300 space-y-2 leading-relaxed">
                <div class="flex items-center gap-2 text-yellow-400 font-semibold">
                    <i class="fa-solid fa-shield-halved text-xs"></i>
                    <span>Informativa privacy</span>
                </div>
                <ul class="list-disc list-inside space-y-1 text-slate-300/90">
                    <li>Dati trattati: email e contenuto del messaggio inviato tramite questo form.</li>
                    <li>FinalitÃ : rispondere ai feedback o alle richieste dell'utente; nessun uso per newsletter o pubblicitÃ .</li>
                    <li>Base giuridica: richiesta dell'utente (misure precontrattuali/interesse legittimo); non Ã¨ necessario il consenso.</li>
                    <li>Conservazione: per il tempo necessario a gestire la richiesta.</li>
                    <li>Destinatari: il team RefereeLab e i sistemi email/di supporto usati per gestire le richieste; nessuna cessione a terzi per marketing o profilazione.</li>

                </ul>
            </div>

            <div id="feedback-status" class="text-xs text-slate-400"></div>

            <div class="flex items-center gap-3">
                <button id="feedback-send-btn" onclick="sendFeedback()" class="flex-1 bg-gradient-to-r from-yellow-400 to-amber-400 text-slate-900 font-bold py-2.5 rounded-lg shadow-glow hover:brightness-105 transition">Invia email</button>
                <button onclick="toggleFeedbackPanel(false)" class="px-4 py-2 rounded-lg border border-slate-700 text-slate-300 hover:text-white">Chiudi</button>
            </div>
        </div>
    </div>

    <button id="feedback-toggle" class="feedback-toggle" onclick="toggleFeedbackPanel()">
        <span class="relative flex items-center justify-center w-10 h-10 rounded-full bg-slate-900 text-yellow-500 shadow-inner shadow-black/30">
            <i class="fa-regular fa-lightbulb text-lg"></i>
            <span class="absolute inset-0 rounded-full border border-yellow-500/60 animate-pulse"></span>
        </span>
        <span class="flex flex-col items-start leading-tight">
            <span class="text-[10px] uppercase tracking-[0.2em] text-slate-800">Feedback</span>
            <span class="text-sm font-extrabold">Clicca qui</span>
        </span>
    </button>

    <script>


const playersRawData = `
Johan VÃ¡squez	DF	Genoa	14,00	0,07	0,86	0,86	0,00	0,14
Giovanni Di Lorenzo	DF,CC	Napoli	14,00	0,07	1,64	0,71	0,00	1,29
Enrico Del Prato	DF	Parma	14,00	0,21	0,57	0,43	0,08	0,36
Antonio Caracciolo	DF	Pisa	14,00	0,21	1,14	0,36	0,00	0,00
Matteo Gabbia	DF	Milan	14,00	0,14	0,71	0,29	0,00	0,07
Manu KonÃ©	CC	Roma	14,00	0,00	1,57	2,21	0,08	0,00
Kialonda	DF	Lecce	14,00	0,29	0,57	1,00	0,15	0,07
Pierre Kalulu	DF	Juventus	14,00	0,07	1,00	0,43	0,00	2,07
Federico Baschirotto	DF	Cremonese	14,00	0,07	1,29	0,14	0,08	0,14
Simone Canestrelli	DF	Pisa	14,00	0,07	0,71	0,29	0,00	0,29
Wladimiro Falcone	POR	Lecce	14,00	0,07	0,00	0,29	0,00	0,00
Nicola Leali	POR	Genoa	14,00	0,07	0,07	0,14	0,00	0,00
Mile Svilar	POR	Roma	14,00	0,00	0,00	0,29	0,00	0,00
Marco Carnesecchi	POR	Atalanta	14,00	0,00	0,07	0,14	0,00	0,00
Lorenzo MontipÃ²	POR	Hellas Verona	14,00	0,00	0,00	0,14	0,00	0,00
Jean Butez	POR	Como	14,00	0,00	0,00	0,36	0,00	0,00
Ivan Provedel	POR	Lazio	14,00	0,00	0,00	0,14	0,00	0,00
Elia Caprile	POR	Cagliari	14,00	0,07	0,00	0,43	0,00	0,00
David de Gea	POR	Fiorentina	14,00	0,00	0,00	0,21	0,00	0,00
Gianluca Mancini	DF	Roma	13,90	0,22	2,01	1,58	0,16	0,65
NicolÃ¡s Paz	CC	Como	13,80	0,14	2,25	1,74	0,00	2,54
Jesper KarlstrÃ¶m	CC	Udinese	13,80	0,22	0,94	1,01	0,00	0,36
Oumar Solet	DF	Udinese	13,70	0,00	0,95	1,02	0,00	0,36
Luka ModriÄ‡	CC	Milan	13,70	0,15	0,44	1,02	0,00	3,94
Victor Nelsson	DF	Hellas Verona	13,70	0,22	1,39	0,44	0,00	0,00
Alexis Saelemaekers	DF,ATT	Milan	13,50	0,07	0,52	2,37	0,16	2,52
Ylber Ramadani	CC	Lecce	13,50	0,22	1,63	1,56	0,00	0,44
Obite N'Dicka	DF	Roma	13,40	0,22	1,27	1,42	0,00	0,07
Mario Gila	DF	Lazio	13,40	0,15	0,60	0,97	0,00	0,07
Antonino Gallo	DF	Lecce	13,30	0,15	0,30	0,45	0,00	3,61
Mateo Pellegrino	ATT	Parma	13,20	0,23	2,50	2,12	0,33	0,30
Strahinja PavloviÄ‡	DF	Milan	13,20	0,08	0,76	0,61	0,08	0,61
Tiago Gabriel	DF	Lecce	13,10	0,08	0,84	0,92	0,00	0,08
DodÃ´	DF	Fiorentina	13,00	0,15	0,54	1,92	0,08	4,00
SaÃºl Coco	DF	Torino	13,00	0,08	1,38	1,46	0,00	0,08
Brooke Norton-Cuffy	DF,ATT	Genoa	13,00	0,31	1,38	0,69	0,00	3,15
Jay Idzes	DF	Sassuolo	13,00	0,00	1,00	0,62	0,00	0,00
Arijanet Muric	POR	Sassuolo	13,00	0,23	0,08	0,15	0,00	0,00
Filippo Terracciano	DF	Cremonese	12,90	0,23	0,39	1,01	0,00	1,01
Nemanja MatiÄ‡	CC	Sassuolo	12,90	0,08	0,54	1,24	0,00	0,62
Moise Kean	ATT	Fiorentina	12,80	0,16	1,17	2,19	1,27	0,31
Michael Folorunsho	CC,ATT	Cagliari	12,80	0,23	1,64	2,27	0,42	1,17
Giovane	ATT	Hellas Verona	12,70	0,16	1,18	1,02	0,43	2,60
Bryan Cristante	CC	Roma	12,70	0,24	1,42	0,24	0,00	0,55
Mattia Zaccagni	ATT	Lazio	12,60	0,24	0,95	4,13	0,00	2,06
Alessandro Bastoni	DF	Inter	12,60	0,08	2,06	1,03	0,00	2,86
Matteo Bianchetti	DF	Cremonese	12,60	0,16	1,03	0,63	0,00	0,32
Mike Maignan	POR	Milan	12,60	0,08	0,00	0,16	0,00	0,00
Andrea Pinamonti	ATT	Sassuolo	12,50	0,08	0,40	1,20	0,42	0,56
Arthur Atta	CC	Udinese	12,30	0,16	0,81	1,54	0,24	2,76
Adrian Bernabe	CC	Parma	12,30	0,00	0,57	2,11	0,00	2,85
Cesare Casadei	CC	Torino	12,30	0,33	2,20	0,65	0,00	0,16
NicolÃ² Barella	CC	Inter	12,20	0,08	0,90	0,74	0,00	4,10
Guillermo MaripÃ¡n	DF	Torino	12,20	0,08	1,07	0,00	0,18	0,25
Isak Hien	DF	Atalanta	12,20	0,25	1,64	0,98	0,00	0,00
Lassana Coulibaly	CC	Lecce	12,10	0,25	1,16	1,24	0,00	0,41
Scott McTominay	CC	Napoli	12,00	0,00	0,92	2,67	0,27	0,33
Manuel Akanji	DF	Inter	12,00	0,17	0,83	0,42	0,09	0,25
Lloyd Kelly	DF	Juventus	12,00	0,25	1,42	0,58	0,18	0,42
Marco Palestra	DF,ATT	Cagliari	12,00	0,00	1,50	2,92	0,09	2,92
Marin PongraÄiÄ‡	DF	Fiorentina	12,00	0,42	2,33	1,08	0,00	0,25
Yann Sommer	POR	Inter	12,00	0,00	0,00	0,08	0,00	0,00
Michele Di Gregorio	POR	Juventus	12,00	0,08	0,00	0,25	0,00	0,00
Adrian Å emper	POR	Pisa	12,00	0,00	0,00	0,08	0,00	0,00
Kenan YÄ±ldÄ±z	CC,ATT	Juventus	11,90	0,00	0,76	1,60	0,09	3,87
MattÃ©o Guendouzi	CC	Lazio	11,90	0,34	1,09	1,26	0,00	0,92
Michel Aebischer	CC	Pisa	11,90	0,25	1,43	1,01	0,00	1,09
Lautaro MartÃ­nez	ATT	Inter	11,70	0,17	2,05	2,14	0,28	0,85
Berat Djimsiti	DF	Atalanta	11,70	0,09	0,51	0,09	0,00	0,17
Morten Frendrup	CC	Genoa	11,70	0,09	1,62	1,03	0,00	0,26
Sebastian Walukiewicz	DF	Sassuolo	11,70	0,17	1,03	0,34	0,00	1,88
Youssouf Fofana	CC	Milan	11,60	0,26	1,29	0,60	0,00	0,43
Federico Dimarco	DF	Inter	11,60	0,09	1,29	0,78	0,19	10,00
Rolando Mandragora	CC	Fiorentina	11,60	0,26	1,90	2,24	0,00	3,19
Michel Ndary Adopo	CC	Cagliari	11,60	0,00	1,12	0,52	0,09	0,52
Luca Ranieri	DF	Fiorentina	11,60	0,34	1,03	1,29	0,28	1,55
Adam MaruÅ¡iÄ‡	DF	Lazio	11,60	0,09	0,95	0,52	0,00	0,69
MÃ¡ximo Perrone	CC	Como	11,50	0,43	1,91	0,61	0,00	0,17
Danilo Veiga	DF	Lecce	11,50	0,26	0,96	1,22	0,00	2,61
Manuel Locatelli	CC	Juventus	11,40	0,26	1,75	1,93	0,00	0,44
Mandela Keita	CC	Parma	11,40	0,09	0,88	1,58	0,00	0,18
TorbjÃ¸rn Heggem	DF	Bologna	11,40	0,00	1,67	0,44	0,00	0,09
Rafik Belghali	DF,ATT	Hellas Verona	11,30	0,35	0,88	0,44	0,39	2,83
Alessio Romagnoli	DF	Lazio	11,30	0,18	0,71	0,53	0,00	0,09
Wesley	DF	Roma	11,20	0,27	1,34	2,23	0,09	3,93
Idrissa TourÃ©	DF	Pisa	11,10	0,09	0,99	1,26	0,20	2,97
Martin Frese	DF	Hellas Verona	11,10	0,36	1,71	0,54	0,10	3,06
Mario PaÅ¡aliÄ‡	CC	Atalanta	11,10	0,09	0,99	0,27	0,09	0,27
Antoine Bernede	CC	Hellas Verona	11,10	0,09	2,34	0,81	0,00	1,35
MatÃ¬as SoulÃ©	CC,ATT	Roma	11,00	0,00	0,27	2,27	0,10	4,00
Jacobo RamÃ³n	DF	Como	11,00	0,27	1,27	0,18	0,00	0,09
Nikola VlaÅ¡iÄ‡	CC,ATT	Torino	11,00	0,18	1,09	1,27	0,40	1,36
Tarik Muharemovic	DF	Sassuolo	11,00	0,27	0,91	1,09	0,00	0,18
Warren Bondo	CC	Cremonese	11,00	0,18	1,91	1,82	0,00	0,09
Sebastiano Luperto	DF	Cagliari	11,00	0,09	1,00	0,82	0,00	0,09
Zion Suzuki	POR	Parma	11,00	0,09	0,00	0,18	0,00	0,00
Adam Obert	DF	Cagliari	10,90	0,55	2,20	0,46	0,00	1,01
Riccardo Orsolini	ATT	Bologna	10,70	0,09	1,12	1,59	1,10	1,87
Jari Vandeputte	CC	Cremonese	10,70	0,09	1,21	1,31	0,00	6,26
Hakan Ã‡alhanoÄŸlu	CC	Inter	10,60	0,19	1,23	0,75	0,00	5,00
Sebastiano Esposito	ATT,CC	Cagliari	10,60	0,28	1,89	1,79	0,21	3,77
Zeki Ã‡elik	DF	Roma	10,60	0,09	1,32	0,47	0,20	2,64
IsmaÃ«l KonÃ©	CC	Sassuolo	10,60	0,28	1,04	1,79	0,00	0,09
Fikayo Tomori	DF	Milan	10,60	0,28	1,04	0,28	0,00	0,57
M'Bala Nzola	ATT	Pisa	10,50	0,10	1,52	1,52	0,95	0,67
Patrizio Masini	CC	Genoa	10,50	0,29	1,71	2,76	0,00	0,86
Leo Skiri Ã˜stigÃ¥rd	DF	Genoa	10,50	0,38	1,71	0,57	0,19	0,00
Josh Doig	DF	Sassuolo	10,50	0,38	0,95	1,05	0,00	1,71
Andre-Frank Zambo Anguissa	CC	Napoli	10,40	0,10	0,96	1,15	0,00	1,44
Matteo Prati	CC	Cagliari	10,40	0,38	1,25	0,29	0,00	1,15
Andrea Cambiaso	DF,ATT	Juventus	10,40	0,10	1,06	0,48	0,00	4,71
Ãlex Valle	DF	Como	10,40	0,10	2,02	1,06	0,00	1,83
AarÃ³n MartÃ­n	DF	Genoa	10,40	0,19	1,15	0,96	0,00	7,79
Diego Carlos	DF	Como	10,40	0,38	1,35	0,38	0,11	0,10
Raoul Bellanova	DF	Atalanta	10,30	0,00	0,10	0,58	0,11	5,92
Juan Miranda	DF	Bologna	10,10	0,30	0,99	1,29	0,12	6,34
KhÃ©phren Thuram	CC	Juventus	10,00	0,00	2,00	0,90	0,00	0,50
Mikael Ellertsson	DF,ATT	Genoa	10,00	0,10	1,00	1,30	0,10	0,70
Domagoj BradariÄ‡	DF,ATT	Hellas Verona	10,00	0,10	0,50	0,50	0,10	4,10
Valentino Lazaro	DF,CC	Torino	10,00	0,20	1,30	0,30	0,00	4,30
Vanja MilinkoviÄ‡-SaviÄ‡	POR	Napoli	10,00	0,00	0,10	0,10	0,00	0,00
Emil Audero	POR	Cremonese	10,00	0,00	0,00	0,30	0,00	0,00
Domenico Berardi	ATT	Sassuolo	9,90	0,20	1,41	1,72	0,71	2,42
Kristjan Asllani	CC	Torino	9,80	0,31	0,71	0,92	0,00	3,88
Danilo Cataldi	CC	Lazio	9,80	0,20	1,33	0,61	0,00	1,12
Lucas Da Cunha	CC	Como	9,70	0,10	1,13	0,72	0,00	3,09
Medon Berisha	CC	Lecce	9,60	0,00	1,15	1,04	0,11	6,15
Teun Koopmeiners	CC,DF	Juventus	9,60	0,42	1,88	0,31	0,12	2,29
Jhon LucumÃ­	DF	Bologna	9,60	0,21	0,83	0,83	0,00	0,10
Francesco Acerbi	DF	Inter	9,60	0,21	1,15	0,83	0,23	0,10
Santiago Castro	ATT	Bologna	9,50	0,11	1,89	1,47	0,53	0,21
Ruslan Malinovskyi	CC	Genoa	9,50	0,53	1,47	1,58	0,00	1,68
Lautaro Valenti	DF	Parma	9,50	0,21	0,74	0,53	0,00	1,26
Gabriele Zappa	DF	Cagliari	9,50	0,21	1,05	0,53	0,00	1,16
Nikola Å tuliÄ‡	ATT	Lecce	9,40	0,11	1,60	1,60	0,57	0,00
Unai NÃºÃ±ez	DF	Hellas Verona	9,40	0,43	2,23	0,64	0,00	0,64
Alessandro Circati	DF	Parma	9,40	0,00	0,74	0,64	0,00	0,00
Davide Zappacosta	DF	Atalanta	9,30	0,22	0,75	0,65	0,35	3,87
Mario Hermoso	DF	Roma	9,30	0,43	1,61	0,32	0,00	0,65
Marcus Pedersen	DF	Torino	9,30	0,11	1,40	0,22	0,24	4,95
Alessandro Buongiorno	DF	Napoli	9,30	0,11	1,72	0,86	0,00	0,22
Gift Orban	ATT	Hellas Verona	9,20	0,33	1,30	0,54	0,87	0,43
Weston McKennie	CC,DF	Juventus	9,20	0,22	1,52	0,22	0,12	0,87
Sascha Britschgi	DF	Parma	9,20	0,22	0,76	1,20	0,00	1,63
Oliver Jensen	CC	Parma	9,10	0,22	1,21	0,99	0,00	0,55
Åukasz Skorupski	POR	Bologna	9,10	0,11	0,00	0,33	0,00	0,00
Matteo Politano	CC,ATT	Napoli	9,00	0,11	0,78	1,56	0,00	7,22
Marten de Roon	CC	Atalanta	9,00	0,56	1,22	0,33	0,00	0,44
Yerry Mina	DF	Cagliari	9,00	0,11	1,33	1,89	0,33	0,00
Pablo MarÃ­	DF	Fiorentina	9,00	0,33	1,89	0,89	0,00	0,00
Franco Israel	POR	Torino	9,00	0,11	0,00	0,33	0,00	0,00
Patrick Cutrone	ATT	Parma	8,90	0,00	0,56	1,57	0,79	1,35
Charles De Ketelaere	CC,ATT	Atalanta	8,90	0,22	1,01	1,69	0,12	3,26
Boulaye Dia	ATT,CC	Lazio	8,90	0,00	1,24	0,90	0,11	0,00
Tete Morente	ATT,CC	Lecce	8,80	0,11	1,25	1,36	0,11	2,73
Ebenezer Akinsanmiro	CC	Pisa	8,80	0,11	2,39	1,59	0,12	1,14
NicolÃ² Zaniolo	ATT	Udinese	8,70	0,23	3,68	2,07	0,13	4,71
Lorenzo Colombo	ATT,CC	Genoa	8,70	0,11	1,95	2,30	0,00	0,57
Jamie Vardy	ATT	Cremonese	8,70	0,23	0,80	0,80	0,90	0,46
Armand Lauriente	ATT	Sassuolo	8,60	0,00	1,28	1,28	0,99	3,02
Kristian Thorstvedt	CC	Sassuolo	8,60	0,47	1,63	2,09	0,00	0,58
Federico Gatti	DF	Juventus	8,60	0,35	1,40	0,70	0,00	0,12
Keinan Davis	ATT	Udinese	8,40	0,36	1,90	2,50	0,26	0,24
Suat Serdar	CC	Hellas Verona	8,40	0,24	1,90	1,19	0,12	0,83
Santiago Pierotti	ATT,CC	Lecce	8,40	0,00	2,86	0,60	0,39	0,60
Roberto Gagliardini	CC	Hellas Verona	8,40	0,48	1,90	0,83	0,00	0,60
Giovanni Simeone	ATT	Torino	8,30	0,00	1,69	2,05	0,60	0,12
Francisco ConceiÃ§Ã£o	CC,ATT	Juventus	8,30	0,00	1,57	1,93	0,00	3,86
Toma BaÅ¡iÄ‡	CC	Lazio	8,30	0,00	1,45	1,57	0,00	2,77
Rasmus HÃ¸jlund	ATT	Napoli	8,30	0,12	1,81	2,53	0,68	0,12
Giuseppe Pezzella	DF	Cremonese	8,30	0,36	1,20	0,60	0,54	3,01
Christian Kabasele	DF	Udinese	8,30	0,12	1,45	0,96	0,14	0,00
Cyril Ngonge	ATT,CC	Torino	8,20	0,24	1,71	1,59	0,37	1,10
NicolÃ² Cambiaghi	ATT	Bologna	8,10	0,37	2,22	4,81	0,14	3,33
Gennaro Borrelli	ATT	Cagliari	8,10	0,25	3,33	3,33	0,27	0,12
Davide Bartesaghi	DF,ATT	Milan	8,10	0,12	0,74	0,49	0,14	4,94
Denzel Dumfries	DF	Inter	8,00	0,13	1,50	0,75	0,13	2,75
Robin Gosens	DF	Fiorentina	8,00	0,13	0,88	1,13	0,25	2,13
Maduka Okoye	POR	Udinese	8,00	0,00	0,13	0,00	0,00	0,00
Alessandro Zanoli	DF	Udinese	8,00	0,00	1,25	0,38	0,00	3,00
Federico Bonazzoli	ATT	Cremonese	7,90	0,00	0,63	2,53	0,32	0,25
MartÃ­n Payero	CC	Cremonese	7,90	0,51	2,53	2,15	0,00	1,39
Ã‰derson	CC	Atalanta	7,90	0,13	1,39	1,65	0,00	0,38
Albert GuÃ°mundsson	CC,ATT	Fiorentina	7,90	0,25	1,52	1,01	0,29	1,52
Henrik Meister	ATT	Pisa	7,80	0,13	1,67	1,03	0,00	0,00
NicolÃ² Bertola	DF	Udinese	7,80	0,26	0,90	0,77	0,00	0,26
Stanislav Lobotka	CC	Napoli	7,80	0,13	0,64	2,05	0,00	0,13
Ademola Lookman	ATT,CC	Atalanta	7,70	0,00	0,78	0,91	0,60	2,47
Jesus RodrÃ­guez	ATT	Como	7,70	0,00	0,65	1,30	0,29	2,47
Marius Marin	CC	Pisa	7,70	0,26	1,95	1,43	0,00	1,56
DuÅ¡an VlahoviÄ‡	ATT	Juventus	7,60	0,00	0,92	1,97	0,53	0,39
Hassane Kamara	DF	Udinese	7,60	0,26	0,66	0,79	0,00	4,21
Petar Sucic	CC	Inter	7,60	0,39	1,97	1,18	0,00	1,18
Emanuele Valeri	DF	Parma	7,60	0,13	0,39	1,18	0,00	8,42
Alessandro Deiola	CC,DF	Cagliari	7,60	0,39	1,84	0,92	0,00	0,13
Remo Freuler	CC	Bologna	7,60	0,26	1,05	1,05	0,00	0,53
Vitinha	ATT,CC	Genoa	7,50	0,27	1,47	2,53	0,74	3,87
Tommaso Barbieri	ATT,DF	Cremonese	7,50	0,13	1,87	1,47	0,18	3,87
Nikola Moro	CC	Bologna	7,50	0,13	1,07	1,20	0,00	2,93
Odilon Kossounou	DF	Atalanta	7,50	0,00	1,20	0,40	0,00	0,27
Adrien Tameze	DF,CC	Torino	7,50	0,13	1,07	0,67	0,00	1,07
Jens Odgaard	CC	Bologna	7,40	0,14	1,89	1,76	0,36	0,68
Che Adams	ATT,CC	Torino	7,30	0,00	0,55	0,96	0,31	1,10
Rafael LeÃ£o	ATT	Milan	7,30	0,14	1,37	2,33	0,14	0,55
David Neres	ATT,CC	Napoli	7,30	0,27	1,92	0,68	0,00	5,89
NicolÃ² Fagioli	CC	Fiorentina	7,30	0,27	0,96	1,23	0,00	3,15
Ivan SmolÄiÄ‡	DF	Como	7,20	0,69	1,53	1,67	0,00	1,53
Ãlvaro Morata	ATT	Como	7,10	0,14	1,83	2,82	0,30	0,85
Samuele Angori	DF	Pisa	7,10	0,00	0,42	1,69	0,15	6,06
MÃ«rgim Vojvoda	ATT,DF	Como	7,00	0,29	1,29	0,43	0,31	3,00
Mehdi LÃ©ris	DF,CC	Pisa	7,00	0,00	0,86	1,29	0,31	6,00
Adrien Rabiot	CC	Milan	7,00	0,14	1,71	1,57	0,33	1,14
Sam Beukema	DF	Napoli	7,00	0,29	1,00	0,57	0,00	0,29
Juan Jesus	DF	Napoli	7,00	0,43	2,43	0,14	0,00	0,00
Marcus Thuram	ATT	Inter	6,90	0,00	2,17	2,17	0,98	1,16
Santiago GimÃ©nez	ATT	Milan	6,90	0,14	1,01	1,45	0,87	0,14
Anastasios Douvikas	ATT	Como	6,90	0,00	1,16	2,46	0,00	0,00
Marc-Oliver Kempf	DF	Como	6,90	0,14	1,16	0,72	0,00	0,00
Gustav Isaksen	ATT	Lazio	6,80	0,00	1,32	3,09	0,00	1,76
Jakub Piotrowski	CC	Udinese	6,80	0,29	1,32	1,03	0,00	0,74
MattÃ©o Tramoni	CC,ATT	Pisa	6,80	0,15	1,47	0,59	0,00	4,41
Tommaso Pobega	CC	Bologna	6,70	0,15	1,64	0,60	0,00	0,15
Nadir Zortea	DF	Bologna	6,70	0,00	0,90	1,04	0,00	3,13
Amir Rrahmani	DF	Napoli	6,70	0,00	0,90	1,04	0,00	0,15
Simon Sohm	CC	Fiorentina	6,70	0,30	1,94	1,64	0,00	0,45
Alessandro Marcandalli	DF	Genoa	6,60	0,30	0,91	0,30	0,00	0,00
Armel Bella Kotchap	DF	Hellas Verona	6,60	0,15	1,97	1,06	0,00	0,15
Lorenzo Pellegrini	CC	Roma	6,50	0,15	1,38	2,46	0,34	5,08
Samuele Ricci	CC	Milan	6,40	0,16	0,47	1,72	0,00	0,94
Jurgen Ekkelenkamp	CC	Udinese	6,40	0,00	1,25	0,78	0,00	2,50
Kevin De Bruyne	CC	Napoli	6,30	0,16	0,79	0,32	0,16	3,97
Morten Thorsby	CC	Genoa	6,30	0,16	1,90	0,79	0,75	0,63
Hans Nicolussi Caviglia	CC	Fiorentina	6,30	0,32	2,22	2,22	0,00	4,44
Roberto Piccoli	ATT,CC	Fiorentina	6,20	0,00	1,77	2,10	0,51	0,32
Jayden Addai	ATT	Como	6,20	0,32	1,77	1,77	0,18	1,45
Leonardo Spinazzola	DF,CC	Napoli	6,20	0,16	0,48	0,16	0,17	4,19
Alessio Zerbin	DF,CC	Cremonese	6,20	0,16	1,29	0,97	0,17	1,29
Lewis Ferguson	CC	Bologna	6,20	0,16	2,26	1,61	0,17	1,29
Romano Floriani	DF,ATT	Cremonese	6,20	0,32	1,45	0,65	0,19	2,58
Kingsley Ehizibue	DF	Udinese	6,20	0,16	1,94	1,61	0,00	3,06
Nikola KrstoviÄ‡	ATT	Atalanta	6,10	0,16	1,15	1,31	1,07	0,33
Jonathan David	ATT	Juventus	6,10	0,00	0,98	1,31	0,18	0,49
Stefano Moreo	ATT,CC	Pisa	6,00	0,00	0,83	1,00	0,52	1,00
Razvan Sava	POR	Udinese	6,00	0,17	0,00	0,00	0,00	0,00
Maxence Caqueret	CC,ATT	Como	5,90	0,17	1,36	2,03	0,17	2,37
Lameck Banda	ATT	Lecce	5,80	0,52	2,93	2,93	0,00	3,10
MathÃ­as Olivera	DF,CC	Napoli	5,80	0,34	1,03	0,69	0,00	0,00
ValentÃ­n Castellanos	ATT	Lazio	5,70	0,35	0,70	1,93	0,78	1,05
Nuno Tavares	DF	Lazio	5,70	0,18	1,58	2,11	0,19	6,49
Honest Ahanor	DF	Atalanta	5,70	0,00	0,70	1,93	0,00	0,18
Paulo Dybala	ATT,CC	Roma	5,60	0,00	0,89	1,61	0,00	7,50
Henrikh Mkhitaryan	CC	Inter	5,60	0,36	1,79	0,71	0,19	2,32
Kamaldeen Sulemana	CC	Atalanta	5,60	0,36	1,07	1,43	0,18	0,89
Nicola Zalewski	DF	Atalanta	5,60	0,00	0,54	2,14	0,00	8,04
Ardian Ismajli	DF	Torino	5,60	0,36	1,25	1,25	0,00	1,25
Lazar Samardzic	CC	Atalanta	5,50	0,00	1,45	0,18	0,00	5,64
Jean-Daniel Akpa-Akpro	CC	Hellas Verona	5,50	0,73	3,45	0,18	0,00	0,55
Abdoulaye Niakhate Ndiaye	DF	Parma	5,50	0,73	1,82	1,27	0,00	0,00
Jordan Zemura	DF	Udinese	5,50	0,18	1,45	0,73	0,37	4,18
Ruben Loftus-Cheek	CC,ATT	Milan	5,40	0,00	1,85	1,48	0,23	0,93
Carlos Augusto	DF	Inter	5,40	0,19	1,48	0,74	0,00	2,22
Pietro Comuzzo	DF	Fiorentina	5,30	0,00	1,51	0,19	0,00	0,00
Mathias LÃ¸vik	DF	Parma	5,20	0,00	0,58	0,38	0,38	2,88
Matteo Cancellieri	ATT	Lazio	5,10	0,00	2,35	4,12	0,00	0,39
Alieu Fadera	ATT	Sassuolo	5,10	0,20	3,73	4,12	0,43	3,14
Adam Buksa	ATT	Udinese	5,10	0,20	1,76	2,35	0,20	0,20
Luca Pellegrini	DF	Lazio	5,10	0,20	1,57	1,18	0,00	2,55
Cristiano Biraghi	DF,CC	Torino	5,10	0,00	1,37	1,18	0,00	6,67
Christian Pulisic	ATT,CC	Milan	5,00	0,00	0,40	1,40	0,00	2,60
Nahuel EstÃ©vez	CC	Parma	5,00	0,20	1,00	1,20	0,00	2,40
Thomas Kristensen	DF	Udinese	5,00	0,00	0,60	0,60	0,20	0,20
Alberto Paleari	POR	Torino	5,00	0,00	0,00	0,00	0,00	0,00
Franco VÃ¡zquez	ATT,CC	Cremonese	4,90	0,20	1,43	3,06	0,00	3,47
Christopher Nkunku	ATT	Milan	4,90	0,00	0,82	1,84	0,51	0,20
Ange-Yoan Bonny	ATT	Inter	4,90	0,00	1,43	2,86	0,82	0,00
Elif Elmas	CC,ATT	Napoli	4,90	0,20	0,82	0,41	0,26	2,24
Pervis EstupiÃ±Ã¡n	DF	Milan	4,90	0,20	1,02	1,02	1,02	0,82
Emil Holm	DF	Bologna	4,90	0,41	1,63	2,45	0,00	3,06
Aster Vranckx	CC	Sassuolo	4,90	0,20	2,24	2,86	0,20	0,82
Arturo Calabresi	DF	Pisa	4,90	0,20	1,43	2,04	0,00	1,22
Gianluca Gaetano	CC,ATT	Cagliari	4,80	0,42	1,88	1,88	0,00	2,50
Giovanni Fabbian	CC	Bologna	4,80	0,00	1,67	2,92	0,42	0,63
NicolÃ¡s Valentini	DF	Hellas Verona	4,80	0,21	1,46	0,42	0,00	1,04
Alberto Grassi	CC	Cremonese	4,80	0,42	0,63	1,88	0,00	0,00
Gianluca Scamacca	ATT	Atalanta	4,70	0,21	1,06	1,91	0,71	0,00
Francesco Camarda	ATT	Lecce	4,70	0,21	1,49	0,43	0,00	0,21
Saba Goglichidze	DF	Udinese	4,70	0,43	1,06	0,85	0,00	0,43
Federico Bernardeschi	ATT,CC	Bologna	4,60	0,43	1,52	1,30	0,00	4,57
Mattia Felici	ATT,DF	Cagliari	4,60	0,65	2,17	1,30	0,00	5,00
Billy Gilmour	CC	Napoli	4,60	0,22	1,09	1,30	0,00	0,43
Antonio Sanabria	ATT	Cremonese	4,60	0,43	1,96	1,30	0,93	0,22
Evan Ferguson	ATT	Roma	4,50	0,22	1,78	1,56	0,24	0,44
Thijs Dallinga	ATT	Bologna	4,40	0,23	2,95	1,36	0,48	0,91
Riccardo Sottil	ATT	Lecce	4,40	0,00	0,91	3,18	0,51	5,00
Neil El Aynaoui	CC	Roma	4,40	0,45	1,82	0,45	0,24	0,91
Jacopo Fazzini	CC,ATT	Fiorentina	4,30	0,00	0,93	2,33	0,00	1,16
Cristian Volpato	ATT,CC	Sassuolo	4,30	0,47	1,86	0,23	0,00	6,05
NiccolÃ² Fortini	DF,CC	Fiorentina	4,30	0,00	0,93	2,79	0,00	4,88
AngeliÃ±o	DF,CC	Roma	4,30	0,23	0,93	0,47	0,00	3,26
Francesco Esposito	ATT	Inter	4,20	0,24	2,62	4,05	0,00	0,00
Lorenzo Lucca	ATT	Napoli	4,20	0,24	3,81	2,62	0,95	0,00
Noa Lang	ATT,CC	Napoli	4,20	0,48	0,48	1,43	0,30	5,95
Fali CandÃ©	DF	Sassuolo	4,20	0,24	1,43	0,95	0,00	0,48
Christian OrdoÃ±ez	CC,DF	Parma	4,20	0,95	2,14	0,71	0,00	1,67
Pedro	ATT	Lazio	4,10	0,24	0,49	3,41	0,00	3,41
Nicolas-Gerrit KÃ¼hn	ATT	Como	4,10	0,00	0,73	0,49	0,25	1,71
Cher Ndour	CC	Fiorentina	4,10	0,24	0,73	1,22	0,00	2,20
Valentin Carboni	CC,ATT	Genoa	4,00	0,50	2,75	1,25	0,00	2,00
Amin Sarr	ATT	Hellas Verona	4,00	0,00	2,00	2,00	0,79	0,50
Luis Henrique	DF	Inter	4,00	0,00	0,00	0,00	0,00	1,25
Filip KostiÄ‡	DF,ATT	Juventus	4,00	0,00	1,50	0,50	0,00	10,50
Martin VitÃ­k	DF	Bologna	4,00	0,25	1,50	0,50	0,00	0,25
Marco Silvestri	POR	Cremonese	4,00	0,00	0,00	0,00	0,00	0,00
Ivan IliÄ‡	CC	Torino	4,00	0,25	2,00	0,75	0,00	0,25
Federico Ravaglia	POR	Bologna	4,00	0,00	0,00	0,25	0,00	0,00
Alex Meret	POR	Napoli	4,00	0,00	0,00	0,25	0,00	0,00
Tommaso Baldanzi	ATT,CC	Roma	3,90	0,51	2,05	4,10	0,61	1,54
Charalampos Lykogiannis	DF	Bologna	3,90	0,51	1,79	0,00	0,00	7,44
Pontus Almqvist	DF,CC	Parma	3,90	0,00	1,54	3,08	0,00	1,03
ZÃ© Pedro Figueiredo	DF	Cagliari	3,90	0,00	1,28	1,54	0,00	0,00
Manuel Lazzari	DF	Lazio	3,90	0,51	0,77	2,82	0,00	1,54
Caleb Ekuban	ATT	Genoa	3,80	0,00	1,32	3,42	0,57	1,05
Piotr ZieliÅ„ski	CC	Inter	3,80	0,00	0,00	0,79	0,00	0,79
Gleison Bremer	DF	Juventus	3,80	0,00	0,53	0,79	0,00	0,26
Koni De Winter	DF	Milan	3,80	0,00	2,63	0,53	0,00	0,53
LoÃ¯s Openda	ATT,CC	Juventus	3,60	0,00	0,83	3,33	1,18	1,94
Jeff Ekhator	ATT	Genoa	3,60	0,56	1,94	2,78	1,18	0,83
Artem Dovbyk	ATT	Roma	3,60	0,00	2,78	1,11	0,83	0,00
Juan Cuadrado	DF,CC	Pisa	3,60	0,56	1,11	2,22	0,00	5,00
Giovanni Bonfanti	DF	Pisa	3,60	0,00	1,67	0,56	0,00	2,50
Riyad Idrissi	DF	Cagliari	3,60	0,28	0,56	0,28	0,29	4,17
Cheikh Niasse	CC	Hellas Verona	3,50	0,00	2,57	2,29	0,38	0,57
Gabriele Piccinini	CC	Pisa	3,40	0,59	0,88	1,47	0,00	3,24
Woyo Coulibaly	DF	Sassuolo	3,40	0,00	2,06	1,18	0,00	1,18
Jonathan Rowe	ATT	Bologna	3,30	0,30	1,52	2,42	0,33	3,33
Yann Aurel Bisseck	DF	Inter	3,30	0,30	1,82	0,91	0,30	0,61
Miguel GutiÃ©rrez	DF,CC	Napoli	3,30	0,00	0,91	1,82	0,00	3,03
Vakoun Bayo	ATT	Udinese	3,20	0,00	1,56	0,94	0,63	0,00
DuvÃ¡n Zapata	ATT	Torino	3,20	0,00	1,25	0,94	0,45	0,63
Adrian Benedyczak	CC,ATT	Parma	3,20	0,31	2,50	1,25	0,42	1,88
Stefan Posch	DF	Como	3,20	0,00	1,88	1,88	0,00	1,88
Giorgio Scalvini	DF	Atalanta	3,20	0,00	2,50	0,31	0,00	0,00
Michele Collocolo	CC	Cremonese	3,20	0,31	0,63	0,63	0,00	1,56
Assane Diao	ATT	Como	3,10	0,00	1,61	3,23	0,00	1,94
Fabiano Parisi	DF,ATT	Fiorentina	3,10	0,65	0,32	3,55	0,00	1,94
Niels Nkounkou	DF,CC	Torino	3,10	0,32	0,00	0,65	0,00	4,52
Gvidas Gineitis	CC,ATT	Torino	3,10	0,00	2,90	3,23	0,00	3,55
Oliver Nielsen	DF	Lazio	3,10	0,00	0,65	0,65	0,00	0,32
Daniel Mosquera	ATT	Hellas Verona	3,00	0,33	3,00	1,33	0,48	0,67
Edoardo Corvi	POR	Parma	3,00	0,00	0,00	0,33	0,00	0,00
Ä°sak Vural	CC	Pisa	2,90	0,69	2,41	4,83	0,00	1,38
Stefano Sabelli	DF	Genoa	2,90	0,00	0,34	1,72	0,00	1,03
RaÃºl Albiol	DF	Pisa	2,90	0,34	1,38	0,69	0,00	0,34
Lorenzo Bernasconi	DF	Atalanta	2,80	0,00	0,71	0,00	0,36	7,86
Fisayo Dele-Bashiru	CC	Lazio	2,80	0,00	0,36	0,00	0,77	0,00
Lorenzo De Silvestri	DF	Bologna	2,80	0,36	1,79	0,36	0,00	1,07
BenjamÃ­n DomÃ­nguez	ATT	Bologna	2,70	0,00	1,11	2,59	0,91	0,74
Alberto Moreno	DF	Como	2,70	0,37	1,48	0,00	0,37	2,96
JoÃ£o MÃ¡rio Lopes	DF	Juventus	2,70	0,37	1,48	3,70	0,00	1,85
Kostas Tsimikas	DF	Roma	2,70	0,37	1,85	1,11	0,00	4,81
NicolÃ² Casale	DF	Bologna	2,60	0,00	1,54	0,77	0,00	0,00
MatÃ­as Vecino	CC	Lazio	2,60	0,00	1,54	0,38	0,00	0,00
Adam Masina	DF	Torino	2,60	0,00	2,31	0,77	0,00	0,00
Edin DÅ¾eko	ATT	Fiorentina	2,50	0,40	0,80	2,00	0,00	0,40
Christ-Owen Kouassi	DF	Lecce	2,50	0,00	0,40	1,20	0,00	0,80
Fallou Cham	DF	Hellas Verona	2,40	0,00	2,50	2,08	0,42	3,75
Daniele Rugani	DF	Juventus	2,40	0,00	0,83	0,00	0,00	0,00
Zito Luvumbo	ATT,CC	Cagliari	2,30	0,00	1,30	5,22	0,00	1,30
Davide Frattesi	CC,ATT	Inter	2,30	0,00	0,87	2,17	0,43	0,00
Mikayil Ngor Faye	DF,ATT	Cremonese	2,30	0,43	0,43	1,30	0,00	1,74
Mattia Viti	DF	Fiorentina	2,30	1,30	3,04	1,74	0,00	0,00
Mateus Lusuardi	DF	Pisa	2,20	0,45	1,82	0,00	0,00	0,45
Almoatasem Al Musrati	CC	Hellas Verona	2,20	0,45	2,27	0,00	0,83	0,00
NicolÃ² Rovella	CC	Lazio	2,20	0,45	0,91	2,73	0,00	3,18
Filippo Romagna	DF	Sassuolo	2,20	0,00	0,00	0,45	0,00	0,00
Mariano Troilo	DF	Parma	2,20	0,91	1,36	2,27	0,00	0,45
Konan N'dri	ATT,CC	Lecce	2,10	0,95	2,38	4,29	0,00	2,38
Daniel Maldini	CC	Atalanta	2,10	0,48	0,95	1,90	0,00	1,90
Andrea Belotti	ATT	Cagliari	2,10	0,00	1,43	3,33	1,43	0,48
Mohamed Kaba	CC,ATT	Lecce	2,10	0,00	1,43	2,86	0,00	1,43
Stephan El Shaarawy	CC,ATT	Roma	2,00	0,50	2,50	1,00	0,50	2,50
Sergi Roberto	CC	Como	2,00	1,00	2,00	1,50	0,00	1,00
Iker Bravo	ATT	Udinese	2,00	0,50	1,50	0,50	0,00	1,50
Stefan de Vrij	DF	Inter	2,00	0,00	0,00	0,00	0,00	0,00
Oier Zarraga	CC	Udinese	2,00	0,50	2,00	0,50	0,00	2,00
Simone Scuffet	POR	Pisa	2,00	0,00	0,00	0,00	0,00	0,00
Mattia Perin	POR	Juventus	2,00	0,00	0,00	0,00	0,00	0,00
Josep Martinez	POR	Inter	2,00	0,00	0,00	0,00	0,00	0,00
Gaetano Oristanio	CC,ATT	Parma	1,90	0,53	2,11	5,26	0,00	2,63
Nicolae Stanciu	CC,ATT	Genoa	1,90	0,00	0,53	1,05	0,00	4,74
Zakaria Aboukhlal	ATT,CC	Torino	1,90	0,53	2,11	3,16	1,67	2,11
Martin Baturina	ATT,CC	Como	1,90	0,00	0,00	2,11	0,00	4,74
Devyne Rensch	DF	Roma	1,90	0,00	1,05	2,63	0,67	1,58
Marco Brescianini	CC	Atalanta	1,80	0,56	2,22	1,11	0,00	3,33
Leon Bailey	ATT,CC	Roma	1,70	0,00	1,18	0,59	0,59	7,06
Reda Belahyane	CC	Lazio	1,70	0,59	3,53	0,00	0,00	0,00
Elseid Hysaj	DF	Lazio	1,70	0,00	0,00	0,59	0,00	1,18
Abdou Harroui	CC,ATT	Hellas Verona	1,60	0,00	2,50	0,63	0,00	3,13
Jeremy Sarmiento	CC,ATT	Cremonese	1,60	0,00	0,00	0,63	0,00	1,25
Daniel Boloca	CC	Sassuolo	1,50	0,00	0,00	0,67	0,00	0,67
Dennis Johnsen	ATT,CC	Cremonese	1,50	0,00	0,67	0,00	0,67	3,33
Sebastian Otoa	DF	Genoa	1,50	0,67	1,33	0,67	0,00	0,00
Vasilije AdÅ¾iÄ‡	CC	Juventus	1,40	0,00	1,43	0,71	0,00	1,43
Ãlex Sala	CC	Lecce	1,40	0,00	2,86	1,43	0,00	2,86
Faustino Anjorin	CC,ATT	Torino	1,40	0,71	2,86	0,71	1,43	0,71
Pietro Terracciano	POR	Milan	1,40	0,00	0,00	0,00	0,00	0,00
Daniel Denoon	DF	Pisa	1,40	0,71	2,86	2,14	0,00	0,00
Walid Cheddira	ATT	Sassuolo	1,30	0,77	1,54	4,62	0,00	2,31
Tijjani Noslin	ATT,CC	Lazio	1,30	0,00	2,31	2,31	0,00	0,00
Rui Modesto	CC,DF	Udinese	1,30	0,00	0,00	0,00	0,00	3,85
Luca Lipani	CC	Sassuolo	1,30	0,00	6,92	0,00	0,00	0,77
Zachary Athekame	DF,ATT	Milan	1,20	1,67	2,50	0,83	0,83	4,17
Sandi LovriÄ‡	CC	Udinese	1,20	0,83	2,50	0,00	0,00	7,50
Junior Messias	ATT,CC	Genoa	1,20	0,00	2,50	4,17	0,00	0,83
Juan David Cabal	DF	Juventus	1,20	0,83	1,67	0,00	1,43	0,00
Malthe Hojholt	CC	Pisa	1,20	0,83	1,67	0,00	0,00	0,00
Jan ZiÃ³Å‚kowski	DF	Roma	1,20	1,67	3,33	3,33	0,00	0,00
Federico Ceccherini	DF	Cremonese	1,20	0,00	1,67	1,67	0,00	0,00
Jacob Ondrejka	CC,ATT	Parma	1,10	0,00	0,91	1,82	0,00	2,73
Matteo Palma	DF	Udinese	1,10	0,00	1,82	0,00	0,00	0,00
Joseph Liteta	CC	Cagliari	1,10	0,00	2,73	0,00	0,00	0,00
Ignace Van Der Brempt	DF	Como	1,10	0,91	4,55	1,82	0,00	0,00
Luca Marianucci	DF	Napoli	1,00	0,00	1,00	0,00	0,00	0,00
Stefano Turati	POR	Sassuolo	1,00	0,00	0,00	0,00	0,00	0,00
Albert GrÃ¸nbaek	ATT,CC	Genoa	1,00	1,00	1,00	1,00	0,00	1,00
Nicholas Pierini	ATT	Sassuolo	0,90	1,11	1,11	3,33	0,00	3,33
Leonardo Pavoletti	ATT,CC	Cagliari	0,90	1,11	4,44	0,00	1,11	0,00
Lennon Miller	CC	Udinese	0,90	1,11	4,44	1,11	0,00	3,33
Edoardo Iannoni	CC	Sassuolo	0,90	2,22	7,78	0,00	1,11	0,00
ÃžÃ³rir JÃ³hann Helgason	CC	Lecce	0,90	0,00	0,00	0,00	0,00	3,33
Massimo Pessina	POR	Bologna	0,90	0,00	0,00	0,00	0,00	0,00
Jamil Siebert	DF	Lecce	0,90	0,00	2,22	0,00	0,00	0,00
David Okereke	ATT	Cremonese	0,90	0,00	0,00	0,00	1,11	0,00
Edon Zhegrova	CC	Juventus	0,80	0,00	2,50	1,25	0,00	15,00
Maxwel Cornet	ATT,DF	Genoa	0,80	0,00	3,75	1,25	1,25	7,50
Hernani	CC,DF	Parma	0,80	0,00	2,50	3,75	1,25	2,50
Semih KÄ±lÄ±Ã§soy	ATT	Cagliari	0,80	1,25	2,50	1,25	1,25	1,25
Corrie Ndaba	DF,CC	Lecce	0,80	0,00	1,25	0,00	0,00	1,25
Yunus Musah	DF	Milan	0,70	0,00	1,43	4,29	1,00	0,00
Fabio Miretti	CC	Juventus	0,70	1,43	2,86	1,43	0,00	2,86
Andy Diouf	CC,DF	Inter	0,70	0,00	0,00	1,43	0,00	2,86
Luca Mazzitelli	CC	Cagliari	0,70	2,86	4,29	1,43	0,00	1,43
Eddy Kouadio	DF	Fiorentina	0,70	0,00	1,43	1,43	0,00	1,43
Milan ÄuriÄ‡	ATT	Parma	0,60	0,00	3,33	1,67	0,00	0,00
NiccolÃ² Pisilli	CC	Roma	0,60	0,00	0,00	0,00	0,00	1,67
Alessandro Di Pardo	DF	Cagliari	0,60	0,00	0,00	1,67	0,00	0,00
Enzo Ebosse	DF	Hellas Verona	0,60	1,67	5,00	0,00	0,00	0,00
Emirhan Ä°lkhan	CC	Torino	0,60	0,00	0,00	3,33	0,00	0,00
Luca Moro	ATT	Sassuolo	0,50	0,00	4,00	6,00	2,00	0,00
Youssef Maleh	CC	Lecce	0,50	0,00	8,00	2,00	0,00	4,00
Sead KolaÅ¡inac	DF	Atalanta	0,50	0,00	2,00	4,00	0,00	0,00
Ãlex JimÃ©nez	DF	Milan	0,50	2,00	0,00	2,00	0,00	2,00
Lorran	CC,DF	Pisa	0,40	0,00	0,00	0,00	0,00	7,50
Lorenzo Venturino	ATT,CC	Genoa	0,40	0,00	2,50	0,00	0,00	20,00
Francesco Folino	DF	Cremonese	0,40	0,00	2,50	2,50	0,00	0,00
Giuseppe Ambrosino	ATT	Napoli	0,40	0,00	2,50	2,50	0,00	0,00
Abdelhamid Sabiri	CC	Fiorentina	0,30	0,00	3,33	3,33	0,00	13,30
Tariq Lamptey	CC,DF	Fiorentina	0,30	0,00	0,00	0,00	0,00	3,33
Samuel Chukwueze	ATT	Milan	0,30	0,00	0,00	10,00	0,00	10,00
Daniele Ghilardi	DF	Roma	0,30	0,00	6,67	0,00	0,00	3,33
Dachi Lordkipanidze	CC	Cremonese	0,30	0,00	0,00	0,00	0,00	0,00
Ciro Immobile	ATT	Bologna	0,30	0,00	0,00	0,00	3,33	0,00
Balthazar Pierret	CC	Lecce	0,30	0,00	0,00	6,67	0,00	0,00
NicolÃ¡s GonzÃ¡lez	CC,DF	Juventus	0,20	0,00	0,00	15,00	0,00	0,00
Manuel De Luca	ATT	Cremonese	0,20	0,00	5,00	5,00	0,00	0,00
Grigoris Kastanos	CC	Hellas Verona	0,20	0,00	10,00	5,00	0,00	10,00
Faris Pemi Moumbagna	ATT	Cremonese	0,20	0,00	0,00	0,00	0,00	0,00
Daniel Oyegoke	CC,DF	Hellas Verona	0,20	0,00	0,00	0,00	0,00	10,00
Ardon Jashari	CC	Milan	0,20	0,00	10,00	15,00	0,00	0,00
Alieu Njie	ATT	Torino	0,20	5,00	10,00	0,00	0,00	5,00
Patric	CC,DF	Lazio	0,20	0,00	5,00	0,00	0,00	0,00
Pasquale Mazzocchi	CC	Napoli	0,20	0,00	0,00	0,00	0,00	0,00
Matteo Darmian	DF	Inter	0,20	0,00	0,00	0,00	5,00	5,00
Louis Buffon	ATT	Pisa	0,20	0,00	0,00	5,00	0,00	0,00
Idrissa GuÃ¨ye	ATT	Udinese	0,20	0,00	10,00	0,00	0,00	0,00
Ben Cremaschi	CC	Parma	0,20	0,00	0,00	0,00	0,00	0,00
Yellu Santiago	CC	Hellas Verona	0,10	0,00	0,00	10,00	0,00	0,00
Calvin Stengs	CC	Pisa	0,10	0,00	0,00	20,00	0,00	30,00
Cheveyo Muy	ATT	Milan	0,10	0,00	0,00	0,00	0,00	0,00
Amir Richardson	CC	Fiorentina	0,10	0,00	10,00	0,00	0,00	0,00
Ali DembÃ©lÃ©	DF	Torino	0,10	0,00	0,00	0,00	0,00	0,00
NicolÃ² Cavuoti	DF	Cagliari	0,10	0,00	10,00	0,00	0,00	0,00
Jean Onana	CC	Genoa	0,10	0,00	20,00	0,00	0,00	0,00
Ibrahim Sulemana	CC	Bologna	0,10	0,00	0,00	0,00	0,00	0,00
Antonio Vergara	CC	Napoli	0,10	0,00	0,00	10,00	0,00	0,00
Andrea Ghion	ATT,CC	Sassuolo	0,10	0,00	0,00	0,00	0,00	10,00
TjaÅ¡ BegiÄ‡	DF	Parma	0,00	0,00	0,00	0,00	0,00	0,00
Junior Ajayi	ATT	Hellas Verona	0,00	0,00	0,00	0,00	0,00	0,00
Edoardo Goldaniga	DF	Como	0,00	0,00	0,00	0,00	0,00	0,00
`;

const playersPassingRawData = `
Player pass completati pass tentati % pass completati tiri tot tiri in porta tiri tot /90 tiri porta /90 distanza media tiri
Johan VÃ¡squez	48,2	57,0	84,6%	15	3	1,07	0,21	17,90
Giovanni Di Lorenzo	52,6	63,8	82,4%	13	7	0,93	0,50	11,00
Enrico Del Prato	31,7	38,9	81,5%	13	7	0,93	0,50	9,90
Antonio Caracciolo	32,2	39,5	81,5%	10	2	0,71	0,14	17,50
Matteo Gabbia	46,7	50,5	92,5%	8	1	0,57	0,07	9,30
Manu KonÃ©	44,6	48,9	91,2%	8	1	0,57	0,07	20,10
Kialonda	33,3	39,3	84,7%	8	0	0,57	0,00	8,60
Pierre Kalulu	58,5	67,1	87,2%	7	1	0,50	0,07	13,10
Federico Baschirotto	36,8	42,5	86,6%	7	4	0,50	0,29	11,30
Simone Canestrelli	29,8	37,0	80,5%	4	1	0,29	0,07	8,90
Wladimiro Falcone	14,9	30,4	49,0%	0	0	0,00	0,00	0,00
Nicola Leali	17,6	27,2	64,7%	0	0	0,00	0,00	0,00
Mile Svilar	28,5	37,8	75,4%	0	0	0,00	0,00	0,00
Marco Carnesecchi	28,6	38,0	75,3%	0	0	0,00	0,00	0,00
Lorenzo MontipÃ²	15,2	30,1	50,5%	0	0	0,00	0,00	0,00
Jean Butez	33,4	39,8	83,9%	0	0	0,00	0,00	0,00
Ivan Provedel	26,6	36,1	73,7%	0	0	0,00	0,00	0,00
Elia Caprile	22,9	33,4	68,6%	0	0	0,00	0,00	0,00
David de Gea	23,0	33,4	68,9%	0	0	0,00	0,00	0,00
Gianluca Mancini	44,7	52,8	84,7%	8	3	0,57	0,22	13,30
NicolÃ¡s Paz	37,9	48,3	78,5%	50	20	3,63	1,45	24,60
Jesper KarlstrÃ¶m	31,8	40,1	79,3%	10	2	0,73	0,15	18,00
Oumar Solet	54,8	62,4	87,8%	13	1	0,95	0,07	22,70
Luka ModriÄ‡	65,5	75,2	87,1%	8	4	0,58	0,29	24,80
Victor Nelsson	25,3	29,7	85,2%	1	0	0,07	0,00	10,60
Alexis Saelemaekers	40,8	50,2	81,3%	20	6	1,48	0,44	17,80
Ylber Ramadani	35,6	44,5	80,0%	8	1	0,59	0,07	26,30
Obite N'Dicka	52,5	58,3	90,1%	9	0	0,67	0,00	11,40
Mario Gila	56,2	62,4	90,1%	8	2	0,60	0,15	12,70
Antonino Gallo	33,8	50,8	66,5%	2	1	0,15	0,08	12,20
Mateo Pellegrino	8,5	15,3	55,4%	23	8	1,74	0,61	16,60
Strahinja PavloviÄ‡	53,3	59,7	89,3%	8	3	0,60	0,23	11,90
Tiago Gabriel	37,3	41,7	89,4%	9	2	0,69	0,15	10,90
DodÃ´	29,1	40,6	71,7%	14	1	1,08	0,08	18,20
SaÃºl Coco	35,8	40,3	88,8%	8	3	0,62	0,23	12,40
Brooke Norton-Cuffy	32,5	42,2	77,0%	6	1	0,46	0,08	14,70
Jay Idzes	36,6	40,4	90,6%	1	0	0,08	0,00	28,20
Arijanet Muric	24,1	35,8	67,3%	0	0	0,00	0,00	0,00
Filippo Terracciano	45,8	56,5	81,1%	11	3	0,85	0,23	10,90
Nemanja MatiÄ‡	46,7	56,2	83,1%	5	4	0,39	0,31	20,10
Moise Kean	6,2	9,3	66,3%	51	10	3,97	0,78	15,40
Michael Folorunsho	15,7	24,1	65,1%	17	4	1,33	0,31	16,90
Giovane	15,4	25,0	61,6%	35	20	2,76	1,58	20,10
Bryan Cristante	48,7	60,7	80,2%	21	5	1,65	0,39	13,90
Mattia Zaccagni	27,1	34,8	77,9%	20	8	1,59	0,64	12,30
Alessandro Bastoni	67,5	79,4	85,0%	11	3	0,87	0,24	13,30
Matteo Bianchetti	41,3	50,6	81,6%	4	0	0,32	0,00	11,00
Mike Maignan	28,0	36,7	76,3%	0	0	0,00	0,00	0,00
Andrea Pinamonti	10,9	16,4	66,5%	35	16	2,79	1,28	14,00
Arthur Atta	28,8	37,1	77,6%	25	9	2,04	0,73	21,50
Adrian Bernabe	35,0	44,0	79,5%	24	6	1,96	0,49	22,60
Cesare Casadei	27,0	34,6	78,0%	18	6	1,47	0,49	15,30
NicolÃ² Barella	54,9	66,9	82,1%	15	2	1,23	0,16	19,10
Guillermo MaripÃ¡n	32,2	37,4	86,1%	9	5	0,74	0,41	11,70
Isak Hien	50,7	56,1	90,4%	5	1	0,41	0,08	9,50
Lassana Coulibaly	20,9	26,5	78,9%	7	4	0,58	0,33	12,30
Scott McTominay	26,8	31,7	84,5%	31	13	2,58	1,08	17,60
Manuel Akanji	65,6	72,2	90,9%	7	0	0,58	0,00	18,30
Lloyd Kelly	55,5	62,4	88,9%	7	2	0,58	0,17	18,10
Marco Palestra	24,8	32,3	76,8%	6	2	0,50	0,17	19,80
Marin PongraÄiÄ‡	48,5	54,3	89,3%	5	0	0,42	0,00	15,20
Yann Sommer	31,9	36,8	86,7%	0	0	0,00	0,00	0,00
Michele Di Gregorio	25,8	31,8	81,1%	0	0	0,00	0,00	0,00
Adrian Å emper	21,6	33,9	63,7%	0	0	0,00	0,00	0,00
Kenan YÄ±ldÄ±z	31,4	40,0	78,5%	30	13	2,53	1,09	19,80
MattÃ©o Guendouzi	42,0	48,1	87,3%	14	8	1,18	0,67	21,30
Michel Aebischer	43,7	51,4	85,0%	6	0	0,51	0,00	25,60
Lautaro MartÃ­nez	17,9	23,7	75,5%	46	12	3,93	1,02	12,50
Berat Djimsiti	54,6	62,1	87,9%	6	0	0,51	0,00	9,10
Morten Frendrup	26,9	33,3	80,8%	3	1	0,26	0,09	17,20
Sebastian Walukiewicz	38,6	46,2	83,5%	1	0	0,09	0,00	29,30
Youssouf Fofana	29,0	34,3	84,5%	22	8	1,90	0,69	19,20
Federico Dimarco	39,0	53,7	72,6%	21	7	1,81	0,60	19,10
Rolando Mandragora	30,9	41,4	74,6%	20	6	1,72	0,52	23,50
Michel Ndary Adopo	24,8	30,4	81,6%	8	3	0,69	0,26	15,20
Luca Ranieri	43,2	52,8	81,8%	7	2	0,60	0,17	13,80
Adam MaruÅ¡iÄ‡	50,6	58,9	85,9%	5	2	0,43	0,17	17,30
MÃ¡ximo Perrone	63,0	68,8	91,6%	5	3	0,44	0,26	15,60
Danilo Veiga	33,9	45,8	74,0%	2	1	0,17	0,09	9,60
Manuel Locatelli	72,0	81,7	88,1%	16	4	1,40	0,35	23,10
Mandela Keita	26,2	31,0	84,5%	5	1	0,44	0,09	28,70
TorbjÃ¸rn Heggem	46,8	51,4	91,1%	4	1	0,35	0,09	10,30
Rafik Belghali	25,5	34,1	74,8%	9	4	0,80	0,35	13,90
Alessio Romagnoli	57,0	61,7	92,4%	1	0	0,09	0,00	11,90
Wesley	39,6	50,4	78,6%	13	7	1,16	0,62	17,90
Idrissa TourÃ©	20,3	32,0	63,4%	16	4	1,44	0,36	11,00
Martin Frese	27,2	42,0	64,8%	12	5	1,08	0,45	18,50
Mario PaÅ¡aliÄ‡	56,3	63,4	88,8%	9	4	0,81	0,36	14,20
Antoine Bernede	23,5	33,0	71,2%	7	2	0,63	0,18	21,30
MatÃ¬as SoulÃ©	32,7	42,1	77,7%	26	10	2,36	0,91	21,00
Jacobo RamÃ³n	60,6	66,6	91,0%	14	2	1,28	0,18	14,50
Nikola VlaÅ¡iÄ‡	27,9	34,5	80,9%	11	3	1,00	0,27	22,00
Tarik Muharemovic	42,5	51,0	83,3%	9	3	0,82	0,27	19,00
Warren Bondo	31,6	36,1	87,5%	3	0	0,27	0,00	26,80
Sebastiano Luperto	38,5	43,3	88,9%	3	2	0,27	0,18	11,80
Zion Suzuki	26,4	40,6	65,0%	0	0	0,00	0,00	0,00
Adam Obert	39,1	48,6	80,5%	2	1	0,18	0,09	13,20
Riccardo Orsolini	15,3	24,9	61,4%	34	12	3,19	1,13	20,10
Jari Vandeputte	32,0	46,4	69,0%	9	4	0,84	0,37	20,80
Hakan Ã‡alhanoÄŸlu	71,6	82,6	86,7%	27	7	2,56	0,66	27,90
Sebastiano Esposito	21,1	31,5	67,0%	21	5	1,99	0,47	20,10
Zeki Ã‡elik	43,5	54,6	79,7%	13	2	1,22	0,19	18,00
IsmaÃ«l KonÃ©	29,6	32,8	90,2%	7	2	0,66	0,19	20,80
Fikayo Tomori	55,5	62,9	88,2%	6	1	0,57	0,09	15,50
M'Bala Nzola	12,6	16,7	75,4%	23	4	2,20	0,38	15,00
Patrizio Masini	27,9	38,2	73,0%	12	2	1,14	0,19	18,20
Leo Skiri Ã˜stigÃ¥rd	52,4	59,1	88,7%	11	6	1,05	0,57	9,10
Josh Doig	34,2	43,8	78,1%	3	2	0,29	0,19	25,70
Andre-Frank Zambo Anguissa	40,2	48,6	82,7%	19	8	1,83	0,77	13,50
Matteo Prati	28,2	36,3	77,7%	13	0	1,25	0,00	24,10
Andrea Cambiaso	50,5	59,3	85,2%	7	3	0,67	0,29	17,10
Ãlex Valle	48,8	58,4	83,6%	6	0	0,58	0,00	15,90
AarÃ³n MartÃ­n	37,3	53,1	70,2%	4	3	0,38	0,29	26,50
Diego Carlos	57,1	62,1	91,9%	1	0	0,10	0,00	36,20
Raoul Bellanova	38,0	47,0	80,9%	10	2	0,97	0,19	16,80
Juan Miranda	47,4	64,3	73,7%	6	2	0,60	0,20	17,00
KhÃ©phren Thuram	49,0	55,4	88,4%	17	6	1,69	0,60	18,20
Mikael Ellertsson	17,7	24,7	71,7%	12	5	1,19	0,50	16,80
Domagoj BradariÄ‡	23,8	34,2	69,6%	5	3	0,50	0,30	16,10
Valentino Lazaro	33,1	42,3	78,3%	1	0	0,10	0,00	17,30
Vanja MilinkoviÄ‡-SaviÄ‡	30,1	43,7	68,9%	0	0	0,00	0,00	0,00
Emil Audero	27,7	45,6	60,7%	0	0	0,00	0,00	0,00
Domenico Berardi	24,5	33,1	74,0%	16	8	1,61	0,81	20,00
Kristjan Asllani	41,3	52,1	79,3%	15	3	1,54	0,31	29,40
Danilo Cataldi	39,4	49,2	80,1%	9	1	0,92	0,10	27,80
Lucas Da Cunha	56,7	64,1	88,5%	11	5	1,13	0,51	23,10
Medon Berisha	32,5	43,8	74,2%	24	5	2,51	0,52	27,90
Teun Koopmeiners	53,6	61,7	86,9%	13	3	1,36	0,31	21,20
Jhon LucumÃ­	58,9	66,0	89,2%	5	2	0,52	0,21	9,70
Francesco Acerbi	56,4	59,6	94,6%	3	1	0,31	0,10	8,00
Santiago Castro	10,4	14,8	70,3%	22	10	2,32	1,06	13,80
Ruslan Malinovskyi	37,7	46,6	80,9%	20	4	2,12	0,42	27,50
Lautaro Valenti	28,0	41,9	66,8%	5	2	0,52	0,21	30,30
Gabriele Zappa	48,2	57,6	83,7%	3	0	0,32	0,00	15,50
Nikola Å tuliÄ‡	10,4	16,6	62,7%	12	3	1,27	0,32	17,70
Unai NÃºÃ±ez	33,0	42,6	77,5%	5	0	0,53	0,00	12,20
Alessandro Circati	39,6	46,7	84,8%	1	1	0,11	0,11	7,70
Davide Zappacosta	43,5	53,1	81,9%	16	3	1,72	0,32	19,90
Mario Hermoso	50,2	59,4	84,5%	6	3	0,64	0,32	12,50
Marcus Pedersen	25,8	37,0	69,7%	5	2	0,54	0,21	13,90
Alessandro Buongiorno	49,9	55,1	90,6%	3	1	0,32	0,11	6,80
Gift Orban	9,2	15,0	61,6%	35	12	3,81	1,31	18,70
Weston McKennie	34,7	42,5	81,6%	13	3	1,41	0,33	12,30
Sascha Britschgi	21,4	30,4	70,4%	7	1	0,76	0,11	22,40
Oliver Jensen	20,3	26,3	77,2%	8	2	0,88	0,22	18,30
Åukasz Skorupski	36,7	46,5	78,9%	0	0	0,00	0,00	0,00
Matteo Politano	30,8	43,4	71,0%	25	4	2,77	0,44	19,70
Marten de Roon	58,1	66,4	87,5%	10	3	1,11	0,33	20,70
Yerry Mina	41,3	46,7	88,4%	4	2	0,45	0,22	14,40
Pablo MarÃ­	46,6	51,0	91,4%	2	0	0,22	0,00	27,70
Franco Israel	22,6	35,9	63,0%	0	0	0,00	0,00	0,00
Patrick Cutrone	12,0	19,7	60,9%	23	7	2,59	0,79	15,50
Charles De Ketelaere	33,9	43,8	77,4%	19	8	2,14	0,90	15,60
Boulaye Dia	18,1	22,2	81,5%	8	4	0,90	0,45	11,00
Tete Morente	22,2	32,2	68,9%	14	2	1,58	0,23	18,70
Ebenezer Akinsanmiro	26,0	30,7	84,7%	10	3	1,13	0,34	24,20
NicolÃ² Zaniolo	17,8	24,9	71,5%	27	10	3,09	1,14	21,30
Lorenzo Colombo	12,8	19,1	67,0%	23	8	2,65	0,92	15,50
Jamie Vardy	7,1	13,2	54,0%	10	6	1,15	0,69	12,90
Armand Lauriente	22,4	28,5	78,6%	25	7	2,89	0,81	20,90
Kristian Thorstvedt	30,6	39,5	77,5%	15	3	1,75	0,35	13,80
Federico Gatti	50,3	55,6	90,5%	10	4	1,16	0,46	12,90
Keinan Davis	12,3	16,3	75,5%	21	8	2,49	0,95	14,60
Suat Serdar	21,8	31,1	70,1%	17	5	2,02	0,59	18,30
Santiago Pierotti	16,9	23,7	71,3%	11	3	1,31	0,36	15,10
Roberto Gagliardini	37,0	48,7	76,0%	3	1	0,36	0,12	10,30
Giovanni Simeone	13,9	18,8	73,9%	27	9	3,24	1,08	17,80
Francisco ConceiÃ§Ã£o	31,7	38,4	82,6%	23	6	2,79	0,73	17,60
Toma BaÅ¡iÄ‡	38,9	46,6	83,5%	17	7	2,04	0,84	25,40
Rasmus HÃ¸jlund	13,5	18,1	74,6%	10	7	1,20	0,84	12,40
Giuseppe Pezzella	20,1	30,6	65,7%	3	0	0,36	0,00	15,90
Christian Kabasele	27,5	31,4	87,6%	2	1	0,24	0,12	8,60
Cyril Ngonge	16,8	24,8	67,7%	17	8	2,06	0,97	19,00
NicolÃ² Cambiaghi	19,1	24,7	77,3%	14	4	1,73	0,49	16,00
Gennaro Borrelli	11,2	15,8	70,9%	14	5	1,73	0,62	12,70
Davide Bartesaghi	36,3	45,3	80,1%	8	3	0,98	0,37	23,00
Denzel Dumfries	26,0	35,3	73,7%	9	3	1,13	0,38	11,80
Robin Gosens	25,9	37,4	69,3%	6	1	0,75	0,12	7,80
Maduka Okoye	25,8	37,6	68,6%	0	0	0,00	0,00	0,00
Alessandro Zanoli	28,0	35,8	78,2%	0	0	0,00	0,00	0,00
Federico Bonazzoli	21,8	27,7	78,7%	18	8	2,29	1,02	18,20
MartÃ­n Payero	20,5	29,2	70,2%	11	4	1,39	0,50	21,40
Ã‰derson	59,1	65,6	90,1%	9	3	1,13	0,38	18,80
Albert GuÃ°mundsson	24,6	29,0	84,8%	3	0	0,38	0,00	23,00
Henrik Meister	5,3	8,6	61,2%	10	3	1,29	0,39	11,40
NicolÃ² Bertola	36,7	46,3	79,3%	5	2	0,64	0,26	14,10
Stanislav Lobotka	59,4	64,6	92,0%	0	0	0,00	0,00	0,00
Ademola Lookman	21,9	29,2	75,0%	21	5	2,73	0,65	16,50
Jesus RodrÃ­guez	20,6	28,7	71,8%	17	5	2,21	0,65	18,30
Marius Marin	19,2	27,7	69,3%	0	0	0,00	0,00	0,00
DuÅ¡an VlahoviÄ‡	11,7	17,2	68,0%	29	10	3,84	1,32	16,30
Hassane Kamara	34,6	45,3	76,4%	11	3	1,44	0,39	24,30
Petar Sucic	42,5	49,9	85,2%	9	3	1,19	0,40	20,40
Emanuele Valeri	20,4	38,6	52,8%	8	0	1,06	0,00	27,80
Alessandro Deiola	34,6	42,0	82,4%	4	3	0,52	0,39	16,70
Remo Freuler	46,6	55,3	84,3%	2	0	0,26	0,00	25,70
Vitinha	13,2	21,7	60,8%	17	5	2,28	0,67	18,60
Tommaso Barbieri	21,5	32,3	66,6%	7	1	0,93	0,13	19,80
Nikola Moro	55,7	66,5	83,8%	4	1	0,53	0,13	27,60
Odilon Kossounou	52,5	57,2	91,8%	3	1	0,40	0,13	21,00
Adrien Tameze	31,1	39,9	77,9%	3	0	0,40	0,00	18,00
Jens Odgaard	14,2	19,5	72,8%	16	6	2,17	0,81	19,10
Che Adams	17,5	23,8	73,5%	21	8	2,88	1,10	21,30
Rafael LeÃ£o	19,9	26,0	76,5%	19	8	2,60	1,09	20,70
David Neres	27,0	38,1	70,9%	13	4	1,78	0,55	22,10
NicolÃ² Fagioli	51,5	59,3	86,8%	2	0	0,27	0,00	27,90
Ivan SmolÄiÄ‡	46,8	55,6	84,2%	4	0	0,55	0,00	11,70
Ãlvaro Morata	19,2	25,4	75,6%	14	4	1,98	0,57	13,90
Samuele Angori	19,7	31,4	62,7%	1	0	0,14	0,00	33,10
MÃ«rgim Vojvoda	42,4	51,6	82,2%	10	5	1,42	0,71	17,80
Mehdi LÃ©ris	24,3	35,7	68,1%	9	1	1,29	0,14	16,60
Adrien Rabiot	41,0	47,1	87,0%	8	1	1,14	0,14	20,80
Sam Beukema	63,7	68,9	92,5%	4	2	0,57	0,29	13,20
Juan Jesus	71,7	77,6	92,4%	2	0	0,29	0,00	7,30
Marcus Thuram	17,1	23,3	73,4%	25	9	3,61	1,30	11,40
Santiago GimÃ©nez	10,3	13,0	79,2%	21	6	3,04	0,87	11,80
Anastasios Douvikas	13,0	16,7	77,8%	17	8	2,46	1,16	12,20
Marc-Oliver Kempf	55,4	62,2	89,1%	6	3	0,87	0,43	11,60
Gustav Isaksen	22,1	28,7	77,0%	18	8	2,66	1,18	17,00
Jakub Piotrowski	25,4	31,2	81,4%	17	3	2,50	0,44	17,60
MattÃ©o Tramoni	14,3	22,6	63,3%	13	3	1,92	0,44	19,70
Tommaso Pobega	21,5	28,5	75,4%	15	6	2,24	0,90	19,20
Nadir Zortea	42,1	53,4	78,8%	6	1	0,89	0,15	24,90
Amir Rrahmani	67,5	73,1	92,3%	4	0	0,60	0,00	10,20
Simon Sohm	35,8	40,7	88,0%	3	0	0,45	0,00	21,10
Alessandro Marcandalli	31,1	38,0	81,8%	3	2	0,45	0,30	11,70
Armel Bella Kotchap	28,2	35,2	80,1%	2	0	0,30	0,00	16,20
Lorenzo Pellegrini	36,3	51,4	70,6%	16	7	2,46	1,08	18,40
Samuele Ricci	39,8	44,4	89,6%	10	5	1,57	0,78	20,10
Jurgen Ekkelenkamp	20,5	28,6	71,7%	6	4	0,94	0,63	23,30
Kevin De Bruyne	54,3	65,9	82,4%	13	4	2,07	0,64	25,60
Morten Thorsby	17,5	26,7	65,5%	9	3	1,43	0,48	11,50
Hans Nicolussi Caviglia	39,5	51,7	76,4%	4	1	0,63	0,16	26,50
Roberto Piccoli	7,4	13,5	55,0%	16	7	2,57	1,13	14,40
Jayden Addai	16,9	24,2	69,8%	11	6	1,79	0,97	17,70
Leonardo Spinazzola	40,2	53,2	75,6%	7	4	1,13	0,65	24,30
Alessio Zerbin	23,9	33,1	72,2%	7	2	1,13	0,32	17,40
Lewis Ferguson	63,9	71,5	89,4%	5	1	0,80	0,16	21,60
Romano Floriani	18,5	27,1	68,3%	2	0	0,32	0,00	21,50
Kingsley Ehizibue	23,9	34,0	70,3%	1	0	0,16	0,00	13,70
Nikola KrstoviÄ‡	19,7	24,8	79,4%	30	9	4,92	1,48	14,70
Jonathan David	21,0	26,6	78,9%	11	4	1,80	0,65	10,30
Stefano Moreo	12,8	22,8	56,1%	11	3	1,84	0,50	13,10
Razvan Sava	22,5	28,7	78,4%	0	0	0,00	0,00	0,00
Maxence Caqueret	57,6	66,3	86,9%	5	1	0,85	0,17	21,30
Lameck Banda	17,8	23,1	77,1%	7	4	1,20	0,69	19,30
MathÃ­as Olivera	46,2	53,4	86,5%	3	1	0,52	0,17	5,90
ValentÃ­n Castellanos	11,9	20,0	59,5%	15	7	2,62	1,22	16,50
Nuno Tavares	53,9	67,0	80,4%	7	0	1,23	0,00	23,00
Honest Ahanor	45,8	50,7	90,3%	5	0	0,87	0,00	9,30
Paulo Dybala	33,4	45,2	73,9%	16	7	2,84	1,24	21,40
Henrikh Mkhitaryan	43,6	52,3	83,4%	11	2	1,97	0,36	18,80
Kamaldeen Sulemana	23,9	29,1	82,1%	8	3	1,44	0,54	15,00
Nicola Zalewski	32,1	49,5	64,8%	7	1	1,25	0,18	20,70
Ardian Ismajli	33,6	40,9	82,2%	1	0	0,18	0,00	16,10
Lazar Samardzic	39,3	51,3	76,6%	8	3	1,46	0,55	20,80
Jean-Daniel Akpa-Akpro	15,3	22,0	69,5%	4	1	0,73	0,18	17,00
Abdoulaye Niakhate Ndiaye	43,6	53,1	82,1%	4	0	0,73	0,00	20,30
Jordan Zemura	27,6	40,7	67,8%	2	0	0,36	0,00	24,00
Ruben Loftus-Cheek	30,6	36,9	82,9%	16	2	2,98	0,37	10,70
Carlos Augusto	44,1	53,0	83,2%	9	4	1,65	0,73	12,70
Pietro Comuzzo	38,9	44,7	87,0%	3	0	0,56	0,00	17,00
Mathias LÃ¸vik	22,9	31,3	73,2%	3	0	0,57	0,00	17,80
Matteo Cancellieri	18,6	25,5	72,9%	13	6	2,57	1,19	15,30
Alieu Fadera	20,6	26,9	76,6%	7	2	1,38	0,39	17,70
Adam Buksa	10,4	17,5	59,4%	7	3	1,38	0,59	13,80
Luca Pellegrini	46,1	59,2	77,9%	4	2	0,79	0,40	18,60
Cristiano Biraghi	31,0	43,9	70,6%	2	0	0,39	0,00	21,10
Christian Pulisic	33,0	39,2	84,2%	13	10	2,62	2,02	15,20
Nahuel EstÃ©vez	25,0	37,6	66,5%	5	0	1,00	0,00	18,00
Thomas Kristensen	44,8	51,0	87,8%	3	1	0,60	0,20	14,10
Alberto Paleari	22,2	33,6	66,1%	0	0	0,00	0,00	0,00
Franco VÃ¡zquez	29,4	40,2	73,1%	11	4	2,22	0,81	20,20
Christopher Nkunku	21,2	23,7	89,5%	9	3	1,85	0,62	12,30
Ange-Yoan Bonny	16,7	21,2	78,8%	9	4	1,85	0,82	12,50
Elif Elmas	31,6	39,0	81,0%	8	3	1,63	0,61	17,80
Pervis EstupiÃ±Ã¡n	41,2	49,4	83,4%	5	0	1,02	0,00	23,40
Emil Holm	39,6	51,6	76,7%	4	1	0,81	0,20	14,00
Aster Vranckx	26,3	32,4	81,2%	2	0	0,40	0,00	27,00
Arturo Calabresi	32,9	41,4	79,5%	2	1	0,41	0,20	21,40
Gianluca Gaetano	34,8	46,7	74,5%	14	6	2,91	1,25	23,00
Giovanni Fabbian	17,7	22,1	80,1%	8	0	1,68	0,00	13,40
NicolÃ¡s Valentini	17,1	25,6	66,8%	3	2	0,63	0,42	18,70
Alberto Grassi	37,7	45,4	83,0%	1	1	0,21	0,21	21,60
Gianluca Scamacca	18,5	25,3	73,1%	24	8	5,09	1,70	18,20
Francesco Camarda	8,3	12,6	65,9%	8	2	1,71	0,43	15,00
Saba Goglichidze	32,3	40,0	80,8%	3	1	0,64	0,21	7,70
Federico Bernardeschi	37,8	47,6	79,4%	11	4	2,40	0,87	21,00
Mattia Felici	18,7	30,0	62,3%	9	6	1,97	1,31	16,30
Billy Gilmour	68,3	77,0	88,7%	5	1	1,09	0,22	20,10
Antonio Sanabria	12,2	14,8	82,4%	4	2	0,86	0,43	5,70
Evan Ferguson	17,8	22,7	78,4%	11	4	2,43	0,88	16,30
Thijs Dallinga	19,5	26,8	72,8%	12	2	2,72	0,45	14,20
Riccardo Sottil	20,7	29,3	70,6%	4	2	0,92	0,46	27,50
Neil El Aynaoui	42,3	48,4	87,4%	3	2	0,68	0,45	26,00
Jacopo Fazzini	22,1	29,5	74,9%	7	1	1,64	0,23	23,00
Cristian Volpato	27,7	38,1	72,7%	7	2	1,62	0,46	16,80
NiccolÃ² Fortini	33,3	42,6	78,2%	5	1	1,17	0,23	25,40
AngeliÃ±o	42,6	56,7	75,1%	4	2	0,93	0,47	13,10
Francesco Esposito	17,4	25,2	69,0%	13	4	3,07	0,94	11,10
Lorenzo Lucca	11,2	14,3	78,3%	12	5	2,83	1,18	14,00
Noa Lang	31,9	46,4	68,8%	4	3	0,94	0,71	16,00
Fali CandÃ©	31,4	39,8	78,9%	3	0	0,72	0,00	23,20
Christian OrdoÃ±ez	13,3	18,6	71,5%	2	1	0,48	0,24	12,70
Pedro	40,2	48,3	83,2%	8	1	1,96	0,24	22,40
Nicolas-Gerrit KÃ¼hn	22,7	30,7	73,9%	4	2	0,98	0,49	13,60
Cher Ndour	27,1	37,3	72,7%	2	0	0,49	0,00	16,70
Valentin Carboni	27,5	36,3	75,8%	6	2	1,51	0,50	17,80
Amin Sarr	18,0	25,5	70,6%	6	2	1,51	0,50	16,80
Luis Henrique	40,8	46,8	87,2%	5	1	1,26	0,25	20,90
Filip KostiÄ‡	41,0	57,3	71,6%	4	3	0,99	0,74	22,10
Martin VitÃ­k	43,0	51,8	83,0%	2	0	0,50	0,00	7,10
Marco Silvestri	24,3	39,3	61,8%	0	0	0,00	0,00	0,00
Ivan IliÄ‡	36,8	44,3	83,1%	0	0	0,00	0,00	0,00
Federico Ravaglia	36,5	46,0	79,3%	0	0	0,00	0,00	0,00
Alex Meret	24,5	27,5	89,1%	0	0	0,00	0,00	0,00
Tommaso Baldanzi	25,9	31,5	82,2%	9	3	2,31	0,77	18,10
Charalampos Lykogiannis	46,2	63,8	72,4%	4	1	1,02	0,25	21,90
Pontus Almqvist	15,4	20,5	75,1%	1	0	0,26	0,00	16,80
ZÃ© Pedro Figueiredo	49,7	56,9	87,3%	0	0	0,00	0,00	0,00
Manuel Lazzari	37,7	46,2	81,6%	0	0	0,00	0,00	0,00
Caleb Ekuban	11,6	18,2	63,7%	11	3	2,89	0,79	14,60
Piotr ZieliÅ„ski	46,1	52,9	87,1%	6	2	1,60	0,53	22,70
Gleison Bremer	44,5	52,1	85,4%	4	1	1,04	0,26	15,30
Koni De Winter	50,3	59,5	84,5%	2	0	0,52	0,00	19,10
LoÃ¯s Openda	19,2	28,3	67,8%	13	2	3,66	0,56	17,00
Jeff Ekhator	10,3	18,9	54,5%	9	2	2,52	0,56	14,40
Artem Dovbyk	13,3	18,9	70,4%	9	4	2,48	1,10	9,50
Juan Cuadrado	31,4	41,7	75,3%	5	1	1,38	0,28	26,80
Giovanni Bonfanti	22,5	37,2	60,5%	5	1	1,39	0,28	14,50
Riyad Idrissi	34,4	48,3	71,2%	2	2	0,55	0,55	9,90
Cheikh Niasse	26,6	34,3	77,6%	2	0	0,57	0,00	18,40
Gabriele Piccinini	17,9	25,9	69,1%	4	1	1,19	0,30	15,60
Woyo Coulibaly	37,9	43,5	87,1%	2	1	0,59	0,29	20,70
Jonathan Rowe	27,0	32,7	82,6%	9	2	2,76	0,61	20,70
Yann Aurel Bisseck	62,4	67,9	91,9%	5	2	1,54	0,61	10,40
Miguel GutiÃ©rrez	44,5	53,9	82,6%	3	1	0,92	0,31	21,40
Vakoun Bayo	20,6	26,9	76,6%	11	1	3,43	0,31	13,30
DuvÃ¡n Zapata	13,8	20,9	66,0%	8	3	2,50	0,94	17,80
Adrian Benedyczak	13,1	21,3	61,5%	5	1	1,55	0,31	15,30
Stefan Posch	51,9	66,3	78,3%	3	2	0,93	0,62	17,20
Giorgio Scalvini	59,4	69,1	86,0%	2	1	0,62	0,31	12,40
Michele Collocolo	26,6	33,1	80,4%	1	1	0,32	0,32	32,70
Assane Diao	24,5	33,9	72,3%	4	1	1,29	0,32	25,70
Fabiano Parisi	38,1	46,1	82,6%	3	0	0,96	0,00	22,30
Niels Nkounkou	28,4	38,4	74,0%	2	0	0,65	0,00	18,80
Gvidas Gineitis	18,7	29,4	63,6%	1	0	0,32	0,00	30,60
Oliver Nielsen	52,3	56,8	92,1%	0	0	0,00	0,00	0,00
Daniel Mosquera	12,7	20,0	63,5%	8	4	2,67	1,33	13,90
Edoardo Corvi	28,0	36,3	77,1%	0	0	0,00	0,00	0,00
Ä°sak Vural	17,6	22,8	77,2%	1	0	0,34	0,00	12,10
Stefano Sabelli	32,4	49,3	65,7%	0	0	0,00	0,00	0,00
RaÃºl Albiol	53,1	60,0	88,5%	0	0	0,00	0,00	0,00
Lorenzo Bernasconi	52,1	65,0	80,2%	4	0	1,41	0,00	19,80
Fisayo Dele-Bashiru	32,9	35,7	92,2%	1	0	0,36	0,00	16,70
Lorenzo De Silvestri	36,4	44,6	81,6%	0	0	0,00	0,00	0,00
BenjamÃ­n DomÃ­nguez	16,3	20,7	78,7%	5	1	1,87	0,37	18,40
Alberto Moreno	51,5	60,0	85,8%	4	2	1,46	0,73	19,20
JoÃ£o MÃ¡rio Lopes	37,0	48,5	76,3%	2	0	0,75	0,00	17,30
Kostas Tsimikas	30,7	43,7	70,3%	1	0	0,37	0,00	21,20
NicolÃ² Casale	34,6	46,2	74,9%	2	0	0,77	0,00	7,70
MatÃ­as Vecino	57,7	62,3	92,6%	2	0	0,77	0,00	23,70
Adam Masina	33,1	39,6	83,6%	0	0	0,00	0,00	0,00
Edin DÅ¾eko	22,8	31,2	73,1%	4	1	1,62	0,41	11,30
Christ-Owen Kouassi	32,8	42,8	76,6%	0	0	0,00	0,00	0,00
Fallou Cham	23,3	36,3	64,2%	5	2	2,10	0,84	14,20
Daniele Rugani	54,2	59,6	90,9%	0	0	0,00	0,00	0,00
Zito Luvumbo	11,7	15,7	74,5%	7	4	3,01	1,72	18,50
Davide Frattesi	13,0	17,8	73,0%	7	3	3,07	1,32	14,90
Mikayil Ngor Faye	30,9	40,4	76,5%	2	0	0,89	0,00	20,30
Mattia Viti	41,7	50,9	81,9%	0	0	0,00	0,00	0,00
Mateus Lusuardi	29,5	36,4	81,0%	4	0	1,82	0,00	13,60
Almoatasem Al Musrati	43,2	51,4	84,0%	2	1	0,90	0,45	20,80
NicolÃ² Rovella	90,0	99,1	90,8%	1	0	0,45	0,00	30,20
Filippo Romagna	47,3	54,5	86,8%	1	0	0,45	0,00	24,90
Mariano Troilo	42,3	48,6	87,0%	0	0	0,00	0,00	0,00
Konan N'dri	19,0	28,6	66,4%	8	3	3,83	1,44	20,80
Daniel Maldini	23,8	33,8	70,4%	7	2	3,33	0,95	23,50
Andrea Belotti	11,0	14,8	74,3%	5	3	2,39	1,44	12,20
Mohamed Kaba	26,7	36,2	73,8%	4	2	1,93	0,96	16,60
Stephan El Shaarawy	37,0	47,0	78,7%	6	3	2,95	1,48	20,70
Sergi Roberto	65,0	72,0	90,3%	5	1	2,45	0,49	19,30
Iker Bravo	15,0	20,5	73,2%	4	1	2,02	0,51	21,00
Stefan de Vrij	62,5	66,5	94,0%	1	0	0,50	0,00	9,50
Oier Zarraga	30,5	36,0	84,7%	1	0	0,49	0,00	27,50
Simone Scuffet	33,5	39,5	84,8%	0	0	0,00	0,00	0,00
Mattia Perin	19,5	19,5	100,0%	0	0	0,00	0,00	0,00
Josep Martinez	27,5	35,5	77,5%	0	0	0,00	0,00	0,00
Gaetano Oristanio	11,6	15,8	73,4%	5	0	2,57	0,00	16,60
Nicolae Stanciu	31,6	46,3	68,3%	4	0	2,09	0,00	18,10
Zakaria Aboukhlal	13,2	20,5	64,4%	2	2	1,05	1,05	13,10
Martin Baturina	37,4	45,3	82,6%	2	1	1,06	0,53	17,40
Devyne Rensch	29,5	44,7	66,0%	1	1	0,53	0,53	5,70
Marco Brescianini	37,8	46,1	82,0%	2	1	1,13	0,57	17,40
Leon Bailey	24,1	34,7	69,5%	1	0	0,57	0,00	4,60
Reda Belahyane	32,4	37,1	87,3%	0	0	0,00	0,00	0,00
Elseid Hysaj	38,2	48,8	78,3%	0	0	0,00	0,00	0,00
Abdou Harroui	23,8	33,8	70,4%	4	1	2,47	0,62	25,30
Jeremy Sarmiento	34,4	38,8	88,7%	2	2	1,27	1,27	31,30
Daniel Boloca	35,3	38,0	92,9%	2	0	1,33	0,00	21,80
Dennis Johnsen	12,0	28,7	41,8%	1	0	0,67	0,00	31,70
Sebastian Otoa	23,3	25,3	92,1%	0	0	0,00	0,00	0,00
Vasilije AdÅ¾iÄ‡	38,6	50,0	77,2%	5	4	3,57	2,86	26,30
Ãlex Sala	31,4	36,4	86,3%	3	1	2,20	0,73	23,20
Faustino Anjorin	17,1	25,7	66,5%	1	0	0,73	0,00	16,50
Pietro Terracciano	23,6	25,7	91,8%	0	0	0,00	0,00	0,00
Daniel Denoon	23,6	28,6	82,5%	0	0	0,00	0,00	0,00
Walid Cheddira	16,2	25,4	63,8%	7	2	5,43	1,55	15,50
Tijjani Noslin	23,1	26,9	85,9%	4	4	3,13	3,13	10,80
Rui Modesto	33,1	46,9	70,6%	1	1	0,76	0,76	34,10
Luca Lipani	40,0	51,5	77,7%	0	0	0,00	0,00	0,00
Zachary Athekame	40,0	50,8	78,7%	2	1	1,61	0,80	27,70
Sandi LovriÄ‡	46,7	62,5	74,7%	2	1	1,65	0,83	14,50
Junior Messias	20,8	29,2	71,2%	2	0	1,61	0,00	13,10
Juan David Cabal	32,5	42,5	76,5%	2	1	1,67	0,83	18,70
Malthe Hojholt	29,2	35,8	81,6%	0	0	0,00	0,00	0,00
Jan ZiÃ³Å‚kowski	37,5	50,8	73,8%	0	0	0,00	0,00	0,00
Federico Ceccherini	32,5	39,2	82,9%	0	0	0,00	0,00	0,00
Jacob Ondrejka	15,5	23,6	65,7%	3	1	2,65	0,88	15,10
Matteo Palma	33,6	41,8	80,4%	0	0	0,00	0,00	0,00
Joseph Liteta	43,6	52,7	82,7%	0	0	0,00	0,00	0,00
Ignace Van Der Brempt	38,2	44,5	85,8%	0	0	0,00	0,00	0,00
Luca Marianucci	100,0	102,0	98,0%	1	0	1,00	0,00	30,80
Stefano Turati	10,0	26,0	38,5%	0	0	0,00	0,00	0,00
Albert GrÃ¸nbaek	14,0	18,0	77,8%	0	0	0,00	0,00	0,00
Nicholas Pierini	26,7	36,7	72,8%	2	0	2,20	0,00	21,50
Leonardo Pavoletti	14,4	27,8	51,8%	2	0	2,14	0,00	9,90
Lennon Miller	12,2	20,0	61,0%	2	1	2,34	1,17	20,00
Edoardo Iannoni	38,9	46,7	83,3%	2	1	2,25	1,13	7,80
ÃžÃ³rir JÃ³hann Helgason	18,9	23,3	81,1%	1	1	1,10	1,10	21,60
Massimo Pessina	22,2	35,6	62,4%	0	0	0,00	0,00	0,00
Jamil Siebert	41,1	42,2	97,4%	0	0	0,00	0,00	0,00
David Okereke	5,6	10,0	55,6%	0	0	0,00	0,00	0,00
Edon Zhegrova	53,8	80,0	67,3%	5	2	6,43	2,57	21,80
Maxwel Cornet	20,0	35,0	57,1%	2	1	2,40	1,20	15,00
Hernani	21,3	32,5	65,5%	1	0	1,23	0,00	21,90
Semih KÄ±lÄ±Ã§soy	13,8	20,0	69,0%	0	0	0,00	0,00	0,00
Corrie Ndaba	37,5	41,3	90,8%	0	0	0,00	0,00	0,00
Yunus Musah	35,0	42,0	83,3%	1	0	1,50	0,00	4,40
Fabio Miretti	72,9	81,4	89,6%	1	0	1,48	0,00	16,00
Andy Diouf	47,1	57,1	82,5%	1	1	1,41	1,41	28,40
Luca Mazzitelli	42,9	55,7	77,0%	0	0	0,00	0,00	0,00
Eddy Kouadio	22,9	30,0	76,3%	0	0	0,00	0,00	0,00
Milan ÄuriÄ‡	8,3	31,7	26,3%	3	0	5,09	0,00	9,00
NiccolÃ² Pisilli	60,0	68,3	87,8%	1	1	1,80	1,80	7,00
Alessandro Di Pardo	31,7	43,3	73,2%	1	0	1,67	0,00	8,40
Enzo Ebosse	43,3	50,0	86,6%	0	0	0,00	0,00	0,00
Emirhan Ä°lkhan	50,0	55,0	90,9%	0	0	0,00	0,00	0,00
Luca Moro	16,0	18,0	88,9%	2	0	4,00	0,00	11,80
Youssef Maleh	32,0	44,0	72,7%	0	0	0,00	0,00	0,00
Sead KolaÅ¡inac	56,0	68,0	82,4%	0	0	0,00	0,00	0,00
Ãlex JimÃ©nez	46,0	50,0	92,0%	0	0	0,00	0,00	0,00
Lorran	35,0	50,0	70,0%	1	1	2,43	2,43	7,20
Lorenzo Venturino	57,5	80,0	71,9%	1	1	2,25	2,25	31,20
Francesco Folino	32,5	42,5	76,5%	1	1	2,25	2,25	8,00
Giuseppe Ambrosino	2,5	10,0	25,0%	0	0	0,00	0,00	0,00
Abdelhamid Sabiri	50,0	76,7	65,2%	1	0	3,33	0,00	32,80
Tariq Lamptey	26,7	36,7	72,8%	0	0	0,00	0,00	0,00
Samuel Chukwueze	40,0	53,3	75,0%	0	0	0,00	0,00	0,00
Daniele Ghilardi	16,7	30,0	55,7%	0	0	0,00	0,00	0,00
Dachi Lordkipanidze	16,7	23,3	71,7%	0	0	0,00	0,00	0,00
Ciro Immobile	13,3	30,0	44,3%	0	0	0,00	0,00	0,00
Balthazar Pierret	36,7	53,3	68,9%	0	0	0,00	0,00	0,00
NicolÃ¡s GonzÃ¡lez	20,0	45,0	44,4%	2	0	9,47	0,00	17,90
Manuel De Luca	5,0	25,0	20,0%	1	1	5,63	5,63	31,60
Grigoris Kastanos	30,0	60,0	50,0%	1	0	4,29	0,00	16,50
Faris Pemi Moumbagna	0,0	10,0	0,0%	1	0	6,00	0,00	11,70
Daniel Oyegoke	45,0	80,0	56,3%	1	0	4,09	0,00	18,90
Ardon Jashari	95,0	100,0	95,0%	1	0	5,29	0,00	27,80
Alieu Njie	5,0	15,0	33,3%	1	1	5,29	5,29	11,70
Patric	95,0	115,0	82,6%	0	0	0,00	0,00	0,00
Pasquale Mazzocchi	20,0	25,0	80,0%	0	0	0,00	0,00	0,00
Matteo Darmian	5,0	20,0	25,0%	0	0	0,00	0,00	0,00
Louis Buffon	0,0	5,0	0,0%	0	0	0,00	0,00	0,00
Idrissa GuÃ¨ye	5,0	10,0	50,0%	0	0	0,00	0,00	0,00
Ben Cremaschi	5,0	5,0	100,0%	0	0	0,00	0,00	0,00
Yellu Santiago	40,0	70,0	57,1%	2	1	30,00	15,00	32,70
Calvin Stengs	130,0	180,0	72,2%	2	1	13,85	6,92	23,70
Cheveyo Muy	0,0	10,0	0,0%	1	0	18,00	0,00	13,70
Amir Richardson	90,0	120,0	75,0%	1	0	7,50	0,00	17,50
Ali DembÃ©lÃ©	30,0	70,0	42,9%	1	0	6,92	0,00	12,40
NicolÃ² Cavuoti	10,0	10,0	100,0%	0	0	0,00	0,00	0,00
Jean Onana	40,0	70,0	57,1%	0	0	0,00	0,00	0,00
Ibrahim Sulemana	50,0	60,0	83,3%	0	0	0,00	0,00	0,00
Antonio Vergara	20,0	20,0	100,0%	0	0	0,00	0,00	0,00
Andrea Ghion	10,0	20,0	50,0%	0	0	0,00	0,00	0,00
TjaÅ¡ BegiÄ‡	0,0	1,0	0,0%	0	0	0,00	0,00	0,00
Junior Ajayi	1,0	1,0	100,0%	0	0	0,00	0,00	0,00
Edoardo Goldaniga	0,0	1,0	0,0%	0	0	0,00	0,00	0,00
`;

let playersData = [];
let playersPassingData = [];
let playersPassingIndex = new Map();
let playersMinMatches = 0;
let playersMaxMatches = 0;
let playersSortColumn = 'name';
let playersSortDirection = 'asc';
const PLAYER_ROLES = ['POR', 'DF', 'CC', 'ATT'];
let selectedPlayerRoles = new Set(PLAYER_ROLES);
let selectedTeams = new Set(['all']);
let playersStatMode = 'per90';
let playerTeams = [];
let excludeLowPresencePlayers = true;
let playerComparisonSelections = { first: '', second: '' };
let playerComparisonOptions = [];

        // --- DATA SECTION (Empty as requested) ---
        const MATCHES_DB_2223 = `Sampdoria-Atalanta	98,53	51,55	52,5%	34
Milan-Udinese	100,25	52,44	52,5%	29
Monza-Torino	95,55	57,57	60,4%	23
Lecce-Inter	99,43	54,26	54,6%	40
Fiorentina-Cremonese	101,51	55,24	54,4%	29
Lazio-Bologna	101,20	47,59	47,4%	29
Salernitana-Roma	95,10	58,11	61,1%	27
Spezia-Empoli	96,10	55,58	58,2%	23
Verona-Napoli	98,50	48,30	49,1%	21
Juventus-Sassuolo	99,14	58,08	58,6%	12
Torino-Lazio	93,37	56,05	59,9%	23
Udinese-Salernitana	100,06	52,51	52,8%	21
Inter-Spezia	93,05	56,58	61,2%	18
Sassuolo-Lecce	98,01	54,41	55,8%	26
Empoli-Fiorentina	103,10	52,18	50,7%	24
Napoli-Monza	99,13	50,41	51,1%	24
Atalanta-Milan	97,26	57,33	59,1%	21
Bologna-Verona	100,48	45,08	44,8%	24
Roma-Cremonese	98,55	52,51	53,4%	21
Sampdoria-Juventus	97,29	54,41	56,1%	22
Monza-Udinese	94,08	51,40	54,9%	26
Lazio-Inter	98,01	59,26	60,6%	17
Cremonese-Torino	95,56	53,11	55,4%	30
Juventus-Roma	95,44	52,46	55,1%	23
Milan-Bologna	94,07	55,04	58,5%	22
Spezia-Sassuolo	99,04	56,24	56,9%	27
Salernitana-Sampdoria	95,12	52,57	55,6%	33
Verona-Atalanta	95,06	50,37	53,2%	22
Fiorentina-Napoli	95,08	61,59	65,2%	26
Lecce-Empoli	98,09	53,31	54,5%	15
Sassuolo-Milan	100,27	49,03	48,8%	27
Inter-Cremonese	94,15	52,10	55,3%	20
Roma-Monza	97,30	60,22	61,9%	17
Empoli-Verona	95,12	49,06	51,6%	27
Sampdoria-Lazio	101,33	60,16	59,3%	22
Udinese-Fiorentina	97,10	58,09	59,8%	25
Juventus-Spezia	98,48	55,35	56,3%	21
Napoli-Lecce	100,16	58,48	58,6%	27
Atalanta-Torino	97,14	52,42	54,2%	27
Bologna-Salernitana	94,04	52,32	55,8%	21
Fiorentina-Juventus	96,03	52,09	54,3%	25
Milan-Inter	97,08	48,47	50,2%	22
Lazio-Napoli	99,40	57,42	57,9%	26
Cremonese-Sassuolo	96,02	54,44	57,0%	22
Spezia-Bologna	102,56	52,16	50,8%	17
Verona-Sampdoria	99,21	48,36	48,9%	27
Udinese-Roma	98,05	53,37	54,7%	29
Monza-Atalanta	95,03	58,24	61,4%	19
Salernitana-Empoli	96,58	55,59	57,7%	16
Torino-Lecce	96,00	54,59	57,3%	24
Napoli-Spezia	98,03	53,04	54,1%	20
Inter-Torino	96,47	56,38	58,5%	25
Sampdoria-Milan	101,05	52,57	52,4%	22
Atalanta-Cremonese	95,08	53,32	56,3%	26
Bologna-Fiorentina	103,24	54,56	53,1%	21
Lecce-Monza	100,14	48,50	48,7%	40
Sassuolo-Udinese	98,36	50,55	51,6%	23
Lazio-Verona	98,45	53,02	53,7%	28
Juventus-Salernitana	106,27	54,17	51,0%	28
Empoli-Roma	99,17	49,19	49,7%	25
Salernitana-Lecce	99,21	57,41	58,1%	20
Bologna-Empoli	98,03	44,44	45,6%	27
Spezia-Sampdoria	95,05	47,58	50,4%	31
Torino-Sassuolo	96,28	60,38	62,9%	20
Udinese-Inter	98,18	50,46	51,6%	24
Cremonese-Lazio	97,10	51,09	52,6%	21
Fiorentina-Verona	98,05	47,21	48,3%	35
Monza-Juventus	100,28	55,57	55,7%	33
Roma-Atalanta	98,09	55,59	57,0%	28
Milan-Napoli	97,07	51,38	53,2%	29
Napoli-Torino	97,18	56,00	57,6%	21
Inter-Roma	99,37	56,56	57,2%	29
Empoli-Milan	101,43	45,28	44,7%	25
Lazio-Spezia	94,30	52,38	55,7%	17
Lecce-Cremonese	95,43	50,17	52,5%	26
Sampdoria-Monza	99,58	52,42	52,7%	40
Sassuolo-Salernitana	95,21	58,43	61,6%	18
Atalanta-Fiorentina	96,03	56,54	59,2%	22
Juventus-Bologna	92,02	54,59	59,7%	26
Verona-Udinese	99,10	51,57	52,4%	26
Sassuolo-Inter	95,28	55,39	58,3%	31
Milan-Juventus	97,29	57,25	58,9%	14
Bologna-Sampdoria	98,20	45,36	46,4%	38
Torino-Empoli	97,07	49,49	51,3%	24
Monza-Spezia	95,16	53,03	55,7%	30
Salernitana-Verona	101,45	54,44	53,8%	24
Udinese-Atalanta	95,05	51,25	54,1%	23
Cremonese-Napoli	97,57	52,42	53,8%	24
Roma-Lecce	98,06	52,11	53,2%	23
Fiorentina-Lazio	97,01	50,32	52,1%	26
Empoli-Monza	96,38	56,51	58,8%	31
Torino-Juventus	95,06	57,01	60,0%	19
Atalanta-Sassuolo	96,01	63,31	66,2%	18
Inter-Salernitana	94,05	51,14	54,5%	26
Lazio-Udinese	95,08	58,33	61,5%	19
Spezia-Cremonese	95,02	49,42	52,3%	23
Napoli-Bologna	95,01	57,28	60,5%	16
Verona-Milan	97,41	48,00	49,1%	16
Sampdoria-Roma	100,47	57,06	56,7%	40
Lecce-Fiorentina	98,23	54,26	55,3%	31
Juventus-Empoli	97,08	55,07	56,7%	24
Salernitana-Spezia	101,03	49,27	48,9%	17
Milan-Monza	94,03	55,59	59,5%	27
Fiorentina-Inter	100,53	48,44	48,3%	29
Udinese-Torino	95,18	50,56	53,4%	28
Bologna-Lecce	98,53	48,45	49,3%	26
Atalanta-Lazio	97,15	57,19	58,9%	24
Roma-Napoli	98,00	54,25	55,5%	26
Cremonese-Sampdoria	99,33	57,16	57,5%	31
Sassuolo-Verona	96,16	51,51	53,9%	26
Napoli-Sassuolo	93,54	54,44	58,3%	11
Lecce-Juventus	96,27	54,08	56,1%	29
Inter-Sampdoria	96,00	58,01	60,4%	17
Empoli-Atalanta	96,02	52,17	54,4%	26
Cremonese-Udinese	95,19	55,54	58,6%	17
Spezia-Fiorentina	97,53	43,41	44,6%	33
Lazio-Salernitana	97,42	60,43	62,1%	17
Torino-Milan	97,59	49,43	50,7%	27
Verona-Roma	98,13	55,01	56,0%	18
Monza-Bologna	95,07	56,52	59,8%	31
Udinese-Lecce	97,30	56,29	57,9%	30
Empoli-Sassuolo	98,03	58,24	59,6%	22
Salernitana-Cremonese	99,42	51,13	51,4%	24
Atalanta-Napoli	96,35	56,29	58,5%	19
Milan-Spezia	100,58	51,13	50,7%	25
Bologna-Torino	101,14	52,53	52,2%	31
Monza-Verona	98,07	53,03	54,1%	19
Sampdoria-Fiorentina	99,59	56,57	57,0%	28
Roma-Lazio	101,54	58,13	57,1%	32
Juventus-Inter	97,24	56,25	57,9%	29
Napoli-Empoli	95,13	53,21	56,0%	28
Spezia-Udinese	97,13	54,00	55,5%	24
Cremonese-Milan	95,58	57,02	59,4%	26
Lecce-Atalanta	97,22	55,37	57,1%	23
Sassuolo-Roma	96,02	58,52	61,3%	27
Fiorentina-Salernitana	95,16	57,59	60,9%	21
Inter-Bologna	94,01	53,34	57,0%	21
Torino-Sampdoria	94,38	49,55	52,7%	35
Verona-Juventus	95,56	50,14	52,4%	27
Lazio-Monza	96,09	58,38	61,0%	29
Empoli-Cremonese	99,03	56,52	57,4%	23
Napoli-Udinese	98,09	55,44	56,8%	25
Sampdoria-Lecce	96,43	46,00	47,6%	33
Bologna-Sassuolo	93,19	55,10	59,1%	18
Atalanta-Inter	97,10	53,30	55,1%	21
Monza-Salernitana	94,18	61,05	64,8%	20
Roma-Torino	99,34	57,35	57,8%	23
Verona-Spezia	101,35	46,30	45,8%	34
Milan-Fiorentina	99,02	55,35	56,1%	24
Juventus-Lazio	95,29	63,51	66,9%	18
Salernitana-Milan	100,38	46,41	46,4%	34
Sassuolo-Sampdoria	100,48	52,31	52,1%	35
Spezia-Atalanta	102,57	55,00	53,4%	22
Torino-Verona	99,03	60,42	61,3%	24
Lecce-Lazio	98,14	52,21	53,3%	29
Roma-Bologna	98,41	58,08	58,9%	20
Cremonese-Juventus	97,57	49,23	50,4%	24
Fiorentina-Monza	95,39	53,00	55,4%	24
Inter-Napoli	94,15	56,01	59,4%	19
Udinese-Empoli	96,41	56,20	58,3%	29
Fiorentina-Sassuolo	103,00	49,25	48,0%	23
Juventus-Udinese	94,55	55,29	58,5%	29
Monza-Inter	98,52	53,50	54,5%	34
Salernitana-Torino	97,13	52,44	54,2%	25
Lazio-Empoli	95,23	58,50	61,7%	27
Spezia-Lecce	94,15	47,41	50,6%	29
Sampdoria-Napoli	99,38	55,56	56,1%	27
Milan-Roma	98,48	51,20	52,0%	32
Verona-Cremonese	100,16	54,37	54,5%	27
Bologna-Atalanta	96,25	57,14	59,4%	31
Napoli-Juventus	95,10	52,37	55,3%	19
Cremonese-Monza	99,32	52,14	52,5%	24
Lecce-Milan	97,12	52,17	53,8%	23
Inter-Verona	96,20	55,07	57,2%	24
Sassuolo-Lazio	97,57	59,24	60,6%	27
Torino-Spezia	97,24	57,17	58,8%	25
Udinese-Bologna	100,27	47,11	47,0%	27
Atalanta-Salernitana	93,03	53,33	57,5%	22
Roma-Fiorentina	95,16	52,35	55,2%	27
Empoli-Sampdoria	104,32	52,46	50,5%	31
Verona-Lecce	101,29	48,33	47,8%	27
Salernitana-Napoli	97,50	57,27	58,7%	29
Fiorentina-Torino	97,00	61,20	63,2%	32
Sampdoria-Udinese	98,24	50,42	51,5%	32
Monza-Sassuolo	94,04	55,10	58,6%	35
Spezia-Roma	98,39	58,30	59,3%	28
Juventus-Atalanta	98,00	61,33	62,8%	15
Bologna-Cremonese	97,32	55,27	56,9%	24
Inter-Empoli	96,55	61,13	63,2%	29
Lazio-Milan	95,28	54,46	57,4%	25
Bologna-Spezia	97,24	55,40	57,2%	24
Lecce-Salernitana	101,22	55,40	54,9%	25
Empoli-Torino	94,02	55,04	58,6%	21
Cremonese-Inter	94,03	57,50	61,5%	19
Atalanta-Sampdoria	96,18	56,42	58,9%	28
Milan-Sassuolo	101,38	46,35	45,8%	21
Juventus-Monza	96,51	59,19	61,2%	22
Lazio-Fiorentina	96,27	59,39	61,8%	29
Napoli-Roma	100,08	57,09	57,1%	22
Udinese-Verona	95,59	51,46	53,9%	20
Cremonese-Lecce	98,11	55,51	56,9%	27
Roma-Empoli	97,58	54,19	55,4%	28
Sassuolo-Atalanta	98,24	61,52	62,9%	25
Spezia-Napoli	94,08	53,12	56,5%	37
Torino-Udinese	96,45	54,20	56,2%	21
Fiorentina-Bologna	97,90	50,30	51,3%	35
Inter-Milan	97,42	53,35	54,8%	27
Verona-Lazio	98,54	53,13	53,8%	28
Monza-Sampdoria	100,00	59,39	59,7%	24
Salernitana-Juventus	96,58	61,11	63,1%	21
Milan-Torino	95,03	54,37	57,5%	30
Empoli-Spezia	99,49	55,02	55,1%	23
Lecce-Roma	98,28	52,35	53,4%	32
Lazio-Atalanta	97,56	59,45	61,0%	26
Udinese-Sassuolo	98,37	56,07	56,9%	20
Bologna-Monza	98,46	51,03	51,7%	33
Juventus-Fiorentina	98,31	51,08	51,9%	28
Napoli-Cremonese	96,12	56,14	58,5%	14
Verona-Salernitana	98,48	49,41	50,3%	35
Sampdoria-Inter	96,45	60,20	62,4%	24
Sassuolo-Napoli	98,32	61,18	62,2%	22
Sampdoria-Bologna	103,52	54,27	52,4%	26
Monza-Milan	98,00	58,06	59,3%	28
Inter-Udinese	98,12	55,00	56,0%	28
Atalanta-Lecce	100,17	61,10	61,0%	22
Fiorentina-Empoli	100,48	48,17	47,9%	23
Salernitana-Lazio	94,58	59,36	62,8%	17
Spezia-Juventus	95,36	56,44	59,3%	17
Roma-Verona	100,15	53,43	53,6%	34
Torino-Cremonese	95,40	53,33	56,0%	21
Empoli-Napoli	97,22	50,57	52,3%	19
Lecce-Sassuolo	97,25	52,25	53,8%	24
Bologna-Inter	98,13	59,57	61,0%	21
Salernitana-Monza	102,27	57,03	55,7%	28
Udinese-Spezia	96,04	53,39	55,8%	27
Milan-Atalanta	95,06	56,05	59,0%	22
Verona-Fiorentina	95,16	53,43	56,4%	26
Lazio-Sampdoria	94,31	59,56	63,4%	23
Cremonese-Roma	99,53	57,41	57,8%	28
Juventus-Torino	98,29	56,38	57,5%	18
Napoli-Lazio	94,58	60,47	64,0%	21
Monza-Empoli	97,06	57,15	59,0%	22
Atalanta-Udinese	98,28	55,28	56,3%	24
Fiorentina-Milan	98,20	50,58	51,8%	29
Spezia-Verona	95,22	51,33	54,1%	13
Sampdoria-Salernitana	98,17	48,49	49,7%	31
Inter-Lecce	96,18	51,54	53,9%	21
Roma-Juventus	99,03	59,10	59,7%	21
Sassuolo-Cremonese	98,06	54,11	55,2%	20
Torino-Bologna	93,56	59,41	63,5%	19
Spezia-Inter	98,52	53,09	53,8%	20
Empoli-Udinese	100,06	51,01	51,0%	25
Napoli-Atalanta	97,03	56,56	58,7%	23
Bologna-Lazio	96,09	60,45	63,2%	19
Lecce-Torino	97,12	53,24	54,9%	33
Cremonese-Fiorentina	93,21	54,16	58,1%	27
Verona-Monza	94,29	60,52	64,4%	29
Roma-Sassuolo	103,00	55,02	53,4%	29
Juventus-Sampdoria	96,13	55,56	58,1%	20
Milan-Salernitana	100,12	55,20	55,2%	28
Sassuolo-Spezia	97,10	58,38	60,3%	23
Atalanta-Empoli	99,01	55,57	56,5%	21
Monza-Cremonese	97,05	58,55	60,7%	24
Salernitana-Bologna	95,28	54,40	57,3%	24
Udinese-Milan	103,11	50,07	48,6%	25
Sampdoria-Verona	99,33	50,57	51,2%	21
Fiorentina-Lecce	95,03	50,51	53,5%	35
Torino-Napoli	92,25	47,52	51,8%	28
Lazio-Roma	99,10	54,46	55,2%	31
Inter-Juventus	103,11	57,20	55,6%	24
Cremonese-Atalanta	96,08	59,05	61,5%	23
Inter-Fiorentina	98,48	54,16	54,9%	15
Juventus-Verona	94,58	52,56	55,7%	36
Bologna-Udinese	98,27	54,27	55,3%	27
Monza-Lazio	94,01	61,24	65,3%	21
Spezia-Salernitana	100,12	48,50	48,7%	24
Roma-Sampdoria	97,16	53,02	54,5%	24
Napoli-Milan	96,00	56,24	58,8%	20
Empoli-Lecce	98,16	49,51	50,7%	25
Sassuolo-Torino	96,09	59,27	61,8%	21
Salernitana-Inter	97,19	56,44	58,3%	24
Lecce-Napoli	98,37	59,11	60,0%	21
Milan-Empoli	98,33	60,45	61,6%	19
Udinese-Monza	99,31	60,18	60,6%	33
Fiorentina-Spezia	99,26	53,48	54,1%	41
Atalanta-Bologna	96,04	60,35	63,1%	11
Sampdoria-Cremonese	100,21	52,52	52,7%	29
Torino-Roma	97,03	58,26	60,2%	16
Verona-Sassuolo	96,51	51,33	53,2%	26
Lazio-Juventus	100,13	54,17	54,2%	26
Cremonese-Empoli	99,23	57,35	57,9%	20
Spezia-Lazio	98,12	61,50	63,0%	19
Bologna-Milan	93,12	52,34	56,4%	29
Napoli-Verona	95,41	60,26	63,2%	26
Inter-Monza	96,06	60,58	63,4%	17
Lecce-Sampdoria	95,18	48,37	51,0%	28
Torino-Salernitana	94,39	52,34	55,5%	28
Sassuolo-Juventus	95,24	58,40	61,5%	15
Roma-Udinese	100,10	49,44	49,7%	29
Fiorentina-Atalanta	98,35	52,11	52,9%	28
Verona-Bologna	109,13	59,01	54,0%	22
Salernitana-Sassuolo	94,01	53,04	56,4%	26
Lazio-Torino	97,03	62,52	64,8%	26
Sampdoria-Spezia	104,43	49,43	47,5%	20
Empoli-Inter	96,14	60,31	62,9%	19
Monza-Fiorentina	99,11	51,52	52,3%	33
Udinese-Cremonese	98,13	53,12	54,2%	24
Milan-Lecce	99,35	61,50	62,1%	16
Juventus-Napoli	100,33	55,19	55,0%	26
Atalanta-Roma	101,48	55,09	54,2%	26
Lecce-Udinese	98,07	51,46	52,8%	33
Spezia-Monza	95,59	59,37	62,1%	26
Roma-Milan	106,06	55,52	52,7%	15
Torino-Atalanta	95,01	60,51	64,0%	16
Inter-Lazio	99,02	58,38	59,2%	27
Cremonese-Verona	100,26	52,44	52,5%	26
Napoli-Salernitana	98,00	56,39	57,8%	24
Sassuolo-Empoli	98,39	57,10	57,9%	22
Fiorentina-Sampdoria	94,18	50,09	53,2%	23
Bologna-Juventus	99,05	57,34	58,1%	21
Atalanta-Spezia	97,38	56,53	58,3%	18
Juventus-Lecce	99,24	52,07	52,4%	21
Salernitana-Fiorentina	95,18	45,49	48,1%	33
Sampdoria-Torino	98,54	61,12	61,9%	25
Lazio-Sassuolo	98,49	57,31	58,2%	26
Milan-Cremonese	99,23	58,52	59,2%	24
Monza-Roma	97,16	51,54	53,4%	28
Verona-Inter	94,54	58,43	61,9%	15
Empoli-Bologna	100,03	48,51	48,8%	31
Udinese-Napoli	94,20	52,08	55,3%	28
Milan-Lazio	97,04	59,23	61,2%	18
Roma-Inter	101,50	59,53	58,8%	20
Cremonese-Spezia	95,15	55,58	58,8%	14
Atalanta-Juventus	100,30	59,59	59,7%	29
Torino-Monza	99,50	56,03	56,1%	25
Napoli-Fiorentina	94,18	53,11	56,4%	27
Lecce-Verona	97,09	48,08	49,5%	24
Empoli-Salernitana	98,47	50,45	51,4%	28
Udinese-Sampdoria	96,07	56,40	59,0%	27
Sassuolo-Bologna	93,41	62,02	66,2%	26
Lazio-Lecce	100,13	57,09	57,0%	24
Salernitana-Atalanta	97,45	54,00	55,2%	27
Spezia-Milan	97,04	48,31	50,0%	26
Inter-Sassuolo	96,00	61,47	64,4%	20
Verona-Torino	97,47	57,53	59,2%	25
Fiorentina-Udinese	98,55	52,30	53,1%	30
Monza-Napoli	96,31	57,38	59,7%	24
Bologna-Roma	97,29	57,36	59,1%	23
Juventus-Cremonese	96,38	59,54	62,0%	20
Sampdoria-Empoli	97,02	53,49	55,5%	30
Sassuolo-Monza	103,39	59,24	57,3%	27
Cremonese-Bologna	94,18	56,39	60,1%	20
Atalanta-Verona	96,01	58,18	60,7%	20
Milan-Sampdoria	90,04	56,23	62,6%	19
Lecce-Spezia	95,53	45,44	47,7%	31
Torino-Fiorentina	95,23	58,00	60,8%	20
Napoli-Inter	95,54	63,07	65,8%	24
Udinese-Lazio	96,36	59,44	61,8%	24
Roma-Salernitana	104,54	58,47	56,0%	23
Empoli-Juventus	97,56	50,29	51,5%	39
Sampdoria-Sassuolo	96,07	55,21	57,6%	24
Salernitana-Udinese	102,34	52,24	51,1%	34
Spezia-Torino	100,44	47,48	47,5%	27
Fiorentina-Roma	99,21	55,33	55,9%	23
Inter-Atalanta	96,27	55,53	57,9%	26
Verona-Empoli	102,42	52,14	50,9%	24
Bologna-Napoli	99,38	57,29	57,7%	27
Monza-Lecce	103,09	54,47	53,1%	31
Lazio-Cremonese	95,59	60,12	62,7%	23
Juventus-Milan	96,09	59,10	61,5%	22
Sassuolo-Fiorentina	94,20	50,49	53,9%	22
Torino-Inter	95,10	62,16	65,4%	13
Cremonese-Salernitana	105,01	58,10	55,4%	27
Empoli-Lazio	94,14	58,58	62,6%	17
Napoli-Sampdoria	92,12	59,28	64,5%	14
Atalanta-Monza	99,12	61,36	62,1%	21
Lecce-Bologna	99,17	58,12	58,6%	20
Milan-Verona	100,48	51,00	50,6%	23
Roma-Spezia	105,18	52,48	50,1%	31
Udinese-Juventus	96,52	55,59	57,8%	20`;

        const MATCHES_DB_2324 = `Empoli-Verona	99,21	46,08	46,4%	35
Frosinone-Napoli	99,55	54,42	54,7%	31
Genoa-Fiorentina	96,55	56,01	57,8%	27
Inter-Monza	99,29	60,33	60,9%	21
Roma-Salernitana	102,41	51,39	50,3%	21
Sassuolo-Atalanta	99,58	63,12	63,2%	22
Lecce-Lazio	97,14	59,32	61,2%	28
Udinese-Juventus	101,04	59,09	58,5%	22
Torino-Cagliari	98,13	54,30	55,5%	20
Bologna-Milan	99,01	61,21	62,0%	14
Frosinone-Atalanta	103,43	59,15	57,1%	20
Monza-Empoli	100,42	60,01	59,6%	21
Milan-Torino	102,27	58,08	56,7%	29
Verona-Roma	109,47	47,45	43,5%	29
Fiorentina-Lecce	103,40	52,18	50,5%	31
Juventus-Bologna	99,29	57,01	57,3%	28
Lazio-Genoa	104,49	64,39	61,7%	25
Napoli-Sassuolo	102,02	59,34	58,4%	19
Salernitana-Udinese	99,41	50,22	50,5%	31
Cagliari-Inter	98,01	61,27	62,7%	19
Sassuolo-Verona	101,51	55,29	54,5%	21
Roma-Milan	101,11	58,15	57,6%	29
Bologna-Cagliari	100,28	61,31	61,2%	22
Udinese-Frosinone	98,52	50,30	51,1%	23
Atalanta-Monza	95,52	62,09	64,8%	20
Napoli-Lazio	101,04	57,51	57,2%	17
Inter-Fiorentina	100,37	56,24	56,1%	25
Torino-Genoa	101,56	53,20	52,3%	20
Empoli-Juventus	100,14	58,45	58,6%	27
Lecce-Salernitana	105,18	50,48	48,2%	32
Juventus-Lazio	99,36	55,14	55,5%	26
Inter-Milan	97,15	52,42	54,2%	29
Genoa-Napoli	98,23	56,24	57,3%	22
Cagliari-Udinese	102,53	53,02	51,5%	23
Monza-Lecce	102,52	56,12	54,6%	28
Frosinone-Sassuolo	104,49	50,42	48,4%	19
Fiorentina-Atalanta	102,23	58,41	57,3%	22
Roma-Empoli	96,12	60,43	63,1%	20
Salernitana-Torino	99,02	57,54	58,5%	28
Verona-Bologna	99,28	56,51	57,2%	28
Salernitana-Frosinone	100,46	50,43	50,3%	24
Lecce-Genoa	96,57	52,36	54,3%	22
Milan-Verona	98,03	55,20	56,4%	23
Sassuolo-Juventus	100,39	53,58	53,6%	21
Lazio-Monza	96,15	62,07	64,5%	20
Empoli-Inter	95,06	54,22	57,2%	26
Atalanta-Cagliari	95,57	58,05	60,5%	17
Udinese-Fiorentina	98,32	52,45	53,5%	24
Bologna-Napoli	98,44	55,40	56,4%	28
Torino-Roma	96,56	59,55	61,8%	10
Juventus-Lecce	97,28	56,55	58,4%	29
Cagliari-Milan	98,22	64,12	65,3%	19
Empoli-Salernitana	101,16	49,34	48,9%	31
Verona-Atalanta	96,16	51,29	53,5%	35
Inter-Sassuolo	99,58	59,56	60,0%	18
Lazio-Torino	100,25	62,40	62,4%	25
Napoli-Udinese	96,00	52,40	54,9%	21
Frosinone-Fiorentina	97,38	53,59	55,3%	17
Monza-Bologna	98,50	62,37	63,4%	24
Genoa-Roma	101,47	57,27	56,4%	19
Lecce-Napoli	96,05	55,45	58,0%	22
Milan-Lazio	97,45	60,07	61,5%	20
Salernitana-Inter	93,34	52,50	56,5%	22
Bologna-Empoli	102,34	55,29	54,1%	27
Udinese-Genoa	98,14	49,51	50,7%	24
Atalanta-Juventus	95,16	63,08	66,3%	20
Roma-Frosinone	100,55	52,22	51,9%	23
Sassuolo-Monza	97,23	59,07	60,7%	18
Torino-Verona	98,05	54,31	55,6%	17
Fiorentina-Cagliari	98,06	63,31	64,7%	20
Empoli-Udinese	98,16	50,23	51,3%	26
Lecce-Sassuolo	98,55	53,04	53,6%	24
Inter-Bologna	97,59	56,14	57,4%	20
Juventus-Torino	97,20	56,52	58,4%	18
Genoa-Milan	105,18	60,54	57,8%	23
Monza-Salernitana	96,07	54,47	57,0%	24
Frosinone-Verona	103,56	53,23	51,4%	20
Lazio-Atalanta	97,59	57,25	58,6%	17
Cagliari-Roma	97,02	50,25	52,0%	28
Napoli-Fiorentina	101,28	62,58	62,1%	18
Verona-Napoli	96,56	54,13	55,9%	21
Torino-Inter	98,12	51,43	52,7%	21
Sassuolo-Lazio	98,48	62,48	63,6%	16
Roma-Monza	104,17	57,35	55,2%	22
Bologna-Frosinone	97,24	49,58	51,3%	24
Salernitana-Cagliari	102,15	46,39	45,6%	23
Atalanta-Genoa	97,51	56,59	58,2%	26
Milan-Juventus	99,02	56,39	57,2%	28
Udinese-Lecce	98,00	51,07	52,2%	26
Fiorentina-Empoli	100,10	56,24	56,3%	30
Genoa-Salernitana	98,55	51,39	52,2%	30
Sassuolo-Bologna	96,39	61,34	63,7%	21
Lecce-Torino	100,03	59,31	59,5%	36
Juventus-Verona	101,37	58,07	57,2%	21
Cagliari-Frosinone	103,20	55,07	53,3%	15
Monza-Udinese	96,51	61,42	63,7%	26
Inter-Roma	97,58	53,56	55,1%	23
Napoli-Milan	99,17	57,53	58,3%	24
Empoli-Atalanta	95,12	56,34	59,4%	23
Lazio-Fiorentina	96,51	58,15	60,1%	29
Bologna-Lazio	97,02	59,39	61,5%	20
Salernitana-Napoli	94,53	54,06	57,0%	25
Atalanta-Inter	102,48	58,24	56,8%	22
Milan-Udinese	98,34	52,57	53,7%	26
Verona-Monza	96,59	59,14	61,1%	18
Cagliari-Genoa	98,48	53,54	54,6%	25
Roma-Lecce	100,17	54,37	54,5%	29
Fiorentina-Juventus	98,51	53,38	54,3%	33
Frosinone-Empoli	97,55	56,58	58,2%	16
Torino-Sassuolo	98,54	58,33	59,2%	15
Sassuolo-Salernitana	96,03	60,26	62,9%	26
Genoa-Verona	98,00	51,24	52,4%	25
Lecce-Milan	98,44	55,07	55,8%	28
Juventus-Cagliari	95,18	52,31	55,1%	22
Monza-Torino	95,27	59,43	62,6%	22
Napoli-Empoli	97,28	55,54	57,4%	24
Udinese-Atalanta	97,19	51,55	53,3%	27
Fiorentina-Bologna	101,41	51,18	50,5%	34
Lazio-Roma	94,00	58,29	62,2%	25
Inter-Frosinone	96,31	59,01	61,1%	23
Salernitana-Lazio	98,32	49,47	50,5%	23
Atalanta-Napoli	99,03	54,18	54,8%	24
Milan-Fiorentina	101,27	60,10	59,3%	19
Cagliari-Monza	95,06	53,02	55,8%	25
Empoli-Sassuolo	97,12	48,39	50,1%	35
Frosinone-Genoa	99,45	59,06	59,2%	19
Roma-Udinese	97,37	54,46	56,1%	23
Juventus-Inter	94,59	64,12	67,6%	25
Verona-Lecce	94,39	47,16	49,9%	32
Bologna-Torino	97,03	51,44	53,3%	31
Monza-Juventus	100,07	62,44	62,7%	20
Genoa-Empoli	95,40	49,47	52,0%	34
Lazio-Cagliari	96,39	60,53	63,0%	23
Milan-Frosinone	96,34	56,34	58,6%	17
Lecce-Bologna	100,50	57,07	56,6%	30
Fiorentina-Salernitana	93,56	56,49	60,5%	25
Udinese-Verona	103,54	47,56	46,1%	29
Sassuolo-Roma	98,45	59,05	59,8%	21
Napoli-Inter	95,58	54,55	57,2%	15
Torino-Atalanta	96,47	57,58	59,9%	26
Juventus-Napoli	97,06	55,54	57,6%	23
Verona-Lazio	97,08	53,42	55,3%	27
Atalanta-Milan	102,10	63,08	61,8%	22
Inter-Udinese	95,53	61,59	64,6%	15
Frosinone-Torino	100,00	52,31	52,5%	30
Monza-Genoa	94,36	56,26	59,7%	24
Salernitana-Bologna	99,41	59,33	59,7%	35
Roma-Fiorentina	101,06	56,44	56,1%	28
Empoli-Lecce	97,35	51,09	52,4%	32
Cagliari-Sassuolo	101,59	48,08	47,2%	30
Genoa-Juventus	94,57	48,40	51,3%	26
Lecce-Frosinone	101,10	53,51	53,2%	22
Napoli-Cagliari	101,25	53,56	53,2%	19
Torino-Empoli	100,52	54,31	54,0%	25
Milan-Monza	95,47	59,25	62,0%	16
Fiorentina-Verona	95,38	49,50	52,1%	24
Udinese-Sassuolo	98,36	55,02	55,8%	19
Bologna-Roma	94,59	56,23	59,4%	32
Lazio-Inter	99,57	58,58	59,0%	28
Atalanta-Salernitana	97,13	56,33	58,2%	20
Sassuolo-Genoa	96,21	57,20	59,5%	20
Empoli-Lazio	96,28	48,21	50,1%	23
Monza-Fiorentina	96,33	57,46	59,8%	28
Salernitana-Milan	98,53	50,34	51,1%	27
Frosinone-Juventus	98,19	51,27	52,3%	18
Torino-Udinese	95,54	52,46	55,0%	21
Bologna-Atalanta	97,50	58,35	59,9%	24
Inter-Lecce	96,01	55,18	57,6%	22
Verona-Cagliari	97,21	52,53	54,3%	28
Roma-Napoli	100,42	49,29	49,1%	31
Fiorentina-Torino	97,03	48,08	49,6%	26
Napoli-Monza	97,04	56,21	58,1%	31
Genoa-Inter	108,16	52,13	48,2%	28
Lazio-Frosinone	98,14	50,59	51,9%	33
Atalanta-Lecce	96,08	53,59	56,2%	26
Cagliari-Empoli	106,57	44,15	41,4%	36
Udinese-Bologna	99,41	52,22	52,5%	29
Milan-Sassuolo	96,04	59,53	62,3%	15
Verona-Salernitana	99,25	47,48	48,1%	27
Juventus-Roma	96,40	60,48	62,9%	29
Bologna-Genoa	98,42	61,26	62,2%	18
Inter-Verona	102,32	53,26	52,1%	31
Frosinone-Monza	103,34	54,01	52,2%	27
Lecce-Cagliari	95,37	46,52	49,0%	34
Sassuolo-Fiorentina	99,56	48,08	48,2%	24
Empoli-Milan	96,28	56,22	58,4%	22
Torino-Napoli	94,21	53,30	56,7%	17
Udinese-Lazio	99,31	50,15	50,5%	38
Salernitana-Juventus	96,25	51,52	53,8%	24
Roma-Atalanta	102,52	51,16	49,8%	28
Genoa-Torino	97,34	52,28	53,8%	22
Napoli-Salernitana	105,35	59,33	56,4%	25
Verona-Empoli	97,03	48,26	49,9%	37
Monza-Inter	97,54	51,13	52,3%	20
Lazio-Lecce	96,03	58,16	60,7%	26
Cagliari-Bologna	98,10	60,10	61,3%	20
Fiorentina-Udinese	96,39	53,58	55,8%	27
Milan-Roma	96,07	59,28	61,9%	21
Atalanta-Frosinone	96,15	57,30	59,7%	19
Juventus-Sassuolo	94,26	62,35	66,3%	18
Roma-Verona	97,57	58,09	59,4%	26
Udinese-Milan	103,58	52,19	50,3%	21
Frosinone-Cagliari	105,26	51,07	48,5%	29
Empoli-Monza	96,07	58,54	61,3%	25
Salernitana-Genoa	97,46	53,22	54,6%	22
Lecce-Juventus	95,35	57,23	60,0%	20
Bologna-Fiorentina	102,04	57,05	55,9%	19
Torino-Lazio	96,14	56,30	58,7%	18
Sassuolo-Napoli	93,22	59,15	63,5%	8
Inter-Atalanta	98,04	54,21	55,4%	25
Cagliari-Torino	100,30	55,36	55,3%	24
Atalanta-Udinese	94,59	58,21	61,4%	19
Juventus-Empoli	97,12	61,22	63,1%	17
Milan-Bologna	98,58	56,10	56,8%	28
Genoa-Lecce	95,17	50,58	53,5%	29
Monza-Sassuolo	102,17	60,06	58,8%	21
Verona-Frosinone	99,33	51,00	51,2%	29
Lazio-Napoli	95,32	58,48	61,5%	22
Fiorentina-Inter	97,27	57,56	59,4%	18
Salernitana-Roma	99,04	58,21	58,9%	24
Lecce-Fiorentina	98,54	50,53	51,4%	28
Empoli-Genoa	94,20	53,24	56,6%	23
Udinese-Monza	94,07	58,18	61,9%	25
Frosinone-Milan	98,08	56,24	57,5%	23
Bologna-Sassuolo	94,58	58,37	61,7%	21
Torino-Salernitana	99,58	52,35	52,6%	19
Napoli-Verona	97,27	55,37	57,1%	25
Atalanta-Lazio	95,26	61,00	63,9%	27
Inter-Juventus	96,12	61,56	64,4%	16
Roma-Cagliari	94,55	53,25	56,3%	20
Salernitana-Empoli	99,03	55,59	56,5%	27
Cagliari-Lazio	96,51	62,39	64,7%	15
Roma-Inter	99,25	56,29	56,8%	23
Sassuolo-Torino	97,51	55,27	56,7%	23
Fiorentina-Frosinone	94,06	49,36	52,7%	24
Bologna-Lecce	94,01	56,30	60,1%	23
Monza-Verona	95,14	52,14	54,8%	34
Genoa-Atalanta	105,20	59,21	56,3%	21
Milan-Napoli	99,17	57,34	58,0%	21
Juventus-Udinese	97,06	53,48	55,4%	25
Torino-Lecce	93,56	55,58	59,6%	27
Inter-Salernitana	90,59	49,49	54,8%	18
Napoli-Genoa	100,04	60,03	60,0%	22
Verona-Juventus	99,13	55,50	56,3%	18
Atalanta-Sassuolo	98,09	58,31	59,6%	19
Lazio-Bologna	97,21	59,55	61,5%	16
Udinese-Cagliari	96,45	54,43	56,6%	24
Empoli-Fiorentina	99,23	54,12	54,5%	29
Frosinone-Roma	95,25	55,20	58,0%	26
Monza-Milan	106,06	59,16	55,9%	21
Bologna-Verona	100,58	48,23	47,9%	27
Sassuolo-Empoli	97,59	50,55	52,0%	26
Salernitana-Monza	94,13	55,36	59,0%	19
Genoa-Udinese	94,58	57,10	60,2%	26
Juventus-Frosinone	97,36	60,28	62,0%	18
Cagliari-Napoli	101,14	51,20	50,7%	24
Lecce-Inter	92,38	55,32	59,9%	19
Milan-Atalanta	98,53	60,42	61,4%	28
Roma-Torino	97,17	58,54	60,5%	28
Fiorentina-Lazio	97,33	59,08	60,6%	27
Lazio-Milan	98,51	50,51	51,4%	36
Udinese-Salernitana	98,08	48,02	48,9%	26
Monza-Roma	100,15	53,48	53,7%	29
Torino-Fiorentina	104,19	47,24	45,4%	26
Verona-Sassuolo	97,44	45,54	47,0%	33
Empoli-Cagliari	101,50	54,32	53,6%	26
Frosinone-Lecce	100,49	48,32	48,1%	21
Atalanta-Bologna	94,24	59,08	62,6%	23
Napoli-Juventus	96,43	54,25	56,3%	22
Inter-Genoa	96,58	58,27	60,3%	22
Napoli-Torino	101,16	53,02	52,4%	22
Cagliari-Salernitana	95,12	48,22	50,8%	27
Sassuolo-Frosinone	99,51	58,45	58,8%	23
Bologna-Inter	97,56	62,01	63,3%	30
Genoa-Monza	99,01	53,08	53,7%	21
Lecce-Verona	100,43	42,55	42,6%	34
Milan-Empoli	96,50	59,52	61,8%	31
Juventus-Atalanta	93,55	60,20	64,2%	22
Fiorentina-Roma	96,24	54,50	56,9%	25
Lazio-Udinese	103,21	52,07	50,4%	24
Empoli-Bologna	96,48	56,08	58,0%	31
Monza-Cagliari	96,46	58,56	60,9%	19
Udinese-Torino	96,10	53,37	55,8%	28
Salernitana-Lecce	98,06	62,41	63,9%	27
Frosinone-Lazio	102,15	54,06	52,9%	26
Juventus-Genoa	96,29	57,25	59,5%	22
Verona-Milan	97,13	55,56	57,5%	17
Roma-Sassuolo	97,10	61,01	62,8%	21
Inter-Napoli	94,30	52,10	55,2%	25
Atalanta-Fiorentina	96,21	55,19	57,4%	14
Napoli-Atalanta	96,46	56,59	58,9%	19
Genoa-Frosinone	98,47	49,53	50,5%	27
Torino-Monza	95,59	56,58	59,4%	20
Lazio-Juventus	94,44	58,20	61,6%	22
Fiorentina-Milan	96,04	55,50	58,1%	20
Bologna-Salernitana	96,16	62,10	64,6%	23
Cagliari-Verona	99,12	48,35	49,0%	27
Sassuolo-Udinese	94,33	56,17	59,5%	17
Lecce-Roma	97,04	55,14	56,9%	21
Inter-Empoli	94,02	56,34	60,2%	30
Salernitana-Sassuolo	98,09	58,03	59,1%	23
Milan-Lecce	98,14	60,57	62,0%	16
Roma-Lazio	97,38	55,08	56,5%	29
Empoli-Torino	98,45	51,38	52,3%	26
Frosinone-Bologna	95,31	54,38	57,2%	24
Monza-Napoli	100,09	55,36	55,5%	18
Cagliari-Atalanta	98,40	48,55	49,6%	35
Verona-Genoa	96,52	52,13	53,9%	29
Juventus-Fiorentina	96,26	58,49	61,0%	24
Udinese-Inter	101,09	55,22	54,7%	22
Lazio-Salernitana	98,26	53,45	54,6%	25
Lecce-Empoli	98,22	45,17	46,0%	33
Torino-Juventus	102,32	55,15	53,9%	29
Bologna-Monza	96,13	55,41	57,9%	32
Napoli-Frosinone	101,31	52,04	51,3%	25
Sassuolo-Milan	99,11	51,32	52,0%	21
Inter-Cagliari	96,23	60,21	62,6%	15
Fiorentina-Genoa	101,03	50,47	50,3%	27
Atalanta-Verona	96,10	51,43	53,8%	16
Udinese-Roma	97,33	60,48	62,3%	25
Genoa-Lazio	95,31	61,03	63,9%	20
Cagliari-Juventus	101,38	52,34	51,7%	31
Empoli-Napoli	95,01	54,55	57,8%	26
Verona-Udinese	95,48	41,18	43,1%	30
Sassuolo-Lecce	93,57	52,19	55,7%	23
Torino-Frosinone	93,55	52,29	55,9%	27
Salernitana-Fiorentina	95,52	54,16	56,6%	24
Monza-Atalanta	99,31	59,19	59,6%	21
Roma-Bologna	99,13	60,27	60,9%	20
Milan-Inter	98,24	57,40	58,6%	29
Frosinone-Salernitana	95,07	51,27	54,1%	24
Lecce-Monza	98,44	55,15	56,0%	31
Juventus-Milan	96,27	59,24	61,6%	14
Lazio-Verona	95,27	46,20	48,5%	31
Inter-Torino	97,12	64,08	66,0%	14
Bologna-Udinese	100,23	56,18	56,1%	32
Napoli-Roma	96,22	55,33	57,6%	16
Atalanta-Empoli	96,56	49,43	51,3%	33
Fiorentina-Sassuolo	90,04	56,38	62,9%	18
Genoa-Cagliari	94,29	51,43	54,7%	26
Torino-Bologna	96,12	58,31	60,8%	25
Monza-Lazio	98,30	60,46	61,7%	21
Sassuolo-Inter	97,46	56,22	57,7%	20
Cagliari-Lecce	100,05	43,30	43,5%	24
Empoli-Frosinone	95,38	42,05	44,0%	26
Verona-Fiorentina	98,51	52,25	53,0%	23
Milan-Genoa	96,19	57,57	60,2%	18
Roma-Juventus	95,14	55,45	58,5%	17
Salernitana-Atalanta	97,54	57,27	58,7%	22
Udinese-Napoli	97,29	50,45	52,1%	23
Frosinone-Inter	93,01	60,04	64,6%	12
Napoli-Bologna	95,29	55,41	58,3%	27
Milan-Cagliari	93,51	60,14	64,2%	20
Lazio-Empoli	99,19	50,11	50,5%	33
Genoa-Sassuolo	100,12	56,15	56,1%	23
Verona-Torino	96,47	50,21	52,0%	34
Juventus-Salernitana	101,22	50,09	49,5%	27
Atalanta-Roma	94,59	56,50	59,8%	22
Lecce-Udinese	96,32	51,54	53,8%	23
Fiorentina-Monza	96,09	58,10	60,5%	23
Fiorentina-Napoli	97,25	49,59	51,3%	30
Lecce-Atalanta	94,05	60,31	64,3%	27
Torino-Milan	96,59	51,34	53,2%	29
Sassuolo-Cagliari	98,22	46,30	47,3%	23
Monza-Frosinone	98,27	56,44	57,6%	27
Udinese-Empoli	109,17	43,50	40,1%	32
Inter-Lazio	95,28	57,57	60,7%	25
Roma-Genoa	95,34	57,55	60,6%	20
Salernitana-Verona	99,51	47,38	47,7%	33
Bologna-Juventus	93,14	53,52	57,8%	29
Cagliari-Fiorentina	106,39	46,55	44,0%	27
Genoa-Bologna	96,22	51,39	53,6%	22
Juventus-Monza	98,03	56,01	57,1%	28
Milan-Salernitana	96,34	51,01	52,8%	17
Napoli-Lecce	95,05	61,57	65,2%	27
Atalanta-Torino	94,16	57,03	60,5%	28
Lazio-Sassuolo	93,51	59,18	63,2%	26
Verona-Inter	95,11	56,36	59,5%	25
Empoli-Roma	99,33	55,35	55,8%	30
Frosinone-Udinese	99,30	45,00	45,2%	19`; 


        const MATCHES_DB_2425 = `Genoa-Inter	103,10	46,39	45,0%	29
Parma-Fiorentina	97,04	48,46	49,9%	24
Empoli-Monza	100,37	44,43	44,3%	35
Milan-Torino	101,58	58,27	57,4%	17
Bologna-Udinese	100,25	48,59	48,5%	28
Verona-Napoli	101,32	48,53	47,9%	28
Cagliari-Roma	94,22	53,36	56,6%	22
Lazio-Venezia	96,00	56,00	58,3%	25
Lecce-Atalanta	92,58	54,12	58,5%	34
Juventus-Como	99,04	56,43	57,0%	23
Parma-Milan	98,04	59,00	60,2%	22
Udinese-Lazio	103,14	49,49	48,0%	25
Inter-Lecce	98,08	56,21	57,3%	21
Monza-Genoa	105,55	56,58	53,6%	23
Torino-Atalanta	103,21	51,08	49,5%	25
Fiorentina-Venezia	97,03	55,29	57,0%	34
Napoli-Bologna	101,09	53,23	52,7%	28
Roma-Empoli	97,20	58,22	59,9%	21
Cagliari-Como	100,35	53,12	52,9%	22
Verona-Juventus	97,02	61,58	63,5%	16
Venezia-Torino	99,08	52,45	52,9%	22
Inter-Atalanta 	97,01	53,40	55,0%	21
Bologna-Empoli 	103,12	55,44	53,8%	33
Lecce-Cagliari	100,37	47,36	47,2%	23
Lazio-Milan	97,00	54,06	55,7%	21
Napoli-Parma	109,08	60,21	55,2%	18
Fiorentina-Monza	103,20	54,53	52,8%	32
Genoa-Verona	99,33	51,32	51,7%	24
Juventus-Roma	96,58	58,50	60,6%	23
Udinese-Como	103,30	54,24	52,5%	25
Como-Bologna	103,14	54,03	52,4%	29
Empoli-Juventus	95,14	60,04	63,1%	21
Milan-Venezia	97,55	57,21	58,6%	24
Genoa-Roma	104,11	53,12	51,0%	21
Atalanta-Fiorentina	95,42	51,04	53,5%	31
Torino-Lecce	95,10	54,31	57,1%	26
Cagliari-Napoli	102,10	50,07	49,0%	33
Monza-Inter	95,18	57,28	60,2%	30
Parma-Udinese	96,05	53,01	55,2%	26
Lazio-Verona	96,07	56,25	58,6%	23
Cagliari-Empoli	97,05	48,44	49,9%	36
Verona-Torino	97,05	60,20	62,0%	18
Venezia-Genoa	100,20	48,20	48,1%	21
Juventus-Napoli	96,26	64,10	66,6%	23
Lecce-Parma	98,37	54,32	55,2%	33
Fiorentina-Lazio	97,15	52,35	53,9%	26
Monza-Bologna	95,05	55,34	58,2%	36
Roma-Udinese	95,00	55,33	58,2%	26
Inter-Milan	97,50	55,33	56,7%	17
Atalanta-Como	98,35	58,21	59,2%	29
Milan-Lecce	96,02	55,41	57,7%	13
Udinese-Inter	98,00	61,58	62,8%	19
Genoa-Juventus	95,10	58,44	61,5%	22
Bologna-Atalanta	97,44	57,29	58,8%	28
Torino-Lazio	96,10	57,06	59,4%	23
Como-Verona	96,57	49,47	51,2%	29
Roma-Venezia	96,08	52,36	54,5%	21
Empoli-Fiorentina	94,11	54,28	57,7%	27
Napoli-Monza	95,57	60,33	63,1%	24
Parma-Cagliari	95,58	55,21	57,8%	26
Napoli-Como	96,28	59,25	61,5%	17
Verona-Venezia	95,02	47,29	49,8%	15	
Udinese-Lecce	95,50	55,10	57,7%	28
Atalanta-Genoa	95,55	55,41	58,0%	24
Inter-Torino	98,30	54,09	55,0%	15
Juventus-Cagliari	99,01	60,08	60,7%	23
Bologna-Parma	95,58	54,55	57,1%	31
Lazio-Empoli	100,48	53,07	52,8%	27
Monza-Roma	99,08	56,25	56,8%	29
Fiorentina-Milan	97,26	48,43	49,8%	33
Como-Parma	96,09	60,51	63,0%	24
Genoa-Bologna	95,51	47,58	49,8%	32
Milan-Udinese	106,27	52,59	49,5%	17
Juventus-Lazio	97,31	56,44	58,0%	25
Empoli-Napoli	96,05	51,43	53,5%	27
Lecce-Fiorentina	93,03	53,12	57,1%	22
Venezia-Atalanta	94,10	54,15	57,5%	18
Cagliari-Torino	96,35	52,53	54,5%	17
Roma-Inter	97,00	59,00	60,8%	25
Verona-Monza	94,00	54,17	57,6%	21
Udinese-Cagliari	94,51	54,38	57,5%	22
Torino-Como	97,40	55,42	56,9%	25
Napoli-Lecce	96,27	52,02	54,0%	20
Bologna-Milan	96,21	53,33	55,4%	28
Atalanta-Verona	91,25	58,27	63,9%	18
Parma-Empoli	95,45	55,33	58,0%	29
Lazio-Genoa	96,07	57,36	59,7%	18
Monza-Venezia	95,57	49,01	51,3%	33
Inter-Juventus	95,12	52,00	54,7%	27
Fiorentina-Roma	94,27	55,39	58,8%	24	
Cagliari-Bologna	94,25	55,29	58,7%	35
Lecce-Verona	98,15	49,06	50,0%	35
Milan-Napoli	96,55	60,55	62,7%	20
Empoli-Inter	96,01	55,51	57,8%	25
Venezia-Udinese	97,22	49,10	50,5%	21
Atalanta-Monza	96,20	57,39	59,7%	25
Juventus-Parma	95,30	61,18	64,2%	12
Genoa-Fiorentina	98,09	52,02	53,0%	23
Como-Lazio	97,44	50,20	51,5%	32
Roma-Torino	95,15	59,29	62,3%	26
Bologna-Lecce	95,25	50,36	52,9%	23
Udinese-Juventus	96,07	55,50	57,8%	26
Monza-Milan	98,17	56,22	57,3%	33
Napoli-Atalanta	96,00	62,27	64,9%	18
Torino-Fiorentina	97,17	59,23	61,0%	28
Verona-Roma	97,43	53,58	55,0%	27
Inter-Venezia	99,15	55,55	56,0%	29
Empoli-Como	96,10	54,05	56,2%	26
Parma-Genoa	97,16	51,42	52,9%	23
Lazio-Cagliari	96,13	54,05	56,2%	29
Genoa-Como	98,16	50,21	51,2%	32
Lecce-Empoli	97,00	51,23	52,8%	31
Venezia-Parma	95,15	57,06	60,0%	19
Cagliari-Milan	100,14	54,30	54,2%	18
Juventus-Torino	95,06	55,08	57,9%	21
Atalanta-Udinese	98,40	51,34	52,2%	22
Fiorentina-Verona	96,53	46,44	48,1%	20
Roma-Bologna	98,55	49,51	50,2%	37
Monza-Lazio	97,01	56,45	58,2%	23
Inter-Napoli	95,15	56,03	58,9%	27
Verona-Inter	93,00	65,30	70,2%	19
Milan-Juventus	95,40	59,45	62,3%	21
Parma-Atalanta	95,40	66,25	69,4%	14
Genoa-Cagliari	98,00	53,26	54,3%	18
Como-Fiorentina	97,00	55,23	56,9%	26
Torino-Monza	93,12	57,26	61,5%	30
Napoli-Roma	93,51	58,44	62,5%	17
Lazio-Bologna	94,57	55,30	58,5%	28
Empoli-Udinese	95,22	58,51	61,4%	21
Venezia-Lecce	96,01	56,21	58,5%	28
Cagliari-Verona	95,29	50,46	53,0%	22
Como-Monza	96,30	51,14	53,1%	27
Milan-Empoli	95,43	54,43	57,0%	28
Bologna-Venezia	96,14	49,35	51,3%	29
Udinese-Genoa	97,10	57,46	59,2%	24
Parma-Lazio	103,52	55,40	53,5%	30
Torino-Napoli	94,42	59,16	62,7%	24
Fiorentina-Inter	101,09	53,53	53,0%	21
Lecce-Juventus	95,05	62,25	65,5%	17
Roma-Atalanta	95,03	55,10	58,0%	30
Inter-Parma	95,00	55,37	58,3%	11
Atalanta-Milan	97,25	59,24	60,9%	27
Genoa-Torino	96,34	56,35	58,5%	27
Juventus-Bologna	98,03	52,19	53,2%	32
Roma-Lecce	97,28	55,05	56,6%	19
Fiorentina-Cagliari	96,03	53,17	55,4%	29
Verona-Empoli	97,20	54,48	56,0%	31
Venezia-Como	95,28	44,33	46,5%	22
Napoli-Lazio	98,45	58,47	59,4%	28
Monza-Udinese	97,10	53,45	55,0%	28
Empoli-Torino	95,04	49,22	51,8%	22
Cagliari-Atalanta	96,30	57,31	59,5%	26
Udinese-Napoli	97,00	51,56	53,2%	22
Juventus-Venezia	98,50	59,57	60,5%	17
Lecce-Monza	99,07	47,00	47,4%	31
Bologna-Fiorentina	96,02	48,30	50,3%	26
Parma-Verona	95,56	54,08	56,6%	21
Como-Roma	98,32	52,56	53,5%	35
Milan-Genoa	96,57	61,42	63,6%	23
Lazio-Inter	99,10	55,11	55,6%	21
Verona-Milan	99,21	54,44	54,9%	30
Torino-Bologna	101,15	56,57	55,9%	28
Genoa-Napoli	97,03	57,55	59,3%	16
Lecce-Lazio	100,19	56,47	56,4%	25
Roma-Parma	91,06	55,55	61,0%	19
Venezia-Cagliari	96,33	49,18	51,1%	17
Atalanta-Empoli	98,00	54,38	55,5%	26
Monza-Juventus	96,32	61,14	63,5%	20
Fiorentina-Udinese	100,55	53,21	52,9%	24
Inter-Como	94,10	52,23	55,5%	28
Empoli-Genoa	98,00	51,47	52,5%	29
Parma-Monza	100,00	48,53	48,5%	37
Cagliari-Inter	95,15	52,18	54,8%	19
Lazio-Atalanta	96,05	58,07	60,5%	17
Udinese-Torino	97,09	54,20	55,8%	29
Napoli-Venezia	95,30	54,07	56,7%	22
Juventus-Fiorentina	97,05	51,51	53,1%	23
Milan-Roma	96,05	51,06	53,2%	25
Como-Lecce	96,37	52,23	54,2%	27
Bologna-Verona	97,39	46,47	47,7%	33
Venezia-Empoli	94,56	51,16	54,1%	29
Fiorentina-Napoli	95,50	49,34	51,7%	32
Verona-Udinese	96,00	50,49	52,6%	30
Monza-Cagliari	99,18	48,31	48,7%	35
Lecce-Genoa	94,12	54,20	57,6%	26
Torino-Parma	97,10	59,17	60,9%	18
Roma-Lazio	97,15	53,25	54,8%	30
Como-Milan	95,10	50,49	53,1%	28
Atalanta-Juventus	97,45	64,13	65,8%	17
Inter-Bologna	96,05	52,32	54,5%	32
Lazio-Como	95,03	47,58	50,1%	29
Empoli-Lecce	98,34	49,09	49,9%	33
Udinese-Atalanta	97,38	58,41	60,0%	20
Torino-Juventus	96,58	60,08	62,2%	27
Milan-Cagliari	96,38	56,05	58,2%	20
Genoa-Parma	96,37	52,11	54,1%	20
Venezia-Inter	95,18	55,10	57,9%	33
Bologna-Roma	98,34	54,11	55,0%	28
Napoli-Verona	93,00	62,26	66,9%	11
Monza-Fiorentina	97,05	60,55	62,4%	35
Roma-Genoa	96,00	58,40	60,8%	24
Bologna-Monza	97,41	59,30	60,9%	34
Juventus-Milan	95,14	56,11	59,0%	30
Atalanta-Napoli	95,06	57,43	60,4%	27
Fiorentina-Torino	96,47	56,28	58,3%	27
Cagliari-Lecce	95,56	51,45	53,8%	21
Parma-Venezia	97,07	50,03	51,5%	29
Verona-Lazio	94,55	55,10	58,3%	18
Inter-Empoli	95,18	57,07	60,0%	20
Como-Udinese	95,57	51,13	53,5%	26
Torino-Cagliari	95,20	57,17	60,1%	21
Como-Atalanta	97,39	56,26	57,8%	25
Napoli-Juventus	97,37	54,14	55,6%	24
Empoli-Bologna	98,56	46,31	47,0%	38
Milan-Parma	99,11	52,02	52,5%	21
Udinese-Roma	99,57	56,19	56,4%	27
Lecce-Inter	93,56	57,11	61,0%	25
Lazio-Fiorentina	100,15	53,46	53,4%	21
Venezia-Verona	96,56	49,18	50,9%	30
Genoa-Monza	97,00	41,34	42,6%	32
Parma-Lecce	97,15	56,49	58,1%	22
Monza-Verona	95,47	53,12	55,6%	35
Udinese-Venezia	97,41	42,22	43,3%	29
Atalanta-Torino	101,01	63,01	62,4%	17
Bologna-Como	96,40	50,12	52,0%	34
Juventus-Empoli	95,12	45,47	47,8%	27
Fiorentina-Genoa	96,09	47,18	49,1%	31
Milan-Inter	98,05	58,36	59,5%	14
Roma-Napoli	96,44	57,50	59,6%	22
Cagliari-Lazio	96,15	55,09	57,3%	23
Como-Juventus	96,52	50,13	51,9%	30
Verona-Atalanta	93,51	56,03	59,9%	16
Empoli-Milan	98,38	48,47	49,3%	27
Torino-Genoa	98,42	57,33	58,3%	21
Venezia-Roma	95,45	53,23	55,8%	34
Cagliari-Parma	96,34	52,57	54,6%	26
Lazio-Monza	94,15	55,49	58,9%	22
Lecce-Bologna	100,17	52,43	52,3%	30
Napoli-Udinese	97,20	57,54	59,2%	21
Inter-Fiorentina	96,10	54,37	56,6%	31
Bologna-Torino	95,32	46,59	48,9%	24
Atalanta-Cagliari	95,19	64,30	67,5%	18
Lazio-Napoli	94,58	55,22	58,4%	28
Milan-Verona	96,20	49,24	51,2%	29
Fiorentina-Como	98,16	58,37	59,5%	38
Monza-Lecce	95,57	56,57	59,2%	28
Udinese-Empoli	95,06	52,19	54,9%	29
Parma-Roma	97,39	58,43	60,0%	16
Juventus-Inter	94,24	55,49	58,9%	27
Genoa-Venezia	93,59	45,50	48,6%	29
Lecce-Udinese	97,16	54,09	55,7%	26
Parma-Bologna	97,04	52,14	53,7%	27
Venezia-Lazio	96,59	56,03	58,0%	33
Torino-Milan	95,15	55,53	58,4%	19
Inter-Genoa	96,44	58,04	60,2%	21
Como-Napoli	96,45	52,35	54,3%	31
Verona-Fiorentina	98,57	51,57	52,3%	27
Empoli-Atalanta	94,57	51,29	54,2%	21
Cagliari-Juventus	96,00	60,44	63,0%	24
Roma-Monza	93,11	61,54	66,1%	13
Fiorentina-Lecce	98,25	54,37	55,3%	22
Atalanta-Venezia	96,53	59,11	61,2%	26
Napoli-Inter	99,30	52,11	52,5%	22
Udinese-Parma	97,32	57,58	59,2%	22
Monza-Torino	93,56	56,28	60,2%	30
Bologna-Cagliari	96,19	51,33	53,4%	39
Genoa-Empoli	96,53	47,28	49,0%	30
Roma-Como	94,57	61,34	64,9%	24
Milan-Lazio	101,13	57,54	56,9%	20
Juventus-Verona	97,43	55,31	56,8%	22
Cagliari-Genoa	96,07	50,53	52,6%	31
Como-Venezia	96,12	51,43	53,5%	25
Parma-Torino	96,32	46,27	48,0%	31
Lecce-Milan	99,34	52,03	52,4%	20
Inter-Monza	98,52	57,48	58,3%	15
Verona-Bologna	96,23	56,41	58,6%	34
Napoli-Fiorentina	96,52	59,57	61,7%	15
Empoli-Roma	96,05	60,45	62,9%	22
Juventus-Atalanta	94,15	57,31	60,9%	23
Lazio-Udinese	97,05	59,55	61,4%	20
Genoa-Lecce	98,10	51,18	52,2%	22
Monza-Parma	94,56	56,25	59,5%	30
Udinese-Verona	94,02	56,15	59,7%	37
Milan-Como	99,27	51,46	51,8%	28
Torino-Empoli	100,23	46,00	45,9%	21
Venezia-Napoli	100,02	48,55	48,5%	27
Bologna-Lazio	94,55	54,15	57,3%	34
Roma-Cagliari	99,22	60,28	60,8%	16
Fiorentina-Juventus	93,14	52,43	56,3%	22
Atalanta-Inter	103,06	54,31	52,7%	25
Como-Empoli	96,34	52,17	54,2%	27
Venezia-Bologna	95,58	53,24	55,7%	35
Juventus-Genoa	94,56	54,24	57,4%	24
Lecce-Roma	97,25	51,33	52,8%	17
Cagliari-Monza	95,57	50,35	52,7%	28
Fiorentina-Atalanta	97,34	55,08	56,6%	23
Inter-Udinese	98,25	55,26	56,2%	22
Napoli-Milan	97,10	59,08	60,8%	15
Verona-Parma	96,29	51,46	53,4%	20
Lazio-Torino	97,50	54,35	55,7%	29
Genoa-Udinese	96,33	54,22	56,3%	30
Monza-Como	95,52	58,00	60,7%	40
Parma-Inter	97,28	57,35	59,0%	16
Milan-Fiorentina	99,07	53,20	53,7%	24
Lecce-Venezia	95,06	44,36	46,7%	24
Empoli-Cagliari	95,00	45,56	48,0%	24
Torino-Verona	96,20	52,10	54,2%	28
Atalanta-Lazio	98,36	60,27	61,3%	12
Roma-Juventus	94,26	61,47	65,2%	26
Bologna-Napoli	98,46	51,14	51,9%	29
Udinese-Milan	96,01	57,21	59,6%	19
Venezia-Monza	100,45	45,52	45,3%	40
Inter-Cagliari	95,55	61,00	63,8%	18
Juventus-Lecce	96,28	55,04	57,2%	17
Atalanta-Bologna	100,02	52,31	52,3%	29
Fiorentina-Parma	95,10	59,22	62,3%	29
Verona-Genoa	96,18	46,55	48,4%	30
Como-Torino	97,30	55,02	56,5%	25
Lazio-Roma	96,24	49,34	51,3%	24
Napoli-Empoli	94,02	54,09	57,5%	23
Lecce-Como	100,53	46,22	46,0%	32
Monza-Napoli	94,19	56,00	59,5%	29
Roma-Verona	93,58	54,09	57,8%	22
Empoli-Venezia	95,32	44,36	46,5%	33
Bologna-Inter	98,55	50,02	50,8%	33
Milan-Atalanta	95,50	62,56	65,5%	15
Torino-Udinese	95,07	53,25	56,0%	24
Cagliari-Fiorentina	100,56	53,48	53,2%	30
Genoa-Lazio	102,15	55,47	54,3%	26
Parma-Juventus	100,20	58,32	58,2%	19
Atalanta-Lecce	99,02	56,54	57,1%	18
Como-Genoa	96,15	54,58	56,8%	34
Venezia-Milan	98,56	52,47	53,2%	27
Fiorentina-Empoli	99,14	48,14	48,6%	34
Inter-Roma	97,22	58,15	59,8%	20
Juventus-Monza	97,00	55,31	57,0%	22
Napoli-Torino	97,54	58,59	60,1%	18
Udinese-Bologna	95,52	47,37	49,6%	31
Verona-Cagliari	97,01	51,05	52,6%	23
Lazio-Parma	98,08	60,08	61,3%	23
Torino-Venezia	100,00	53,17	53,2%	25
Cagliari-Udinese	97,49	55,29	56,7%	20
Parma-Como	96,02	50,20	52,3%	30
Lecce-Napoli	105,14	58,14	55,3%	15
Inter-Verona	95,25	61,36	64,4%	17
Empoli-Lazio	98,03	55,18	56,3%	24
Monza-Atalanta	94,45	57,35	60,7%	19
Roma-Fiorentina	101,34	63,43	62,6%	17
Bologna-Juventus	98,06	45,42	46,3%	25
Genoa-Milan	98,17	52,54	53,5%	26
Milan-Bologna	97,45	56,48	58,0%	19
Como-Cagliari	100,35	54,24	54,1%	24
Lazio-Juventus	99,22	51,18	51,6%	24
Empoli-Parma	98,00	47,27	48,2%	37
Udinese-Monza	95,23	54,45	57,2%	29
Verona-Lecce	98,03	44,14	45,0%	32
Torino-Inter	99,11	57,18	57,7%	20
Napoli-Genoa	98,25	55,15	56,1%	26
Venezia-Fiorentina	98,32	54,06	55,0%	38
Atalanta-Roma	97,05	51,49	53,1%	28
Genoa-Atalanta	97,16	52,40	53,9%	24
Cagliari-Venezia	98,25	52,10	53,0%	16
Fiorentina-Bologna	98,55	51,27	52,0%	38
Inter-Lazio	102,53	58,13	56,7%	24
Juventus-Udinese	96,37	47,39	49,2%	22
Lecce-Torino	96,47	55,00	57,0%	21
Monza-Empoli	95,12	58,32	61,3%	24
Parma-Napoli	103,36	52,42	50,7%	29
Roma-Milan	96,20	61,26	63,7%	28
Verona-Como	97,07	48,53	50,0%	23
Como-Inter	98,45	60,24	61,2%	19
Napoli-Cagliari	100,40	51,44	51,2%	28
Bologna-Genoa	96,11	46,03	47,9%	36
Milan-Monza	92,19	59,23	64,2%	17
Atalanta-Parma	98,25	58,43	59,5%	14
Empoli-Verona	99,03	43,40	43,8%	39
Lazio-Lecce	99,12	52,01	52,5%	22
Torino-Roma	94,54	57,30	60,6%	26
Udinese-Fiorentina	96,02	57,55	59,9%	21
Venezia-Juventus	98,32	49,56	50,4%	28`;

        // INIEZIONE DEI NUOVI DATI FORNITI DALL'UTENTE
        const MATCHES_DB_2526 = `Genoa-Lecce	95,47	46,53	48,7%	29
Sassuolo-Napoli	97,20	60,05	61,8%	30
Milan-Cremonese	97,21	65,26	67,1%	28
Roma-Bologna	96,35	59,56	61,8%	24
Cagliari-Fiorentina	100,54	49,03	48,8%	32
Como-Lazio	95,46	54,15	56,7%	27
Atalanta-Pisa	96,06	57,39	59,7%	19
Juventus-Parma	96,26	55,01	57,1%	22
Udinese-Verona	94,24	54,35	57,7%	24
Inter-Torino	91,24	52,19	57,2%	20
Cremonese-Sassuolo	98,13	59,20	60,3%	29
Lecce-Milan	100,08	58,39	58,3%	18
Bologna-Como	96,20	55,35	57,5%	32
Parma-Atalanta	97,06	59,53	61,3%	23
Napoli-Cagliari	97,56	64,09	65,7%	28
Pisa-Roma	96,46	59,27	61,4%	24
Genoa-Juventus	98,26	54,37	55,3%	29
Torino-Fiorentina	94,09	51,30	54,5%	34
Inter-Udinese	98,12	57,38	58,5%	22
Lazio-Verona	93,02	59,58	64,1%	27
Cagliari-Parma	101,55	54,11	53,3%	33
Juventus-Inter	97,19	54,23	55,8%	24
Fiorentina-Napoli	99,24	54,04	54,5%	28
Roma-Torino	102,10	56,51	55,3%	29
Atalanta-Lecce	94,30	58,12	61,6%	19
Pisa-Udinese	96,31	58,32	60,6%	28
Sassuolo-Lazio	101,17	63,56	62,8%	26
Milan-Bologna	98,03	59,39	60,6%	32
Verona-Cremonese	97,02	61,52	63,4%	21
Como-Genoa	99,29	57,30	57,7%	31
Lecce-Cagliari	96,37	53,19	55,2%	29
Bologna-Genoa	108,02	53,57	49,6%	27
Verona-Juventus	99,52	54,14	54,4%	28
Udinese-Milan	95,27	65,04	68,3%	16
Lazio-Roma	100,08	51,06	51,0%	36
Cremonese-Parma	100,26	56,21	56,1%	24
Torino-Atalanta	95,17	63,29	66,5%	20
Fiorentina-Como	106,39	58,50	55,0%	35
Inter-Sassuolo	98,24	56,21	57,2%	23
Napoli-Pisa	101,11	57,06	56,4%	27
Como-Cremonese	97,54	ND	ND	33
Juventus-Atalanta	98,52	ND	ND	13
Cagliari-Inter	96,35	ND	ND	27
Sassuolo-Udinese	98,39	ND	ND	27
Pisa-Fiorentina	98,27	ND	ND	30
Roma-Verona	100,00	ND	ND	30
Lecce-Bologna	97,51	ND	ND	26
Milan-Napoli	99,10	ND	ND	13
Parma-Torino	98,49	ND	ND	22
Genoa-Lazio	96,06	ND	ND	34
Verona-Sassuolo	99,27	49,17	49,5%	26
Lazio-Torino	103,57	54,51	52,6%	35
Parma-Lecce	101,04	47,10	46,6%	32
Inter-Cremonese	95,20	55,44	58,2%	17
Atalanta-Como	95,25	56,48	59,3%	29
Udinese-Cagliari	97,10	50,42	51,9%	29
Bologna-Pisa	91,03	51,05	56,1%	28
Fiorentina-Roma	98,08	49,19	50,2%	40
Napoli-Genoa	96,31	ND	ND	31
Juventus-Milan	94,13	57,17	60,7%	23
Lecce-Sassuolo	97,33	ND	ND	30
Pisa-Verona	98,41	52,04	52,9%	22
Torino-Napoli	99,17	60,15	60,7%	18
Roma-Inter	96,40	55,18	57,2%	47
Como-Juventus	98,59	48,03	48,7%	32
Cagliari-Bologna	96,32	50,55	52,5%	37
Genoa-Parma	99,37	53,50	53,8%	28
Atalanta-Lazio	95,15	64,07	67,3%	15
Milan-Fiorentina	98,13	54,05	55,1%	26
Cremonese-Udinese	94,10	49,12	52,2%	29
Milan-Pisa	100,06	56,45	56,4%	29
Parma-Como	98,03	56,10	57,2%	24
Udinese-Lecce	96,22	51,39	53,4%	21
Napoli-Inter	102,58	54,57	53,2%	25
Cremonese-Atalanta	96,00	57,39	59,8%	14
Torino-Genoa	97,28	52,06	53,5%	23
Sassuolo-Roma	98,24	49,54	50,4%	34
Verona-Cagliari	100,04	54,13	54,1%	27
Fiorentina-Bologna	101,03	43,00	42,6%	33
Lazio-Juventus	96,12	54,45	56,6%	29
Lecce-Napoli	99,07	54,46	55,0%	24
Atalanta-Milan	97,51	59,25	60,8%	17
Como-Verona	99,03	53,25	53,8%	32
Juventus-Udinese	102,54	51,31	50,0%	25
Roma-Parma	97,04	53,34	55,0%	17
Bologna-Torino	96,01	57,36	59,7%	31
Genoa-Cremonese	100,41	46,31	46,1%	29
Inter-Fiorentina	95,10	54,25	57,0%	27
Cagliari-Sassuolo	100,29	50,07	49,9%	41
Pisa-Lazio	95,16	57,15	60,1%	28
Udinese-Atalanta	95,30	57,43	60,3%	25
Napoli-Como	98,23	56,49	57,5%	31
Cremonese-Juventus	99,18	58,32	58,8%	24
Verona-Inter	99,00	57,18	57,8%	20
Fiorentina-Lecce	97,15	52,10	53,6%	35
Torino-Pisa	97,32	52,41	53,9%	22
Parma-Bologna	101,04	47,22	46,7%	31
Milan-Roma	97,10	56,38	58,1%	25
Sassuolo-Genoa	99,04	55,16	55,7%	26
Lazio-Cagliari	95,01	57,15	60,2%	26
Pisa-Cremonese	96,03	53,23	55,4%	28
Como-Cagliari	99,11	51,53	52,0%	36
Lecce-Verona	97,28	48,07	49,4%	28
Juventus-Torino	99,50	64,42	64,7%	13
Parma-Milan	95,00	57,59	60,6%	24
Atalanta-Sassuolo	99,06	60,28	60,9%	17
Bologna-Napoli	99,24	54,49	54,9%	29
Genoa-Fiorentina	97,03	46,12	47,5%	35
Roma-Udinese	98,21	58,53	59,6%	27
Inter-Lazio	97,11	59,00	60,8%	37
Cagliari-Genoa	96,36	45,56	47,3%	38
Udinese-Bologna	101,03	46,21	45,7%	35
Fiorentina-Juventus	101,06	55,15	54,6%	29
Napoli-Atalanta	96,16	56,23	58,5%	23
Verona-Parma	98,17	54,51	55,5%	30
Cremonese-Roma	100,43	53,23	53,0%	28
Lazio-Lecce	98,36	59,36	60,4%	21
Inter-Milan	98,01	60,11	61,3%	16
Torino-Como	96,52	53,33	55,3%	15
Sassuolo-Pisa	98,18	54,38	55,6%	20
Como-Sassuolo	97,44	60,42	62,1%	18
Genoa-Verona	97,26	50,34	51,9%	28
Parma-Udinese	97,45	52,09	53,4%	25
Juventus-Cagliari	97,03	62,32	64,4%	32
Milan-Lazio	104,56	61,30	58,6%	22
Lecce-Torino	97,48	48,26	49,5%	38
Pisa-Inter	96,00	54,31	56,8%	28
Atalanta-Fiorentina	95,05	58,45	61,8%	25
Roma-Napoli	97,12	58,40	60,4%	27
Bologna-Cremonese	101,26	52,25	51,7%	21
Sassuolo-Fiorentina	99,36	54,43	54,9%	30
Inter-Como	95,44	52,45	55,1%	29
Verona-Atalanta	99,35	51,45	52,0%	21
Cremonese-Lecce	101,16	50,07	49,5%	27
Cagliari-Roma	98,10	50,24	51,3%	34
Lazio-Bologna	98,48	54,50	55,5%	31
Napoli-Juventus	95,11	58,12	61,1%	21
Pisa-Parma	97,47	51,33	52,7%	22
Udinese-Genoa	98,46	50,21	51,0%	28
Torino-Milan	99,30	56,25	56,7%	23`;

        // DATI PARTITE ND AGGIUNTI MANUALMENTE
        const EXTRA_MATCHES_2223 = ``;
        const EXTRA_MATCHES_2324 = ``;
        const EXTRA_MATCHES_2526 = ``;

        // Associazioni manuali per partite non assegnate automaticamente (per via di valori ND)
        const MANUAL_REF_ASSIGNMENTS = {
            "2025-26": {
                "Como-Cremonese": "Di Bello",
                "Juventus-Atalanta": "Sozza",
                "Cagliari-Inter": "Piccinini",
                "Sassuolo-Udinese": "Perenzoni",
                "Pisa-Fiorentina": "Manganiello",
                "Roma-Verona": "Feliciani",
                "Lecce-Bologna": "Fourneau",
                "Milan-Napoli": "Collu",
                "Genoa-Lazio": "Ayroldi",
                "Parma-Torino": "Collu",
                "Napoli-Genoa": "La Penna",
                "Lecce-Sassuolo": "Crezzini"
            },
            "2023-24": {
                // Aggiungi qui eventuali associazioni manuali per il 2023/24 se necessari
            }
        };
        
        const PLAYING_TIME_DB = {
            "2025-26": `Massa	46,53
Ayroldi	60,05
Collu	65,26
Zufferli	59,56
Sozza	49,03
Manganiello	54,15
Arena	57,39
Marcenaro	55,01
Tremolada	54,35
La Penna	52,19
Guida	59,20
Marinelli	58,39
Doveri	55,35
Mariani	59,53
Bonacina	64,09
Collu	59,27
Chiffi	54,37
Abisso	51,30
Marchetti	57,38
Crezzini	59,58
Fourneau	54,11
Colombo	54,23
Zufferli	54,04
Ayroldi	56,51
Manganiello	58,12
Massa	58,32
Tremolada	63,56
Marcenaro	59,39
Arena	61,52
Piccinini	57,30
Zufferli	53,19
Collu	53,57
Rapuano	54,14
Doveri	65,04
Sozza	51,06
La Penna	56,21
Colombo	63,29
Bonacina	58,50
Marinelli	56,21
Crezzini	57,06
Fourneau	49,17
Piccinini	54,51
Doveri	47,10
Feliciani	55,44
Zufferli	56,48
Arena	50,42
Abisso	51,05
Colombo	49,19
Guida	57,17
Guida	52,04
Marcenaro	60,15
Massa	55,18
Ayroldi	48,03
Marchetti	50,55
Sozza	53,50
Collu	64,07
Marinelli	54,05
Fabbri	49,12
Zufferli	56,45
Chiffi	56,10
Feliciani	51,39
Mariani	54,57
Arena	57,39
Bonacina	52,06
Manganiello	49,54
Dionisi	54,13
La Penna	43,00
Colombo	54,45
Collu	54,46
Doveri	59,25
Marcenaro	53,25
Di Bello	51,31
Crezzini	53,34
Ayroldi	57,36
Abisso	46,31
Sozza	54,25
Pairetto	50,07
Massa	57,15
Fabbri	57,43
Zufferli	56,49
Chiffi	58,32
Doveri	57,18
Rapuano	52,10
Arena	52,41
Bonacina	47,22
Guida	56,38
Feliciani	55,16
Sacchi	57,15
Marcenaro	53,23
Pezzuto	51,53
Abisso	48,07
Zufferli	64,42
Di Bello	57,59
Crezzini	60,28
Chiffi	54,49
Guida	46,12
Collu	58,53
Manganiello	59,00
La Penna	45,56
Sacchi	46,21
Doveri	55,15
Di Bello	56,23
Pairetto	54,51
Ayroldi	53,23
Arena	59,36
Sozza	60,11
Bonacina	53,33
Di Marco	54,38
Marchetti	60,42
Fabbri	50,34
Piccinini	52,09
Crezzini	62,32
Collu	61,30
Mariani	48,26
Guida	54,31
Marcenaro	58,45
Massa	58,40
Feliciani	52,25
Pairetto	54,43
Di Bello	52,45
Mariani	51,45
Mucera	50,07
Zufferli	50,24
Fabbri	54,50
La Penna	58,12
Doveri	51,33
Maresca	50,21
Chiffi	56,25'
`,
            "2024-25": `Feliciani	46,39
Ayroldi	48,46
Fabbri	44,43
Maresca	58,27
Ferrieri Caputi	48,59
Marchetti	48,53
Marinelli	53,36
Tremolada	56,00
Massa	54,12
Marcenaro	56,43
Sacchi	59,00
Doveri	49,49
Di Marco	56,21
Mariani	56,58
Rapuano	51,08
Sozza	55,29
Pairetto	53,23
Zufferli	58,22
Di Bello	53,12
Giua	61,58
Marcenaro	52,45
Marchetti	53,40
Marinelli	55,44
Fabbri	47,36
Massa	54,06
Tremolada	60,21
Colombo	54,53
Ayroldi	51,32
Guida	58,50
Prontera	54,24
Piccinini	54,03
Di Bello	60,04
Di Marco	57,21
Giua	53,12
Sacchi	51,04
Colombo	54,31
La Penna	50,07
Pairetto	57,28
Abisso	53,01
Zufferli	56,25
Sozza	48,44
Marinelli	60,20
Marchetti	48,20
Doveri	64,10
Guida	54,32
Marcenaro	52,35
Massa	55,34
Feliciani	55,33
Mariani	55,33
Tremolada	58,21
Zufferli	55,41
Sacchi	61,58
Colombo	58,44
Rapuano	57,29
Sozza	57,06
Giua	49,47
Abisso	52,36
Aureliano	54,28
Manganiello	60,33
Fourneau	55,21
Feliciani	59,25
Guida	47,29
Mariani	55,10
Chiffi	55,41
Marcenaro	54,09
Marinelli	60,08
Di Bello	54,55
Ayroldi	53,07
La Penna	56,25
Pairetto	48,43
Fabbri	60,51
Doveri	47,58
Chiffi	52,59
Sacchi	56,44
Abisso	51,43
Fourneau	53,12
Zufferli	54,15
Aureliano	52,53
Massa	59,00
Dionisi	54,17
Manganiello	54,38
Ayroldi	55,42
Tremolada	52,02
Mariani	53,33
Feliciani	58,27
La Penna	55,33
Piccinini	57,36
Rapuano	49,01
Guida	52,00
Sozza	55,39
Fourneau	55,29
Mariani	49,06
Colombo	60,55
Marchetti	55,51
Massa	49,10
Piccinini	57,39
Zufferli	61,18
Chiffi	52,02
Pairetto	50,20
Fabbri	59,29
Collu	50,36
Abisso	55,50
Feliciani	56,22
Doveri	62,27
La Penna	59,23
Marcenaro	53,58
Ferrieri Caputi	55,55
Di Bello	54,05
Guida	51,42
Ayroldi	54,05
Rapuano	50,21
Sacchi	51,23
Chiffi	57,06
Fabbri	54,30
Sozza	55,08
Di Bello	51,34
Zufferli	46,44
Manganiello	49,51
Colombo	56,45
Mariani	56,03
Colombo	65,30
Chiffi	59,45
Manganiello	66,25
Sozza	53,26
Marchetti	55,23
Abisso	57,26
Massa	58,44
Rapuano	55,30
Marinelli	58,51
Pairetto	56,21
Mariani	50,46
Sacchi	51,14
Dionisi	54,43
Massimi	49,35
Aureliano	57,46
Zufferli	55,40
Fabbri	59,16
Doveri	53,53
Rapuano	62,25
Guida	55,10
Abisso	55,37
La Penna	59,24
Marinelli	56,35
Marchetti	52,19
Chiffi	55,05
Piccinini	53,17
Di Bello	54,48
Doveri	44,33
Colombo	58,47
Manganiello	53,45
Bonacina	49,22
Pairetto	57,31
Doveri	51,56
Giua	59,57
Mariani	47,00
Fabbri	48,30
Sozza	54,08
Rapuano	52,56
Guida	61,42
Chiffi	55,11
Marinelli	54,44
Piccinini	56,57
La Penna	57,55
Manganiello	56,47
Di Bello	55,55
Guida	49,18
Feliciani	54,38
Massa	61,14
Marcenaro	53,21
Giua	52,23
Rapuano	51,47
La Penna	48,53
Doveri	52,18
Massa	58,07
Fourneau	54,20
Cosso	54,07
Mariani	51,51
Fabbri	51,06
Piccinini	52,23
Ayroldi	46,47
Sacchi	51,16
Manganiello	49,34
Dionisi	50,49
Di Bello	48,31
Marinelli	54,20
Feliciani	59,17
Pairetto	53,25
Manganiello	50,49
Doveri	64,13
Pairetto	52,32
Tremolada	47,58
Chiffi	49,09
Mariani	58,41
Fabbri	60,08
Fourneau	56,05
Colombo	52,11
Piccinini	55,10
Abisso	54,11
Zufferli	62,26
Dionisi	60,55
Zufferli	58,40
Mariani	59,30
Massa	56,11
Colombo	57,43
Marinelli	56,28
Sacchi	51,45
Fourneau	50,03
Fabbri	55,10
Feliciani	57,07
Cosso	51,13
Bonacina	57,17
Pairetto	56,26
Chiffi	54,14
La Penna	46,31
Abisso	52,02
Sozza	56,19
Marinelli	57,11
Rapuano	53,46
Manganiello	49,18
Doveri	41,34
Sozza	56,49
Massa	53,12
Mariani	42,22
Piccinini	63,01
Massimi	50,12
Zufferli	45,47
Collu	47,18
Chiffi	58,36
Fabbri	57,50
Manganiello	55,09
Abisso	50,13
Sozza	56,03
Pairetto	48,47
Feliciani	57,33
Zufferli	53,23
Di Bello	52,57
Aureliano	55,49
Fourneau	52,43
Marinelli	57,54
La Penna	54,37
Fabbri	46,59
Marchetti	64,30
Massa	55,22
Fourneau	49,24
Piccinini	58,37
Collu	56,57
Doveri	52,19
Chiffi	58,43
Mariani	55,49
Marinelli	45,50
Bonacina	54,09
Abisso	52,14
Marchetti	56,03
Sozza	55,53
Piccinini	58,04
Manganiello	52,35
Di Bello	51,57
Mariani	51,29
Colombo	60,44
Maresca	61,54
Marinelli	54,37
Collu	59,11
Doveri	52,11
Maresca	57,58
Rapuano	56,28
Zufferli	51,33
Massa	47,28
Pairetto	61,34
Manganiello	57,54
Marchetti	55,31
Fabbri	50,53
Ayroldi	51,43
Fourneau	46,27
Doveri	52,03
Zufferli	57,48
Rapuano	56,41
Colombo	59,57
Di Bello	60,45
Sozza	57,31
Piccinini	59,55
Maresca	51,18
Manganiello	56,25
Ayroldi	56,15
Marchetti	51,46
Chiffi	46,00
Mariani	48,55
Colombo	54,15
Piccinini	60,28
Fabbri	52,43
Massa	54,31
Mariani	52,17
Di Bello	53,24
Rapuano	54,24
Manganiello	51,33
Fourneau	50,35
Doveri	55,08
Chiffi	55,26
Sozza	59,08
Sacchi	51,46
Massa	54,35
Perenzoni	54,22
Collu	58,00
Doveri	57,35
Ayroldi	53,20
Piccinini	44,36
La Penna	45,56
Bonacina	52,10
Chiffi	60,27
Colombo	61,47
Massa	51,14
Sacchi	57,21
Maresca	45,52
Di Bello	61,00
Zufferli	55,04
Mariani	52,31
Manganiello	59,22
Marchetti	46,55
Marcenaro	55,02
Sozza	49,34
Fabbri	54,09
Sozza	46,22
La Penna	56,00
Pairetto	54,09
Massa	44,36
Colombo	50,02
Piccinini	62,56
Collu	53,25
Marinelli	53,48
Ayroldi	55,47
Chiffi	58,32
La Penna	56,54
Arena	54,58
Manganiello	52,47
Rapuano	48,14
Fabbri	58,15
Perenzoni	55,31
Mariani	58,59
Maresca	47,37
Abisso	51,05
Sacchi	60,08
Sozza	53,17
Feliciani	55,29
Di Bello	50,20
Massa	58,14
Manganiello	61,36
Colombo	55,18
Pairetto	57,35
Chiffi	63,43
Doveri	45,42
Collu	52,54
Marinelli	56,48
Fourneau	54,24
Massa	51,18
Fabbri	47,27
Crezzini	54,45
Maresca	44,14
La Penna	57,18
Piccinini	55,15
Marchetti	54,06
Sozza	51,49
Ghersini	52,40
Pairetto	52,10
Zufferli	51,27
Chiffi	58,13
Ayroldi	47,39
Rapuano	55,00
Marinelli	58,32
Doveri	52,42
Piccinini	61,26
Abisso	48,53
Massa	60,24
La Penna	51,44
Monaldi	46,03
Rutella	59,23
Marinelli	58,43
Doveri	43,40
Fabbri	52,01
Di Bello	57,30
Marcenaro	57,55
Colombo	49,56`,
            
"2023-24": `Massimi	46,08
Marcenaro	54,42
Ayroldi	56,01
Colombo	60,33
Feliciani	51,39
Marchetti	63,12
Dionisi	59,32
Rapuano	59,09
Cosso	54,30
Pairetto	61,21
Sacchi	59,15
Aureliano	60,01
Mariani	58,08
Doveri	47,45
Ferrieri Caputi	52,18
Di Bello	57,01
Marinelli	64,39
Giua	59,34
Massa	50,22
Fabbri	61,27
Piccinini	55,29
Rapuano	58,15
Orsato	61,31
Guida	50,30
Marcenaro	62,09
Colombo	57,51
Marchetti	56,24
Chiffi	53,20
Ayroldi	58,45
Massimi	50,48
Maresca	55,14
Sozza	52,42
Fabbri	56,24
Doveri	53,02
Marinelli	56,12
Prontera	50,42
Pairetto	58,41
Sacchi	60,43
Giua	57,54
La Penna	56,51
Piccinini	50,43
Rapuano	52,36
Maresca	55,20
Colombo	53,58
Abisso	62,07
Marcenaro	54,22
Feliciani	58,05
Chiffi	52,45
Ayroldi	55,40
Guida	59,55
Giua	56,55
La Penna	64,12
Rapuano	49,34
Dionisi	51,29
Massimi	59,56
Fabbri	62,40
Manganiello	52,40
Fourneau	53,59
Pezzuto	62,37
Orsato	57,27
Pairetto	55,45
Massa	60,07
Abisso	52,50
Maresca	55,29
Mariani	49,51
Chiffi	63,08
Marchetti	52,22
Zufferli	59,07
Feliciani	54,31
Di Bello	63,31
Fabbri	50,23
Sacchi	53,04
Guida	56,14
Massa	56,52
Piccinini	60,54
Massimi	54,47
Ferrieri Caputi	53,23
Orsato	57,25
Sozza	50,25
La Penna	62,58
Abisso	54,13
Marchetti	51,43
Di Bello	62,48
Ayroldi	57,35
Doveri	49,58
Chiffi	46,39
Marinelli	56,59
Mariani	56,39
Tremolada	51,07
Dionisi	56,24
Massa	51,39
Giua	61,34
Aureliano	59,31
Feliciani	58,07
Pairetto	55,07
Prontera	61,42
Maresca	53,56
Orsato	57,53
Massimi	56,34
Marcenaro	58,15
La Penna	59,39
Rapuano	54,06
Sozza	58,24
Sacchi	52,57
Collu	59,14
Guida	53,54
Colombo	54,37
Chiffi	53,38
Manganiello	56,58
Ferrieri Caputi	58,33
Ghersini	60,26
Orsato	51,24
Abisso	55,07
Piccinini	52,31
Doveri	59,43
Prontera	55,54
Aureliano	51,55
Maresca	51,18
Massa	58,29
Dionisi	59,01
Prontera	49,47
Mariani	54,18
Di Bello	60,10
Marchetti	53,02
Sozza	48,39
Zufferli	59,06
Massimi	54,46
Guida	64,12
La Penna	47,16
Colombo	51,44
Fabbri	62,44
Aureliano	49,47
Dionisi	60,53
Marchetti	56,34
Doveri	57,07
Tremolada	56,49
Maresca	47,56
Marcenaro	59,05
Massa	54,55
Piccinini	57,58
Orsato	55,54
Ayroldi	53,42
La Penna	63,08
Di Bello	61,59
Massimi	52,31
Collu	56,26
Sozza	59,33
Rapuano	56,44
Colombo	51,09
Mariani	48,08
Massa	48,40
Zufferli	53,51
Marcenaro	53,56
Marinelli	54,31
Aureliano	59,25
Ferrieri Caputi	49,50
Manganiello	55,02
Guida	56,23
Maresca	58,58
Feliciani	56,33
Guida	57,20
Marchetti	48,21
Sacchi	57,46
Doveri	50,34
Mariani	51,27
Fabbri	52,46
Rapuano	58,35
Marcenaro	55,18
Orsato	52,53
Colombo	49,29
La Penna	48,08
Di Bello	56,21
Doveri	52,13
Feliciani	50,59
Manganiello	53,59
Maresca	44,15
Orsato	52,22
Marinelli	59,53
Mariani	47,48
Sozza	60,48
Colombo	61,26
Fabbri	53,26
Ferrieri Caputi	54,01
Massa	46,52
Abisso	48,08
La Penna	56,22
Mariani	53,30
Sacchi	50,15
Guida	51,52
Aureliano	51,16
Giua	52,28
Marinelli	59,33
Doveri	48,26
Rapuano	51,13
Ferrieri Caputi	58,16
Manganiello	60,10
Pairetto	53,58
Guida	59,28
Prontera	57,30
Piccinini	62,35
Sacchi	58,09
Maresca	52,19
Dionisi	51,07
Giua	58,54
Orsato	53,22
Doveri	57,23
Chiffi	57,05
La Penna	56,30
Chiffi	59,15
Colombo	54,21
Colombo	55,36
Piccinini	58,21
Marinelli	61,22
Massa	56,10
Pairetto	50,58
Manganiello	60,06
La Penna	51,00
Orsato	58,48
Aureliano	57,56
Di Bello	58,21
Giua	50,53
Feliciani	53,24
Prontera	58,18
Pairetto	56,24
Sacchi	58,37
Chiffi	52,35
Piccinini	55,37
Guida	61,00
Maresca	61,56
Marcenaro	53,25
Mariani	55,59
Di Bello	62,39
Guida	56,29
Orsato	55,27
Feliciani	49,36
Manganiello	56,30
Massa	52,14
Colombo	59,21
Doveri	57,34
Abisso	53,48
Ayroldi	55,58
Piccinini	49,49
Sacchi	60,03
Di Bello	55,50
Prontera	58,31
Maresca	59,55
Mariani	54,43
Pairetto	54,12
Giua	55,20
Colombo	59,16
Abisso	48,23
Aureliano	50,55
Fabbri	55,36
Fourneau	57,10
Rapuano	60,28
Pairetto	51,20
Doveri	55,32
Orsato	60,42
Sacchi	58,54
Guida	59,08
Di Bello	50,51
Manganiello	48,02
Piccinini	53,48
Marchetti	47,24
Maresca	45,54
Rapuano	54,32
Guida	48,32
La Penna	59,08
Mariani	54,25
Ayroldi	58,27
Orsato	53,02
Fourneau	48,22
La Penna	58,45
Pairetto	62,01
Feliciani	53,08
Chiffi	42,55
Sacchi	59,52
Guida	60,20
Massa	54,50
Aureliano	52,07
Fabbri	56,08
Marcenaro	58,56
Colombo	53,37
Maresca	62,41
Rapuano	54,06
Giua	57,25
Mariani	55,56
Manganiello	61,01
La Penna	52,10
Orsato	55,19
Pairetto	56,59
Sacchi	49,53
Aureliano	56,58
Colombo	58,20
Maresca	55,50
Feliciani	62,10
Doveri	48,35
Fabbri	56,17
Marcenaro	55,14
Dionisi	56,34
Sozza	58,03
Massimi	60,57
Guida	55,08
Massa	51,38
Orsato	54,38
Doveri	55,36
Rapuano	48,55
Manganiello	52,13
La Penna	58,49
Piccinini	55,22
Zufferli	53,45
Mariani	45,17
Maresca	55,15
La Penna	55,41
Fabbri	52,04
Massa	51,32
Fourneau	60,21
Di Marco	50,47
Sacchi	51,43
Pairetto	60,48
Feliciani	61,03
Piccinini	52,34
Manganiello	54,55
Guida	41,18
Doveri	52,19
Rapuano	52,29
Marchetti	54,16
Giua	59,19
Maresca	60,27
Colombo	57,40
Fourneau	51,27
Santoro	55,15
Mariani	59,24
Massa	46,20
Ferrieri Caputi	64,08
Sacchi	56,18
Sozza	55,33
Fabbri	49,43
Marcenaro	56,38
Dionisi	51,43
Sozza	58,31
Pairetto	60,46
Marchetti	56,22
Marcenaro	43,30
Doveri	42,05
Rapuano	52,25
Prontera	57,57
Colombo	55,45
Feliciani	57,27
Aureliano	50,45
Giua	60,04
Pairetto	55,41
Sozza	60,14
Aureliano	50,11
Mariani	56,15
Marinelli	50,21
Santoro	50,09
Guida	56,50
Massa	51,54
Zufferli	58,10
Marchetti	49,59
Rapuano	60,31
Feliciani	51,34
Doveri	46,30
Fabbri	56,44
Guida	43,50
Sacchi	57,57
Manganiello	57,55
Di Bello	47,38
Ayroldi	53,52
Prontera	46,55
Santoro	51,39
Ferrieri Caputi	56,01
Di Marco	51,01
Dionisi	61,57
Sozza	57,03
Tremolada	59,18
Zufferli	56,36
Massa	55,35
Doveri	45,00'
`, 

            "2022-23": `Dionisi	51,55
Marinelli	52,44
Mariani	57,57
Prontera	54,26
Sacchi	55,24
Massimi	47,59
Sozza	58,11
Chiffi	55,58
Fabbri	48,30
Rapuano	58,08
Piccinini	56,05
Aureliano	52,51
Ghersini	56,58
Colombo	54,41
Marchetti	52,18
Fourneau	50,41
Maresca	57,33
Marcenaro	45,08
Massimi	52,51
Abisso	54,41
Di Bello	51,40
Fabbri	59,26
Valeri	53,11
Irrati	52,46
Manganiello	55,04
Cosso	56,24
Massa	52,57
Prontera	50,37
Marinelli	61,59
Santoro	53,31
Ayroldi	49,03
Fourneau	52,10
Piccinini	60,22
Serra	49,06
Aureliano	60,16
Mariani	58,09
Colombo	55,35
Marcenaro	58,48
Di Bello	52,42
Ghersini	52,32
Doveri	52,09
Chiffi	48,47
Sozza	57,42
Pairetto	54,44
Giua	52,16
Valeri	48,36
Maresca	53,37
Sacchi	58,24
Abisso	55,59
Volpi	54,59
Santoro	53,04
Ayroldi	56,38
Fabbri	52,57
Colombo	53,32
Orsato	54,56
Pairetto	48,50
Camplone	50,55
Irrati	53,02
Marcenaro	54,17
Marinelli	49,19
Doveri	57,41
Volpi	44,44
Sozza	47,58
Baroni	60,38
Valeri	50,46
Orsato	51,09
Rapuano	47,21
Maresca	55,57
Chiffi	55,59
Mariani	51,38
Massimi	56,00
Massa	56,56
Aureliano	45,28
Sacchi	52,38
Marinelli	50,17
Ayroldi	52,42
Ferrieri Caputi	58,43
Irrati	56,54
Abisso	54,59
Minelli	51,57
Sozza	55,39
Orsato	57,25
Piccinini	45,36
Fourneau	49,49
Perenzoni	53,03
Ghersini	54,44
Doveri	51,25
Abisso	52,42
Prontera	52,11
Maresca	50,32
Rapuano	56,51
Mariani	57,01
Marcenaro	63,31
Sacchi	51,14
Colombo	58,33
Manganiello	49,42
Cosso	57,28
Massa	48,00
Di Bello	57,06
Massimi	54,26
Fabbri	55,07
Chiffi	49,27
Marinelli	55,59
Valeri	48,44
Marchetti	50,56
Sozza	48,45
Abisso	57,19
Irrati	54,25
Maresca	57,16
Santoro	51,51
Rapuano	54,44
Chiffi	54,08
Massimi	58,01
Ayroldi	52,17
Irrati	55,54
Massa	43,41
Manganiello	60,43
Abisso	49,43
Sacchi	55,01
Pairetto	56,52
Fourneau	56,29
Feliciani	58,24
Marchetti	51,13
Mariani	56,29
Fabbri	51,13
Giua	52,53
Cosso	53,03
Marinelli	56,57
Orsato	58,13
Doveri	56,25
Pairetto	53,21
Piccinini	54,00
Rapuano	57,02
Aureliano	55,37
Ayroldi	58,52
La Penna	57,59
Colombo	53,34
Massa	49,55
Di Bello	50,14
Santoro	58,38
Dionisi	56,52
Ayroldi	55,44
Doveri	46,00
Pezzuto	55,10
Chiffi	53,30
Giua	61,05
Rapuano	57,35
Maresca	46,30
Sozza	55,35
Massa	63,51
Fourneau	46,41
Maresca	52,31
Giua	55,00
Dionisi	60,42
Marinelli	52,21
Santoro	58,08
Ayroldi	49,23
Feliciani	53,00
Sozza	56,01
Serra	56,20
Manganiello	49,25
Marchetti	55,29
Sacchi	53,50
Colombo	52,44
Pezzuto	58,50
Chiffi	47,41
Abisso	55,56
Massa	51,20
Mariani	54,37
Di Bello	57,14
Doveri	52,37
Massa	52,14
Orsato	52,17
Fabbri	55,07
Pairetto	59,24
Ghersini	57,17
Volpi	47,11
Aureliano	53,33
Giua	52,35
Santoro	52,46
La Penna	48,33
Chiffi	57,27
Dionisi	61,20
Mariani	50,42
Prontera	55,10
Sozza	58,30
Marinelli	61,33
Marchetti	55,27
Rapuano	61,13
Di Bello	54,46
Massimi	55,40
Massa	55,40
Marcenaro	55,04
Mariani	57,50
Doveri	56,42
Giua	46,35
Aureliano	59,19
Colombo	59,39
Orsato	57,09
Pairetto	51,46
Orsato	55,51
Dionisi	54,19
Marcenaro	61,52
Di Bello	53,12
Prontera	54,20
Pairetto	50,30
Massa	53,35
Ayroldi	53,13
Chiffi	59,39
Rapuano	61,11
Ayroldi	54,37
Giua	55,02
Aureliano	52,35
Orsato	59,45
Pezzuto	56,07
Zufferli	51,03
Fabbri	51,08
Massimi	56,14
Valeri	49,41
Maresca	60,20
Colombo	61,18
Irrati	54,27
Rapuano	58,06
Dionisi	55,00
Piccinini	61,10
Prontera	48,17
Abisso	59,36
La Penna	56,44
Sozza	53,43
Camplone	53,33
Ayroldi	50,57
Baroni	52,25
Orsato	59,57
Marinelli	57,03
Marchetti	53,39
Mariani	56,05
La Penna	53,43
Colombo	59,56
Piccinini	57,41
Chiffi	56,38
Pairetto	60,47
Feliciani	57,15
Piccinini	55,28
Di Bello	50,58
Doveri	51,33
Massa	48,49
Manganiello	51,54
Maresca	59,10
Fourneau	54,11
Rapuano	59,41
Marinelli	53,09
Cosso	51,01
Colombo	56,56
Maresca	60,45
Sacchi	53,24
Marcenaro	54,16
Piccinini	60,52
Fabbri	55,02
Prontera	55,56
La Penna	55,20
Ghersini	58,38
Dionisi	55,57
Giua	58,55
Pairetto	54,40
Doveri	50,07
Mariani	50,57
Abisso	50,51
Marchetti	47,52
Massa	54,46
Chiffi	57,20
Marinelli	59,05
Maresca	54,16
Marchetti	52,56
Ferrieri Caputi	54,27
Marcenaro	61,24
Orsato	48,50
Irrati	53,02
Rapuano	56,24
Fabbri	49,51
Pezzuto	59,27
Fabbri	56,44
Manganiello	59,11
Marcenaro	60,45
Massimi	60,18
Dionisi	53,48
Orsato	60,35
Doveri	52,52
Colombo	58,26
Fourneau	51,33
Di Bello	54,17
Zufferli	57,35
Irrati	61,50
Massa	52,34
La Penna	60,26
Pairetto	60,58
Mariani	48,37
Aureliano	52,34
Rapuano	58,40
Giua	49,44
Guida	52,11
Mariani	59,01
Camplone	53,04
Ghersini	62,52
Maresca	49,43
Marinelli	60,31
Sacchi	51,52
Fourneau	53,12
Chiffi	61,50
Fabbri	55,19
Irrati	55,09
Marchetti	51,46
Rapuano	59,37
Orsato	55,52
Sacchi	60,51
Guida	58,38
Doveri	52,44
Marcenaro	56,39
Dionisi	57,10
Giua	50,09
Sozza	57,34
Marinelli	56,53
Fourneau	52,07
Pezzuto	45,49
Camplone	61,12
Irrati	57,31
Pairetto	58,52
Chiffi	51,54
Orsato	58,43
La Penna	48,51
Abisso	52,08
Rapuano	59,23
Maresca	59,53
Guida	55,58
Doveri	59,59
Zufferli	56,03
Marchetti	53,11
Massa	48,08
Volpi	50,45
Baroni	56,40
Ferrieri Caputi	62,02
Maresca	57,09
Piccinini	54,00
Doveri	48,31
Marcenaro	61,47
Di Bello	57,53
Paterna	52,30
Cosso	57,38
Orsato	57,36
Chiffi	59,54
Feliciani	53,49
Santoro	59,24
Valeri	56,39
Sozza	58,18
Fourneau	56,23
Mariani	45,44
Massimi	58,00
Marinelli	63,07
Pairetto	59,44
Colombo	58,47
Ayroldi	50,29
Meraviglia	55,21
Baroni	52,24
Guida	47,48
Ayroldi	55,33
Orsato	55,53
Chiffi	52,14
Marcenaro	57,29
Doveri	54,47
Giua	60,12
Mariani	59,10
Marchetti	50,49
Fabbri	62,16
Perenzoni	58,10
Massimi	58,58
Feliciani	59,28
Di Bello	61,36
Piccinini	58,12
Valeri	51,00
Maresca	52,48
Guida	55,59'
`, 

            "2021-22": ``, "2020-21": ``
        };
        

        // --- STATS DB (IMPORTANTE: INCOLLA QUI IL TUO CODICE con const db = { ... }) ---
        // Il sistema userÃ  questa variabile per le statistiche.
        
        const db = {
            "2025-26": [
                { name: "Luca Zufferli", matches: 8, fouls_avg: 27.63, penalties_ap: 0.50, yellows_ap: 3.00, yellows: 24, reds_ap: 0.13, reds: 1 },
                { name: "Giuseppe Collu", matches: 8, fouls_avg: 23.13, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 36, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 6, fouls_avg: 27.00, penalties_ap: 1.00, yellows_ap: 4.67, yellows: 28, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Doveri", matches: 7, fouls_avg: 24.00, penalties_ap: 0.14, yellows_ap: 4.29, yellows: 30, reds_ap: 0.14, reds: 1 },
                { name: "Daniele Chiffi", matches: 6, fouls_avg: 23.33, penalties_ap: 0.33, yellows_ap: 2.17, yellows: 13, reds_ap: 0.17, reds: 1 },
                { name: "Gianluca Manganiello", matches: 5, fouls_avg: 29.40, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Simone Sozza", matches: 6, fouls_avg: 25.33, penalties_ap: 0.50, yellows_ap: 3.00, yellows: 18, reds_ap: 0.83, reds: 5 },
                { name: "Giovanni Ayroldi", matches: 6, fouls_avg: 31.17, penalties_ap: 0.00, yellows_ap: 4.33, yellows: 26, reds_ap: 0.17, reds: 1 },
                { name: "Matteo Marcenaro", matches: 6, fouls_avg: 26.33, penalties_ap: 0.00, yellows_ap: 4.33, yellows: 26, reds_ap: 0.17, reds: 1 },
                { name: "Valerio Crezzini", matches: 6, fouls_avg: 25.17, penalties_ap: 0.33, yellows_ap: 3.17, yellows: 19, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Arena", matches: 6, fouls_avg: 21.17, penalties_ap: 0.17, yellows_ap: 2.83, yellows: 17, reds_ap: 0.00, reds: 0 },
                { name: "Davide Massa", matches: 5, fouls_avg: 31.80, penalties_ap: 0.00, yellows_ap: 5.20, yellows: 26, reds_ap: 0.00, reds: 0 },
                { name: "Rosario Abisso", matches: 4, fouls_avg: 29.75, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.25, reds: 1 },
                { name: "Federico La Penna", matches: 6, fouls_avg: 27.83, penalties_ap: 0.33, yellows_ap: 3.17, yellows: 19, reds_ap: 0.33, reds: 2 },
                { name: "Andrea Colombo", matches: 4, fouls_avg: 28.25, penalties_ap: 0.25, yellows_ap: 3.75, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Ermanno Feliciani", matches: 5, fouls_avg: 24.40, penalties_ap: 0.20, yellows_ap: 3.20, yellows: 16, reds_ap: 0.00, reds: 0 },
                { name: "Kevin Bonacina", matches: 5, fouls_avg: 26.40, penalties_ap: 0.20, yellows_ap: 3.80, yellows: 19, reds_ap: 0.20, reds: 1 },
                { name: "Marco Di Bello", matches: 5, fouls_avg: 26.80, penalties_ap: 0.60, yellows_ap: 4.00, yellows: 20, reds_ap: 0.20, reds: 1 },
                { name: "Marco Piccinini", matches: 4, fouls_avg: 29.25, penalties_ap: 0.50, yellows_ap: 3.75, yellows: 15, reds_ap: 0.50, reds: 2 },
                { name: "Livio Marinelli", matches: 3, fouls_avg: 22.33, penalties_ap: 0.33, yellows_ap: 3.33, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Fourneau", matches: 3, fouls_avg: 28.33, penalties_ap: 0.67, yellows_ap: 5.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Maurizio Mariani", matches: 4, fouls_avg: 26.75, penalties_ap: 1.00, yellows_ap: 3.75, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Michael Fabbri", matches: 4, fouls_avg: 28.25, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 20, reds_ap: 0.25, reds: 1 },
                { name: "Antonio Rapuano", matches: 2, fouls_avg: 31.50, penalties_ap: 0.50, yellows_ap: 5.50, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Marchetti", matches: 3, fouls_avg: 25.67, penalties_ap: 0.33, yellows_ap: 3.67, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Paride Tremolada", matches: 2, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Luca Pairetto", matches: 3, fouls_avg: 33.67, penalties_ap: 0.33, yellows_ap: 6.67, yellows: 20, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 1, fouls_avg: 36.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Juan Luca Sacchi", matches: 2, fouls_avg: 30.50, penalties_ap: 0.50, yellows_ap: 1.50, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 1, fouls_avg: 28.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Perenzoni", matches: 1, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Fabio Maresca", matches: 1, fouls_avg: 28.00, penalties_ap: 1.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Giuseppe Mucera", matches: 1, fouls_avg: 27.00, penalties_ap: 1.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 1, fouls_avg: 20.00, penalties_ap: 1.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 }
            ],
            "2024-25": [
                { name: "Davide Massa", matches: 19, fouls_avg: 25.74, penalties_ap: 0.16, yellows_ap: 4.21, yellows: 80, reds_ap: 0.26, reds: 5 },
                { name: "Maurizio Mariani", matches: 18, fouls_avg: 25.94, penalties_ap: 0.11, yellows_ap: 3.72, yellows: 67, reds_ap: 0.17, reds: 3 },
                { name: "Michael Fabbri", matches: 18, fouls_avg: 24.89, penalties_ap: 0.06, yellows_ap: 3.89, yellows: 70, reds_ap: 0.33, reds: 6 },
                { name: "Daniele Doveri", matches: 18, fouls_avg: 24.11, penalties_ap: 0.22, yellows_ap: 2.50, yellows: 45, reds_ap: 0.11, reds: 2 },
                { name: "Daniele Chiffi", matches: 17, fouls_avg: 20.29, penalties_ap: 0.29, yellows_ap: 3.71, yellows: 63, reds_ap: 0.18, reds: 3 },
                { name: "Gianluca Manganiello", matches: 17, fouls_avg: 25.59, penalties_ap: 0.24, yellows_ap: 3.24, yellows: 55, reds_ap: 0.18, reds: 3 },
                { name: "Livio Marinelli", matches: 17, fouls_avg: 24.18, penalties_ap: 0.29, yellows_ap: 2.88, yellows: 49, reds_ap: 0.18, reds: 3 },
                { name: "Simone Sozza", matches: 17, fouls_avg: 24.00, penalties_ap: 0.59, yellows_ap: 3.53, yellows: 60, reds_ap: 0.06, reds: 1 },
                { name: "Marco Piccinini", matches: 16, fouls_avg: 24.00, penalties_ap: 0.19, yellows_ap: 3.81, yellows: 61, reds_ap: 0.06, reds: 1 },
                { name: "Andrea Colombo", matches: 16, fouls_avg: 25.19, penalties_ap: 0.13, yellows_ap: 4.13, yellows: 66, reds_ap: 0.13, reds: 2 },
                { name: "Marco Di Bello", matches: 15, fouls_avg: 26.20, penalties_ap: 0.27, yellows_ap: 2.60, yellows: 39, reds_ap: 0.13, reds: 2 },
                { name: "Luca Zufferli", matches: 15, fouls_avg: 22.80, penalties_ap: 0.20, yellows_ap: 2.73, yellows: 41, reds_ap: 0.20, reds: 3 },
                { name: "Luca Pairetto", matches: 14, fouls_avg: 26.57, penalties_ap: 0.29, yellows_ap: 4.14, yellows: 58, reds_ap: 0.50, reds: 7 },
                { name: "Federico La Penna", matches: 14, fouls_avg: 27.71, penalties_ap: 0.43, yellows_ap: 4.36, yellows: 61, reds_ap: 0.07, reds: 1 },
                { name: "Antonio Rapuano", matches: 14, fouls_avg: 27.93, penalties_ap: 0.14, yellows_ap: 4.50, yellows: 63, reds_ap: 0.43, reds: 6 },
                { name: "Rosario Abisso", matches: 12, fouls_avg: 24.42, penalties_ap: 0.50, yellows_ap: 3.83, yellows: 46, reds_ap: 0.17, reds: 2 },
                { name: "Matteo Marchetti", matches: 12, fouls_avg: 26.83, penalties_ap: 0.08, yellows_ap: 4.00, yellows: 48, reds_ap: 0.25, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 11, fouls_avg: 24.27, penalties_ap: 0.09, yellows_ap: 3.36, yellows: 37, reds_ap: 0.18, reds: 2 },
                { name: "Francesco Fourneau", matches: 11, fouls_avg: 27.55, penalties_ap: 0.27, yellows_ap: 4.18, yellows: 46, reds_ap: 0.09, reds: 1 },
                { name: "Giovanni Ayroldi", matches: 11, fouls_avg: 26.91, penalties_ap: 0.36, yellows_ap: 5.73, yellows: 63, reds_ap: 0.55, reds: 6 },
                { name: "Ermanno Feliciani", matches: 10, fouls_avg: 22.90, penalties_ap: 0.40, yellows_ap: 2.50, yellows: 25, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 8, fouls_avg: 22.63, penalties_ap: 0.25, yellows_ap: 3.88, yellows: 31, reds_ap: 0.25, reds: 2 },
                { name: "Matteo Marcenaro", matches: 8, fouls_avg: 22.88, penalties_ap: 0.50, yellows_ap: 5.00, yellows: 40, reds_ap: 0.38, reds: 3 },
                { name: "Fabio Maresca", matches: 7, fouls_avg: 25.43, penalties_ap: 0.29, yellows_ap: 4.43, yellows: 31, reds_ap: 0.14, reds: 1 },
                { name: "Giuseppe Collu", matches: 7, fouls_avg: 28.29, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 28, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Giua", matches: 5, fouls_avg: 22.20, penalties_ap: 0.60, yellows_ap: 3.60, yellows: 18, reds_ap: 0.20, reds: 1 },
                { name: "Paride Tremolada", matches: 5, fouls_avg: 24.20, penalties_ap: 0.60, yellows_ap: 4.20, yellows: 21, reds_ap: 0.40, reds: 2 },
                { name: "Gianluca Aureliano", matches: 4, fouls_avg: 22.50, penalties_ap: 0.25, yellows_ap: 2.75, yellows: 11, reds_ap: 0.25, reds: 1 },
                { name: "Federico Dionisi", matches: 4, fouls_avg: 28.50, penalties_ap: 0.25, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                { name: "Kevin Bonacina", matches: 4, fouls_avg: 24.25, penalties_ap: 0.50, yellows_ap: 3.00, yellows: 12, reds_ap: 0.50, reds: 2 },
                { name: "Luca Massimi", matches: 2, fouls_avg: 31.50, penalties_ap: 1.00, yellows_ap: 4.50, yellows: 9, reds_ap: 0.50, reds: 1 },
                { name: "Francesco Cosso", matches: 2, fouls_avg: 24.00, penalties_ap: 0.50, yellows_ap: 2.50, yellows: 5, reds_ap: 1.00, reds: 2 },
                { name: "Daniele Perenzoni", matches: 2, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.50, reds: 1 },
                { name: "Maria Ferrieri Caputi", matches: 2, fouls_avg: 32.00, penalties_ap: 1.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 2, fouls_avg: 22.50, penalties_ap: 1.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.50, reds: 1 },
                { name: "Davide Ghersini", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 0.00, yellows: 0, reds_ap: 0.00, reds: 0 },
                { name: "Alessandro Prontera", matches: 1, fouls_avg: 25.00, penalties_ap: 1.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Rutella", matches: 1, fouls_avg: 17.00, penalties_ap: 0.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Marco Monaldi", matches: 1, fouls_avg: 36.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Valerio Crezzini", matches: 1, fouls_avg: 29.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 5, reds_ap: 0.00, reds: 0 }
            ],
            "2023-24": [
                { name: "Marco Guida", matches: 17, fouls_avg: 23.59, penalties_ap: 0.47, yellows_ap: 4.00, yellows: 68, reds_ap: 0.06, reds: 1 },
                { name: "Daniele Doveri", matches: 17, fouls_avg: 24.47, penalties_ap: 0.18, yellows_ap: 3.24, yellows: 55, reds_ap: 0.35, reds: 6 },
                { name: "Daniele Orsato", matches: 16, fouls_avg: 23.38, penalties_ap: 0.31, yellows_ap: 4.69, yellows: 75, reds_ap: 0.19, reds: 3 },
                { name: "Davide Massa", matches: 16, fouls_avg: 26.06, penalties_ap: 0.31, yellows_ap: 5.06, yellows: 81, reds_ap: 0.00, reds: 0 },
                { name: "Fabio Maresca", matches: 16, fouls_avg: 25.50, penalties_ap: 0.25, yellows_ap: 5.69, yellows: 91, reds_ap: 0.06, reds: 1 },
                { name: "Andrea Colombo", matches: 16, fouls_avg: 24.19, penalties_ap: 0.19, yellows_ap: 5.38, yellows: 86, reds_ap: 0.38, reds: 6 },
                { name: "Maurizio Mariani", matches: 15, fouls_avg: 23.80, penalties_ap: 0.33, yellows_ap: 3.80, yellows: 57, reds_ap: 0.27, reds: 4 },
                { name: "Federico La Penna", matches: 15, fouls_avg: 24.07, penalties_ap: 0.40, yellows_ap: 4.60, yellows: 69, reds_ap: 0.13, reds: 2 },
                { name: "Juan Luca Sacchi", matches: 15, fouls_avg: 25.60, penalties_ap: 0.40, yellows_ap: 4.40, yellows: 66, reds_ap: 0.07, reds: 1 },
                { name: "Antonio Rapuano", matches: 15, fouls_avg: 25.40, penalties_ap: 0.40, yellows_ap: 3.93, yellows: 59, reds_ap: 0.27, reds: 4 },
                { name: "Luca Pairetto", matches: 14, fouls_avg: 23.36, penalties_ap: 0.50, yellows_ap: 4.14, yellows: 58, reds_ap: 0.00, reds: 0 },
                { name: "Michael Fabbri", matches: 13, fouls_avg: 24.31, penalties_ap: 0.31, yellows_ap: 3.23, yellows: 42, reds_ap: 0.15, reds: 2 },
                { name: "Ermanno Feliciani", matches: 13, fouls_avg: 22.38, penalties_ap: 0.23, yellows_ap: 3.08, yellows: 40, reds_ap: 0.08, reds: 1 },
                { name: "Gianluca Aureliano", matches: 12, fouls_avg: 25.50, penalties_ap: 0.50, yellows_ap: 4.25, yellows: 51, reds_ap: 0.17, reds: 2 },
                { name: "Gianluca Manganiello", matches: 12, fouls_avg: 22.33, penalties_ap: 0.25, yellows_ap: 3.67, yellows: 44, reds_ap: 0.25, reds: 3 },
                { name: "Marco Piccinini", matches: 12, fouls_avg: 23.17, penalties_ap: 0.50, yellows_ap: 3.83, yellows: 46, reds_ap: 0.17, reds: 2 },
                { name: "Matteo Marcenaro", matches: 12, fouls_avg: 22.58, penalties_ap: 0.33, yellows_ap: 4.83, yellows: 58, reds_ap: 0.25, reds: 3 },
                { name: "Marco Di Bello", matches: 11, fouls_avg: 23.18, penalties_ap: 0.45, yellows_ap: 4.18, yellows: 46, reds_ap: 0.45, reds: 5 },
                { name: "Antonio Giua", matches: 11, fouls_avg: 23.00, penalties_ap: 0.27, yellows_ap: 3.64, yellows: 40, reds_ap: 0.27, reds: 3 },
                { name: "Simone Sozza", matches: 11, fouls_avg: 26.36, penalties_ap: 0.82, yellows_ap: 4.36, yellows: 48, reds_ap: 0.18, reds: 2 },
                { name: "Matteo Marchetti", matches: 11, fouls_avg: 23.27, penalties_ap: 0.18, yellows_ap: 3.00, yellows: 33, reds_ap: 0.09, reds: 1 },
                { name: "Daniele Chiffi", matches: 9, fouls_avg: 22.22, penalties_ap: 0.11, yellows_ap: 4.00, yellows: 36, reds_ap: 0.11, reds: 1 },
                { name: "Alessandro Prontera", matches: 9, fouls_avg: 22.22, penalties_ap: 0.67, yellows_ap: 3.78, yellows: 34, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 9, fouls_avg: 27.89, penalties_ap: 0.11, yellows_ap: 3.22, yellows: 29, reds_ap: 0.11, reds: 1 },
                { name: "Livio Marinelli", matches: 8, fouls_avg: 24.38, penalties_ap: 0.25, yellows_ap: 4.50, yellows: 36, reds_ap: 0.50, reds: 4 },
                { name: "Luca Massimi", matches: 8, fouls_avg: 25.13, penalties_ap: 0.25, yellows_ap: 3.75, yellows: 30, reds_ap: 0.13, reds: 1 },
                { name: "Giovanni Ayroldi", matches: 8, fouls_avg: 26.13, penalties_ap: 0.38, yellows_ap: 5.25, yellows: 42, reds_ap: 0.38, reds: 3 },
                { name: "Maria Ferrieri Caputi", matches: 8, fouls_avg: 23.13, penalties_ap: 0.38, yellows_ap: 4.13, yellows: 33, reds_ap: 0.38, reds: 3 },
                { name: "Rosario Abisso", matches: 7, fouls_avg: 23.86, penalties_ap: 0.43, yellows_ap: 5.29, yellows: 37, reds_ap: 0.14, reds: 1 },
                { name: "Luca Zufferli", matches: 6, fouls_avg: 22.00, penalties_ap: 0.17, yellows_ap: 2.50, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Fourneau", matches: 5, fouls_avg: 21.80, penalties_ap: 0.40, yellows_ap: 3.60, yellows: 18, reds_ap: 0.20, reds: 1 },
                { name: "Alberto Santoro", matches: 3, fouls_avg: 26.67, penalties_ap: 0.33, yellows_ap: 5.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Paride Tremolada", matches: 3, fouls_avg: 25.67, penalties_ap: 0.67, yellows_ap: 4.33, yellows: 13, reds_ap: 0.00, reds: 0 },
                { name: "Giuseppe Collu", matches: 2, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 6, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 2, fouls_avg: 21.00, penalties_ap: 0.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Davide Ghersini", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 1.00, reds: 1 },
                { name: "Francesco Cosso", matches: 1, fouls_avg: 20.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 2, reds_ap: 0.00, reds: 0 }
            ],
            "2022-23": [
                 { name: "Daniele Orsato", matches: 15, fouls_avg: 21.40, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 45, reds_ap: 0.07, reds: 1 },
                 { name: "Fabio Maresca", matches: 15, fouls_avg: 25.60, penalties_ap: 0.00, yellows_ap: 5.33, yellows: 80, reds_ap: 0.20, reds: 3 },
                 { name: "Daniele Chiffi", matches: 15, fouls_avg: 23.47, penalties_ap: 0.00, yellows_ap: 4.47, yellows: 67, reds_ap: 0.20, reds: 3 },
                 { name: "Maurizio Mariani", matches: 14, fouls_avg: 24.07, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 63, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Doveri", matches: 14, fouls_avg: 25.43, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 49, reds_ap: 0.21, reds: 3 },
                 { name: "Davide Massa", matches: 14, fouls_avg: 27.64, penalties_ap: 0.00, yellows_ap: 6.21, yellows: 87, reds_ap: 0.29, reds: 4 },
                 { name: "Antonio Rapuano", matches: 14, fouls_avg: 22.43, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 63, reds_ap: 0.21, reds: 3 },
                 { name: "Livio Marinelli", matches: 14, fouls_avg: 24.07, penalties_ap: 0.00, yellows_ap: 3.36, yellows: 47, reds_ap: 0.21, reds: 3 },
                 { name: "Michael Fabbri", matches: 12, fouls_avg: 23.17, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 57, reds_ap: 0.33, reds: 4 },
                 { name: "Luca Pairetto", matches: 12, fouls_avg: 26.08, penalties_ap: 0.00, yellows_ap: 4.42, yellows: 53, reds_ap: 0.17, reds: 2 },
                 { name: "Giovanni Ayroldi", matches: 12, fouls_avg: 27.50, penalties_ap: 0.00, yellows_ap: 5.25, yellows: 63, reds_ap: 0.08, reds: 1 },
                 { name: "Andrea Colombo", matches: 12, fouls_avg: 22.83, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 57, reds_ap: 0.00, reds: 0 },
                 { name: "Matteo Marcenaro", matches: 12, fouls_avg: 23.42, penalties_ap: 0.00, yellows_ap: 4.83, yellows: 58, reds_ap: 0.50, reds: 6 },
                 { name: "Marco Di Bello", matches: 11, fouls_avg: 28.55, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 55, reds_ap: 0.18, reds: 2 },
                 { name: "Antonio Giua", matches: 11, fouls_avg: 23.64, penalties_ap: 0.00, yellows_ap: 5.18, yellows: 57, reds_ap: 0.36, reds: 4 },
                 { name: "Simone Sozza", matches: 11, fouls_avg: 26.09, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 55, reds_ap: 0.00, reds: 0 },
                 { name: "Matteo Marchetti", matches: 11, fouls_avg: 27.45, penalties_ap: 0.00, yellows_ap: 4.09, yellows: 45, reds_ap: 0.27, reds: 3 },
                 { name: "Massimiliano Irrati", matches: 10, fouls_avg: 23.70, penalties_ap: 0.00, yellows_ap: 5.10, yellows: 51, reds_ap: 0.20, reds: 2 },
                 { name: "Rosario Abisso", matches: 10, fouls_avg: 24.60, penalties_ap: 0.00, yellows_ap: 3.90, yellows: 39, reds_ap: 0.30, reds: 3 },
                 { name: "Francesco Fourneau", matches: 10, fouls_avg: 24.20, penalties_ap: 0.00, yellows_ap: 4.70, yellows: 47, reds_ap: 0.00, reds: 0 },
                 { name: "Luca Massimi", matches: 10, fouls_avg: 22.70, penalties_ap: 0.00, yellows_ap: 4.10, yellows: 41, reds_ap: 0.40, reds: 4 },
                 { name: "Juan Luca Sacchi", matches: 9, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 3.22, yellows: 29, reds_ap: 0.22, reds: 2 },
                 { name: "Marco Piccinini", matches: 9, fouls_avg: 25.33, penalties_ap: 0.00, yellows_ap: 4.44, yellows: 40, reds_ap: 0.00, reds: 0 },
                 { name: "Federico Dionisi", matches: 9, fouls_avg: 28.11, penalties_ap: 0.00, yellows_ap: 4.56, yellows: 41, reds_ap: 0.11, reds: 1 },
                 { name: "Gianluca Aureliano", matches: 8, fouls_avg: 24.25, penalties_ap: 0.00, yellows_ap: 3.13, yellows: 25, reds_ap: 0.13, reds: 1 },
                 { name: "Paolo Valeri", matches: 7, fouls_avg: 26.86, penalties_ap: 0.00, yellows_ap: 4.57, yellows: 32, reds_ap: 0.14, reds: 1 },
                 { name: "Davide Ghersini", matches: 7, fouls_avg: 23.00, penalties_ap: 0.00, yellows_ap: 4.14, yellows: 29, reds_ap: 0.29, reds: 2 },
                 { name: "Federico La Penna", matches: 7, fouls_avg: 25.14, penalties_ap: 0.00, yellows_ap: 3.86, yellows: 27, reds_ap: 0.00, reds: 0 },
                 { name: "Alessandro Prontera", matches: 7, fouls_avg: 26.29, penalties_ap: 0.00, yellows_ap: 4.43, yellows: 31, reds_ap: 0.14, reds: 1 },
                 { name: "Alberto Santoro", matches: 7, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 4.86, yellows: 34, reds_ap: 0.14, reds: 1 },
                 { name: "Gianluca Manganiello", matches: 6, fouls_avg: 21.17, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 21, reds_ap: 0.00, reds: 0 },
                 { name: "Marco Guida", matches: 5, fouls_avg: 23.20, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                 { name: "Ivano Pezzuto", matches: 5, fouls_avg: 23.80, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                 { name: "Francesco Cosso", matches: 5, fouls_avg: 22.20, penalties_ap: 0.00, yellows_ap: 3.40, yellows: 17, reds_ap: 0.40, reds: 2 },
                 { name: "Ermanno Feliciani", matches: 5, fouls_avg: 22.40, penalties_ap: 0.00, yellows_ap: 3.80, yellows: 19, reds_ap: 0.00, reds: 0 },
                 { name: "NiccolÃ² Baroni", matches: 4, fouls_avg: 26.25, penalties_ap: 0.00, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                 { name: "Manuel Volpi", matches: 4, fouls_avg: 26.75, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 16, reds_ap: 0.00, reds: 0 },
                 { name: "Giacomo Camplone", matches: 4, fouls_avg: 23.75, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.50, reds: 2 },
                 { name: "Luca Zufferli", matches: 3, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 9, reds_ap: 0.00, reds: 0 },
                 { name: "Maria Ferrieri Caputi", matches: 3, fouls_avg: 23.67, penalties_ap: 0.00, yellows_ap: 2.33, yellows: 7, reds_ap: 0.00, reds: 0 },
                 { name: "Marco Serra", matches: 2, fouls_avg: 28.00, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.50, reds: 1 },
                 { name: "Daniele Perenzoni", matches: 2, fouls_avg: 28.50, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Minelli", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Paterna", matches: 1, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 2.00, reds: 2 },
                 { name: "Francesco Meraviglia", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 }
            ],
            "2021-22": [
                { name: "Daniele Doveri", matches: 17, fouls_avg: 26.82, penalties_ap: 0.35, yellows_ap: 3.47, yellows: 59, reds_ap: 0.18, reds: 3 },
                { name: "Marco Di Bello", matches: 17, fouls_avg: 27.18, penalties_ap: 0.47, yellows_ap: 4.29, yellows: 73, reds_ap: 0.24, reds: 4 },
                { name: "Fabio Maresca", matches: 16, fouls_avg: 24.75, penalties_ap: 0.38, yellows_ap: 4.50, yellows: 72, reds_ap: 0.31, reds: 5 },
                { name: "Daniele Chiffi", matches: 16, fouls_avg: 24.88, penalties_ap: 0.31, yellows_ap: 3.63, yellows: 58, reds_ap: 0.19, reds: 3 },
                { name: "Daniele Orsato", matches: 15, fouls_avg: 28.00, penalties_ap: 0.27, yellows_ap: 5.87, yellows: 88, reds_ap: 0.13, reds: 2 },
                { name: "Maurizio Mariani", matches: 14, fouls_avg: 28.79, penalties_ap: 0.21, yellows_ap: 4.86, yellows: 68, reds_ap: 0.36, reds: 5 },
                { name: "Marco Guida", matches: 14, fouls_avg: 27.14, penalties_ap: 0.29, yellows_ap: 4.79, yellows: 67, reds_ap: 0.21, reds: 3 },
                { name: "Davide Massa", matches: 14, fouls_avg: 26.29, penalties_ap: 0.14, yellows_ap: 4.21, yellows: 59, reds_ap: 0.36, reds: 5 },
                { name: "Livio Marinelli", matches: 14, fouls_avg: 21.86, penalties_ap: 0.29, yellows_ap: 3.93, yellows: 55, reds_ap: 0.00, reds: 0 },
                { name: "Simone Sozza", matches: 14, fouls_avg: 26.43, penalties_ap: 0.29, yellows_ap: 4.36, yellows: 61, reds_ap: 0.21, reds: 3 },
                { name: "Rosario Abisso", matches: 13, fouls_avg: 25.92, penalties_ap: 0.46, yellows_ap: 4.69, yellows: 61, reds_ap: 0.31, reds: 4 },
                { name: "Paolo Valeri", matches: 12, fouls_avg: 30.25, penalties_ap: 0.42, yellows_ap: 5.00, yellows: 60, reds_ap: 0.17, reds: 2 },
                { name: "Michael Fabbri", matches: 12, fouls_avg: 23.67, penalties_ap: 0.17, yellows_ap: 3.67, yellows: 44, reds_ap: 0.50, reds: 6 },
                { name: "Luca Pairetto", matches: 12, fouls_avg: 26.58, penalties_ap: 0.92, yellows_ap: 4.33, yellows: 52, reds_ap: 0.25, reds: 3 },
                { name: "Gianluca Manganiello", matches: 12, fouls_avg: 24.08, penalties_ap: 0.17, yellows_ap: 3.50, yellows: 42, reds_ap: 0.17, reds: 2 },
                { name: "Massimiliano Irrati", matches: 11, fouls_avg: 27.00, penalties_ap: 0.64, yellows_ap: 5.64, yellows: 62, reds_ap: 0.27, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 11, fouls_avg: 25.55, penalties_ap: 0.09, yellows_ap: 3.45, yellows: 38, reds_ap: 0.27, reds: 3 },
                { name: "Francesco Fourneau", matches: 11, fouls_avg: 27.45, penalties_ap: 0.36, yellows_ap: 4.73, yellows: 52, reds_ap: 0.27, reds: 3 },
                { name: "Luca Massimi", matches: 11, fouls_avg: 29.27, penalties_ap: 0.18, yellows_ap: 4.27, yellows: 47, reds_ap: 0.27, reds: 3 },
                { name: "Giovanni Ayroldi", matches: 11, fouls_avg: 29.82, penalties_ap: 0.18, yellows_ap: 5.36, yellows: 59, reds_ap: 0.18, reds: 2 },
                { name: "Alessandro Prontera", matches: 10, fouls_avg: 26.70, penalties_ap: 0.50, yellows_ap: 4.70, yellows: 47, reds_ap: 0.40, reds: 4 },
                { name: "Antonio Rapuano", matches: 9, fouls_avg: 26.22, penalties_ap: 0.44, yellows_ap: 4.11, yellows: 37, reds_ap: 0.56, reds: 5 },
                { name: "Davide Ghersini", matches: 8, fouls_avg: 21.38, penalties_ap: 0.63, yellows_ap: 3.25, yellows: 26, reds_ap: 0.13, reds: 1 },
                { name: "Gianluca Aureliano", matches: 8, fouls_avg: 29.63, penalties_ap: 0.75, yellows_ap: 5.13, yellows: 41, reds_ap: 0.25, reds: 2 },
                { name: "Marco Piccinini", matches: 8, fouls_avg: 26.00, penalties_ap: 0.38, yellows_ap: 4.25, yellows: 34, reds_ap: 0.50, reds: 4 },
                { name: "Matteo Marchetti", matches: 8, fouls_avg: 26.13, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 36, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 7, fouls_avg: 31.14, penalties_ap: 0.14, yellows_ap: 4.86, yellows: 34, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 7, fouls_avg: 26.86, penalties_ap: 0.43, yellows_ap: 3.57, yellows: 25, reds_ap: 0.43, reds: 3 },
                { name: "Antonio Giua", matches: 6, fouls_avg: 25.67, penalties_ap: 0.50, yellows_ap: 5.33, yellows: 32, reds_ap: 0.17, reds: 1 },
                { name: "Manuel Volpi", matches: 6, fouls_avg: 31.17, penalties_ap: 0.50, yellows_ap: 6.17, yellows: 37, reds_ap: 0.33, reds: 2 },
                { name: "Piero Giacomelli", matches: 5, fouls_avg: 29.60, penalties_ap: 0.40, yellows_ap: 4.60, yellows: 23, reds_ap: 0.00, reds: 0 },
                { name: "Marco Serra", matches: 5, fouls_avg: 24.80, penalties_ap: 1.00, yellows_ap: 5.20, yellows: 26, reds_ap: 0.20, reds: 1 },
                { name: "Lorenzo Maggioni", matches: 4, fouls_avg: 29.00, penalties_ap: 0.50, yellows_ap: 5.00, yellows: 20, reds_ap: 0.25, reds: 1 },
                { name: "Giacomo Camplone", matches: 3, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 3.67, yellows: 11, reds_ap: 0.67, reds: 2 },
                { name: "Andrea Colombo", matches: 3, fouls_avg: 25.33, penalties_ap: 0.00, yellows_ap: 5.33, yellows: 16, reds_ap: 0.33, reds: 1 },
                { name: "Matteo Marcenaro", matches: 3, fouls_avg: 28.33, penalties_ap: 0.33, yellows_ap: 4.67, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Valerio Marini", matches: 2, fouls_avg: 28.50, penalties_ap: 1.50, yellows_ap: 5.50, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Santoro", matches: 2, fouls_avg: 25.50, penalties_ap: 0.00, yellows_ap: 2.50, yellows: 5, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Gariglio", matches: 2, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Cosso", matches: 2, fouls_avg: 25.00, penalties_ap: 1.00, yellows_ap: 5.00, yellows: 10, reds_ap: 1.00, reds: 2 },
                { name: "Antonio Di Martino", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "NiccolÃ² Baroni", matches: 1, fouls_avg: 23.00, penalties_ap: 2.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Paterna", matches: 1, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Meraviglia", matches: 1, fouls_avg: 29.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Gianpiero Miele", matches: 1, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 }
            ],
            "2020-21": [
                { name: "Maurizio Mariani", matches: 18, fouls_avg: 27.11, penalties_ap: 0.50, yellows_ap: 3.67, yellows: 66, reds_ap: 0.11, reds: 2 },
                { name: "Daniele Doveri", matches: 17, fouls_avg: 29.06, penalties_ap: 0.29, yellows_ap: 4.06, yellows: 69, reds_ap: 0.00, reds: 0 },
                { name: "Davide Massa", matches: 17, fouls_avg: 27.76, penalties_ap: 0.35, yellows_ap: 4.47, yellows: 76, reds_ap: 0.24, reds: 4 },
                { name: "Marco Di Bello", matches: 17, fouls_avg: 27.41, penalties_ap: 0.47, yellows_ap: 4.65, yellows: 79, reds_ap: 0.18, reds: 3 },
                { name: "Piero Giacomelli", matches: 17, fouls_avg: 29.65, penalties_ap: 0.65, yellows_ap: 4.59, yellows: 78, reds_ap: 0.06, reds: 1 },
                { name: "Gianpaolo Calvarese", matches: 16, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 3.50, yellows: 56, reds_ap: 0.31, reds: 5 },
                { name: "Daniele Chiffi", matches: 16, fouls_avg: 27.75, penalties_ap: 0.31, yellows_ap: 3.56, yellows: 57, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Orsato", matches: 15, fouls_avg: 29.07, penalties_ap: 0.13, yellows_ap: 5.13, yellows: 77, reds_ap: 0.13, reds: 2 },
                { name: "Luca Pairetto", matches: 15, fouls_avg: 28.67, penalties_ap: 0.47, yellows_ap: 3.80, yellows: 57, reds_ap: 0.40, reds: 6 },
                { name: "Michael Fabbri", matches: 14, fouls_avg: 23.57, penalties_ap: 0.36, yellows_ap: 4.57, yellows: 64, reds_ap: 0.21, reds: 3 },
                { name: "Fabio Maresca", matches: 14, fouls_avg: 26.64, penalties_ap: 0.07, yellows_ap: 6.00, yellows: 84, reds_ap: 0.29, reds: 4 },
                { name: "Paolo Valeri", matches: 13, fouls_avg: 27.00, penalties_ap: 0.38, yellows_ap: 4.38, yellows: 57, reds_ap: 0.23, reds: 3 },
                { name: "Rosario Abisso", matches: 13, fouls_avg: 27.23, penalties_ap: 0.62, yellows_ap: 4.31, yellows: 56, reds_ap: 0.31, reds: 4 },
                { name: "Marco Piccinini", matches: 13, fouls_avg: 27.85, penalties_ap: 0.38, yellows_ap: 3.62, yellows: 47, reds_ap: 0.08, reds: 1 },
                { name: "Fabrizio Pasqua", matches: 12, fouls_avg: 25.00, penalties_ap: 0.25, yellows_ap: 3.42, yellows: 41, reds_ap: 0.25, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 12, fouls_avg: 25.75, penalties_ap: 0.33, yellows_ap: 4.17, yellows: 50, reds_ap: 0.08, reds: 1 },
                { name: "Massimiliano Irrati", matches: 11, fouls_avg: 27.73, penalties_ap: 0.09, yellows_ap: 4.55, yellows: 50, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 10, fouls_avg: 27.70, penalties_ap: 0.50, yellows_ap: 4.20, yellows: 42, reds_ap: 0.30, reds: 3 },
                { name: "Federico La Penna", matches: 10, fouls_avg: 28.00, penalties_ap: 0.40, yellows_ap: 4.80, yellows: 48, reds_ap: 0.40, reds: 4 },
                { name: "Gianluca Manganiello", matches: 10, fouls_avg: 25.40, penalties_ap: 0.20, yellows_ap: 3.00, yellows: 30, reds_ap: 0.10, reds: 1 },
                { name: "Francesco Fourneau", matches: 9, fouls_avg: 29.00, penalties_ap: 0.67, yellows_ap: 5.56, yellows: 50, reds_ap: 0.22, reds: 2 },
                { name: "Valerio Marini", matches: 7, fouls_avg: 30.57, penalties_ap: 0.71, yellows_ap: 4.29, yellows: 30, reds_ap: 0.00, reds: 0 },
                { name: "Giovanni Ayroldi", matches: 7, fouls_avg: 26.00, penalties_ap: 0.57, yellows_ap: 3.86, yellows: 27, reds_ap: 0.43, reds: 3 },
                { name: "Gianluca Aureliano", matches: 6, fouls_avg: 26.17, penalties_ap: 0.67, yellows_ap: 5.50, yellows: 33, reds_ap: 0.00, reds: 0 },
                { name: "Livio Marinelli", matches: 6, fouls_avg: 23.83, penalties_ap: 0.17, yellows_ap: 4.00, yellows: 24, reds_ap: 0.17, reds: 1 },
                { name: "Antonio Giua", matches: 6, fouls_avg: 31.00, penalties_ap: 0.33, yellows_ap: 3.83, yellows: 23, reds_ap: 0.33, reds: 2 },
                { name: "Simone Sozza", matches: 6, fouls_avg: 25.00, penalties_ap: 0.17, yellows_ap: 3.33, yellows: 20, reds_ap: 0.33, reds: 2 },
                { name: "Ivano Pezzuto", matches: 5, fouls_avg: 28.40, penalties_ap: 0.80, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Alessandro Prontera", matches: 5, fouls_avg: 28.60, penalties_ap: 0.40, yellows_ap: 3.40, yellows: 17, reds_ap: 0.40, reds: 2 },
                { name: "Manuel Volpi", matches: 5, fouls_avg: 32.20, penalties_ap: 0.40, yellows_ap: 3.20, yellows: 16, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 5, fouls_avg: 29.40, penalties_ap: 0.40, yellows_ap: 4.40, yellows: 22, reds_ap: 0.00, reds: 0 },
                { name: "Davide Ghersini", matches: 4, fouls_avg: 25.75, penalties_ap: 1.00, yellows_ap: 4.50, yellows: 18, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Di Martino", matches: 4, fouls_avg: 28.75, penalties_ap: 0.25, yellows_ap: 4.75, yellows: 19, reds_ap: 0.75, reds: 3 },
                { name: "Antonio Rapuano", matches: 4, fouls_avg: 27.50, penalties_ap: 0.50, yellows_ap: 4.75, yellows: 19, reds_ap: 0.00, reds: 0 },
                { name: "Luca Massimi", matches: 4, fouls_avg: 31.25, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 18, reds_ap: 0.25, reds: 1 },
                { name: "Eugenio Abbattista", matches: 3, fouls_avg: 26.33, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 15, reds_ap: 0.33, reds: 1 },
                { name: "Marco Serra", matches: 2, fouls_avg: 33.00, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 9, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Paterna", matches: 2, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Santoro", matches: 2, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Gariglio", matches: 2, fouls_avg: 25.00, penalties_ap: 0.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Marchetti", matches: 2, fouls_avg: 32.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Riccardo Ros", matches: 1, fouls_avg: 37.00, penalties_ap: 1.00, yellows_ap: 6.00, yellows: 6, reds_ap: 1.00, reds: 1 },
                { name: "Lorenzo Maggioni", matches: 1, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Giacomo Camplone", matches: 1, fouls_avg: 20.00, penalties_ap: 1.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Meraviglia", matches: 1, fouls_avg: 22.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 1.00, reds: 1 }
            ],
        };

        const HISTORICAL_SEASONS = ['2023-24', '2022-23', '2021-22', '2020-21'];
        const SOON_SEASONS = ['2021-22', '2020-21']; // Re-added
        const ANALYTICS_SEASON_OPTIONS = ['2025-26', '2024-25', '2023-24', '2022-23'];
        const ANALYTICS_SEASON_DEFAULT = ['2025-26'];
        let analyticsSeasonFilters = {
            ritmo: [...ANALYTICS_SEASON_DEFAULT],
            severity: [...ANALYTICS_SEASON_DEFAULT],
            refRadar: [...ANALYTICS_SEASON_DEFAULT],
            eff: [...ANALYTICS_SEASON_DEFAULT],
            effTot: [...ANALYTICS_SEASON_DEFAULT],
            teamRadar: [...ANALYTICS_SEASON_DEFAULT],
        };

        const VIEW_ROUTE_MAP = {
            stats: 'stats',
            analytics: 'analytics',
            playingTime: 'playing-time',
            matches: 'matches',
            teams: 'teams',
            players: 'players',
            quiz: 'quiz',
        };

        // --- LOGIC SECTION ---
        let currentView = 'stats';
        let activeSeasons = ['2025-26'];
        let sortColumn = 'matches';
        let sortDirection = 'desc';
        let minMatchesFilterStats = 0;
	let minMatchesFilterPT = 0;
        let analyticsMinMatchesFilter = 0; // NUOVA VARIABILE PER IL FILTRO ANALYTICS
        let hideInactive = false;
        let isSeasonDropdownOpen = false;
        let debounceTimer; // Timer for debounce optimization
        
        // Paging variables for 'matches' view
        let matchesDataAll = [];
        let matchesCurrentPage = 1;
        const MATCHES_PER_PAGE = 50;


        // Chart Instances
        let chartScatter = null;
        let chartMatchCorrelation = null;
        let chartEffTotalCorrelation = null;
        let chartFoulsByMatchday = null;
        let chartPlayerScatter = null;
        let currentAnalyticsData = [];
        let currentMatchData = [];
let refereeData = [];
let chartRadar = null;

        const QUIZ_LENGTH = 10;
        const QUIZ_SEASON_WINDOWS = ANALYTICS_SEASON_OPTIONS.map((_, idx) => ANALYTICS_SEASON_OPTIONS.slice(0, idx + 1));
        const QUIZ_LATEST_SEASON = ANALYTICS_SEASON_OPTIONS[0];
        const QUIZ_MIN_REF_MATCHES = 5;

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i -= 1) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function buildOptionsFromCandidates(candidates, correctLabel) {
            const uniqueOptions = Array.from(new Set(candidates.filter(Boolean)));
            if (uniqueOptions.length < 4) return null;

            const shortlist = uniqueOptions.slice(0, 4);
            const options = shuffleArray(shortlist);
            const answer = options.indexOf(correctLabel);

            return answer === -1 ? null : { options, answer };
        }

        function buildTopEntityQuestion({ items, metricAccessor, labelAccessor, question, order = 'desc', valueFormatter, seasonLabel }) {
            const scored = (items || [])
                .map(item => ({ item, value: metricAccessor(item), label: labelAccessor(item) }))
                .filter(entry => Number.isFinite(entry.value) && entry.label);

            const sorted = scored.sort((a, b) => (order === 'asc' ? a.value - b.value : b.value - a.value));
            const uniqueLabels = [];

            sorted.forEach(row => {
                if (!uniqueLabels.includes(row.label)) uniqueLabels.push(row.label);
            });

            if (uniqueLabels.length < 4 || !sorted.length) return null;

            const topEntry = sorted[0];
            const correctLabel = topEntry.label;
            const optionSet = buildOptionsFromCandidates(uniqueLabels, correctLabel);
            if (!optionSet) return null;

            const questionText = typeof question === 'function'
                ? question({ topValue: topEntry.value, topLabel: correctLabel, seasonLabel })
                : question;

            if (!questionText) return null;

            const finalQuestion = valueFormatter && typeof valueFormatter === 'function' && typeof question !== 'function'
                ? `${questionText} (${valueFormatter(topEntry.value)})`
                : questionText;

            return {
                question: finalQuestion,
                options: optionSet.options,
                answer: optionSet.answer,
            };
        }

        function buildDynamicQuizQuestions() {
            const questions = [];
            const latestTeams = processTeamsData([QUIZ_LATEST_SEASON]);
            const seasonWindows = QUIZ_SEASON_WINDOWS.length ? QUIZ_SEASON_WINDOWS : [ANALYTICS_SEASON_OPTIONS];

            const matchLabel = m => `${m.match} (${m.season})`;
            const effRatio = m => Number.isFinite(m.effRatio) ? m.effRatio : calculateEffRatio(m.effectiveTimeSec, m.totalTimeSec);

            seasonWindows.forEach(seasons => {
                const seasonLabel = formatSeasonSpanLabel(seasons);
                const recentMatches = processMatchesViewData(seasons);
                const recentRefs = processCombinedStats(seasons).filter(r => (r.matches || 0) >= QUIZ_MIN_REF_MATCHES);

                const builders = [
                    buildTopEntityQuestion({
                        items: recentMatches,
                        metricAccessor: m => m.effectiveTimeSec,
                        labelAccessor: matchLabel,
                        valueFormatter: formatSecondsToTime,
                        seasonLabel,
                        question: ({ topValue }) => `Quale partita ha avuto il maggior tempo effettivo (${formatSecondsToTime(topValue)}) ${seasonLabel}?`
                    }),
                    buildTopEntityQuestion({
                        items: recentMatches,
                        metricAccessor: m => m.totalTimeSec,
                        labelAccessor: matchLabel,
                        valueFormatter: formatSecondsToTime,
                        seasonLabel,
                        question: ({ topValue }) => `Quale partita ha avuto il maggior tempo totale (${formatSecondsToTime(topValue)}) ${seasonLabel}?`
                    }),
                    buildTopEntityQuestion({
                        items: recentMatches,
                        metricAccessor: m => effRatio(m),
                        labelAccessor: matchLabel,
                        valueFormatter: formatEffRatio,
                        seasonLabel,
                        question: ({ topValue }) => `Quale partita ha registrato la percentuale di tempo effettivo piÃ¹ alta (${formatEffRatio(topValue)}) ${seasonLabel}?`
                    }),
                    buildTopEntityQuestion({
                        items: recentMatches,
                        metricAccessor: m => m.fouls,
                        labelAccessor: matchLabel,
                        valueFormatter: v => formatQuizNumber(v, 0),
                        seasonLabel,
                        question: ({ topValue }) => `Quale partita ha avuto piÃ¹ falli fischiati (${formatQuizNumber(topValue, 0)}) ${seasonLabel}?`
                    }),
                    buildTopEntityQuestion({
                        items: recentRefs,
                        metricAccessor: r => r.avgFouls,
                        labelAccessor: r => r.name,
                        valueFormatter: v => `${formatQuizNumber(v, 2)} falli`,
                        seasonLabel,
                        question: ({ topValue }) => `Quale arbitro ha la media falli piÃ¹ alta (${formatQuizNumber(topValue, 2)}) ${seasonLabel}?`
                    }),
                    buildTopEntityQuestion({
                        items: recentRefs,
                        metricAccessor: r => r.avgYellows,
                        labelAccessor: r => r.name,
                        valueFormatter: v => `${formatQuizNumber(v, 2)} gialli`,
                        seasonLabel,
                        question: ({ topValue }) => `Quale arbitro estrae piÃ¹ cartellini gialli in media (${formatQuizNumber(topValue, 2)}) ${seasonLabel}?`
                    }),
                    buildTopEntityQuestion({
                        items: recentRefs,
                        metricAccessor: r => r.avgPens,
                        labelAccessor: r => r.name,
                        valueFormatter: v => `${formatQuizNumber(v, 2)} rigori`,
                        seasonLabel,
                        question: ({ topValue }) => `Quale arbitro ha assegnato piÃ¹ rigori in media (${formatQuizNumber(topValue, 2)}) ${seasonLabel}?`
                    }),
                    buildTopEntityQuestion({
                        items: recentRefs,
                        metricAccessor: r => r.avgEffSec,
                        labelAccessor: r => r.name,
                        valueFormatter: formatSecondsToTime,
                        seasonLabel,
                        question: ({ topValue }) => `Quale arbitro gestisce le gare con il maggior tempo effettivo medio (${formatSecondsToTime(topValue)}) ${seasonLabel}?`
                    })
                ];

                builders.filter(Boolean).forEach(q => questions.push(q));
            });

            const teamQuestions = [
                buildTopEntityQuestion({
                    items: latestTeams,
                    metricAccessor: t => t.avgEff,
                    labelAccessor: t => t.name,
                    valueFormatter: formatSecondsToTime,
                    question: ({ topValue }) => `Le partite di quale squadra hanno il tempo effettivo medio piÃ¹ alto (${formatSecondsToTime(topValue)}) nella stagione ${QUIZ_LATEST_SEASON}?`
                }),
                buildTopEntityQuestion({
                    items: latestTeams,
                    metricAccessor: t => t.avgFouls,
                    labelAccessor: t => t.name,
                    valueFormatter: v => `${formatQuizNumber(v, 2)} falli`,
                    question: ({ topValue }) => `Le partite di quale squadra registrano piÃ¹ falli in media (${formatQuizNumber(topValue, 2)}) nella stagione ${QUIZ_LATEST_SEASON}?`
                })
            ];

            teamQuestions.filter(Boolean).forEach(q => questions.push(q));
            return questions;
        }

        let quizQuestionsPool = [];
        let quizRound = [];
        let quizScore = 0;

        function normalizeQuizQuestion(question) {
            if (!question) return null;

            const mapped = (question.options || []).map((option, idx) => ({ option, idx }));
            shuffleArray(mapped);

            const shuffledOptions = mapped.map(item => item.option);
            const answerIndex = mapped.findIndex(item => item.idx === question.answer);

            return {
                ...question,
                options: shuffledOptions,
                answer: answerIndex,
                selected: null,
            };
        }

        function prepareQuizRound() {
            quizQuestionsPool = buildDynamicQuizQuestions();
            if (!quizQuestionsPool.length) return;

            const poolCopy = [...quizQuestionsPool];
            shuffleArray(poolCopy);

            quizRound = poolCopy.slice(0, QUIZ_LENGTH).map(normalizeQuizQuestion).filter(Boolean);
            quizScore = 0;
            updateQuizScore();
            renderQuizQuestions();
        }

        function updateQuizScore() {
            const scoreEl = document.getElementById('quiz-score');
            if (!scoreEl) return;

            scoreEl.textContent = `${quizScore} / ${QUIZ_LENGTH}`;
        }

        function handleQuizAnswer(questionIndex, optionIndex, targetBtn) {
            const question = quizRound[questionIndex];
            if (!question || question.selected !== null) return;

            question.selected = optionIndex;

            const optionButtons = targetBtn?.parentElement?.querySelectorAll('button') || [];

            optionButtons.forEach((button, idx) => {
                button.disabled = true;
                button.classList.remove('bg-slate-900', 'border-slate-800');

                if (idx === question.answer) {
                    button.classList.add('correct', 'border-emerald-400', 'bg-emerald-500/10');
                } else if (idx === optionIndex) {
                    button.classList.add('wrong', 'border-rose-400', 'bg-rose-500/10');
                } else {
                    button.classList.add('bg-slate-800/60', 'border-slate-700/70', 'text-slate-300');
                }
            });

            if (optionIndex === question.answer) quizScore += 1;
            updateQuizScore();
        }

        function renderQuizQuestions() {
            const container = document.getElementById('quiz-questions');
            if (!container) return;

            container.innerHTML = '';

            quizRound.forEach((question, questionIndex) => {
                const card = document.createElement('div');
                card.className = 'pro-card rounded-lg p-4 space-y-3 border border-slate-800 bg-slate-900/60 interactive-surface';

                const title = document.createElement('div');
                title.className = 'flex items-start gap-3';
                title.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-yellow-500/10 border border-yellow-500/30 text-yellow-400 font-bold flex items-center justify-center">${questionIndex + 1}</div>
                    <div>
                        <p class="text-xs uppercase tracking-[0.16em] text-slate-500 font-semibold">Domanda</p>
                        <h3 class="text-base font-semibold text-white leading-snug">${question.question}</h3>
                    </div>
                `;

                const optionsWrapper = document.createElement('div');
                optionsWrapper.className = 'grid grid-cols-1 gap-2';

                question.options.forEach((option, optionIndex) => {
                    const button = document.createElement('button');
                    button.type = 'button';
                    button.className = 'quiz-option interactive-surface w-full text-left px-3 py-2 bg-slate-900 border border-slate-800 rounded-lg text-sm font-semibold text-slate-200';
                    button.innerHTML = `
                        <span class="flex items-center gap-2">
                            <span class="w-6 h-6 rounded-full border border-slate-700 flex items-center justify-center text-[11px] text-slate-400">${String.fromCharCode(65 + optionIndex)}</span>
                            <span>${option}</span>
                        </span>
                    `;

                    button.addEventListener('click', () => handleQuizAnswer(questionIndex, optionIndex, button));
                    optionsWrapper.appendChild(button);
                });

                card.appendChild(title);
                card.appendChild(optionsWrapper);

                attachRippleEffect(Array.from(optionsWrapper.querySelectorAll('button')));

                container.appendChild(card);
            });
        }

let selectedRadarReferees = [];

        const PLAYER_SCATTER_ROLE_COLORS = {
            DF: '#22c55e',
            CC: '#38bdf8',
            ATT: '#ef4444'
        };

        const PLAYER_SCATTER_ROLE_LABELS = {
            DF: 'Difensori',
            CC: 'Centrocampisti',
            ATT: 'Attaccanti'
        };

        let analyticsPlayerRoles = new Set(['DF', 'CC', 'ATT']);
        let analyticsViewMode = 'refs';

        // Cache per i dataset pesanti usati nei grafici analytics
        const DATA_CACHE = {
            combinedStats: new Map(),
            playingTime: new Map(),
            matches: new Map(),
            heatmap: new Map(),
        };

        const SCUDETTO_ICON_URL = 'https://upload.wikimedia.org/wikipedia/commons/9/99/Scudetto.svg';

        // Heatmap hover/focus cache
        let heatmapMatrixCache = {};
        let heatmapOrderedTeams = [];
        let heatmapPinnedCell = null;
        let currentHeatmapSeason = '2024-25';

        // Player scatter focus cache
        let scatterPinnedPoint = null;


// ðŸ”µ Lista arbitri predefiniti (CAMBIALA OGNI GIORNATA)
const PRESET_RADAR_REFEREES = [
    "Livio Marinelli",
    "Simone Sozza",
    "Andrea Colombo",
    "Ermanno Feliciani",
    "Matteo Marchetti",
    "Daniele Doveri",
    "Davide Di Marco",
    "Juan Luca Sacchi",
    "Davide Massa",
    "Valerio Crezzini"
];


        const REFEREES_2425 = ["Feliciani", "Ayroldi", "Fabbri", "Maresca", "Ferrieri Caputi", "Marchetti", "Marinelli", "Tremolada", "Massa", "Marcenaro", "Sacchi", "Doveri", "Di Marco", "Mariani", "Rapuano", "Sozza", "Pairetto", "Zufferli", "Di Bello", "Giua", "Colombo", "Guida", "Prontera", "Piccinini", "La Penna", "Abisso", "Aureliano", "Manganiello", "Fourneau", "Chiffi", "Dionisi", "Collu", "Massimi", "Bonacina", "Cosso", "Perenzoni", "Ghersini", "Monaldi", "Rutella"];
        const REFEREES_2526 = ["Massa", "Ayroldi", "Collu", "Zufferli", "Sozza", "Manganiello", "Arena", "Marcenaro", "Tremolada", "La Penna", "Guida", "Marinelli", "Doveri", "Mariani", "Bonacina", "Chiffi", "Abisso", "Marchetti", "Crezzini", "Fourneau", "Colombo", "Piccinini", "Rapuano", "Feliciani", "Fabbri", "Dionisi", "Di Bello", "Pairetto", "Sacchi", "Pezzuto", "Di Marco", "GalipÃ²", "Perenzoni", "Ghersini", "Rutella", "Camplone", "Monaldi", "Cosso", "Santoro", "Scatena", "Mucera"];
        const ACTIVE_EXCEPTIONS = ["Maresca", "Caputi", "Ferrieri Caputi"];
        const HISTORICAL_SURNAMES = ["Irrati", "Orsato", "Valeri", "Pasqua", "Calvarese", "Giacomelli"];

// --- DATABASE LOGHI SQUADRE (Fonte: FotMob CDN - PNG Trasparenti) ---
const TEAM_LOGOS = {
    "Atalanta": "https://images.fotmob.com/image_resources/logo/teamlogo/8524.png",
    "Bologna": "https://images.fotmob.com/image_resources/logo/teamlogo/9857.png",
    "Cagliari": "https://images.fotmob.com/image_resources/logo/teamlogo/8529.png",
    "Como": "https://images.fotmob.com/image_resources/logo/teamlogo/10171.png",
    "Cremonese": "https://images.fotmob.com/image_resources/logo/teamlogo/7801.png",
    "Empoli": "https://images.fotmob.com/image_resources/logo/teamlogo/8534.png",
    "Fiorentina": "https://images.fotmob.com/image_resources/logo/teamlogo/8535.png",
    "Genoa": "https://images.fotmob.com/image_resources/logo/teamlogo/10233.png",
    "Inter": "https://images.fotmob.com/image_resources/logo/teamlogo/8636.png",
    "Juventus": "https://images.fotmob.com/image_resources/logo/teamlogo/9885.png",
    "Lazio": "https://images.fotmob.com/image_resources/logo/teamlogo/8543.png",
    "Lecce": "https://images.fotmob.com/image_resources/logo/teamlogo/9888.png",
    "Milan": "https://images.fotmob.com/image_resources/logo/teamlogo/8564.png",
    "Monza": "https://images.fotmob.com/image_resources/logo/teamlogo/6504.png",
    "Napoli": "https://images.fotmob.com/image_resources/logo/teamlogo/9875.png",
    "Parma": "https://images.fotmob.com/image_resources/logo/teamlogo/10167.png",
    "Pisa": "https://images.fotmob.com/image_resources/logo/teamlogo/6479.png",
    "Roma": "https://images.fotmob.com/image_resources/logo/teamlogo/8686.png",
    "Salernitana": "https://images.fotmob.com/image_resources/logo/teamlogo/6480.png",
    "Sassuolo": "https://images.fotmob.com/image_resources/logo/teamlogo/7943.png",
    "Frosinone": "https://images.fotmob.com/image_resources/logo/teamlogo/9891.png",
    "Torino": "https://images.fotmob.com/image_resources/logo/teamlogo/9804.png",
    "Udinese": "https://images.fotmob.com/image_resources/logo/teamlogo/8600.png",
    "Venezia": "https://images.fotmob.com/image_resources/logo/teamlogo/7881.png",
    "Verona": "https://images.fotmob.com/image_resources/logo/teamlogo/9876.png"
};

// Funzione helper per ottenere il logo (o uno scudetto grigio se manca)
function getTeamLogo(teamName) {
    const normalized = (teamName || '').trim();
    if (!normalized) return '';

    const lower = normalized.toLowerCase();
    const key = Object.keys(TEAM_LOGOS).find(k => lower.includes(k.toLowerCase()));
    return key ? TEAM_LOGOS[key] : "https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg";
}

        // --- DEBOUNCE FUNCTION ---
        function debounce(func, timeout = 300) {
          return (...args) => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => { func.apply(this, args); }, timeout);
          };
        }
        const debounceAggregate = debounce(aggregateData);
        // Nuova funzione debounce per i grafici
        const debounceRenderAnalytics = debounce(renderAnalyticsWithFilters);

        function getCacheKeyFromSeasons(seasons) {
            const seasonsArray = (Array.isArray(seasons) && seasons.length) ? seasons : activeSeasons;
            return [...seasonsArray].sort().join('|');
        }

        function scheduleAnalyticsRender(task = renderAnalyticsWithFilters) {
            const runner = () => task();

            if (typeof requestIdleCallback === 'function') {
                requestIdleCallback(runner, { timeout: 150 });
            } else {
                requestAnimationFrame(runner);
            }
        }

        // Helper Functions
        function parseTimeStr(str) {
            if(!str || str.trim().toUpperCase() === 'ND') return NaN;
            const clean = str.replace(/[^\d,\.]/g, '').replace(',', '.');
            const parts = clean.split('.');
            let m = parseInt(parts[0]) || 0;
            let s = parts.length > 1 ? parseInt(parts[1]) : 0;
            return (m * 60) + s;
        }

        function formatSecondsToTime(totalSeconds) {
            if(isNaN(totalSeconds)) return "ND";
            if(!totalSeconds && totalSeconds !== 0) return "00'00''";
            const m = Math.floor(totalSeconds / 60);
            const s = Math.round(totalSeconds % 60);
            return `${m}'${s.toString().padStart(2, '0')}''`;
        }

        function formatQuizNumber(value, digits = 2) {
            return Number.isFinite(value) ? value.toFixed(digits).replace('.', ',') : '-';
        }

        function calculateEffRatio(effSec, totSec) {
            if (!Number.isFinite(effSec) || !Number.isFinite(totSec) || totSec === 0) return NaN;
            return (effSec / totSec) * 100;
        }

        function formatEffRatio(value) {
            return Number.isFinite(value) ? `${value.toFixed(1)}%` : '-';
        }

        function formatSeasonSpanLabel(seasons) {
            if (!Array.isArray(seasons)) return '';
            const count = seasons.length;
            if (count === 1) return `nella stagione ${seasons[0]}`;
            return `nelle ultime ${count} stagioni`;
        }

        function parseItalianFloat(str) {
            if(!str || str.trim().toUpperCase() === 'ND') return NaN;
            return parseFloat(str.replace(',', '.').replace('%', ''));
        }

        function formatTitleCase(text) {
            if (!text) return '';
            return text
                .split(/\s+/)
                .filter(Boolean)
                .map(part => part.charAt(0).toUpperCase() + part.slice(1).toLowerCase())
                .join(' ');
        }

        function isRefereeActive(name) {
            const searchName = name.toUpperCase();
            if (activeSeasons.includes('2025-26')) {
                 if (REFEREES_2526.some(surname => searchName.includes(surname.toUpperCase()))) return true;
                 if (ACTIVE_EXCEPTIONS.some(ex => searchName.includes(ex.toUpperCase()))) return true;
            }
            if (!activeSeasons.includes('2025-26') && activeSeasons.includes('2024-25')) {
                 if (REFEREES_2425.some(surname => searchName.includes(surname.toUpperCase()))) return true;
            }
            return REFEREES_2526.some(surname => searchName.includes(surname.toUpperCase())) ||
                   ACTIVE_EXCEPTIONS.some(ex => searchName.includes(ex.toUpperCase()));
        }

        function formatRefereeNameHTML(fullName) {
            const upperName = fullName.toUpperCase();
            const allSurnames = [...REFEREES_2526, ...REFEREES_2425, ...ACTIVE_EXCEPTIONS, ...HISTORICAL_SURNAMES];
            const matches = allSurnames.filter(s => {
                const sUp = s.toUpperCase();
                return upperName.endsWith(" " + sUp) || upperName === sUp || upperName.includes(" " + sUp + " ");
            });
            const match = matches.sort((a, b) => b.length - a.length)[0];
            let surname = "", firstname = "";

            if (match) {
                const idx = upperName.lastIndexOf(match.toUpperCase());
                surname = fullName.substring(idx);
                firstname = fullName.substring(0, idx).trim();
            } else {
                const parts = fullName.split(' ');
                surname = parts.pop();
                firstname = parts.join(' ');
            }
            return `<div class="flex items-center truncate">
                        <span class="text-slate-500 font-medium mr-1.5 capitalize text-xs hidden sm:inline">${firstname.toLowerCase()}</span> 
                        <span class="text-white font-bold uppercase tracking-wide text-xs sm:text-sm">${surname}</span>
                    </div>`;
        }
        
        function getRefereeSurname(fullName) {
            const upperName = fullName.toUpperCase();
            const allSurnames = [...REFEREES_2526, ...REFEREES_2425, ...ACTIVE_EXCEPTIONS, ...HISTORICAL_SURNAMES];
            const matches = allSurnames.filter(s => upperName.includes(s.toUpperCase()));
            return matches.length > 0 ? matches.sort((a, b) => b.length - a.length)[0] : fullName.split(' ').pop();
        }

        /**
         * Calcola il colore in base al valore.
         * @param {number} value Il valore da colorare.
         * @param {number} min Il valore minimo del range.
         * @param {number} max Il valore massimo del range.
         * @param {boolean} reverse Se TRUE, Verde=Basso, Rosso=Alto. Utile per Tempo Totale.
         * @returns {string} La stringa CSS hsl() per il colore.
         */
        function getColorForValue(value, min, max, reverse = false) {
            if (isNaN(value) || value === null) return 'inherit';
            const range = max - min;
            if (range === 0) return 'hsl(120, 80%, 50%)'; // Verde fisso se il range Ã¨ nullo
            
            let percent = Math.min(1, Math.max(0, (value - min) / range));
            
            // Hue from 0 (red) to 120 (green)
            let hue;
            if (reverse) {
                // Rosso (0) per alto, Verde (120) per basso
                hue = (1 - percent) * 120;
            } else {
                // Rosso (0) per basso, Verde (120) per alto
                hue = percent * 120;
            }
            
            return `hsl(${hue}, 80%, 50%)`;
        }

        function parseMatchesDB(dbString, season) {
            if(!dbString || dbString.trim() === '') return [];
            return dbString.trim().split('\n').map(line => {
                const p = line.trim().split(/\t+/);
                if (p.length < 5) return null;
                return {
                    match: p[0].trim(), totalTimeSec: parseTimeStr(p[1]), effectiveTimeSec: parseTimeStr(p[2]),
                    ratio: parseItalianFloat(p[3]), fouls: parseInt(p[4]) || 0, yellows: p.length > 5 ? (parseInt(p[5]) || 0) : 0,
                    reds: p.length > 6 ? (parseInt(p[6]) || 0) : 0, pens: p.length > 7 ? (parseItalianFloat(p[7]) || 0) : 0,
                    season: season, rawTotal: p[1], rawEff: p[2], referee: null
                };
            }).filter(x => x);
        }

        function parsePlayingTimeDB(dbString, season) {
             if(!dbString || dbString.trim() === '') return [];
             return dbString.trim().split('\n').map(line => {
                 const p = line.split('\t');
                 if (p.length < 2) return null;
                 return { season: season, referee: p[0].trim(), effectiveTimeSec: parseTimeStr(p[1]), totalTimeSec: p.length > 2 ? parseTimeStr(p[2]) : NaN };
             }).filter(x => x);
        }

        function processStatsData(seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            let statsMap = new Map();
            const sourceDB = (typeof db !== 'undefined') ? db : STATS_DB;
            seasonsToUse.forEach(season => {
                // Filtra solo le stagioni con dati disponibili (db[season].length > 0)
                if (sourceDB[season] && sourceDB[season].length > 0) {
                    sourceDB[season].forEach(m => {
                        if (!statsMap.has(m.name)) statsMap.set(m.name, { name: m.name, matches: 0, fouls: 0, yellows: 0, reds: 0, pens: 0, w_avgFouls: 0, w_avgYellows: 0, w_avgReds: 0, w_avgPens: 0, w_effMin: 0 });
                        let r = statsMap.get(m.name);
                        r.matches += m.matches; r.yellows += m.yellows; r.reds += m.reds;
                        r.w_avgFouls += m.fouls_avg * m.matches; r.w_avgYellows += m.yellows_ap * m.matches;
                        r.w_avgReds += m.reds_ap * m.matches; r.w_avgPens += m.penalties_ap * m.matches;
                        // Uso eff_min per i dati dummy, altrimenti viene sovrascritto da ptData
                        r.w_effMin += (m.eff_min || 0) * m.matches; 
                    });
                }
            });
            return Array.from(statsMap.values()).map(r => {
                r.avgFouls = r.matches ? (r.w_avgFouls / r.matches) : 0; r.avgYellows = r.matches ? (r.w_avgYellows / r.matches) : 0;
                r.avgReds = r.matches ? (r.w_avgReds / r.matches) : 0; r.avgPens = r.matches ? (r.w_avgPens / r.matches) : 0;
                // Pre-popolo avgEffSec con i dati dummy, se presenti
                r.avgEffSec = r.matches ? (r.w_effMin / r.matches) * 60 : 0; 
                r.isInactive = !isRefereeActive(r.name);
                return r;
            });
        }

        function processCombinedStats(seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            const cacheKey = getCacheKeyFromSeasons(seasonsToUse);
            if (DATA_CACHE.combinedStats.has(cacheKey)) return DATA_CACHE.combinedStats.get(cacheKey);

            const stats = processStatsData(seasonsToUse);
            const pt = processPlayingTimeViewData(seasonsToUse);
            
            // IMPROVED MERGE: Match by Surname to solve "0 data" issues
            const merged = stats.map(s => {
                const surnameS = getRefereeSurname(s.name);
                const ptData = pt.find(p => getRefereeSurname(p.name) === surnameS);
                // Se ci sono dati in ptData, sovrascrivi l'avgEffSec calcolato prima
                s.avgEffSec = ptData ? ptData.avgEffSec : s.avgEffSec; 
                return {
                    ...s,
                    // avgEffSec: ptData ? ptData.avgEffSec : 0, // Rimossa, usiamo s.avgEffSec giÃ  aggiornato
                    avgTotSec: ptData ? ptData.avgTotSec : 0
                };
            });

            DATA_CACHE.combinedStats.set(cacheKey, merged);
            return merged;
        }

        function processPlayingTimeViewData(seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            const cacheKey = getCacheKeyFromSeasons(seasonsToUse);
            if (DATA_CACHE.playingTime.has(cacheKey)) return DATA_CACHE.playingTime.get(cacheKey);
            let statsMap = new Map();
            let allMatchData = [];
            seasonsToUse.forEach(s => {
                let db = (s === '2025-26')
                    ? MATCHES_DB_2526 + EXTRA_MATCHES_2526
                    : (s === '2024-25'
                        ? MATCHES_DB_2425
                        : (s === '2023-24'
                            ? MATCHES_DB_2324 + EXTRA_MATCHES_2324
                            : (s === '2022-23' ? MATCHES_DB_2223 + EXTRA_MATCHES_2223 : null)));
                if(db) allMatchData = allMatchData.concat(parseMatchesDB(db, s));
            });
            seasonsToUse.forEach(season => {
                const refData = parsePlayingTimeDB(PLAYING_TIME_DB[season], season);
                const assignedMatches = new Set();
                refData.forEach(entry => {
                    if (!statsMap.has(entry.referee)) statsMap.set(entry.referee, { name: entry.referee, matches: 0, totalEffectiveSec: 0, totalTotalSec: 0, validEffMatches: 0, validTotMatches: 0, matchList: [] });
                    let r = statsMap.get(entry.referee);
                    r.matches++;
                    if(!isNaN(entry.effectiveTimeSec)) { r.totalEffectiveSec += entry.effectiveTimeSec; r.validEffMatches++; }
                    let match = null;
                    const unassigned = allMatchData.filter(m => !assignedMatches.has(m.match) && m.season === season);
                    if (!isNaN(entry.effectiveTimeSec)) match = unassigned.find(m => Math.abs(m.effectiveTimeSec - entry.effectiveTimeSec) < 1);
                    if (!match && !isNaN(entry.totalTimeSec)) { const c = unassigned.filter(m => Math.abs(m.totalTimeSec - entry.totalTimeSec) < 2); if(c.length) match = c[0]; }
                    if(match) {
                        match.effRatio = Number.isFinite(match.ratio) ? match.ratio : calculateEffRatio(match.effectiveTimeSec, match.totalTimeSec);
                        r.matchList.push(match);
                        assignedMatches.add(match.match);
                        if(!isNaN(match.totalTimeSec)) { r.totalTotalSec += match.totalTimeSec; r.validTotMatches++; }
                    }
                    else {
                        let mt = !isNaN(entry.totalTimeSec) ? entry.totalTimeSec : NaN;
                        if(!isNaN(mt)) { r.totalTotalSec += mt; r.validTotMatches++; }
                        const effRatio = calculateEffRatio(entry.effectiveTimeSec, mt);
                        r.matchList.push({ match: "Dettaglio non disp.", season: season, effectiveTimeSec: entry.effectiveTimeSec, totalTimeSec: mt, effRatio });
                    }
                });
            });
            const processed = Array.from(statsMap.values()).map(r => {
                r.avgEffSec = r.validEffMatches ? (r.totalEffectiveSec / r.validEffMatches) : 0;
                r.avgTotSec = r.validTotMatches ? (r.totalTotalSec / r.validTotMatches) : 0;
                r.effRatio = calculateEffRatio(r.avgEffSec, r.avgTotSec);
                return r;
            });

            DATA_CACHE.playingTime.set(cacheKey, processed);
            return processed;
        }

        function processMatchesViewData(seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            const cacheKey = getCacheKeyFromSeasons(seasonsToUse);
            if (DATA_CACHE.matches.has(cacheKey)) return DATA_CACHE.matches.get(cacheKey);
            let all = [];
            seasonsToUse.forEach(s => {
                let dbData = (s === '2025-26')
                    ? MATCHES_DB_2526 + EXTRA_MATCHES_2526
                    : (s === '2024-25'
                        ? MATCHES_DB_2425
                        : (s === '2023-24'
                            ? MATCHES_DB_2324 + EXTRA_MATCHES_2324
                            : (s === '2022-23' ? MATCHES_DB_2223 + EXTRA_MATCHES_2223 : null)));
                if(dbData) all = all.concat(parseMatchesDB(dbData, s));
            });

            const parsed = assignRefereesToMatches(all, seasonsToUse);
            DATA_CACHE.matches.set(cacheKey, parsed);
            return parsed;
        }

        function assignRefereesToMatches(matches, seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            const assignedMatches = new Set();

            seasonsToUse.forEach(season => {
                const refEntries = parsePlayingTimeDB(PLAYING_TIME_DB[season], season);
                refEntries.forEach(entry => {
                    const candidates = matches.filter(m => m.season === season && !assignedMatches.has(m));

                    let match = candidates.find(m => Number.isFinite(m.effectiveTimeSec) && Math.abs(m.effectiveTimeSec - entry.effectiveTimeSec) < 1);

                    if (!match && Number.isFinite(entry.totalTimeSec)) {
                        match = candidates.find(m => Number.isFinite(m.totalTimeSec) && Math.abs(m.totalTimeSec - entry.totalTimeSec) < 2);
                    }

                    if (match) {
                        match.referee = entry.referee;
                        assignedMatches.add(match);
                    }
                });
            });

            // Assegna manualmente i match ancora senza arbitro usando la mappa dedicata
            seasonsToUse.forEach(season => {
                const manualMap = MANUAL_REF_ASSIGNMENTS[season] || {};
                matches.forEach(match => {
                    if (match.season === season && !match.referee && manualMap[match.match]) {
                        match.referee = manualMap[match.match];
                    }
                });
            });

            return matches;
        }

        function processTeamsData(seasons) {
            let teamsMap = new Map();
            const matches = processMatchesViewData(seasons);

            matches.forEach(m => {
                if(!m.match.includes('-')) return;
                const parts = m.match.split('-').map(s => s.trim());
                if(parts.length !== 2) return;
                const home = parts[0];
                const away = parts[1];

                [home, away].forEach((team, idx) => {
                    if(!teamsMap.has(team)) teamsMap.set(team, { 
                        name: team, matches: 0, 
                        totalFoulsInGames: 0, homeFoulsInGames: 0, awayFoulsInGames: 0,
                        homeGames: 0, awayGames: 0,
                        totalEffSec: 0, homeEffSec: 0, awayEffSec: 0,
                        validHomeEff: 0, validAwayEff: 0, validTotalEff: 0
                    });
                    
                    const t = teamsMap.get(team);
                    t.matches++;
                    t.totalFoulsInGames += m.fouls;
                    
                    if (!isNaN(m.effectiveTimeSec)) {
                        t.totalEffSec += m.effectiveTimeSec;
                        t.validTotalEff++;
                        if(idx === 0) { // Home
                            t.homeEffSec += m.effectiveTimeSec;
                            t.validHomeEff++;
                        } else { // Away
                            t.awayEffSec += m.effectiveTimeSec;
                            t.validAwayEff++;
                        }
                    }

                    if(idx === 0) { // Home
                        t.homeGames++;
                        t.homeFoulsInGames += m.fouls;
                    } else { // Away
                        t.awayGames++;
                        t.awayFoulsInGames += m.fouls;
                    }
                });
            });

            return Array.from(teamsMap.values()).map(t => {
                const avgFoulsHome = t.homeGames ? t.homeFoulsInGames/t.homeGames : 0;
                const avgFoulsAway = t.awayGames ? t.awayFoulsInGames/t.awayGames : 0;
                return {
                    name: t.name,
                    matches: t.matches,
                    avgFouls: t.matches ? t.totalFoulsInGames/t.matches : 0,
                    avgFoulsHome: avgFoulsHome,
                    avgFoulsAway: avgFoulsAway,
                    avgEff: t.validTotalEff ? t.totalEffSec/t.validTotalEff : 0,
                    avgEffHome: t.validHomeEff ? t.homeEffSec/t.validHomeEff : 0,
                    avgEffAway: t.validAwayEff ? t.awayEffSec/t.validAwayEff : 0
                };
            });
        }

        // --- Aggregation & UI Update ---
        function aggregateData() {
            // Nasconde i messaggi di stato
            ['historical-data-msg', 'empty-state-msg'].forEach(id => document.getElementById(id)?.classList.add('hidden'));
            
            let result = [];
            let matchResult = [];
            
            // Gestione della visibilitÃ  della ricerca globale e dei filtri laterali
            const globalSearchContainer = document.getElementById('global-search-container');
            const statsControls = document.getElementById('stats-controls');
            const minMatchesContainer = document.getElementById('min-matches-container');
            const activeFilterContainer = document.getElementById('active-filter-container');
            const matchesFiltersContainer = document.getElementById('matches-filters-container');

            // Nascondo tutti i filtri specifici per riabilitare solo quelli necessari
            if (globalSearchContainer) globalSearchContainer.classList.add('hidden');
            if (statsControls) statsControls.classList.add('hidden');
            if (matchesFiltersContainer) matchesFiltersContainer.classList.add('hidden');
            if (minMatchesContainer) minMatchesContainer.classList.add('hidden');
            if (activeFilterContainer) activeFilterContainer.classList.add('hidden');


            if (currentView === 'stats') {
                if (globalSearchContainer) globalSearchContainer.classList.remove('hidden');
                if (statsControls) statsControls.classList.remove('hidden');
                if (minMatchesContainer) minMatchesContainer.classList.remove('hidden');
                if (activeFilterContainer) activeFilterContainer.classList.remove('hidden');

                matchesCurrentPage = 1; 
                result = processCombinedStats(); 
                
                if(result.length > 0) {
                    const maxMatches = Math.max(...result.map(r => r.matches));
                    document.getElementById('minMatches').max = maxMatches;
                    document.getElementById('minMatches_mobile').max = maxMatches;
                }
                result = result.filter(r => r.matches >= minMatchesFilterStats);
                if(hideInactive) result = result.filter(r => !r.isInactive);
            } 

else if (currentView === 'playingTime') {
    if (globalSearchContainer) globalSearchContainer.classList.remove('hidden');
    if (statsControls) statsControls.classList.remove('hidden');
    if (minMatchesContainer) minMatchesContainer.classList.remove('hidden');

    matchesCurrentPage = 1;

    result = processPlayingTimeViewData();

    // â­ AGGIORNA IL MASSIMO DEL FILTRO (NUOVO)
    if (result.length > 0) {
        const maxMatchesPT = Math.max(...result.map(r => r.matches));
        document.getElementById('minMatches').max = maxMatchesPT;
        document.getElementById('minMatches_mobile').max = maxMatchesPT;
    }

    // â­ APPLICA IL FILTRO DI PLAYING TIME
    result = result.filter(r => r.matches >= minMatchesFilterPT);
}

else if (currentView === 'matches') {
    if (globalSearchContainer) globalSearchContainer.classList.remove('hidden');
    if (statsControls) statsControls.classList.remove('hidden');
    if (matchesFiltersContainer) matchesFiltersContainer.classList.remove('hidden');
    
    result = processMatchesViewData();
    const minTot = parseInt(document.getElementById('filterMinTot').value) * 60 || 0;
    const maxTot = (parseInt(document.getElementById('filterMaxTot').value) * 60) || 999999;
    const minEff = parseInt(document.getElementById('filterMinEff').value) * 60 || 0;
    const maxEff = (parseInt(document.getElementById('filterMaxEff').value) * 60) || 999999;
    const minFls = parseInt(document.getElementById('filterMinFls').value) || 0;
    const maxFls = parseInt(document.getElementById('filterMaxFls').value) || 999999;
    
    // ðŸ”¢ filtro per minuti / falli
    result = result.filter(r => {
        const tot = r.totalTimeSec || 0; 
        const eff = r.effectiveTimeSec || 0; 
        const fls = r.fouls || 0;
        return (
            tot >= minTot && tot <= maxTot &&
            eff >= minEff && eff <= maxEff &&
            fls >= minFls && fls <= maxFls
        );
    });

    // ðŸ” filtro di ricerca SOLO per la vista "Database / Partite"
    const qMatches = document.getElementById('searchInput')?.value?.toLowerCase() || '';
    if (qMatches) {
        result = result.filter(r =>
            (r.match || '').toLowerCase().includes(qMatches)
        );
    }
    
    matchesDataAll = result; 
    result = matchesDataAll.slice(0, matchesCurrentPage * MATCHES_PER_PAGE);
}

            else if (currentView === 'teams') {
                 if (globalSearchContainer) globalSearchContainer.classList.remove('hidden');
                 matchesCurrentPage = 1;
                 result = processTeamsData();
            }
            else if (currentView === 'analytics') {
                 // NESSUNA RICERCA/FILTRO GLOBALE PER I GRAFICI (solo filtri interni)
                 matchesCurrentPage = 1;

                 // Carica sempre tutte le stagioni disponibili per i grafici, poi i filtri locali gestiscono la selezione
                 result = processCombinedStats(ANALYTICS_SEASON_OPTIONS);
                 matchResult = processMatchesViewData(ANALYTICS_SEASON_OPTIONS);

                 // Imposta il massimo per il filtro min presenze dell'analytics
                 if(result.length > 0) {
                     const maxMatches = Math.max(...result.map(r => r.matches));
                     const analyticsMinMatchesEl = document.getElementById('analyticsMinMatches');
                     if(analyticsMinMatchesEl) analyticsMinMatchesEl.max = maxMatches;
                 }

                 // Il filtro per presenze minime in analytics viene applicato in renderAnalyticsWithFilters
                 if(hideInactive) result = result.filter(r => !r.isInactive);
            }


// Search (applied globally where applicable)
const q = document.getElementById('searchInput')?.value?.toLowerCase() || '';

if(q && result.length && currentView !== 'analytics') {

    if(currentView === 'matches') {
        result = result.filter(r =>
            (r.match || `${r.homeTeam}-${r.awayTeam}`)
                .toLowerCase()
                .includes(q)
        );
    }

    else {
        result = result.filter(r =>
            (r.name || '').toLowerCase().includes(q)
        );
    }
}

            // Sort (applied before paging if matches view)
            if (matchesDataAll.length && currentView === 'matches') {
                 matchesDataAll.sort((a, b) => { 
                    let va = a[sortColumn], vb = b[sortColumn];
                    const isInvalid = (v) => (typeof v === 'number' && isNaN(v)) || v === null || v === undefined;
                    if (isInvalid(va) && isInvalid(vb)) return 0;
                    if (isInvalid(va)) return 1; 
                    if (isInvalid(vb)) return -1; 
                    if (typeof va === 'string') return sortDirection === 'asc' ? va.localeCompare(vb) : vb.localeCompare(va);
                    return sortDirection === 'desc' ? vb - va : va - vb;
                 });
                 result = matchesDataAll.slice(0, matchesCurrentPage * MATCHES_PER_PAGE);
            } else if (result.length && currentView !== 'analytics') {
                result.sort((a, b) => {
                    let va = a[sortColumn], vb = b[sortColumn];
                    if (currentView === 'teams' && ['avgFouls', 'avgEff', 'avgFoulsHome', 'avgFoulsAway'].includes(sortColumn)) { 
                        const isInvalid = (v) => (typeof v === 'number' && isNaN(v)) || v === null || v === undefined || v === 0;
                        if (isInvalid(va) && isInvalid(vb)) return 0;
                        if (isInvalid(va)) return 1; 
                        if (isInvalid(vb)) return -1; 
                    }
                    const isInvalid = (v) => (typeof v === 'number' && isNaN(v)) || v === null || v === undefined;
                    if (isInvalid(va) && isInvalid(vb)) return 0;
                    if (isInvalid(va)) return 1; 
                    if (isInvalid(vb)) return -1; 
                    if (typeof va === 'string') return sortDirection === 'asc' ? va.localeCompare(vb) : vb.localeCompare(va);
                    return sortDirection === 'desc' ? vb - va : va - vb;
                });
            }

            // Render
            if (result.length > 0 || (currentView === 'analytics' && matchResult.length > 0)) {
                if (currentView === 'analytics') {
                    currentAnalyticsData = result;
                    currentMatchData = matchResult.filter(m => !isNaN(m.effectiveTimeSec) && m.effectiveTimeSec > 0 && m.fouls > 0); 
    refereeData = currentAnalyticsData;
                    renderAnalyticsWithFilters(); // Render with local filters
                } else {
                    renderTable(result);
                }
                updateKPIDashboard(result);
            } else {
                updateKPIDashboard([]);
                
                const viewsWithHistorical = ['playingTime', 'matches', 'teams'];
                const isHistoricalView = viewsWithHistorical.includes(currentView);
                const selectedHistorical = activeSeasons.filter(s => SOON_SEASONS.includes(s));
                
                // Controlla se ci sono dati per le stagioni 2024-25 e 2025-26
                const currentDataAvailable = db['2025-26'].length > 0 || db['2024-25'].length > 0 || db['2023-24'].length > 0;
                
                // Il messaggio storico appare se una vista storica Ã¨ selezionata E ci sono solo stagioni senza dati (SOON) selezionate
                const onlySoonSelected = activeSeasons.every(s => SOON_SEASONS.includes(s));
                const showHistoricalMessage = isHistoricalView && onlySoonSelected && !currentDataAvailable;

                if (showHistoricalMessage) {
                    const msgDiv = document.getElementById('historical-data-msg');
                    msgDiv.classList.remove('hidden');
                    document.getElementById('historical-msg-title').innerText = `Dati Stagione ${selectedHistorical.join(', ')} in fase di caricamento...`;
                } else {
                    document.getElementById('empty-state-msg').classList.remove('hidden');
                }
            }

            updateSeasonButtonsUI();
            updatePageTitleUI();
        }
        
        // --- PAGINATION / LAZY LOADING FUNCTIONS ---
        
        function resetMatchesPaging() {
            matchesCurrentPage = 1;
        }

        function loadMoreMatches() {
            matchesCurrentPage++;
            const startIndex = (matchesCurrentPage - 1) * MATCHES_PER_PAGE;
            const endIndex = matchesCurrentPage * MATCHES_PER_PAGE;
            
            const newMatches = matchesDataAll.slice(startIndex, endIndex);
            
            if (newMatches.length > 0) {
                renderMatchesRows(newMatches, false);
            }
            
            updateLoadMoreButton();
        }

        function updateLoadMoreButton() {
            const btnContainer = document.getElementById('loadMoreContainer');
            if(!btnContainer) return;

            const totalLoaded = matchesCurrentPage * MATCHES_PER_PAGE;
            const totalAvailable = matchesDataAll.length;
            
            if (currentView === 'matches' && totalLoaded < totalAvailable) {
                btnContainer.classList.remove('hidden');
                btnContainer.innerHTML = `<button onclick="loadMoreMatches()" class="w-full bg-slate-800 hover:bg-slate-700 text-yellow-500 font-bold py-2 px-4 rounded transition-colors text-sm flex items-center justify-center gap-2">
                    <i class="fa-solid fa-arrow-down-to-line"></i> Carica altre ${Math.min(MATCHES_PER_PAGE, totalAvailable - totalLoaded)} partite (${totalAvailable - totalLoaded} rimanenti)
                </button>`;
            } else {
                btnContainer.classList.add('hidden');
                if (currentView === 'matches' && totalAvailable > 0) {
                    const tfoot = document.getElementById('tableFooter');
                    // Rimuove messaggi precedenti prima di aggiungere il nuovo
                    const existingMsg = tfoot.querySelector('.final-message');
                    if (existingMsg) existingMsg.remove();
                    // Aggiungo un messaggio finale solo se non ci sono piÃ¹ match da caricare
                    const msgRow = document.createElement('tr');
                    msgRow.innerHTML = `<td colspan="6" class="text-center p-3 text-slate-500 text-xs border-t border-slate-700/50 final-message">Tutte le ${totalAvailable} partite visualizzate.</td>`;
                    tfoot.appendChild(msgRow);
                }
            }
        }
        
        // --- APEX CHARTS LOGIC ---
        
        // NUOVA FUNZIONE PER AGGIORNARE IL FILTRO MIN MATCHES DELL'ANALYTICS
        function updateAnalyticsMinMatches(val) {
            analyticsMinMatchesFilter = parseInt(val);
            document.getElementById('analyticsMinMatchesValue').innerText = val;
            debounceRenderAnalytics(); 
        }

        /**
         * Soluzione Definitiva Quadranti: Iniezione di DIV/HTML (Overlay)
         * Si basa sul ricalcolo manuale della plot area di ApexCharts e l'iniezione
         * di 4 DIV posizionati assolutamente.
         * @param {object} chartContext Il contesto del grafico ApexCharts.
         * @param {number} midXVal Valore medio dell'asse X.
         * @param {number} midYVal Valore medio dell'asse Y.
         * @param {boolean} isSeverityChart TRUE se Ã¨ il grafico di SeveritÃ .
         */

        function injectQuadrantDIVOverlay(chartContext, midXVal, midYVal, isSeverityChart = true) {
            const chart = chartContext.w.globals;
            const containerEl = chart.dom.baseEl;
            
            // Trova l'area di plotting (dove i dati sono disegnati)
            const plotArea = containerEl.querySelector('.apexcharts-plot-area');
            if (!plotArea) return;

            // Rimuove vecchi overlay
            let quadrantLayer = containerEl.querySelector('.overlay-quadranti');
            if (quadrantLayer) {
                quadrantLayer.remove();
            }

            // Aggiunge un nuovo layer di overlay come primo figlio (sotto SVG/Canvas)
            quadrantLayer = document.createElement('div');
            quadrantLayer.className = 'overlay-quadranti';
            containerEl.prepend(quadrantLayer);

            // Calcola le dimensioni e la posizione del plot area rispetto al container
            const containerRect = containerEl.getBoundingClientRect();
            const plotRect = plotArea.getBoundingClientRect();

            const plotTop = plotRect.top - containerRect.top;
            const plotLeft = plotRect.left - containerRect.left;
            const plotWidth = plotRect.width;
            const plotHeight = plotRect.height;

            // Applica le dimensioni e la posizione all'overlay
            quadrantLayer.style.top = `${plotTop}px`;
            quadrantLayer.style.left = `${plotLeft}px`;
            quadrantLayer.style.width = `${plotWidth}px`;
            quadrantLayer.style.height = `${plotHeight}px`;

            // Calcola le coordinate in pixel della linea mediana
            const xRange = chart.maxX - chart.minX;
            const yRange = chart.maxY - chart.minY;
            
            const xPercent = (midXVal - chart.minX) / xRange;
            const yPercent = (midYVal - chart.minY) / yRange;

            // La coordinata X (orizzontale) cresce da sinistra a destra
            let midXPixel = xPercent * plotWidth;
            
            // La coordinata Y (verticale) cresce dall'alto al basso (0% top, 100% bottom)
            // L'asse Y di ApexCharts Ã¨ invertito (Y=min Ã¨ in basso, Y=max Ã¨ in alto)
            let midYPixel = plotHeight * (1 - yPercent);

            // Correzione per valori fuori scala (midXPixel/midYPixel potrebbe essere < 0 o > plotWidth/plotHeight)
            midXPixel = Math.max(0, Math.min(plotWidth, midXPixel));
            midYPixel = Math.max(0, Math.min(plotHeight, midYPixel));

            // Colori: [Top-Left, Top-Right, Bottom-Left, Bottom-Right]
            const SEVERITY_COLORS = {
                // Low F, High Y (Chirurgici)
                TL: '#eab308',
                // High F, High Y (Rigidi)
                TR: '#ef4444', 
                // Low F, Low Y (Inglesi)
                BL: '#64748b', 
                // High F, Low Y (Gestori)
                BR: '#3b82f6'
            };

            const RITMO_COLORS = {
                // Low F, High TE (FluiditÃ )
                TL: '#22c55e', 
                // High F, High TE (Intenso)
                TR: '#3b82f6', 
                // Low F, Low TE (Lento)
                BL: '#64748b', 
                // High F, Low TE (Spezzettato)
                BR: '#ef4444' 
            };

            const colors = isSeverityChart ? SEVERITY_COLORS : RITMO_COLORS;
            
            // Aggiungi i 4 quadranti come DIV (posizionati relativamente all'overlay)
            quadrantLayer.innerHTML = `
                <!-- Top Left (Low X, High Y) -->
                <div class="quadrant" style="top: 0; left: 0; width: ${midXPixel}px; height: ${midYPixel}px; background-color: ${colors.TL}"></div>
                <!-- Top Right (High X, High Y) -->
                <div class="quadrant" style="top: 0; left: ${midXPixel}px; width: ${plotWidth - midXPixel}px; height: ${midYPixel}px; background-color: ${colors.TR}"></div>
                <!-- Bottom Left (Low X, Low Y) -->
                <div class="quadrant" style="top: ${midYPixel}px; left: 0; width: ${midXPixel}px; height: ${plotHeight - midYPixel}px; background-color: ${colors.BL}"></div>
                <!-- Bottom Right (High X, Low Y) -->
                <div class="quadrant" style="top: ${midYPixel}px; left: ${midXPixel}px; width: ${plotWidth - midXPixel}px; height: ${plotHeight - midYPixel}px; background-color: ${colors.BR}"></div>
            `;
            
            // Aggiungi le linee divisorie nel DIV overlay per evitare sovrapposizioni delle etichette
            quadrantLayer.innerHTML += `
                <!-- Linea Orizzontale -->
                <div style="position: absolute; top: ${midYPixel}px; left: 0; width: 100%; height: 1px; background: none; border-top: 1px dashed #475569; pointer-events: none; z-index: 2;"></div>
                <!-- Linea Verticale -->
                <div style="position: absolute; top: 0; left: ${midXPixel}px; width: 1px; height: 100%; background: none; border-left: 1px dashed #475569; pointer-events: none; z-index: 2;"></div>
            `;
        }

        function renderAnalyticsWithFilters() {
            // 1. Applica filtri locali ai dati globali
            const qSeverity = document.getElementById('analyticsSearchSeverity')?.value?.toLowerCase() || '';
            const qEffTot = document.getElementById('analyticsSearchEffTot')?.value?.toLowerCase() || '';

            const severitySeasons = analyticsSeasonFilters.severity || ANALYTICS_SEASON_DEFAULT;
            const radarSeasons = analyticsSeasonFilters.refRadar || ANALYTICS_SEASON_DEFAULT;
            const ritmoSeasons = analyticsSeasonFilters.ritmo || ANALYTICS_SEASON_DEFAULT;
            const effSeasons = analyticsSeasonFilters.eff || ANALYTICS_SEASON_DEFAULT;
            const effTotSeasons = analyticsSeasonFilters.effTot || ANALYTICS_SEASON_DEFAULT;
            const teamRadarSeasons = analyticsSeasonFilters.teamRadar || ANALYTICS_SEASON_DEFAULT;

            // --- APPLICAZIONE NUOVO FILTRO MIN MATCHES (Feature 1) ---
            const minMatches = analyticsMinMatchesFilter;

            let filteredRefData = processCombinedStats(severitySeasons).filter(r =>
                getRefereeSurname(r.name).toLowerCase().includes(qSeverity) &&
                r.matches >= minMatches
            );

            let radarData = processCombinedStats(radarSeasons).filter(r => r.matches >= minMatches);
            if (hideInactive) {
                filteredRefData = filteredRefData.filter(r => !r.isInactive);
                radarData = radarData.filter(r => !r.isInactive);
            }

            radarData = radarData.filter(r => getRefereeSurname(r.name).toLowerCase().includes(qSeverity));

            const effMatches = processMatchesViewData(effSeasons);
            const effTotMatches = processMatchesViewData(effTotSeasons);
            const filteredEffTotData = effTotMatches.filter(m =>
                m.match.toLowerCase().includes(qEffTot)
            );

            // Aggiorna i dataset globali usati dai grafici radar e scatter
            currentAnalyticsData = radarData;
            refereeData = radarData;

            // Aggiorna la UI dei chip stagione
            refreshAllAnalyticsSeasonChips();

            // Popola il dropdown del Radar
            const populateSelect = (id) => {
                const select = document.getElementById(id);
                // Salva lo stato del dropdown e ricarica solo le opzioni
                const currentValue = select.value;
                select.innerHTML = '<option value="">Seleziona arbitro da aggiungere...</option>';
                const sortedRefs = [...currentAnalyticsData].sort((a, b) => getRefereeSurname(a.name).localeCompare(getRefereeSurname(b.name)));
                sortedRefs.forEach(r => {
                    const opt = document.createElement('option');
                    opt.value = r.name;
                    opt.text = getRefereeSurname(r.name);
                    select.appendChild(opt);
                });
                select.value = currentValue; // Ripristina il valore selezionato
            }
            populateSelect('radar-ref-select');
            renderRadarChips();

            // 2. Renderizza i grafici con i dati filtrati
            renderSeverityScatter(filteredRefData);
            renderEffVsTotalScatter(filteredEffTotData, effTotMatches, effTotSeasons);
            updateRadarChart();
            renderEffDistributionChart(effMatches); // Passiamo i dati delle partite
            renderFoulsByMatchdayChart();
            renderTopFlopTeamsChart(teamRadarSeasons); // Questa calcolerÃ  i dati delle squadre internamente
            renderTeamHeatmap();

        }

        function renderSeverityScatter(refData) {
            const scatterData = refData.filter(r => r.avgFouls > 0 && r.avgYellows > 0).map(r => ({
                x: parseFloat(r.avgFouls.toFixed(2)),
                y: parseFloat(r.avgYellows.toFixed(2)),
                name: getRefereeSurname(r.name)
            }));
            
            const xVals = scatterData.map(d => d.x);
            const yVals = scatterData.map(d => d.y);
            const xMinData = xVals.length ? Math.min(...xVals) : 20;
            const xMaxData = xVals.length ? Math.max(...xVals) : 30;
            const yMinData = yVals.length ? Math.min(...yVals) : 3;
            const yMaxData = yVals.length ? Math.max(...yVals) : 6;

            // Allinea le tacche dei falli a step fissi di 4 unitÃ 
            const FOUL_TICK_STEP = 4;
            const xMin = Math.floor((xMinData - 1) / FOUL_TICK_STEP) * FOUL_TICK_STEP;
            const xMax = Math.ceil((xMaxData + 3) / FOUL_TICK_STEP) * FOUL_TICK_STEP;
            const xTickAmount = Math.max(Math.round((xMax - xMin) / FOUL_TICK_STEP), 1);

            const yMin = Math.floor(yMinData - 0.5);
            const yMax = Math.ceil(yMaxData + 1.5);

            // Calcola le medie reali dei punti mostrati
            const midFouls = xVals.length ? parseFloat((xVals.reduce((sum, val) => sum + val, 0) / xVals.length).toFixed(2)) : 24.5;
            const midYellows = yVals.length ? parseFloat((yVals.reduce((sum, val) => sum + val, 0) / yVals.length).toFixed(2)) : 4.5;

            const scatterOptions = {
                series: [{ name: "Arbitri", data: scatterData }],
                chart: { 
                    type: 'scatter', height: 350, background: 'transparent', 
                    toolbar: { show: false }, zoom: { enabled: false },
                    events: {
                        // Eventi per disegnare l'overlay DIV
                        mounted: (chartContext) => injectQuadrantDIVOverlay(chartContext, midFouls, midYellows, true),
                        updated: (chartContext) => injectQuadrantDIVOverlay(chartContext, midFouls, midYellows, true)
                    }
                },
                // Marker size ripristinata
                markers: { size: 4 }, 
                colors: ['#EAB308'],
                xaxis: {
                    title: { text: 'Media Falli', style: { color: '#94a3b8' } },
                    tickAmount: xTickAmount,
                    min: xMin, max: xMax,
                    labels: { style: { colors: '#cbd5e1' } },
                    tooltip: {
                        enabled: true,
                        formatter: (val) => Number(val).toFixed(1)
                    },
                    axisBorder: { color: '#334155' },
                    axisTicks: { color: '#334155' }
                },
                yaxis: { 
                    title: { text: 'Media Gialli', style: { color: '#94a3b8' } }, 
                    tickAmount: 5, 
                    min: yMin, max: yMax, 
                    labels: { style: { colors: '#cbd5e1' } } 
                },
                // Linee di annotazione mantenute per le etichette
                annotations: {
                    shapes: [], 
                    xaxis: [{ 
                        x: midFouls, borderColor: '#475569', strokeDashArray: 5, 
                        label: { 
                            borderColor: '#475569', 
                            style: { color: '#cbd5e1', background: '#334155' }, 
                            text: 'Media Falli',
                            offsetY: 10, 
                        } 
                    }],
                    yaxis: [{ 
                        y: midYellows, borderColor: '#475569', strokeDashArray: 5, 
                        label: { 
                            borderColor: '#475569', 
                            style: { color: '#cbd5e1', background: '#334155' }, 
                            text: 'Media Gialli',
                            offsetX: -15, 
                        } 
                    }]
                },
grid: {
    show: true,
    strokeDashArray: 0,
    borderColor: 'rgba(255,255,255,0.04)',

    xaxis: {
        lines: {
            show: true,
            color: 'rgba(255,255,255,0.10)'   // linee verticali leggere
        }
    },

    yaxis: {
        lines: {
            show: true,
            color: 'rgba(255,255,255,0.18)'   // linee orizzontali un po' piÃ¹ visibili
        }
    }
},

                theme: { mode: 'dark' },
                tooltip: { custom: ({ series, seriesIndex, dataPointIndex, w }) => { const d = w.globals.initialSeries[seriesIndex].data[dataPointIndex]; return `<div class="px-3 py-2 bg-slate-800 border border-slate-700 rounded shadow-lg"><div class="font-bold text-white text-xs mb-1">${d.name}</div><div class="text-[10px] text-slate-300">Falli: ${d.x} - Gialli: ${d.y}</div></div>`; } }
            };

            if(chartScatter) chartScatter.destroy();
            chartScatter = new ApexCharts(document.querySelector("#chart-scatter"), scatterOptions);
            chartScatter.render();
        }

function renderRitmoScatter(matchData, fullMatchData, seasonsOverride) {
    // Usa i filtri locali delle stagioni del grafico (fallback ai default analytics)
    const seasons = (seasonsOverride && seasonsOverride.length)
        ? seasonsOverride
        : ANALYTICS_SEASON_OPTIONS;

    // ðŸ”¹ Dati per le MEDIE: tutte le partite delle stagioni selezionate
    const base = (fullMatchData || matchData).filter(m =>
        seasons.includes(m.season)
    );

    // ðŸ”¹ Dati mostrati nel grafico: filtrati da ricerca + stagioni
    const filtered = matchData.filter(m =>
        seasons.includes(m.season)
    );

    // ðŸ”¹ Escludiamo i dati senza Tempo Effettivo o Falli validi
    const validBase = base.filter(m => !isNaN(m.effectiveTimeSec) && !isNaN(m.fouls));
    const validFiltered = filtered.filter(m => !isNaN(m.effectiveTimeSec) && !isNaN(m.fouls));

    // Se NON ci sono punti da mostrare (es. filtro squadra troppo stretto) â†’ grafico "vuoto"
    if (!validFiltered.length) {
        if (chartMatchCorrelation) chartMatchCorrelation.destroy();

        chartMatchCorrelation = new ApexCharts(
            document.querySelector("#chart-match-scatter"),
            {
                series: [],
                chart: {
                    type: 'scatter',
                    height: 350,
                    background: 'transparent',
                    toolbar: { show: false }
                },
                noData: {
                    text: 'Nessun dato per il filtro selezionato',
                    align: 'center',
                    style: {
                        color: '#cbd5e1',
                        fontSize: '12px'
                    }
                },
                xaxis: {
                    labels: { style: { colors: '#cbd5e1' } }
                },
                yaxis: {
                    labels: { style: { colors: '#cbd5e1' } }
                }
            }
        );

        chartMatchCorrelation.render();
        return;
    }

    // ðŸ”¹ Serie del grafico (solo dati FILTRATI -> i pallini che vedi)
    const series = seasons.map(season => ({
        name: season,
        data: validFiltered
            .filter(m => m.season === season)
            .map(m => ({
                x: m.fouls,
                y: +(m.effectiveTimeSec / 60).toFixed(2), // minuti
                matchName: m.match
            }))
    }));

    // ðŸ”¹ Assi fissi
    const mXMin = 10;
    const mXMax = 48;
    const mYMin = 40;
    const mYMax = 70;

    // ðŸ”¹ MEDIE calcolate SOLO sui dati base (tutte le partite delle stagioni attive)
    const totalSeconds = validBase.reduce((sum, m) => sum + m.effectiveTimeSec, 0);
    const avgEffSec = validBase.length ? (totalSeconds / validBase.length) : NaN;
    const avgEff = isNaN(avgEffSec) ? ((mYMin + mYMax) / 2) : +(avgEffSec / 60).toFixed(2);

    const avgFouls = validBase.length ? (validBase.reduce((s, m) => s + m.fouls, 0) / validBase.length) : ((mXMin + mXMax) / 2);


    const matchChartOptions = {
        series: series,

        chart: {
            type: 'scatter',
            height: 350,
            background: 'transparent',
            toolbar: { show: false },
            zoom: { enabled: false },
            events: {
                mounted: (ctx) => injectQuadrantDIVOverlay(ctx, avgFouls, avgEff, false),
                updated: (ctx) => injectQuadrantDIVOverlay(ctx, avgFouls, avgEff, false)
            }
        },

// --- INIZIO MODIFICA: Aggiungi questo blocco RESPONSIVE ---
        responsive: [
            {
                breakpoint: 640, // Si attiva su schermi < 640px (cellulari)
                options: {
                    xaxis: {
                        labels: {
                            rotate: -45, // Consiglio: ruota leggermente i numeri per evitare sovrapposizioni
                            style: {
                                fontSize: '8px', // QUI riduci la dimensione del font (default Ã¨ circa 12px)
                            },
                            hideOverlappingLabels: true // Nasconde i numeri se si accavallano
                        }
                    }
                }
            }
        ],
        // --- FINE MODIFICA ---

        markers: { size: 2.5,
strokeWidth: 0,
            hover: {
                size: 4 // OPZIONALE: Quando ci passi sopra col mouse, si ingrandisce a 5
            }
        },

        // Legenda: solo se >1 stagione
        legend: {
            show: seasons.length > 1,
            position: "top",
            horizontalAlign: "left",
            labels: { colors: "#cbd5e1" },
            fontSize: "11px"
        },

        colors: ['#3b82f6', '#22c55e', '#eab308', '#f97316'],

xaxis: {
    title: { text: 'Falli Totali', style: { color: '#94a3b8' } },
    min: 10,
    max: 48,
    tickAmount: 19,
    labels: {
        style: { colors: '#cbd5e1' },
        formatter: (val) => val
    },
    axisBorder: { color: 'rgba(255,255,255,0.15)' },  // piÃ¹ trasparente
    axisTicks:  { color: 'rgba(255,255,255,0.15)' }    // piÃ¹ trasparente
},

yaxis: {
    title: { text: 'Tempo Effettivo (min)', style: { color: '#94a3b8' } },
    min: mYMin,
    max: mYMax,
    tickAmount: 6,
    labels: {
        style: { colors: '#cbd5e1' },
        formatter: (val) => val.toFixed(0)
    },
    axisBorder: { show: true, color: 'rgba(255,255,255,0.15)' },
    axisTicks:  { show: true, color: 'rgba(255,255,255,0.15)' }
},

grid: {
    borderColor: 'rgba(255,255,255,0.04)',  // linee piÃ¹ morbide
    xaxis: { lines: { show: true } },        // mostra linee verticali
    yaxis: { lines: { show: true } }         // mostra linee orizzontali
},

        // ðŸ”¹ Etichette delle medie â€“ SOLO TESTO, posizionate fuori dai pallini
        annotations: {
            xaxis: [{
                x: avgFouls,
                borderColor: "#475569",
                strokeDashArray: 5,
                label: {
                    borderColor: '#475569',
                    style: { color: '#cbd5e1', background: '#334155' },
                    text: 'Media Falli',
                    offsetY: -20,
                    offsetX: -10
                }
            }],
            yaxis: [{
                y: avgEff,
                borderColor: "#475569",
                strokeDashArray: 5,
                label: {
                    borderColor: '#475569',
                    style: { color: '#cbd5e1', background: '#334155' },
                    text: 'Media T.E.',
                    offsetX: -40,
                    offsetY: 20
                }
            }]
        },

        tooltip: {
            custom: ({ seriesIndex, dataPointIndex, w }) => {
                const d = w.globals.initialSeries[seriesIndex].data[dataPointIndex];
                if (!d) return '';
                return `
                    <div class="px-3 py-2 bg-slate-800 border border-slate-700 rounded shadow-lg">
                        <div class="font-bold text-white text-xs mb-1">${d.matchName}</div>
                        <div class="text-[10px] text-slate-300">
                            Falli: ${d.x} â€“ T.E.: ${d.y.toFixed(2)} min
                        </div>
                    </div>`;
            }
        }
    };

    if (chartMatchCorrelation) chartMatchCorrelation.destroy();
    chartMatchCorrelation = new ApexCharts(
        document.querySelector("#chart-match-scatter"),
        matchChartOptions
    );
    chartMatchCorrelation.render();
}

function renderEffVsTotalScatter(matchData, fullMatchData, seasonsOverride) {
    const seasons = (seasonsOverride && seasonsOverride.length)
        ? seasonsOverride
        : ANALYTICS_SEASON_OPTIONS;

    const base = (fullMatchData || matchData).filter(m => seasons.includes(m.season));
    const filtered = matchData.filter(m => seasons.includes(m.season));

    const validBase = base.filter(m => !isNaN(m.effectiveTimeSec) && !isNaN(m.totalTimeSec));
    const validFiltered = filtered.filter(m => !isNaN(m.effectiveTimeSec) && !isNaN(m.totalTimeSec));

    if (!validFiltered.length) {
        if (chartEffTotalCorrelation) chartEffTotalCorrelation.destroy();
        chartEffTotalCorrelation = new ApexCharts(
            document.querySelector('#chart-eff-total'),
            {
                series: [],
                chart: {
                    type: 'scatter',
                    height: 350,
                    background: 'transparent',
                    toolbar: { show: false }
                },
                noData: {
                    text: 'Nessun dato per il filtro selezionato',
                    align: 'center',
                    style: { color: '#cbd5e1', fontSize: '12px' }
                },
                xaxis: {
                    min: 40,
                    max: 68,
                    tickAmount: 7,
                    labels: { style: { colors: '#cbd5e1' } }
                },
                yaxis: {
                    min: 90,
                    max: 112,
                    tickAmount: 11,
                    labels: { style: { colors: '#cbd5e1' } }
                }
            }
        );
        chartEffTotalCorrelation.render();
        return;
    }

    const series = seasons.map(season => ({
        name: season,
        data: validFiltered
            .filter(m => m.season === season)
            .map(m => ({
                x: +(m.effectiveTimeSec / 60).toFixed(2),
                y: +(m.totalTimeSec / 60).toFixed(2),
                matchName: m.match
            }))
    }));

    const X_MIN = 40;
    const X_MAX = 68;
    const X_TICK_STEP = 1;

    const Y_MIN = 90;
    const Y_MAX = 112;
    const Y_TICK_STEP = 2;

    const xMin = X_MIN;
    const xMax = X_MAX;

    const avgEff = validBase.length
        ? +(validBase.reduce((sum, m) => sum + m.effectiveTimeSec, 0) / validBase.length / 60).toFixed(2)
        : ((xMin + xMax) / 2);
    const avgTotal = validBase.length
        ? +(validBase.reduce((sum, m) => sum + m.totalTimeSec, 0) / validBase.length / 60).toFixed(2)
        : ((Y_MIN + Y_MAX) / 2);

    const options = {
        series,
        chart: {
            type: 'scatter',
            height: 350,
            background: 'transparent',
            toolbar: { show: false },
            zoom: { enabled: false },
            events: {
                mounted: (ctx) => injectQuadrantDIVOverlay(ctx, avgEff, avgTotal, false),
                updated: (ctx) => injectQuadrantDIVOverlay(ctx, avgEff, avgTotal, false)
            }
        },
        markers: {
            size: 2.5,
            strokeWidth: 0,
            hover: { size: 3.2 }
        },
        responsive: [
            {
                breakpoint: 640,
                options: {
                    xaxis: {
                        labels: { rotate: -45, style: { fontSize: '8px' }, hideOverlappingLabels: true }
                    }
                }
            }
        ],
        legend: {
            show: seasons.length > 1,
            position: 'top',
            horizontalAlign: 'left',
            labels: { colors: '#cbd5e1' },
            fontSize: '11px'
        },
        colors: ['#3b82f6', '#22c55e', '#eab308', '#f97316'],
        xaxis: {
            title: { text: 'Tempo Effettivo (min)', style: { color: '#94a3b8' } },
            min: xMin,
            max: xMax,
            tickAmount: (X_MAX - X_MIN) / X_TICK_STEP,
            labels: {
                style: { colors: '#cbd5e1' },
                formatter: (val) => val.toFixed(0)
            },
            axisBorder: { color: 'rgba(255,255,255,0.15)' },
            axisTicks: { color: 'rgba(255,255,255,0.15)' }
        },
        yaxis: {
            title: { text: 'Tempo Totale (min)', style: { color: '#94a3b8' } },
            min: Y_MIN,
            max: Y_MAX,
            tickAmount: (Y_MAX - Y_MIN) / Y_TICK_STEP,
            labels: {
                style: { colors: '#cbd5e1' },
                formatter: (val) => val.toFixed(0)
            },
            axisBorder: { show: true, color: 'rgba(255,255,255,0.15)' },
            axisTicks: { show: true, color: 'rgba(255,255,255,0.15)' }
        },
        grid: {
            borderColor: 'rgba(255,255,255,0.04)',
            xaxis: { lines: { show: true } },
            yaxis: { lines: { show: true } }
        },
        annotations: {
            xaxis: [{
                x: avgEff,
                borderColor: '#475569',
                strokeDashArray: 5,
                label: {
                    borderColor: '#475569',
                    style: { color: '#cbd5e1', background: '#334155' },
                    text: 'Media T.E.',
                    offsetY: -20,
                    offsetX: -10
                }
            }],
            yaxis: [{
                y: avgTotal,
                borderColor: '#475569',
                strokeDashArray: 5,
                label: {
                    borderColor: '#475569',
                    style: { color: '#cbd5e1', background: '#334155' },
                    text: 'Media T.T.',
                    offsetX: -40,
                    offsetY: 20
                }
            }]
        },
        tooltip: {
            x: {
                formatter: (val) => Number(val).toFixed(2)
            },
            custom: ({ seriesIndex, dataPointIndex, w }) => {
                const d = w.globals.initialSeries[seriesIndex].data[dataPointIndex];
                if (!d) return '';
                return `
                    <div class="px-3 py-2 bg-slate-800 border border-slate-700 rounded shadow-lg">
                        <div class="font-bold text-white text-xs mb-1">${d.matchName}</div>
                        <div class="text-[10px] text-slate-300">
                            T.E.: ${d.x.toFixed(2)} min â€“ T.T.: ${d.y.toFixed(2)} min
                        </div>
                    </div>`;
            }
        }
    };

    if (chartEffTotalCorrelation) chartEffTotalCorrelation.destroy();
    chartEffTotalCorrelation = new ApexCharts(
        document.querySelector('#chart-eff-total'),
        options
    );
    chartEffTotalCorrelation.render();
}

//NUOVO GRAFICO DITRIBUZIONE TEMPO EFFETTIVO
function renderEffDistributionChart(matches) {
    // 1. Definiamo le fasce (Bins)
    const bins = {
        '< 45 min': 0,
        '45-50 min': 0,
        '50-55 min': 0,
        '55-60 min': 0,
        '> 60 min': 0
    };

    // 2. Contiamo le partite e calcoliamo il totale
    let totalMatches = 0;
    matches.forEach(m => {
        const minutes = m.effectiveTimeSec / 60;
        
        // Controlliamo che il dato sia valido
        if (!isNaN(minutes) && minutes > 0) {
            totalMatches++;
            if (minutes < 45) bins['< 45 min']++;
            else if (minutes >= 45 && minutes < 50) bins['45-50 min']++;
            else if (minutes >= 50 && minutes < 55) bins['50-55 min']++;
            else if (minutes >= 55 && minutes < 60) bins['55-60 min']++;
            else if (minutes >= 60) bins['> 60 min']++;
        }
    });

    const categories = Object.keys(bins);
    const dataValues = Object.values(bins);
    
    // CALCOLO PERCENTUALI
    const dataPercentages = dataValues.map(val => {
        return totalMatches > 0 ? ((val / totalMatches) * 100).toFixed(1) : 0;
    });

    // 3. Configurazione Grafico
    const options = {
        series: [{
            name: '% Partite',
            data: dataPercentages // Usiamo le percentuali qui
        }],
        chart: {
            type: 'bar',
            height: 350,
            background: 'transparent',
            toolbar: { show: false }
        },
        plotOptions: {
            bar: {
                borderRadius: 4,
                columnWidth: '50%',
                distributed: true
            }
        },
        colors: ['#ef4444', '#f97316', '#eab308', '#22c55e', '#00ff1a'],
        dataLabels: {
            enabled: true,
            style: { colors: ['#fff'] },
            formatter: function (val) {
                return val + "%"; // Aggiunge il simbolo % sulle barre
            }
        },
        legend: { show: false },
        xaxis: {
            categories: categories,
            labels: {
                style: { colors: '#cbd5e1', fontSize: '11px' }
            },
            axisBorder: { show: false },
            axisTicks: { show: false }
        },
        yaxis: {
            title: { text: '% Partite', style: { color: '#94a3b8' } },
            labels: { 
                style: { colors: '#cbd5e1' },
                formatter: (val) => parseInt(val) + "%" 
            },
min: 0, // <--- CORREZIONE FONDAMENTALE: Forza l'inizio a 0
            max: function(max) { return max + 5; }, // Lascia spazio in alto
            forceNiceScale: true // Aiuta a rendere i numeri sull'asse piÃ¹ "puliti"
        },
        grid: {
            borderColor: 'rgba(255,255,255,0.05)',
        },
        tooltip: {
            theme: 'dark',
            y: {
                formatter: function (val, { dataPointIndex }) {
                    // Mostra sia la percentuale che il numero reale tra parentesi
                    const count = dataValues[dataPointIndex];
                    return val + "% (" + count + " partite)";
                }
            }
        }
    };

    const chartDiv = document.querySelector("#chart-eff-distribution");
    chartDiv.innerHTML = "";
    const chart = new ApexCharts(chartDiv, options);
    chart.render();
}

function hexToRgba(hex, alpha = 1) {
    const clean = hex.replace('#', '');
    const expanded = clean.length === 3 ? clean.split('').map(c => c + c).join('') : clean;
    const bigint = parseInt(expanded, 16);
    const r = (bigint >> 16) & 255;
    const g = (bigint >> 8) & 255;
    const b = bigint & 255;
    return `rgba(${r}, ${g}, ${b}, ${alpha})`;
}

function renderFoulsByMatchdayChart() {
    const meta = [
        { key: '2022-23', label: '22/23', color: '#f472b6' },
        { key: '2023-24', label: '23/24', color: '#22c55e' },
        { key: '2024-25', label: '24/25', color: '#3b82f6' },
        { key: '2025-26', label: '25/26', color: '#eab308' },
    ];

    const categories = [];
    const data = [];
    const colors = [];
    const seasonAverages = [];

    meta.forEach(season => {
        const matches = processMatchesViewData([season.key]).filter(
            m => m.season === season.key && Number.isFinite(m.fouls)
        );

        if (matches.length) {
            const seasonAvg = matches.reduce((sum, match) => sum + match.fouls, 0) / matches.length;
            const startIndex = categories.length;

            for (let i = 0; i < matches.length; i += 10) {
                const giornata = Math.floor(i / 10) + 1;
                const chunk = matches.slice(i, i + 10);
                if (!chunk.length) continue;

                const avgFouls = chunk.reduce((sum, match) => sum + match.fouls, 0) / chunk.length;

                categories.push(giornata);
                data.push(+avgFouls.toFixed(2));
                colors.push(season.color);
            }

            seasonAverages.push({
                season: season.label,
                average: +seasonAvg.toFixed(2),
                start: startIndex,
                end: categories.length - 1,
                color: season.color
            });
        }
    });

    const options = {
        series: [{ name: 'Falli medi', data }],
        chart: {
            type: 'bar',
            height: 440,
            background: 'transparent',
            toolbar: { show: false }
        },
        plotOptions: {
            bar: {
                distributed: true,
                columnWidth: '40%',
                borderRadius: 0
            }
        },
        colors,
        dataLabels: { enabled: false },
        xaxis: {
            categories,
            labels: {
                rotate: 0,
                style: { colors: '#cbd5e1', fontSize: '10px' }
            },
            axisBorder: { color: 'rgba(255,255,255,0.08)' },
            axisTicks: { color: 'rgba(255,255,255,0.08)' }
        },
        yaxis: {
            title: { text: 'Falli fischiati', style: { color: '#94a3b8' } },
            labels: {
                style: { colors: '#cbd5e1' },
                formatter: val => val.toFixed(1)
            },
            min: 0
        },
        legend: { show: false },
        grid: { borderColor: 'rgba(255,255,255,0.05)' },
        annotations: {
            yaxis: seasonAverages.map(season => ({
                y: season.average,
                borderColor: hexToRgba(season.color, 0.9),
                strokeDashArray: 5,
                opacity: 0.7
            }))
        },
        tooltip: {
            theme: 'dark',
            custom: ({ series, dataPointIndex, w }) => {
                const giornata = w?.globals?.labels?.[dataPointIndex];
                const value = series?.[0]?.[dataPointIndex];

                if (!Number.isFinite(value)) return '';

                return `
                    <div class="px-3 py-2 bg-slate-800 border border-slate-700 rounded shadow-lg">
                        <div class="font-semibold text-white text-xs mb-1">Giornata n. ${giornata}</div>
                        <div class="text-[10px] text-slate-300">Falli medi: ${value.toFixed(2)} falli</div>
                    </div>
                `;
            }
        }
    };

    const target = document.querySelector('#chart-fouls-matchday');
    if (!target) return;

    if (chartFoulsByMatchday) chartFoulsByMatchday.destroy();
    chartFoulsByMatchday = new ApexCharts(target, options);
    chartFoulsByMatchday.render();
    renderFoulsAveragesLegend(seasonAverages);
}

function renderFoulsAveragesLegend(seasonAverages) {
    const legend = document.querySelector('#chart-fouls-matchday-legend');
    if (!legend) return;

    if (!seasonAverages.length) {
        legend.innerHTML = '<span class="text-slate-500">Nessuna media disponibile</span>';
        return;
    }

    legend.innerHTML = seasonAverages.map(season => {
        const lineStyle = `border-top: 2px dashed ${hexToRgba(season.color, 0.9)};`;
        return `
            <div class="flex items-center gap-2">
                <span class="w-8 h-[1px]" style="${lineStyle}"></span>
                <span class="text-slate-200">Media ${season.season} = ${season.average.toFixed(1)}</span>
            </div>`;
    }).join('');
}


//NUOVO GRAFICO radar ritmo squadre

function renderTopFlopTeamsChart(seasons) {
    // 1. Dati e Ordinamento
    let teamsData = processTeamsData(seasons);
    teamsData = teamsData.filter(t => t.avgEff > 0)
                         .sort((a, b) => b.avgEff - a.avgEff);

    if (teamsData.length === 0) return;

    // 2. Dati Reali e Normalizzati
    const realValues = teamsData.map(t => parseFloat((t.avgEff / 60).toFixed(1)));
    const labels = teamsData.map(t => t.name);

    // TRUCCO MATEMATICO (Scala visiva)
    const minVal = Math.min(...realValues);
    const baseline = minVal - 10.0; 
    const visualData = realValues.map(val => parseFloat((val - baseline).toFixed(2)));

    // Colori
    function generateColors(count) {
        const palette = [
            '#22c55e', '#4ade80', '#86efac', 
            '#facc15', '#eab308',            
            '#fb923c', '#f87171', '#ef4444', 
            '#dc2626', '#991b1b'             
        ];
        const colors = [];
        for (let i = 0; i < count; i++) {
            const index = Math.floor((i / count) * palette.length);
            colors.push(palette[Math.min(index, palette.length - 1)]);
        }
        return colors;
    }

    const teamColors = generateColors(realValues.length);

    const options = {
        series: visualData,
        labels: labels,
        chart: {
            type: 'polarArea',
            height: 480, 
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true },
            events: {
                // FONDAMENTALE: Ridisegna i loghi quando il grafico Ã¨ pronto o aggiornato
                mounted: function(chartContext, config) {
                    setTimeout(() => renderRadarLogos(teamsData), 100);
                },
                updated: function(chartContext, config) {
                    setTimeout(() => renderRadarLogos(teamsData), 100);
                }
            }
        },
        stroke: { colors: ['#0f172a'], width: 1 },
        fill: { opacity: 0.9 },
        colors: teamColors, 
        yaxis: { show: false },
        legend: { show: false }, // Nascondiamo la legenda, usiamo i loghi!
        plotOptions: {
            polarArea: {
                rings: { strokeWidth: 0 },
                spokes: { connectorColors: 'rgba(255,255,255,0.1)' }
            }
        },
        dataLabels: { enabled: false }, // Disabilitiamo le etichette di testo
        tooltip: {
            theme: 'dark',
            y: {
                formatter: function (val, { dataPointIndex }) {
                    const trueValue = realValues[dataPointIndex];
                    return trueValue + " min";
                }
            }
        }
    };

    const chartDiv = document.querySelector("#chart-top-flop");
    chartDiv.innerHTML = ""; 
    const chart = new ApexCharts(chartDiv, options);
    chart.render();
}

// --- NUOVA FUNZIONE PER DISEGNARE I LOGHI ---
function renderRadarLogos(teamsData) {
    const container = document.querySelector("#chart-top-flop");
    if (!container) return;

    // 1. Pulizia vecchi loghi
    const oldLogos = container.querySelectorAll('.chart-team-logo');
    oldLogos.forEach(el => el.remove());

    // 2. Trova il centro e il raggio del grafico
    // ApexCharts piazza il canvas al centro. Dobbiamo calcolare in base alle dimensioni del container.
    const rect = container.getBoundingClientRect();
    const width = rect.width;
    const height = rect.height;
    
    // Il centro Ã¨ la metÃ  del contenitore
    const centerX = width / 2;
    const centerY = height / 2;
    
    // Il raggio esterno dove piazzare i loghi. 
    // In un grafico height 480, il raggio utile Ã¨ circa 200-220px. 
    // Se lo schermo Ã¨ piccolo, dobbiamo ridurre.
    const maxRadius = Math.min(width, height) / 2;
    const logoRadius = maxRadius - 30; // 30px dal bordo esterno per non tagliare

    const totalSlices = teamsData.length;
    const angleStep = (2 * Math.PI) / totalSlices;
    
    // ApexCharts Polar inizia a -90 gradi (ore 12)
    const startAngle = -Math.PI / 2; 

    teamsData.forEach((team, index) => {
        // Calcola l'angolo per il centro dello spicchio corrente
        // Angolo Inizio + (Indice * Step) + (Mezzo Step per centrare)
        const angle = startAngle + (index * angleStep) + (angleStep / 2);

        // Calcola coordinate X e Y (Trigonometria di base)
        // x = r * cos(a) + cx
        // y = r * sin(a) + cy
        const x = logoRadius * Math.cos(angle) + centerX;
        const y = logoRadius * Math.sin(angle) + centerY;

        // Crea l'immagine
        const img = document.createElement('img');
        img.src = getTeamLogo(team.name);
        img.className = 'chart-team-logo';
        img.style.left = `${x}px`;
        img.style.top = `${y}px`;
        img.title = `${team.name}: ${(team.avgEff/60).toFixed(1)} min`; // Tooltip nativo

        container.appendChild(img);
    });
}



        

// =========================================================
function addRefereeToRadar() {
    const select = document.getElementById('radar-ref-select');
    const name = select.value;
    if (name && !selectedRadarReferees.includes(name)) {
        if (selectedRadarReferees.length >= 10) {
            console.error("Massimo 10 arbitri raggiunti per il confronto.");
            return;
        }
        selectedRadarReferees.push(name);
        renderRadarChips();
        updateRadarChart();
    }
    select.value = "";
}

function removeRefereeFromRadar(name) {
    selectedRadarReferees = selectedRadarReferees.filter(n => n !== name);
    renderRadarChips();
    updateRadarChart();
}

function resetRadar() {
    selectedRadarReferees = [];
    renderRadarChips();
    updateRadarChart();
}

function loadPresetRadarRefs() {
    // Svuota selezione corrente
    selectedRadarReferees = [];

    PRESET_RADAR_REFEREES.forEach(ref => {
        if (!selectedRadarReferees.includes(ref)) {
            selectedRadarReferees.push(ref);
        }
    });

    renderRadarChips();
    updateRadarChart();
    // se non hai una funzione refreshRadarDropdownChecks(), puoi commentare la prossima riga:
    // refreshRadarDropdownChecks();
}

function renderRadarChips() {
    const container = document.getElementById('radar-chips-container');
    const count = document.getElementById('radar-count');
    container.innerHTML = '';
    if (selectedRadarReferees.length === 0) {
         container.innerHTML = '<span class="text-[10px] text-slate-500 italic py-1">Aggiungi fino a 10 arbitri per il confronto...</span>';
    } else {
        selectedRadarReferees.forEach(name => {
            const surname = getRefereeSurname(name);
            const div = document.createElement('div');
            div.className = 'ref-chip';
            div.innerHTML = `<span>${surname}</span><button onclick="removeRefereeFromRadar('${name}')"><i class="fa-solid fa-times"></i></button>`;
            container.appendChild(div);
        });
    }
    count.innerText = `${selectedRadarReferees.length}/10`;
}

function updateRadarChart() {
    const data = currentAnalyticsData;
    
    // SCALA per â€œspacchettareâ€ i dati
    const SCALE = { 
        FOULS:   { min: 15, max: 35 }, 
        YELLOWS: { min: 1,  max: 7  },
        REDS:    { min: 0,  max: 0.6 },
        PENS:    { min: 0,  max: 0.6 }, 
        EFF:     { min: 50, max: 60 } 
    };
    
    // Calcolo media
    let tF=0, tY=0, tR=0, tP=0, tEff=0, count=0, effCount=0;
    data.forEach(r => { 
        tF += r.avgFouls; 
        tY += r.avgYellows; 
        tR += r.avgReds; 
        tP += r.avgPens; 
        if (r.avgEffSec > 0) { 
            tEff += r.avgEffSec; 
            effCount++; 
        } 
        count++; 
    });

    const avgF   = count     ? tF / count      : 0; 
    const avgY   = count     ? tY / count      : 0; 
    const avgR   = count     ? tR / count      : 0; 
    const avgP   = count     ? tP / count      : 0; 
    const avgEff = effCount  ? (tEff / effCount) / 60 : 0;

    const normalize = (val, min, max) =>
        Math.min(100, Math.max(0, ((val - min) / (max - min)) * 100));

    let seriesData = [{ 
        name: 'Media', 
        data: [
            normalize(avgF,   SCALE.FOULS.min,   SCALE.FOULS.max),
            normalize(avgY,   SCALE.YELLOWS.min, SCALE.YELLOWS.max),
            normalize(avgR,   SCALE.REDS.min,    SCALE.REDS.max),
            normalize(avgP,   SCALE.PENS.min,    SCALE.PENS.max),
            normalize(avgEff, SCALE.EFF.min,     SCALE.EFF.max)
        ],
        raw: [
            avgF.toFixed(1),
            avgY.toFixed(1),
            avgR.toFixed(2),
            avgP.toFixed(2),
            avgEff.toFixed(1)
        ] 
    }];
    
    const addSeries = (name) => {
        const r = data.find(x => x.name === name);
        if (r) {
            const eff = r.avgEffSec > 0 ? (r.avgEffSec / 60) : 0;
            seriesData.push({ 
                name: getRefereeSurname(r.name), 
                data: [
                    normalize(r.avgFouls,   SCALE.FOULS.min,   SCALE.FOULS.max),
                    normalize(r.avgYellows, SCALE.YELLOWS.min, SCALE.YELLOWS.max),
                    normalize(r.avgReds,    SCALE.REDS.min,    SCALE.REDS.max),
                    normalize(r.avgPens,    SCALE.PENS.min,    SCALE.PENS.max),
                    normalize(eff,         SCALE.EFF.min,     SCALE.EFF.max)
                ],
                raw: [
                    r.avgFouls.toFixed(1),
                    r.avgYellows.toFixed(1),
                    r.avgReds.toFixed(2),
                    r.avgPens.toFixed(2),
                    eff.toFixed(1)
                ] 
            });
        }
    };

    selectedRadarReferees.forEach(name => addSeries(name));

    const radarOptions = {
        series: seriesData,
        chart: { 
            type: 'radar', 
            height: 530, 
            background: 'transparent', 
            toolbar: { show: false }
        },
        labels: ['Falli', 'Gialli', 'Rossi', 'Rigori', 'Temp. Eff.'],
        stroke: { width: 1 }, 
        fill: { opacity: 0.25 }, 
        markers: { size: 2.2, strokeWidth: 0.5 }, 
        yaxis: { show: false, max: 100 },
        xaxis: { labels: { style: { colors: ['#cbd5e1','#cbd5e1','#cbd5e1','#cbd5e1','#cbd5e1'], fontSize: '10px', fontFamily: 'JetBrains Mono' } } },
        grid: {
            padding: {
                left: 40,
                right: 10,
                top: 10,
                bottom: 10
            }
        },
        theme: { mode: 'dark', palette: 'palette1' }, 
        legend: { position: 'bottom', labels: { colors: '#cbd5e1' } },
        tooltip: { 
            theme: 'dark', 
            y: { 
                formatter: (val, { seriesIndex, dataPointIndex, w }) => {
                    const series = w.config.series[seriesIndex];
                    if (series && series.raw && series.raw[dataPointIndex] !== undefined) {
                        return series.raw[dataPointIndex] + (dataPointIndex === 4 ? " min" : "");
                    }
                    return val.toFixed(1);
                }
            } 
        }
    };
    
    // Distruggi eventuale grafico precedente
    if (chartRadar) {
        chartRadar.destroy();
        chartRadar = null;
    }

    const radarContainer = document.getElementById('chart-radar');

    // Se NON sono selezionati arbitri â†’ mostra solo il messaggio
    if (selectedRadarReferees.length === 0) {
        radarContainer.innerHTML =
            '<p class="text-xs text-slate-500">Seleziona un arbitro per vedere il profilo.</p>';
        return;
    }

    // Almeno un arbitro â†’ pulisco eventuale messaggio e disegno il grafico
    radarContainer.innerHTML = '';
    chartRadar = new ApexCharts(radarContainer, radarOptions);
    chartRadar.render();
}

    const HEATMAP_SEASONS = {
        '2024-25': {
            label: '2024/25',
            dataset: MATCHES_DB_2425,
            orderedTeams: [
                "Monza","Venezia","Empoli","Lecce","Parma","Cagliari","Verona","Genoa","Udinese","Torino",
                "Como","Bologna","Milan","Lazio","Fiorentina","Roma","Juventus","Atalanta","Inter","Napoli"
            ]
        },
        '2023-24': {
            label: '2023/24',
            dataset: MATCHES_DB_2324,
            orderedTeams: [
                "Salernitana","Sassuolo","Frosinone","Empoli","Cagliari","Udinese","Lecce","Verona","Monza","Genoa",
                "Napoli","Torino","Fiorentina","Lazio","Roma","Bologna","Atalanta","Juventus","Milan","Inter"
            ]
        },
        '2022-23': {
            label: '2022/23',
            dataset: MATCHES_DB_2223,
            orderedTeams: ["Sampdoria","Cremonese","Spezia","Verona","Lecce","Salernitana","Empoli","Sassuolo","Udinese","Monza",
                "Torino","Bologna","Fiorentina","Juventus","Roma","Atalanta","Milan","Inter","Lazio","Napoli"]
        }
    };

// ===========================================
// PARSER STAGIONE (TEMPO EFFETTIVO + FALLI)
// ===========================================
function parseSeasonMatches(seasonKey) {
    if (DATA_CACHE.heatmap.has(seasonKey)) return DATA_CACHE.heatmap.get(seasonKey);

    const config = HEATMAP_SEASONS[seasonKey] || {};
    const dataset = config.dataset || '';
    const lines = dataset.split('\n').map(l => l.trim()).filter(l => l.length > 0);
    const matrix = {};
    const orderedTeams = Array.isArray(config.orderedTeams) && config.orderedTeams.length
        ? [...config.orderedTeams]
        : [];

    orderedTeams.forEach(t => {
        matrix[t] = {};
    });

    let matchIndex = 0;
    for (let i = 0; i < lines.length; i++) {
        const line = lines[i];
        const parts = line.split(/\s+/);

        const matchName = parts[0];
        const [home, away] = matchName.split('-');

        const effStr = parts[2]?.replace(',', '.');
        const eff = parseFloat(effStr);

        const fouls = parseInt(parts[4], 10) || 0;

        const giornata = Math.floor(matchIndex / 10) + 1;
        matchIndex++;

        if (!matrix[home]) matrix[home] = {};
        if (!matrix[away]) matrix[away] = {};

        if (!orderedTeams.includes(home)) orderedTeams.push(home);
        if (!orderedTeams.includes(away)) orderedTeams.push(away);

        const cellData = { eff, fouls, match: `${home}-${away}` };
        matrix[home][giornata] = cellData;
        matrix[away][giornata] = cellData;
    }

    const parsed = { teams: orderedTeams, matrix, label: config.label || seasonKey };
    DATA_CACHE.heatmap.set(seasonKey, parsed);
    return parsed;
}

let currentHeatmapMetric = 'eff'; // 'eff' oppure 'fouls'

function getHeatmapHoverElements() {
    return {
        layer: document.getElementById('heatmap-hover-layer'),
        row: document.getElementById('heatmap-hover-row'),
        col: document.getElementById('heatmap-hover-col')
    };
}

function resetHeatmapFocusCard() {
    const card = document.getElementById('heatmap-focus-card');
    if (!card) return;
    card.classList.remove('hidden');
    document.getElementById('heatmap-focus-title').textContent = 'Passa il mouse sulla heatmap';
    document.getElementById('heatmap-focus-subtitle').textContent = 'Hover o clic per vedere match e valore.';
    document.getElementById('heatmap-focus-team').textContent = 'â€”';
    document.getElementById('heatmap-focus-match').textContent = 'â€”';
    document.getElementById('heatmap-focus-value').textContent = 'â€”';
}

function hideHeatmapHighlight() {
    const { layer, row, col } = getHeatmapHoverElements();
    if (!layer || !row || !col) return;
    row.removeAttribute('data-visible');
    col.removeAttribute('data-visible');
    layer.classList.add('hidden');
}

function updateHeatmapHighlight(seriesIndex, dataPointIndex, chartContext) {
    const { layer, row, col } = getHeatmapHoverElements();
    if (!layer || !row || !col) return;
    const g = chartContext?.w?.globals;
    if (!g) return;

    const columns = g.series?.[0]?.length || 0;
    const rows = g.series?.length || 0;
    if (!columns || !rows) return;

    const cellWidth = g.gridWidth / columns;
    const cellHeight = g.gridHeight / rows;

    const originX = g.translateX;
    const originY = g.translateY;

    row.style.left = `${originX}px`;
    row.style.top = `${originY + seriesIndex * cellHeight}px`;
    row.style.width = `${g.gridWidth}px`;
    row.style.height = `${cellHeight}px`;
    row.dataset.visible = 'true';

    col.style.left = `${originX + dataPointIndex * cellWidth}px`;
    col.style.top = `${originY}px`;
    col.style.width = `${cellWidth}px`;
    col.style.height = `${g.gridHeight}px`;
    col.dataset.visible = 'true';

    layer.classList.remove('hidden');
}

function updateHeatmapFocus(seriesIndex, dataPointIndex, sticky = false) {
    const team = heatmapOrderedTeams[seriesIndex];
    const giornata = dataPointIndex + 1;
    const cell = heatmapMatrixCache?.[team]?.[giornata];

    const card = document.getElementById('heatmap-focus-card');
    if (!card || !team) return;

    card.classList.remove('hidden');

    const title = document.getElementById('heatmap-focus-title');
    const subtitle = document.getElementById('heatmap-focus-subtitle');
    const teamEl = document.getElementById('heatmap-focus-team');
    const matchEl = document.getElementById('heatmap-focus-match');
    const valueEl = document.getElementById('heatmap-focus-value');

    title.textContent = `${team} â€¢ Giornata ${giornata}`;
    subtitle.textContent = sticky ? 'Cella fissata: clicca altrove per cambiare focus.' : 'Hover o clic per fissare una cella.';

    teamEl.textContent = team;
    matchEl.textContent = cell?.match || 'Match non disponibile';

    if (cell) {
        valueEl.textContent = (currentHeatmapMetric === 'eff')
            ? `${cell.eff.toFixed(2)} min di tempo effettivo`
            : `${cell.fouls} falli fischiati`;
    } else {
        valueEl.textContent = 'Dato mancante';
    }
}

// ===========================================
// RENDER HEATMAP SQUADRE (METRICA DINAMICA)
// ===========================================
function renderTeamHeatmap() {

    const { teams, matrix, label } = parseSeasonMatches(currentHeatmapSeason);
    const orderedTeams = teams;

    const titleEl = document.getElementById('heatmap-title');
    if (titleEl) {
        titleEl.textContent = `Heatmap Squadre â€” Stagione ${label || currentHeatmapSeason}`;
    }

    // --- 1) Costruisco la serie in base alla metrica corrente ---
    const metric = currentHeatmapMetric; // 'eff' o 'fouls'
    heatmapMatrixCache = matrix;
    heatmapOrderedTeams = orderedTeams;
    currentHeatmapMetric = metric;
    heatmapPinnedCell = null;
    resetHeatmapFocusCard();
    hideHeatmapHighlight();

    const series = orderedTeams.map(team => {
        const data = [];
        for (let g = 1; g <= 38; g++) {
            const cell = matrix[team][g];
            if (!cell) {
                data.push(null);
            } else {
                const val = (metric === 'eff') ? cell.eff : cell.fouls;
                data.push(val);
            }
        }
        return {
            name: team,
            data
        };
    });

    // --- 2) Color scale diversa per le due metriche ---
    const effColorScale = {
        ranges: [
            { from: 0,   to: 45,  color: '#e86f5c' },
            { from: 45,  to: 47,  color: '#eba96d' },
            { from: 47,  to: 49,  color: '#efc06f' },
            { from: 49,  to: 51,  color: '#f6d977' },
            { from: 51,  to: 53,  color: '#fae98a' },
            { from: 53,  to: 55,  color: '#f2e897' },
            { from: 55,  to: 57,  color: '#d7e5a4' },
            { from: 57,  to: 59,  color: '#b9dca1' },
            { from: 59,  to: 61,  color: '#9ad593' },
            { from: 61,  to: 63,  color: '#7ac87d' },
            { from: 63,  to: 65,  color: '#5dbf72' },
            { from: 65,  to: 70,  color: '#4fb56b' }
        ]
    };

    // stima range falli ~ 10â€“40 (puoi rifinirla piÃ¹ avanti)
const foulsColorScale = {
    ranges: [
        { from: 0,  to: 18, color: '#7ac87d' },   // pochi falli â†’ verde chiaro
        { from: 18, to: 21, color: '#9ad593' },
        { from: 21, to: 24, color: '#b9dca1' },
        { from: 24, to: 27, color: '#d7e5a4' },
        { from: 27, to: 30, color: '#fae98a' },
        { from: 30, to: 33, color: '#f6d977' },
        { from: 33, to: 36, color: '#efc06f' },
        { from: 36, to: 40, color: '#eba96d' },
        { from: 40, to: 99, color: '#e86f5c' }   // molti falli â†’ rosso
    ]
};

        const colorScale = (metric === 'eff') ? effColorScale : foulsColorScale;

        const options = {
            series: series,
            chart: {
                type: "heatmap",
                height: 600,
                background: "transparent",
                toolbar: { show: false },
                animations: { enabled: true, speed: 450 },
                events: {
                    dataPointMouseEnter: (event, chartCtx, config) => {
                        updateHeatmapHighlight(config.seriesIndex, config.dataPointIndex, chartCtx);
                        if (!heatmapPinnedCell) {
                            updateHeatmapFocus(config.seriesIndex, config.dataPointIndex);
                        }
                    },
                    dataPointMouseLeave: (event, chartCtx) => {
                        if (heatmapPinnedCell) {
                            updateHeatmapHighlight(heatmapPinnedCell.seriesIndex, heatmapPinnedCell.dataPointIndex, chartCtx);
                            updateHeatmapFocus(heatmapPinnedCell.seriesIndex, heatmapPinnedCell.dataPointIndex, true);
                        } else {
                            hideHeatmapHighlight();
                            resetHeatmapFocusCard();
                        }
                    },
                    dataPointSelection: (event, chartCtx, config) => {
                        heatmapPinnedCell = { seriesIndex: config.seriesIndex, dataPointIndex: config.dataPointIndex };
                        updateHeatmapHighlight(config.seriesIndex, config.dataPointIndex, chartCtx);
                        updateHeatmapFocus(config.seriesIndex, config.dataPointIndex, true);
                    }
                }
            },
            plotOptions: {
                heatmap: {
                    enableShades: false,
                    shadeIntensity: 0,
                colorScale: colorScale,
                radius: 0
            }
        },
        xaxis: {
            categories: Array.from({ length: 38 }, (_, i) => i + 1),
            title: { text: "Giornate", style: { color: '#cbd5e1' } },
            labels: { style: { colors: '#94a3b8', fontSize: '10px' } }
        },
	yaxis: {
    		categories: orderedTeams,
    		labels: {
		align: 'left',
       		 style: { colors: '#cbd5e1', fontSize: '11px' },
        	// Modifica qui: aggiungiamo una logica di controllo
        	formatter: (value, index) => {
           	 const rank = 20 - index;
            // Se il numero Ã¨ 0 (o meno) oppure non c'Ã¨ una squadra (value Ã¨ vuoto), non mostrare nulla
            if (rank < 1 || !value) return ""; 
            
            return `${rank}. ${value}`;
        }
    }
},        dataLabels: { enabled: false },
        tooltip: {
            theme: 'dark',
            x: { show: false },
            y: { show: false },
            custom: function({ seriesIndex, dataPointIndex }) {
                const squadra = orderedTeams[seriesIndex];
                const giornata = dataPointIndex + 1;
                const row = matrix[squadra];
                if (!row) return '';

                const cell = row[giornata];
                if (!cell) return '';

                const nomePartita = cell.match;

                let valueLabel;
                if (metric === 'eff') {
                    valueLabel = `${cell.eff.toFixed(2)} min`;
                } else {
                    valueLabel = `${cell.fouls} falli fischiati`;
                }

                return `
                    <div class="px-2 py-1 text-xs bg-slate-900 border border-slate-700 rounded shadow-lg text-slate-100">
                        ${nomePartita} â€” ${valueLabel}
                    </div>
                `;
            }
        }
    };

    const container = document.getElementById("chart-team-heatmap");

    if (container._chart) {
        container._chart.destroy();
    }

    container._chart = new ApexCharts(container, options);
    container._chart.render();
}




// Ricalcola e riposiziona l'overlay ad ogni ridimensionamento
window.addEventListener('resize', debounceRenderAnalytics);

        function updatePlayerScatterRoleUI() {
            document.querySelectorAll('.player-scatter-role-toggle').forEach((btn) => {
                const role = btn.getAttribute('data-role');
                const isActive = analyticsPlayerRoles.has(role);

                btn.classList.toggle('bg-slate-800/70', isActive);
                btn.classList.toggle('bg-slate-900/40', !isActive);
                btn.style.borderColor = isActive
                    ? (PLAYER_SCATTER_ROLE_COLORS[role] || '#eab308')
                    : '#1e293b';
            });
        }

        function togglePlayerScatterRole(role) {
            if (!PLAYER_SCATTER_ROLE_COLORS[role]) return;

            if (analyticsPlayerRoles.has(role) && analyticsPlayerRoles.size > 1) {
                analyticsPlayerRoles.delete(role);
            } else {
                analyticsPlayerRoles.add(role);
            }

            updatePlayerScatterRoleUI();
            renderPlayerScatterChart();
        }

        function resetScatterFocus() {
            const card = document.getElementById('player-scatter-focus');
            if (!card) return;

            card.classList.remove('hidden');
            document.getElementById('scatter-focus-name').textContent = 'Passa sopra un punto o clicca';
            document.getElementById('scatter-focus-team').textContent = 'â€”';
            document.getElementById('scatter-focus-role').textContent = 'Ruolo: â€”';
            document.getElementById('scatter-focus-shots').textContent = 'Tiri/90: â€”';
            document.getElementById('scatter-focus-on-target').textContent = 'Tiri in porta/90: â€”';
            scatterPinnedPoint = null;
        }

        function updateScatterFocus(point, sticky = false) {
            const card = document.getElementById('player-scatter-focus');
            if (!card || !point) return;

            card.classList.remove('hidden');
            document.getElementById('scatter-focus-name').textContent = point.name || 'Giocatore';
            document.getElementById('scatter-focus-team').textContent = point.team || 'Squadra non disponibile';
            document.getElementById('scatter-focus-role').textContent = `Ruolo: ${point.role || 'â€”'}${sticky ? ' (fissato)' : ''}`;
            document.getElementById('scatter-focus-shots').textContent = `Tiri/90: ${Number(point.x).toFixed(2)}`;
            document.getElementById('scatter-focus-on-target').textContent = `Tiri in porta/90: ${Number(point.y).toFixed(2)}`;
        }

        function renderPlayerScatterChart() {
            const container = document.querySelector('#chart-player-scatter');
            if (!container) return;

            resetScatterFocus();

            const minPresence = playersMaxMatches ? playersMaxMatches * 0.3 : 0;

            const eligiblePlayers = playersData
                .filter(p => Number.isFinite(p.n90) && p.n90 >= minPresence)
                .filter(p => {
                    const roles = (p.role || '')
                        .split(',')
                        .map(r => r.trim().toUpperCase())
                        .filter(Boolean);

                    const nonGoalkeeperRoles = roles.filter(r => r !== 'POR');
                    if (!nonGoalkeeperRoles.length) return false;

                    return nonGoalkeeperRoles.some(r => analyticsPlayerRoles.has(r));
                })
                .filter(p => Number.isFinite(p.shotsPer90) && Number.isFinite(p.shotsOnTargetPer90));

            const series = Array.from(analyticsPlayerRoles).map((role) => {
                const roleData = eligiblePlayers
                    .filter(p => (p.role || '').toUpperCase().includes(role))
                    .map(p => ({
                        x: p.shotsPer90,
                        y: p.shotsOnTargetPer90,
                        name: formatPlayerName(p.name),
                        team: p.team || '',
                        role: PLAYER_SCATTER_ROLE_LABELS[role] || role
                    }));

                return {
                    name: PLAYER_SCATTER_ROLE_LABELS[role] || role,
                    data: roleData,
                    color: PLAYER_SCATTER_ROLE_COLORS[role]
                };
            }).filter(series => series.data.length);

            if (chartPlayerScatter) {
                chartPlayerScatter.destroy();
                chartPlayerScatter = null;
            }

            if (!series.length) {
                chartPlayerScatter = new ApexCharts(container, {
                    series: [],
                    chart: {
                        type: 'scatter',
                        height: 420,
                        background: 'transparent',
                        toolbar: { show: false }
                    },
                    noData: {
                        text: 'Nessun giocatore corrisponde ai filtri',
                        align: 'center',
                        style: { color: '#cbd5e1', fontSize: '12px' }
                    },
                    xaxis: { labels: { style: { colors: '#cbd5e1' } } },
                    yaxis: { labels: { style: { colors: '#cbd5e1' } } }
                });

                chartPlayerScatter.render();
                return;
            }

            const computeAxisParams = (maxValue) => {
                const safeMax = Math.max(maxValue, 1);
                const targetTicks = 6;
                const roughStep = safeMax / targetTicks;
                const magnitude = Math.pow(10, Math.floor(Math.log10(roughStep)));
                const residual = roughStep / magnitude;

                let niceStep;
                if (residual >= 5) niceStep = 10;
                else if (residual >= 2) niceStep = 5;
                else if (residual >= 1) niceStep = 2;
                else niceStep = 1;

                const stepSize = niceStep * magnitude;
                const niceMax = Math.ceil(safeMax / stepSize) * stepSize;
                const tickAmount = Math.max(3, Math.min(10, Math.round(niceMax / stepSize)));

                return { niceMax, tickAmount };
            };

            const maxShotsPer90 = Math.max(...eligiblePlayers.map(p => p.shotsPer90));
            const maxShotsOnTargetPer90 = Math.max(...eligiblePlayers.map(p => p.shotsOnTargetPer90));

            const { niceMax: maxX, tickAmount: xTicks } = computeAxisParams(maxShotsPer90);
            const { niceMax: maxY, tickAmount: yTicks } = computeAxisParams(maxShotsOnTargetPer90);

            const scatterOptions = {
                series,
                chart: {
                    type: 'scatter',
                    height: 460,
                    background: 'transparent',
                    toolbar: { show: false },
                    zoom: { enabled: false },
                    events: {
                        dataPointMouseEnter: (event, chartContext, config) => {
                            const d = config.w.config.series?.[config.seriesIndex]?.data?.[config.dataPointIndex];
                            if (!d) return;

                            chartContext?.updateOptions({
                                annotations: {
                                    xaxis: [{
                                        x: d.x,
                                        strokeDashArray: 5,
                                        borderColor: 'rgba(255,255,255,0.4)'
                                    }],
                                    yaxis: [{
                                        y: d.y,
                                        strokeDashArray: 5,
                                        borderColor: 'rgba(255,255,255,0.4)'
                                    }]
                                }
                            }, false, false);

                            if (!scatterPinnedPoint) {
                                updateScatterFocus(d, false);
                            }
                        },
                        dataPointMouseLeave: (event, chartContext) => {
                            chartContext?.updateOptions({ annotations: { xaxis: [], yaxis: [] } }, false, false);

                            if (scatterPinnedPoint) {
                                updateScatterFocus(scatterPinnedPoint, true);
                            } else {
                                resetScatterFocus();
                            }
                        },
                        dataPointSelection: (event, chartContext, config) => {
                            const d = config.w.config.series?.[config.seriesIndex]?.data?.[config.dataPointIndex];
                            if (!d) return;
                            scatterPinnedPoint = d;
                            updateScatterFocus(d, true);
                        }
                    }
                },
                colors: series.map(s => s.color),
                dataLabels: { enabled: false },
                markers: {
                    size: 4,
                    strokeWidth: 1,
                    strokeColors: '#0f172a',
                    hover: { sizeOffset: 3 }
                },
                states: {
                    hover: { filter: { type: 'lighten', value: 0.1 } },
                    active: { filter: { type: 'none' }, allowMultipleDataPointsSelection: true }
                },
                grid: {
                    borderColor: 'rgba(255,255,255,0.08)',
                    strokeDashArray: 0,
                    xaxis: { lines: { show: true } },
                    yaxis: { lines: { show: true } }
                },
                xaxis: {
                    title: { text: 'Tiri/90', style: { color: '#cbd5e1', fontWeight: 600 } },
                    labels: { style: { colors: '#cbd5e1' } },
                    min: 0,
                    max: maxX,
                    tickAmount: xTicks,
                    tooltip: {
                        enabled: true,
                        formatter: (val) => Number(val).toFixed(2)
                    },
                    crosshairs: {
                        show: true,
                        position: 'back',
                        stroke: { color: 'rgba(255,255,255,0.4)', width: 1, dashArray: 5 }
                    }
                },
                yaxis: {
                    title: { text: 'Tiri in porta/90', style: { color: '#cbd5e1', fontWeight: 600 } },
                    labels: { style: { colors: '#cbd5e1' } },
                    min: 0,
                    max: maxY,
                    tickAmount: yTicks,
                    crosshairs: {
                        show: true,
                        stroke: { color: 'rgba(255,255,255,0.4)', width: 1, dashArray: 5 }
                    }
                },
                legend: {
                    labels: { colors: '#e2e8f0' }
                },
                tooltip: {
                    custom: ({ seriesIndex, dataPointIndex, w }) => {
                        const d = w.globals.initialSeries[seriesIndex].data[dataPointIndex];
                        if (!d) return '';

                        const roleKey = Object.keys(PLAYER_SCATTER_ROLE_LABELS).find(key =>
                            PLAYER_SCATTER_ROLE_LABELS[key] === w.globals.initialSeries[seriesIndex].name
                        );

                        const bullet = roleKey && PLAYER_SCATTER_ROLE_COLORS[roleKey]
                            ? `<span style="background:${PLAYER_SCATTER_ROLE_COLORS[roleKey]};" class="inline-block w-2 h-2 rounded-full mr-2"></span>`
                            : '';

                        const shots = Number.isFinite(d.x) ? d.x.toFixed(2) : d.x;
                        const shotsOn = Number.isFinite(d.y) ? d.y.toFixed(2) : d.y;

                        return `
                            <div class="px-3 py-2 bg-slate-800 border border-slate-700 rounded shadow-lg">
                                <div class="font-bold text-white text-xs mb-1">${bullet}${d.name}</div>
                                <div class="text-[10px] text-slate-300">${d.team ? `${d.team} Â· ` : ''}Tiri/90: ${shots} â€” Tiri in porta/90: ${shotsOn}</div>
                            </div>`;
                    }
                },
                annotations: { xaxis: [], yaxis: [] }
            };

            chartPlayerScatter = new ApexCharts(container, scatterOptions);
            chartPlayerScatter.render();
        }




        


        // --- UI RENDER FUNCTIONS ---
        function updatePageTitleUI() {
            const el = document.getElementById('breadcrumb-current');
            const title = document.getElementById('page-title');
            if(currentView === 'stats') { el.innerText = "Overview"; title.innerText = ""; }
            else if(currentView === 'analytics') { el.innerText = "Visual"; title.innerText = ""; }
            else if(currentView === 'playingTime') { el.innerText = "Performance"; title.innerText = ""; }
            else if(currentView === 'teams') { el.innerText = "Ranking"; title.innerText = ""; }
            else { el.innerText = "Database"; title.innerText = ""; }
        }

        function renderTable(data) {
            const thead = document.getElementById('tableHeader');
            const tbody = document.getElementById('tableBody');
            const tfoot = document.getElementById('tableFooter');
            
            thead.innerHTML = ''; tbody.innerHTML = ''; tfoot.innerHTML = '';
            
            const getSortIcon = (col) => sortColumn === col ? (sortDirection === 'asc' ? '<i class="fa-solid fa-sort-up ml-1 text-yellow-500"></i>' : '<i class="fa-solid fa-sort-down ml-1 text-yellow-500"></i>') : '';
            
            // Tooltip mapping for Teams view
            const tooltipMap = {
                'matches': 'Partite giocate dalla squadra nella stagione selezionata.',
                'avgFouls': 'Media falli fischiati nella partita (a favore/contro la squadra) per partita.',
                'avgFoulsHome': 'Media falli a partita, considerando solo le partite in casa.',
                'avgFoulsAway': 'Media falli a partita, considerando solo le partite in trasferta.',
                'avgEffHome': 'Tempo effettivo medio delle partite casalinghe (in minuti e secondi).',
                'avgEffAway': 'Tempo effettivo medio delle partite in trasferta (in minuti e secondi).',
                'avgEff': 'Tempo effettivo medio totale (in minuti e secondi).'
            };
            
            const th = (lbl, col, cls='', tooltip='') => {
                const titleAttr = tooltip ? `title="${tooltip}"` : '';
                return `<th class="cursor-pointer select-none hover:text-white transition-colors ${cls}" onclick="handleSort('${col}')" ${titleAttr}>
                    <span class="flex items-center justify-center ${cls.includes('sticky-col') ? 'justify-start' : 'justify-center'}">
                        ${lbl}${getSortIcon(col)}
                    </span>
                </th>`;
            }

            if (currentView === 'stats') {
                thead.innerHTML = `<tr>${th('Arbitro', 'name', 'sticky-col')}${th('Presenze', 'matches', 'text-center')}${th('Falli/P', 'avgFouls', 'text-center')}${th('Gialli Tot', 'yellows', 'text-center !text-yellow-500 font-bold')}${th('Gialli/P', 'avgYellows', 'text-center !text-yellow-500')}${th('Rossi Tot', 'reds', 'text-center !text-red-500 font-bold')}${th('Rossi/P', 'avgReds', 'text-center !text-red-500')}${th('Rigori/P', 'avgPens', 'text-center')}</tr>`;
                let tM=0, tF=0, tY=0, tR=0, tP=0;
                data.forEach((r) => { tM+=r.matches; tF+=r.avgFouls*r.matches; tY+=r.yellows; tR+=r.reds; tP+=r.avgPens*r.matches; tbody.innerHTML += `<tr class="${r.isInactive?'opacity-50 grayscale':''}"><td class="sticky-col border-b border-slate-800">${formatRefereeNameHTML(r.name)}</td><td class="text-center font-bold text-white text-base">${r.matches}</td><td class="text-center text-slate-300">${r.avgFouls.toFixed(2)}</td><td class="text-center !text-yellow-500 font-bold">${r.yellows}</td><td class="text-center !text-yellow-500">${r.avgYellows.toFixed(2)}</td><td class="text-center !text-red-500 font-bold">${r.reds}</td><td class="text-center !text-red-500">${r.avgReds.toFixed(2)}</td><td class="text-center text-slate-400">${r.avgPens.toFixed(2)}</td></tr>`; });
                // Nota come ho cambiato tutti i 'p-3' in 'p-2'
tfoot.innerHTML = `<tr><td class="sticky-col p-2 border-t border-slate-700">TOTALE</td><td class="text-center p-2 text-white">${tM}</td><td class="text-center p-2">${(tF/tM).toFixed(2)}</td><td class="text-center p-2 text-yellow-500 font-bold">${tY}</td><td class="text-center p-2 text-yellow-500">${(tY/tM).toFixed(2)}</td><td class="text-center p-2 text-red-500 font-bold">${tR}</td><td class="text-center p-2 text-red-500">${(tR/tM).toFixed(2)}</td><td class="text-center p-2">${(tP/tM).toFixed(2)}</td></tr>`;
            } 
            else if (currentView === 'playingTime') {
                const showTot = activeSeasons.some(season => ['2025-26', '2024-25', '2023-24', '2022-23'].includes(season));
                thead.innerHTML = `<tr>${th('Arbitro', 'name', 'sticky-col')}${th('Match', 'matches', 'text-center')}${th('Media T.E.', 'avgEffSec', 'text-center text-green-400')}${showTot ? th('Media T.Tot', 'avgTotSec', 'text-center text-blue-400') : ''}${th('Media % T.Eff', 'effRatio', 'text-center text-yellow-400')}<th class="w-10"></th></tr>`;
                data.forEach((r, i) => {
                    tbody.innerHTML += `<tr class="cursor-pointer group" onclick="toggleDetails(${i})"><td class="sticky-col border-b border-slate-800">${formatRefereeNameHTML(r.name)}</td><td class="text-center text-white">${r.matches}</td><td class="text-center font-bold text-green-400 font-mono text-base">${formatSecondsToTime(r.avgEffSec)}</td>${showTot ? `<td class="text-center font-medium text-blue-400 font-mono">${formatSecondsToTime(r.avgTotSec)}</td>` : ''}<td class="text-center font-mono text-yellow-400 font-semibold">${formatEffRatio(r.effRatio)}</td><td class="text-center text-slate-600 group-hover:text-white transition-colors"><i class="fa-solid fa-chevron-down text-xs" id="icon-${i}"></i></td></tr>`;
                    const matchesHeader = `<div class="grid grid-cols-${showTot ? '5' : '4'} gap-2 px-4 pb-2 text-[10px] uppercase tracking-wider text-slate-500"><span class="text-left">Partita</span><span class="text-center">Stagione</span><span class="text-center">T. Eff</span>${showTot ? '<span class="text-center">T. Tot</span>' : ''}<span class="text-center">% Eff</span></div>`;
                    const matchesHtml = r.matchList.map(m => {
                        const ratioDisplay = formatEffRatio(Number.isFinite(m.effRatio) ? m.effRatio : calculateEffRatio(m.effectiveTimeSec, m.totalTimeSec));
                        return `<div class="grid grid-cols-${showTot ? '5' : '4'} gap-2 py-2 px-4 border-b border-slate-800/50 text-xs hover:bg-slate-800 items-center">`+
                            `<span class="text-white font-bold truncate">${m.match}</span>`+
                            `<span class="text-center text-slate-500 font-mono">${m.season || '-'}</span>`+
                            `<span class="text-center font-mono ${m.effectiveTimeSec ? 'text-green-400' : 'text-slate-600'}">${formatSecondsToTime(m.effectiveTimeSec)}</span>`+
                            `${showTot ? `<span class="text-center font-mono text-blue-400">${formatSecondsToTime(m.totalTimeSec)}</span>` : ''}`+
                            `<span class="text-center font-mono text-yellow-400">${ratioDisplay}</span>`+
                        `</div>`;
                    }).join('');
                    tbody.innerHTML += `<tr id="details-${i}" class="hidden bg-slate-900/50"><td colspan="${showTot ? 6 : 5}" class="p-0 border-b border-slate-800"><div class="py-2 bg-[#0b1120] shadow-inner">${matchesHeader}${matchesHtml}</div></td></tr>`;
                });
            } else if (currentView === 'matches') {

                // Separated rendering logic for paging
                renderMatchesHeader(thead, th, getSortIcon);
                renderMatchesRows(data, true); // Pass true to clear tbody first
                renderMatchesFooter(tfoot, data.length);
                updateLoadMoreButton();
            } else if (currentView === 'teams') {
                // Squadra, Partite, Falli Tot, Falli Casa, Falli Trasf, T.Eff. Medio, T.Eff. Casa, T.Eff. Trasf.
                
                thead.innerHTML = `<tr>
                    ${th('Squadra', 'name', 'sticky-col')}
                    ${th('Partite', 'matches', 'text-center', tooltipMap.matches)}
                    ${th('Falli Tot', 'avgFouls', 'text-center text-red-400', tooltipMap.avgFouls)}
                    ${th('Falli Casa', 'avgFoulsHome', 'text-center text-red-400/70', tooltipMap.avgFoulsHome)}
                    ${th('Falli Trasf', 'avgFoulsAway', 'text-center text-red-400/70', tooltipMap.avgFoulsAway)}
                    ${th('T.Eff. Medio', 'avgEff', 'text-center text-green-400 font-bold', tooltipMap.avgEff)}
                    ${th('T.Eff. Casa', 'avgEffHome', 'text-center text-green-400/70', tooltipMap.avgEffHome)}
                    ${th('T.Eff. Trasf', 'avgEffAway', 'text-center text-green-400/70', tooltipMap.avgEffAway)}
                    </tr>`;

                data.forEach(t => {
                    const teamName = (t.name || '').toUpperCase();
                    tbody.innerHTML += `<tr>
                        <td class="sticky-col border-b border-slate-800 font-bold text-white uppercase">${teamName}</td>
                        <td class="text-center text-slate-400">${t.matches}</td>
                        <td class="text-center font-bold text-red-400">${t.avgFouls.toFixed(1)}</td>
                        <td class="text-center text-red-400/70">${t.avgFoulsHome.toFixed(1)}</td>
                        <td class="text-center text-red-400/70">${t.avgFoulsAway.toFixed(1)}</td>
                        <td class="text-center font-mono font-bold text-green-400">${formatSecondsToTime(t.avgEff)}</td>
                        <td class="text-center font-mono text-green-400/70">${formatSecondsToTime(t.avgEffHome)}</td>
                        <td class="text-center font-mono text-green-400/70">${formatSecondsToTime(t.avgEffAway)}</td>
                    </tr>`;
                });
            }
        }
        
        function renderMatchesHeader(thead, th, getSortIcon) {
             thead.innerHTML = `<tr>${th('Partita', 'match', 'sticky-col')}${th('Arbitro', 'referee', 'text-center text-green-400')}${th('Stagione', 'season', 'text-center')}${th('Tempo Tot', 'totalTimeSec', 'text-center text-blue-400')}${th('Tempo Eff', 'effectiveTimeSec', 'text-center text-green-400')}${th('% Eff', 'ratio', 'text-center')}${th('Falli', 'fouls', 'text-center text-red-400')}</tr>`;
        }

        function renderMatchesRows(data, clearTbody = true) {
            const tbody = document.getElementById('tableBody');
            if (clearTbody) tbody.innerHTML = '';
            
            // Per il calcolo dei colori, usiamo tutti i dati filtrati (matchesDataAll)
            const validTots = matchesDataAll.map(d=>d.totalTimeSec).filter(v=>!isNaN(v));
            const validEffs = matchesDataAll.map(d=>d.effectiveTimeSec).filter(v=>!isNaN(v));
            const validRatios = matchesDataAll.map(d=>d.ratio).filter(v=>!isNaN(v));
            
            const minTot = Math.min(...validTots); const maxTot = Math.max(...validTots);
            const minEff = Math.min(...validEffs); const maxEff = Math.max(...validEffs);
            const minRat = Math.min(...validRatios); const maxRat = Math.max(...validRatios);

            let rowsHtml = '';
            data.forEach((r) => {
                const colTot = getColorForValue(r.totalTimeSec, minTot, maxTot, true);
                const colEff = getColorForValue(r.effectiveTimeSec, minEff, maxEff);
                const colRat = getColorForValue(r.ratio, minRat, maxRat);

                const matchLabel = (r.match || '').toUpperCase();
                const refereeName = formatTitleCase(r.referee);

                rowsHtml += `<tr>
                    <td class="sticky-col border-b border-slate-800 font-bold text-white text-xs sm:text-sm truncate max-w-[180px] sm:max-w-none uppercase" title="${matchLabel}">${matchLabel}</td>
                    <td class="text-center text-green-400 bg-slate-800/10 rounded font-sans">${refereeName || '-'}</td>
                    <td class="text-center text-slate-500 text-xs">${r.season}</td>
                    <td class="text-center font-mono" style="color: ${colTot}">${formatSecondsToTime(r.totalTimeSec)}</td>
                    <td class="text-center font-mono font-bold" style="color: ${colEff}">${formatSecondsToTime(r.effectiveTimeSec)}</td>
                    <td class="text-center font-mono font-bold" style="color: ${colRat}">${r.ratio ? r.ratio.toFixed(1) + '%' : '-'}</td>
                    <td class="text-center font-bold text-white bg-slate-800/30 rounded">${r.fouls}</td>
                </tr>`;
            });
            tbody.innerHTML += rowsHtml;
        }

        function renderMatchesFooter(tfoot, dataLength) {
            tfoot.innerHTML = '';
            
            const dataToCalculate = matchesDataAll;
            let sumTot=0, countTot=0, sumEff=0, countEff=0, sumRat=0, countRat=0, sumFouls=0, countFouls=0, countMatches=dataToCalculate.length;

            dataToCalculate.forEach((r) => { 
                if(!isNaN(r.totalTimeSec)) { sumTot+=r.totalTimeSec; countTot++; }
                if(!isNaN(r.effectiveTimeSec)) { sumEff+=r.effectiveTimeSec; countEff++; }
                if(!isNaN(r.ratio)) { sumRat+=r.ratio; countRat++; }
                if(!isNaN(r.fouls)) { sumFouls+=r.fouls; countFouls++; }
            });

            if(countMatches > 0) {
                 const avgTot = countTot > 0 ? sumTot / countTot : 0;
                 const avgEff = countEff > 0 ? sumEff / countEff : 0;
                 const avgRat = countRat > 0 ? sumRat / countRat : 0;
                 const avgFouls = countFouls > 0 ? sumFouls / countFouls : 0;
                
                 // Container per il pulsante "Carica altro" PRIMA della riga medie
                 const loadMoreRow = document.createElement('tr');
                 loadMoreRow.innerHTML = `<td colspan="7" class="p-3 text-center" id="loadMoreContainer"></td>`;
                 tfoot.appendChild(loadMoreRow);

                 tfoot.innerHTML += `<tr class="avg-row">
                    <td class="sticky-col">MEDIE (${countMatches} partite)</td>
                    <td class="text-center">-</td>
                    <td class="text-center">-</td>
                    <td class="text-center font-mono text-blue-300">${formatSecondsToTime(avgTot)}</td>
                    <td class="text-center font-mono text-green-300">${formatSecondsToTime(avgEff)}</td>
                    <td class="text-center font-mono text-yellow-300">${avgRat.toFixed(1)}%</td>
                    <td class="text-center text-white">${avgFouls.toFixed(1)}</td>
                 </tr>`;
            } else {
                 // Container per il pulsante "Carica altro"
                tfoot.innerHTML += `<tr><td colspan="7" class="p-3 text-center" id="loadMoreContainer"></td></tr>`;
            }

        }

        function updateKPIDashboard(data) {
            const container = document.getElementById('kpi-dashboard');
            
            if (currentView === 'teams' || currentView === 'analytics') {
                container.classList.add('opacity-0', 'h-0', 'overflow-hidden');
                container.classList.remove('h-auto', 'opacity-100');
                return;
            } else {
                container.classList.remove('opacity-0', 'h-0', 'overflow-hidden');
                container.classList.add('h-auto', 'opacity-100');
            }

            const v1 = document.getElementById('kpi-value-1'); const v2 = document.getElementById('kpi-value-2'); const v3 = document.getElementById('kpi-value-3'); const v4 = document.getElementById('kpi-value-4');
            const l1 = document.getElementById('kpi-label-1'); const l2 = document.getElementById('kpi-label-2'); const l3 = document.getElementById('kpi-label-3'); const l4 = document.getElementById('kpi-label-4');
            if(!v1) return; const count = data.length;

            if (currentView === 'stats') {
                let tM=0, tF=0, tY=0, tR=0; data.forEach(r => { tM+=r.matches; tF+=r.avgFouls*r.matches; tY+=r.yellows; tR+=r.reds; });
                l1.innerText = "Arbitri"; v1.innerText = count; l2.innerText = "Falli P/P"; v2.innerText = tM ? (tF/tM).toFixed(2) : '-'; l3.innerText = "Gialli / P"; v3.innerText = tM ? (tY/tM).toFixed(2) : '-'; l4.innerText = "Rossi / P"; v4.innerText = tM ? (tR/tM).toFixed(2) : '-';
            } else if (currentView === 'playingTime') {
                let tEff=0, cEff=0, tTot=0, cTot=0; data.forEach(r => { if(r.avgEffSec){ tEff+=r.avgEffSec; cEff++; } if(r.avgTotSec){ tTot+=r.avgTotSec; cTot++; } });
                l1.innerText = "Arbitri"; v1.innerText = count; l2.innerText = "Partite"; v2.innerText = data.reduce((a,b)=>a+b.matches,0); l3.innerText = "Media T.E."; v3.innerText = cEff ? formatSecondsToTime(tEff/cEff) : '-'; l4.innerText = "Media Tot"; v4.innerText = cTot ? formatSecondsToTime(tTot/cTot) : '-';
            } else if (currentView === 'matches') {
                const matchData = matchesDataAll;
                let tM=matchData.length, sumTot=0, countTot=0, sumEff=0, countEff=0, sumFouls=0;
                matchData.forEach(r => { 
                    if (!isNaN(r.totalTimeSec)) { sumTot += r.totalTimeSec; countTot++; }
                    if (!isNaN(r.effectiveTimeSec)) { sumEff += r.effectiveTimeSec; countEff++; }
                    sumFouls += r.fouls; 
                });
                
                // Card order: Partite -> Tempo Tot -> Tempo Eff -> Falli/P
                l1.innerText = "Partite Tot"; v1.innerText = tM;
                l2.innerText = "Tempo Tot Medio"; v2.innerText = countTot ? formatSecondsToTime(sumTot/countTot) : '-';
                l3.innerText = "Tempo Eff Medio"; v3.innerText = countEff ? formatSecondsToTime(sumEff/countEff) : '-';
                l4.innerText = "Falli / P"; v4.innerText = tM ? (sumFouls/tM).toFixed(2) : '-';
            }
        }

        function toggleDetails(i) {
            const row = document.getElementById(`details-${i}`);
            const icon = document.getElementById(`icon-${i}`);
            if(row.classList.contains('hidden')) { row.classList.remove('hidden'); icon.classList.replace('fa-chevron-down', 'fa-chevron-up'); }
            else { row.classList.add('hidden'); icon.classList.replace('fa-chevron-up', 'fa-chevron-down'); }
        }

        function handleSort(col) {
            if (currentView === 'matches') resetMatchesPaging();

            if (sortColumn === col) sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            else { sortColumn = col; sortDirection = 'desc'; }

            // Nuovi default di ordinamento per la scheda teams dopo la rimozione di contactIndex
            if(currentView === 'teams' && col === 'name') sortDirection = 'asc';
            if(currentView === 'teams' && col === 'matches') sortDirection = 'desc';

            aggregateData();
        }

        function animateSection(section) {
            if (!section) return;

            section.classList.remove('fade-in-soft', 'view-transitioning');
            // force reflow to restart animation
            void section.offsetWidth;
            section.classList.add('fade-in-soft', 'view-transitioning');
        }

        function pulseNavigation(view) {
            const navKey = view === 'playingTime' ? 'time' : view;
            [`nav-${navKey}`, `mob-nav-${navKey}`].forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;

                el.classList.remove('nav-pill-boost');
                void el.offsetWidth;
                el.classList.add('nav-pill-boost');
            });
        }

        function showSection(section) {
            if (!section) return;

            section.classList.remove('hidden');
            animateSection(section);
        }

        function hideSection(section) {
            if (!section) return;

            section.classList.add('hidden');
        }

        function getBasePathForRouting() {
            const segments = window.location.pathname.split('/').filter(Boolean);
            const routeSegments = new Set(Object.values(VIEW_ROUTE_MAP));

            if (segments.length && routeSegments.has(segments[segments.length - 1])) segments.pop();

            const basePath = '/' + segments.join('/');
            return basePath === '//' ? '/' : basePath || '/';
        }

        function buildUrlForView(view) {
            const slug = VIEW_ROUTE_MAP[view];
            if (!slug) return window.location.pathname;

            const basePath = getBasePathForRouting();
            const prefix = basePath === '/' ? '' : basePath;
            return `${prefix}/${slug}`;
        }

        function getViewFromLocation() {
            const segments = window.location.pathname.split('/').filter(Boolean);
            const routeViewMap = Object.entries(VIEW_ROUTE_MAP).reduce((acc, [view, slug]) => {
                acc[slug] = view;
                return acc;
            }, {});

            for (let i = segments.length - 1; i >= 0; i -= 1) {
                const candidate = routeViewMap[segments[i]];
                if (candidate) return candidate;
            }

            const params = new URLSearchParams(window.location.search);
            const queryView = params.get('view');
            if (queryView && VIEW_ROUTE_MAP[queryView]) return queryView;

            return 'stats';
        }

        function updateHistoryState(view, { replace = false } = {}) {
            const slug = VIEW_ROUTE_MAP[view];
            if (!slug) return;

            const newUrl = buildUrlForView(view);
            const state = { view };

            if (replace) history.replaceState(state, '', newUrl);
            else history.pushState(state, '', newUrl);
        }

        function switchView(view, options = {}) {
            const { updateHistory = true, replaceHistory = false } = options;
            // CORREZIONE BUG: Resetta la selezione delle stagioni a '2025-26' ad ogni cambio di vista
            if (currentView !== view) {
                activeSeasons = ['2025-26'];
                // Reset analytics filter to avoid confusing behavior on switch
                analyticsMinMatchesFilter = 0;
                const analyticsMinMatchesEl = document.getElementById('analyticsMinMatches');
                if(analyticsMinMatchesEl) analyticsMinMatchesEl.value = 0;
                const analyticsMinMatchesValueEl = document.getElementById('analyticsMinMatchesValue');
                if(analyticsMinMatchesValueEl) analyticsMinMatchesValueEl.innerText = 0;
            }
            
            currentView = view;


    // â­â­â­ RESET DEI FILTRI PRESENZE QUANDO CAMBIO SCHEDA
    minMatchesFilterStats = 0;
    minMatchesFilterPT = 0;

    if (document.getElementById('minMatches')) {
        document.getElementById('minMatches').value = 0;
    }
    if (document.getElementById('minMatchesValue')) {
        document.getElementById('minMatchesValue').innerText = 0;
    }
    // â­â­â­ FINE RESET

            resetMatchesPaging(); 

            // Update Active State (Desktop)
            ['nav-stats', 'nav-analytics', 'nav-time', 'nav-matches', 'nav-teams', 'nav-players', 'nav-quiz'].forEach(id => {
                const el = document.getElementById(id);
                if(el) {
                    if(id === `nav-${view === 'playingTime' ? 'time' : view}`) el.classList.add('active');
                    else el.classList.remove('active');
                }
            });
            // Mobile State
             ['mob-nav-stats', 'mob-nav-analytics', 'mob-nav-time', 'mob-nav-matches', 'mob-nav-teams', 'mob-nav-players', 'mob-nav-quiz'].forEach(id => {
                 const el = document.getElementById(id);
                 if(el) {
                     if(id === `mob-nav-${view === 'playingTime' ? 'time' : view}`) {
                         el.classList.add('text-yellow-500', 'bg-slate-700'); el.classList.remove('text-slate-400');
                     } else {
                         el.classList.remove('text-yellow-500', 'bg-slate-700'); el.classList.add('text-slate-400');
                     }
                 }
            });

const searchInput   = document.getElementById('searchInput');
const tableView     = document.getElementById('table-view');
const analyticsView = document.getElementById('analytics-view');
const playersView   = document.getElementById('players-view');
const sidebar       = document.getElementById('sidebar-filters');
const mainContent   = document.getElementById('main-content');
const seasonCard    = document.getElementById('season-selector-card');
const analyticsShortcutsCard = document.getElementById('analytics-shortcuts-card');
const quizView      = document.getElementById('quiz-view');

        if (view === 'analytics') {
            hideSection(tableView);
            showSection(analyticsView);
            hideSection(playersView);
            hideSection(quizView);
            showSection(sidebar);
    if (seasonCard)    seasonCard.classList.add('hidden');
    if (analyticsShortcutsCard) analyticsShortcutsCard.classList.remove('hidden');
    if (mainContent) {
        mainContent.classList.remove('lg:col-span-12');
        mainContent.classList.add('lg:col-span-9');
    }
            setAnalyticsViewMode('refs');
            scheduleAnalyticsRender();
        } else if (view === 'players') {
            hideSection(tableView);
            hideSection(analyticsView);
            showSection(playersView);
            hideSection(quizView);
    if (sidebar)       sidebar.classList.add('hidden');
    if (seasonCard)    seasonCard.classList.add('hidden');
    if (analyticsShortcutsCard) analyticsShortcutsCard.classList.add('hidden');
    if (mainContent) {
        mainContent.classList.remove('lg:col-span-9');
        mainContent.classList.add('lg:col-span-12');
    }


    // renderizza / aggiorna la tabella giocatori
    initPlayersFilters();
    renderPlayersTable();
        } else if (view === 'quiz') {
            hideSection(tableView);
            hideSection(analyticsView);
            hideSection(playersView);
            showSection(quizView);
    if (sidebar)       sidebar.classList.add('hidden');
    if (seasonCard)    seasonCard.classList.add('hidden');
    if (analyticsShortcutsCard) analyticsShortcutsCard.classList.add('hidden');
    if (mainContent) {
        mainContent.classList.remove('lg:col-span-9');
        mainContent.classList.add('lg:col-span-12');
    }
            if (!quizRound.length) prepareQuizRound();
} else {

    // stats, matches, playingTime, teams
    showSection(tableView);
    hideSection(analyticsView);
    hideSection(playersView);
    hideSection(quizView);
    showSection(sidebar);
    if (seasonCard)    seasonCard.classList.remove('hidden');
    if (analyticsShortcutsCard) analyticsShortcutsCard.classList.add('hidden');
    if (mainContent) {
        mainContent.classList.remove('lg:col-span-12');
        mainContent.classList.add('lg:col-span-9');
    }
}
            // Update search placeholder based on view
            if(searchInput) {
                 if(view === 'teams') searchInput.placeholder = 'Cerca squadra...';
                 else if(view === 'matches') searchInput.placeholder = 'Cerca squadra o partita...';
                 else searchInput.placeholder = 'Cerca arbitro...';
                 searchInput.value = '';
            }

            // Set default sort columns
            if(view === 'stats' || view === 'analytics') { sortColumn = 'matches'; sortDirection = 'desc'; }
            if(view === 'playingTime') { sortColumn = 'avgEffSec'; sortDirection = 'desc'; }
            if(view === 'matches') { sortColumn = 'match'; sortDirection = 'asc'; }
            if(view === 'teams') { sortColumn = 'matches'; sortDirection = 'desc'; } // Nuovo default per squadre

            updateSeasonButtonsUI();
            aggregateData(); // Non debouncato per il cambio scheda, deve essere immediato

            if (updateHistory) updateHistoryState(view, { replace: replaceHistory });
        }

        function setAnalyticsViewMode(mode) {
            if (!['refs', 'players'].includes(mode)) return;

            analyticsViewMode = mode;

            const refsWrapper = document.getElementById('analytics-refs-wrapper');
            const playersWrapper = document.getElementById('analytics-players-wrapper');
            const btnRefs = document.getElementById('analytics-mode-refs');
            const btnPlayers = document.getElementById('analytics-mode-players');
            const shortcutsCard = document.getElementById('analytics-shortcuts-card');

            if (refsWrapper) refsWrapper.classList.toggle('hidden', mode !== 'refs');
            if (playersWrapper) playersWrapper.classList.toggle('hidden', mode !== 'players');

            const updateButtonState = (btn, isActive) => {
                if (!btn) return;
                btn.classList.toggle('bg-yellow-500', isActive);
                btn.classList.toggle('text-slate-900', isActive);
                btn.classList.toggle('shadow-glow', isActive);
                btn.classList.toggle('bg-slate-900', !isActive);
                btn.classList.toggle('text-slate-300', !isActive);
                btn.classList.toggle('border', !isActive);
                btn.classList.toggle('border-slate-700', !isActive);
            };

            updateButtonState(btnRefs, mode === 'refs');
            updateButtonState(btnPlayers, mode === 'players');

            if (shortcutsCard) shortcutsCard.classList.toggle('hidden', mode !== 'refs');

            if (mode === 'players') {
                renderPlayerScatterChart();
            }
        }

        function toggleSeason(s) {
            resetMatchesPaging();

            // Blocco le stagioni SOON solo se la vista attuale Ã¨ una di quelle con il blocco attivo
            const viewsToBlockSoon = ['playingTime', 'matches', 'teams']; 
            const isBlockedView = viewsToBlockSoon.includes(currentView);
            const isSoonSeason = SOON_SEASONS.includes(s);

            if (isBlockedView && isSoonSeason && s !== '2024-25' && !activeSeasons.includes(s)) {
                // Previene la selezione di stagioni SOON che non sono 2024-25 in viste bloccate
                return;
            }

            if(activeSeasons.includes(s)) activeSeasons = activeSeasons.filter(x => x !== s);
            else activeSeasons.push(s);
            updateSeasonButtonsUI();
            aggregateData();
        }

        function toggleAllSeasons() {
            resetMatchesPaging();
            
            const all = ['2025-26', '2024-25', '2023-24', '2022-23'];
            activeSeasons = activeSeasons.length === all.length ? [] : [...all];
            updateSeasonButtonsUI();
            aggregateData();
        }

        function updateSeasonButtonsUI() {
            const allSeasons = ['2025-26', '2024-25', '2023-24', '2022-23', '2021-22', '2020-21'];
            // Viste in cui i dati storici sono "SOON" e quindi disabilitati (a meno che non siano stats/analytics)
            const viewsToBlockSoon = ['playingTime', 'matches', 'teams'];
            const isBlockedView = viewsToBlockSoon.includes(currentView);
            const viewsWithNewHistorical = ['playingTime', 'matches', 'teams'];

            allSeasons.forEach(s => {
                const btn = document.getElementById(`btn-${s}`);
                if(!btn) return;
                const icon = btn.querySelector('.check-icon');
                const soonLabel = btn.querySelector('.coming-soon-label');
                const newBadge = btn.querySelector('.season-new-badge');
                const isSoonSeason = SOON_SEASONS.includes(s);
                const is2425 = s === '2024-25';
                const isSelected = activeSeasons.includes(s);

                const shouldShowNewBadge = viewsWithNewHistorical.includes(currentView) && (s === '2023-24' || s === '2022-23');

                if (newBadge) {
                    if (shouldShowNewBadge) newBadge.classList.remove('hidden');
                    else newBadge.classList.add('hidden');
                }

                // Gestione VisibilitÃ  SOON
                if (isSoonSeason && soonLabel) {
                    if (isBlockedView) {
                         // CORREZIONE 2: Rende la label visibile con opacitÃ  ridotta, ma non 'hidden'
                         soonLabel.style.display = 'inline-block';
                         soonLabel.style.opacity = '0.9';
                    } else {
                         soonLabel.style.display = 'none';
                    }
                } else {
                    if (soonLabel) soonLabel.style.display = 'none'; 
                }
                
                // Gestione Disabilitazione / OpacitÃ 
                const shouldBeBlocked = isBlockedView && isSoonSeason && !is2425;

                if (shouldBeBlocked) {
                    btn.disabled = true;
                    // Rimuovo l'opacitÃ  dal pulsante stesso per non oscurare troppo la label SOON
                    btn.classList.add('cursor-not-allowed', 'text-slate-500'); 
                    btn.classList.remove('opacity-40', 'text-slate-400', 'text-white', 'text-yellow-500');
                    if(icon) icon.classList.add('opacity-0');
                } else {
                    // SBLOCCA: Rimuovi disabilitazione e opacitÃ 
                    btn.disabled = false;
                    btn.classList.remove('opacity-40', 'cursor-not-allowed', 'text-slate-500');
                }

                // Gestione Active State e Spunta Gialla
                if(isSelected) {
                    btn.classList.add('active');
                    // La spunta deve essere visibile solo se selezionata
                    if(icon) {
                        icon.classList.remove('opacity-0');
                        icon.classList.add('opacity-100');
                    }
                } else {
                    btn.classList.remove('active');
                    // La spunta deve essere invisibile se non selezionata
                    if(icon) {
                        icon.classList.remove('opacity-100');
                        icon.classList.add('opacity-0');
                    }
                }
            });
        }

        function toggleAnalyticsSeason(chartKey, season) {
            if (!analyticsSeasonFilters[chartKey]) return;

            const current = new Set(analyticsSeasonFilters[chartKey]);

            if (current.has(season) && current.size > 1) {
                current.delete(season);
            } else {
                current.add(season);
            }

            analyticsSeasonFilters[chartKey] = Array.from(current);
            updateAnalyticsSeasonChipsUI(chartKey);
            scheduleAnalyticsRender();
        }

        function updateAnalyticsSeasonChipsUI(chartKey) {
            const activeSet = new Set(analyticsSeasonFilters[chartKey] || []);
            const container = document.getElementById(`season-toggle-${chartKey}`);
            if (!container) return;

            container.querySelectorAll('.analytics-season-chip').forEach(btn => {
                const btnSeason = btn.getAttribute('data-season');
                if (activeSet.has(btnSeason)) btn.classList.add('active');
                else btn.classList.remove('active');
            });
        }

        function refreshAllAnalyticsSeasonChips() {
            Object.keys(analyticsSeasonFilters).forEach(updateAnalyticsSeasonChipsUI);
        }

        function scrollToAnalyticsSection(targetId) {
            const performScroll = () => {
                const target = document.getElementById(targetId);
                if (!target) return;

                const headerHeight = document.querySelector('.pro-header')?.offsetHeight || 0;
                const offset = headerHeight + 16;
                const top = target.getBoundingClientRect().top + window.scrollY - offset;
                window.scrollTo({ top, behavior: 'smooth' });
            };

            performScroll();
        }

function updateMinMatches(val) {
    if (currentView === 'stats') {
        minMatchesFilterStats = parseInt(val);
    } else if (currentView === 'playingTime') {
        minMatchesFilterPT = parseInt(val);
    }

    document.getElementById('minMatchesValue').innerText = val;
    document.getElementById('minMatches').value = val;
document.getElementById("players-view").classList.add("hidden");


    debounceAggregate();
}

function getPlayerStatsForMode(player) {
    const presence = Number.isFinite(player.n90) ? player.n90 : 0;
    const roundTotal = (val) => Number.isFinite(val) ? Math.round(val * presence) : 0;

    const per90Stats = {
        n90: presence,
        yellow: player.yellow ?? 0,
        fouls: player.fouls ?? 0,
        fouled: player.fouled ?? 0,
        crosses: player.crosses ?? 0,
        passCompleted: player.passCompleted,
        passAttempted: player.passAttempted,
        passPct: player.passPct,
        shotsTotal: player.shotsTotal,
        shotsOnTarget: player.shotsOnTarget,
        shotsPer90: player.shotsPer90,
        shotsOnTargetPer90: player.shotsOnTargetPer90,
    };

    const totals = {
        ...per90Stats,
        yellow: roundTotal(player.yellow),
        fouls: roundTotal(player.fouls),
        fouled: roundTotal(player.fouled),
        crosses: roundTotal(player.crosses),
        passCompleted: roundTotal(player.passCompleted),
        passAttempted: roundTotal(player.passAttempted),
        shotsPer90: roundTotal(player.shotsPer90),
        shotsOnTargetPer90: roundTotal(player.shotsOnTargetPer90),
    };
    return playersStatMode === 'total' ? totals : per90Stats;
}

function updatePlayersModeToggleUI() {
    document.querySelectorAll('[data-mode]').forEach((btn) => {
        const isActive = btn.getAttribute('data-mode') === playersStatMode;
        btn.classList.toggle('bg-yellow-500/10', isActive);
        btn.classList.toggle('border-yellow-500', isActive);
        btn.classList.toggle('text-yellow-400', isActive);
    });

    document.querySelectorAll('#players-table thead .players-col-label').forEach((labelEl) => {
        const per90 = labelEl.getAttribute('data-label-per90');
        const total = labelEl.getAttribute('data-label-total');
        if (per90 && total) {
            labelEl.textContent = playersStatMode === 'total' ? total : per90;
        }
    });
}

function setPlayersStatMode(mode) {
    if (!['per90', 'total'].includes(mode)) return;
    playersStatMode = mode;
    updatePlayersModeToggleUI();
    renderPlayersTable();
    renderPlayerComparisonTable();
}

function normalizeText(value) {
    return (value || '')
        .toLowerCase()
        .normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '');
}

function renderPlayersTable() {
    const q = normalizeText(document.getElementById("players-search")?.value || "");
    const tbody = document.getElementById("players-table-body");
    if (!tbody) return;
    tbody.innerHTML = "";

    const filtered = playersData
        .filter(p => normalizeText(p.name).includes(q))
        .filter(p => p.n90 >= playersMinMatches)
        .filter(p => !excludeLowPresencePlayers || playersMaxMatches === 0 || p.n90 >= playersMaxMatches * 0.3)
        .filter(p => {
            const playerRoles = (p.role || '')
                .split(',')
                .map(r => r.trim())
                .filter(Boolean);
            const matchesRole = selectedPlayerRoles.size === 0
                ? true
                : playerRoles.some(r => selectedPlayerRoles.has(r));
            const matchesTeam = selectedTeams.has('all') || selectedTeams.size === 0
                ? true
                : selectedTeams.has((p.team || '').toLowerCase());

            return matchesRole && matchesTeam;
        });

    const sorted = [...filtered].sort((a, b) => {
        const valA = getPlayersSortValue(a, playersSortColumn);
        const valB = getPlayersSortValue(b, playersSortColumn);

        if (typeof valA === 'string' || typeof valB === 'string') {
            const comparison = String(valA).localeCompare(String(valB), 'it', { sensitivity: 'base' });
            return playersSortDirection === 'asc' ? comparison : -comparison;
        }

        const comparison = valA - valB;
        return playersSortDirection === 'asc' ? comparison : -comparison;
    });

    sorted.forEach((p, index) => {
        const tr = document.createElement("tr");
        const stats = getPlayerStatsForMode(p);
        const rateDigits = playersStatMode === 'total' ? 0 : 2;
        const volumeDigits = playersStatMode === 'total' ? 0 : 1;
        const passPct = Number.isFinite(stats.passPct)
            ? `${stats.passPct.toFixed(1).replace('.', ',')}%`
            : '-';
        const teamLogo = getTeamLogo(p.team || '');
        const logoImg = teamLogo
            ? `<img src="${teamLogo}" alt="${p.team || 'Logo squadra'}" class="inline-block ml-2 h-4 w-4 object-contain align-middle opacity-80">`
            : '';
        const fullName = formatPlayerName(p.name);
        const surnameOnly = formatPlayerSurname(p.name);
        const nameLabel = `
            <span class="inline-flex items-center gap-1">
                <span class="block sm:hidden">${surnameOnly}</span>
                <span class="hidden sm:inline">${fullName}</span>
                ${logoImg}
            </span>
        `;

        tr.title = p.team ? `Squadra: ${p.team}` : 'Squadra non disponibile';
        tr.innerHTML = `
            <td class="p-2 font-mono text-xs text-slate-400 sticky-col players-rank-col">${index + 1}</td>
            <td class="p-2 text-left whitespace-nowrap sticky-col sticky-col-name max-w-[10rem] truncate">${nameLabel}</td>

            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.n90, 1)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.yellow, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.fouls, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.fouled, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.crosses, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.passCompleted, volumeDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.passAttempted, volumeDigits)}</td>
            <td class="p-2 whitespace-nowrap">${passPct}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.shotsPer90, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.shotsOnTargetPer90, rateDigits)}</td>
        `;
        tbody.appendChild(tr);
    });

    updatePlayersSortUI();
}

function getPlayersSortValue(player, column) {
    const stats = getPlayerStatsForMode(player);
    switch (column) {
        case 'name':
            return extractSurname(player.name) || '';
        case 'role':
            return (player.role || '').toLowerCase();
        case 'team':
            return (player.team || '').toLowerCase();
        case 'n90':
            return stats.n90 || 0;
        case 'yellow':
            return stats.yellow || 0;
        case 'fouls':
            return stats.fouls || 0;
        case 'fouled':
            return stats.fouled || 0;
        case 'crosses':
            return stats.crosses || 0;
        case 'passCompleted':
            return Number.isFinite(stats.passCompleted) ? stats.passCompleted : 0;
        case 'passAttempted':
            return Number.isFinite(stats.passAttempted) ? stats.passAttempted : 0;
        case 'passPct':
            return Number.isFinite(stats.passPct) ? stats.passPct : 0;
        case 'shotsPer90':
            return Number.isFinite(stats.shotsPer90) ? stats.shotsPer90 : 0;
        case 'shotsOnTargetPer90':
            return Number.isFinite(stats.shotsOnTargetPer90) ? stats.shotsOnTargetPer90 : 0;
        default:
            return 0;
    }
}

function handlePlayersSort(column) {
    if (playersSortColumn === column) {
        playersSortDirection = playersSortDirection === 'asc' ? 'desc' : 'asc';
    } else {
        playersSortColumn = column;
        playersSortDirection = column === 'name' ? 'asc' : 'desc';
    }

    renderPlayersTable();
}

function updatePlayersSortUI() {
    document.querySelectorAll('#players-table thead th[data-sort-col]').forEach(th => {
        const icon = th.querySelector('.players-sort-icon');
        const isActive = th.dataset.sortCol === playersSortColumn;

        th.classList.toggle('text-yellow-400', isActive);

        if (!icon) return;

        if (isActive) icon.textContent = playersSortDirection === 'asc' ? 'â†‘' : 'â†“';
        else icon.textContent = '';
    });
}

function populatePlayersComparisonOptions() {
    playerComparisonOptions = playersData.map((p) => p.name);
    updatePlayersComparisonOptions('');
}

function updatePlayersComparisonOptions(query) {
    const datalist = document.getElementById('players-compare-options');
    if (!datalist) return;

    const normalizedQuery = normalizePlayerKey(query);

    const options = playerComparisonOptions
        .filter((name) => {
            if (!normalizedQuery) return true;
            return normalizePlayerKey(name).includes(normalizedQuery);
        })
        .map((name) => `<option value="${name}"></option>`)
        .join('');

    datalist.innerHTML = options;
}

function handlePlayerComparisonInput(slot, value) {
    const sanitized = (value || '').trim();
    if (slot === 1) playerComparisonSelections.first = sanitized;
    else if (slot === 2) playerComparisonSelections.second = sanitized;

    updatePlayersComparisonOptions(sanitized);

    renderPlayerComparisonTable();
}

function findPlayerByName(name) {
    if (!name) return null;
    const key = normalizePlayerKey(name);
    return playersData.find((p) => normalizePlayerKey(p.name) === key) || null;
}

function buildComparisonRow(label, rawA, rawB, formatter) {
    const displayA = formatter(rawA);
    const displayB = formatter(rawB);

    const isNumA = Number.isFinite(rawA);
    const isNumB = Number.isFinite(rawB);
    const highlightA = isNumA && (!isNumB || rawA > rawB);
    const highlightB = isNumB && (!isNumA || rawB > rawA);

    const cellA = highlightA ? `<span class="font-bold text-white">${displayA}</span>` : displayA;
    const cellB = highlightB ? `<span class="font-bold text-white">${displayB}</span>` : displayB;

    return `
        <tr class="border-t border-slate-800">
            <th class="p-2 text-left text-slate-400 font-semibold">${label}</th>
            <td class="p-2 text-center font-mono text-slate-200">${cellA}</td>
            <td class="p-2 text-center font-mono text-slate-200">${cellB}</td>
        </tr>
    `;
}

function renderPlayerComparisonTable() {
    const table = document.getElementById('players-comparison-table');
    if (!table) return;

    const playerA = findPlayerByName(playerComparisonSelections.first);
    const playerB = findPlayerByName(playerComparisonSelections.second);

    if (!playerA && !playerB) {
        table.innerHTML = `<tbody><tr><td class="p-3 text-center text-slate-500" colspan="3">Seleziona due giocatori per confrontare le statistiche.</td></tr></tbody>`;
        return;
    }

    const statsA = playerA ? getPlayerStatsForMode(playerA) : null;
    const statsB = playerB ? getPlayerStatsForMode(playerB) : null;
    const rateDigits = playersStatMode === 'total' ? 0 : 2;
    const volumeDigits = playersStatMode === 'total' ? 0 : 1;
    const presenceDigits = playersStatMode === 'total' ? 0 : 1;

    const formatPercent = (value) => Number.isFinite(value) ? `${value.toFixed(1).replace('.', ',')}%` : '-';

    const rows = [
        buildComparisonRow("Presenze (90')", statsA?.n90, statsB?.n90, (v) => formatPassingValue(v, presenceDigits)),
        buildComparisonRow('Gialli', statsA?.yellow, statsB?.yellow, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('Falli Commessi', statsA?.fouls, statsB?.fouls, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('Falli Subiti', statsA?.fouled, statsB?.fouled, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('Cross', statsA?.crosses, statsB?.crosses, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('PassC', statsA?.passCompleted, statsB?.passCompleted, (v) => formatPassingValue(v, volumeDigits)),
        buildComparisonRow('PassT', statsA?.passAttempted, statsB?.passAttempted, (v) => formatPassingValue(v, volumeDigits)),
        buildComparisonRow('% Pass', statsA?.passPct, statsB?.passPct, formatPercent),
        buildComparisonRow('Tiri', statsA?.shotsPer90, statsB?.shotsPer90, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('Tiri in Porta', statsA?.shotsOnTargetPer90, statsB?.shotsOnTargetPer90, (v) => formatPassingValue(v, rateDigits)),
    ];

    const headerA = playerA ? formatPlayerName(playerA.name) : 'â€”';
    const headerB = playerB ? formatPlayerName(playerB.name) : 'â€”';

    table.innerHTML = `
        <thead class="bg-slate-900/60 border-b border-slate-800">
            <tr>
                <th class="p-2 text-left text-slate-400">STATS</th>
                <th class="p-2 text-center text-white">${headerA}</th>
                <th class="p-2 text-center text-white">${headerB}</th>
            </tr>
        </thead>
        <tbody>${rows.join('')}</tbody>
    `;
}

function normalizePlayerKey(name) {
    return (name || '')
        .normalize('NFD')
        .replace(/\p{Diacritic}/gu, '')
        .toLowerCase()
        .replace(/\s+/g, ' ')
        .trim();
}

// Converte la stringa TSV dei giocatori in un array di oggetti
function parsePlayersDB(raw) {
    if (!raw) return [];

    const toNumber = (val) => {
        const normalized = (val || '').replace(',', '.');
        const parsed = parseFloat(normalized);
        return Number.isFinite(parsed) ? parsed : 0;
    };

    const parseLine = (line) => {
        const tabParts = line.split('\t');

        let name = '';
        let role = '';
        let team = '';
        let statsTokens = [];

        if (tabParts.length >= 8) {
            [name, role, team, ...statsTokens] = tabParts.slice(0, 8);
        } else {
            const trimmed = line.trim();
            const numberMatches = Array.from(trimmed.matchAll(/(\d+,\d{1,2})/g));

            if (numberMatches.length < 5) return null;

            const statsMatches = numberMatches.slice(-5);
            statsTokens = statsMatches.map((m) => m[1]);

            const firstStatIndex = statsMatches[0]?.index ?? trimmed.length;
            const prefix = trimmed.slice(0, firstStatIndex).trim();

            const nameRoleTeamMatch = prefix.match(/^(?<name>.+?)(?<role>[A-Z]{2,3}(?:,[A-Z]{2,3})*)(?<team>[A-ZÃ€-Ã¿][A-Za-zÃ€-Ã¿'\.\s-]*)$/);
            if (!nameRoleTeamMatch || !nameRoleTeamMatch.groups) return null;

            name = (nameRoleTeamMatch.groups.name || '').trim();
            role = (nameRoleTeamMatch.groups.role || '').trim();
            team = (nameRoleTeamMatch.groups.team || '').trim();
        }

        if (statsTokens.length < 5) return null;

        return {
            name,
            role,
            team,
            n90:     toNumber(statsTokens[0]),
            yellow:  toNumber(statsTokens[1]),
            fouls:   toNumber(statsTokens[2]),
            fouled:  toNumber(statsTokens[3]),
            crosses: toNumber(statsTokens[4])
        };
    };
    return raw
        .trim()
        .split('\n')
        .map(parseLine)
        .filter(Boolean);
}

// Parsing per il dataset Passaggi/Tiri giocatori
function parsePlayersPassing(raw) {
    if (!raw) return [];

    const toNumber = (val) => {
        const normalized = String(val || '').replace('%', '').replace(',', '.');
        const parsed = parseFloat(normalized);
        return Number.isFinite(parsed) ? parsed : 0;
    };

    const numberPattern = /(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)%?\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)/;

    return raw
        .trim()
        .split('\n')
        .map((line) => {
            const trimmed = line.trim();
            if (!trimmed || trimmed.toLowerCase().startsWith('player pass')) return null;

            const match = trimmed.match(numberPattern);
            if (!match) return null;

            const name = trimmed.slice(0, match.index).trim();
            if (!name) return null;

            const [_, passesCompleted, passesAttempted, passPct, shotsTotal, shotsOnTarget, shotsPer90, shotsOnTargetPer90, avgShotDistance] = match;

            return {
                name,
                passesCompleted: toNumber(passesCompleted),
                passesAttempted: toNumber(passesAttempted),
                passPct: toNumber(passPct),
                shotsTotal: toNumber(shotsTotal),
                shotsOnTarget: toNumber(shotsOnTarget),
                shotsPer90: toNumber(shotsPer90),
                shotsOnTargetPer90: toNumber(shotsOnTargetPer90),
                avgShotDistance: toNumber(avgShotDistance)
            };
        })
        .filter(Boolean);
}

function buildPlayersPassingIndex() {
    playersPassingIndex = new Map(
        playersPassingData.map((p) => [normalizePlayerKey(p.name), p])
    );

    playersData = playersData.map((player) => {
        const passing = playersPassingIndex.get(normalizePlayerKey(player.name)) || {};
        const toNullableNumber = (val) => (Number.isFinite(val) ? val : null);

        return {
            ...player,
            passCompleted: toNullableNumber(passing.passesCompleted),
            passAttempted: toNullableNumber(passing.passesAttempted),
            passPct: toNullableNumber(passing.passPct),
            shotsTotal: toNullableNumber(passing.shotsTotal),
            shotsOnTarget: toNullableNumber(passing.shotsOnTarget),
            shotsPer90: toNullableNumber(passing.shotsPer90),
            shotsOnTargetPer90: toNullableNumber(passing.shotsOnTargetPer90),
            avgShotDistance: toNullableNumber(passing.avgShotDistance),
        };
    });
}

// Sovrascriviamo playersData con lâ€™array parsato
playersData = parsePlayersDB(playersRawData);
playersPassingData = parsePlayersPassing(playersPassingRawData);
buildPlayersPassingIndex();
initPlayersFilters();
populatePlayersComparisonOptions();
renderPlayerComparisonTable();
updatePlayerScatterRoleUI();
function extractSurname(fullName) {
    const parts = (fullName || '').trim().split(/\s+/);
    return parts.length ? parts[parts.length - 1].toLowerCase() : '';
}

function updatePlayersMinMatches(val) {
    const parsed = parseFloat(val);
    playersMinMatches = Number.isFinite(parsed) ? parsed : 0;

    const label = document.getElementById('playersMinMatchesValue');
    if (label) label.innerText = playersMinMatches;

    renderPlayersTable();
}

function updatePresenceThresholdButton() {
    const btn = document.getElementById('players-presence-threshold');
    if (!btn) return;

    const threshold = playersMaxMatches ? playersMaxMatches * 0.3 : 0;
    const thresholdLabel = threshold ? threshold.toFixed(1).replace('.', ',') : '0';

    btn.textContent = excludeLowPresencePlayers
        ? `Esclusi i giocatori sotto ${thresholdLabel} presenze (30%)`
        : 'Escludi chi Ã¨ sotto il 30% delle presenze';

    btn.classList.toggle('border-yellow-500', excludeLowPresencePlayers);
    btn.classList.toggle('text-yellow-400', excludeLowPresencePlayers);
    btn.classList.toggle('bg-yellow-500/10', excludeLowPresencePlayers);
}

function toggleLowPresenceExclusion() {
    excludeLowPresencePlayers = !excludeLowPresencePlayers;
    updatePresenceThresholdButton();
    renderPlayersTable();
}

function initPlayersFilters() {
    const slider = document.getElementById('playersMinMatches');
    const label = document.getElementById('playersMinMatchesValue');
    const teamOptionsContainer = document.getElementById('players-team-options');

    if (slider) {
        playersMaxMatches = playersData.length ? Math.max(...playersData.map(p => p.n90)) : 0;
        slider.max = Math.max(10, Math.ceil(playersMaxMatches));
        slider.value = playersMinMatches;
    }

    if (label) label.innerText = playersMinMatches;

    updatePresenceThresholdButton();

    playerTeams = Array.from(new Set(playersData
        .map(p => (p.team || '').trim())
        .filter(Boolean)))
        .sort((a, b) => a.localeCompare(b, 'it', { sensitivity: 'base' }));

    if (teamOptionsContainer) renderPlayersTeamOptions();

    syncPlayerRoleCheckboxes();

    updatePlayersModeToggleUI();
}

function syncPlayerRoleCheckboxes() {
    PLAYER_ROLES.forEach(role => {
        const cb = document.getElementById(`role-filter-${role.toLowerCase()}`);
        if (cb) cb.checked = selectedPlayerRoles.has(role);
    });
}

function renderPlayersTeamOptions() {
    const container = document.getElementById('players-team-options');
    if (!container) return;

    const teams = ['all', ...playerTeams];
    const optionHtml = teams.map((team) => {
        const value = team === 'all' ? 'all' : team.toLowerCase();
        const isChecked = selectedTeams.has('all') ? team === 'all' : selectedTeams.has(value);
        const label = team === 'all' ? 'Tutte le squadre' : team;

        return `
            <label class="flex items-center gap-2 px-3 py-2 text-sm text-slate-200 hover:bg-slate-800 cursor-pointer">
                <input type="checkbox" class="rounded border-slate-700 bg-slate-900 text-yellow-400 focus:ring-yellow-400" value="${value}" ${isChecked ? 'checked' : ''} onchange="handlePlayersTeamCheckbox(this)">
                <span>${label}</span>
            </label>
        `;
    }).join('');

    container.innerHTML = optionHtml;
    updatePlayersTeamTriggerLabel();
}

function updatePlayersTeamTriggerLabel() {
    const triggerLabel = document.getElementById('players-team-trigger-label');
    if (!triggerLabel) return;

    if (selectedTeams.has('all') || selectedTeams.size === 0) {
        triggerLabel.textContent = 'Tutte le squadre';
        return;
    }

    const selectedLabels = playerTeams
        .filter(team => selectedTeams.has(team.toLowerCase()))
        .slice(0, 3);

    const moreCount = selectedTeams.size - selectedLabels.length;
    const baseLabel = selectedLabels.join(', ');
    triggerLabel.textContent = moreCount > 0
        ? `${baseLabel} +${moreCount}`
        : baseLabel || 'Tutte le squadre';
}

function handlePlayersTeamCheckbox(checkbox) {
    if (!checkbox) return;
    const value = (checkbox.value || '').toLowerCase();

    if (value === 'all') {
        selectedTeams = checkbox.checked ? new Set(['all']) : new Set();
    } else {
        if (checkbox.checked) {
            selectedTeams.delete('all');
            selectedTeams.add(value);
        } else {
            selectedTeams.delete(value);
        }

        if (selectedTeams.size === 0) selectedTeams.add('all');
    }

    syncPlayersTeamCheckboxes();
    updatePlayersTeamTriggerLabel();
    renderPlayersTable();
}

function syncPlayersTeamCheckboxes() {
    document.querySelectorAll('#players-team-options input[type="checkbox"]').forEach((input) => {
        const val = (input.value || '').toLowerCase();
        input.checked = selectedTeams.has('all') ? val === 'all' : selectedTeams.has(val);
    });
}

function togglePlayersTeamDropdown(forceState) {
    const dropdown = document.getElementById('players-team-dropdown');
    if (!dropdown) return;

    const shouldOpen = typeof forceState === 'boolean'
        ? forceState
        : dropdown.classList.contains('hidden');

    dropdown.classList.toggle('hidden', !shouldOpen);
}

function closePlayersTeamDropdown() {
    togglePlayersTeamDropdown(false);
}

document.addEventListener('click', (event) => {
    const container = document.getElementById('players-team-filter-container');
    if (!container) return;
    if (!container.contains(event.target)) closePlayersTeamDropdown();
});

function selectAllPlayerRoles() {
    selectedPlayerRoles = new Set(PLAYER_ROLES);
    syncPlayerRoleCheckboxes();
    renderPlayersTable();
}

function togglePlayerRole(role) {
    if (!PLAYER_ROLES.includes(role)) return;

    if (selectedPlayerRoles.has(role)) selectedPlayerRoles.delete(role);
    else selectedPlayerRoles.add(role);

    syncPlayerRoleCheckboxes();
    renderPlayersTable();
}
function splitPlayerName(fullName) {
    const parts = (fullName || '')
        .trim()
        .split(/\s+/)
        .filter(Boolean);

    if (!parts.length) return { surname: 'Nome non disponibile', given: '' };

    const surnamePrefixes = new Set([
        'de', 'del', 'della', 'dello', 'dei', 'degli', 'delle',
        'di', 'da', 'dal', 'dalla', 'dall', 'dallo',
        'van', 'von', 'der', 'den',
        'dos', 'das', 'do', 'du',
        'le', 'la', 'lo',
        'mc', 'mac',
        "d'", "l'", "del'",
        'san', 'santa', 'st', 'saint'
    ]);

    let idx = parts.length - 1;
    const surnameParts = [parts[idx]];
    idx--;

    while (idx >= 0) {
        const lower = parts[idx].toLowerCase();
        if (surnamePrefixes.has(lower) || lower.endsWith("'")) {
            surnameParts.unshift(parts[idx]);
            idx--;
        } else {
            break;
        }
    }

    return {
        surname: surnameParts.join(' '),
        given: parts.slice(0, idx + 1).join(' '),
    };
}

function formatPlayerName(fullName) {
    const { surname, given } = splitPlayerName(fullName);
    if (!surname || surname === 'Nome non disponibile') return 'Nome non disponibile';
    return given ? `${surname} ${given}` : surname;
}

function formatPlayerSurname(fullName) {
    return splitPlayerName(fullName).surname;
}

function formatPassingValue(val, digits = 2) {
    if (!Number.isFinite(val)) return '-';
    return val.toFixed(digits).replace('.', ',');
}

function renderPlayersPassingTable() {
    const tbody = document.getElementById('players-passing-body');
    if (!tbody) return;

    tbody.innerHTML = '';

    playersPassingData.forEach((p, index) => {
        const passPct = Number.isFinite(p.passPct)
            ? `${p.passPct.toFixed(1).replace('.', ',')}%`
            : '-';

        const row = `
            <tr>
                <td class="p-2 font-mono text-xs text-slate-400">${index + 1}</td>
                <td class="p-2 text-left">${formatPlayerName(p.name)}</td>
                <td class="p-2">${formatPassingValue(p.passesCompleted)}</td>
                <td class="p-2">${formatPassingValue(p.passesAttempted)}</td>
                <td class="p-2">${passPct}</td>
                <td class="p-2">${formatPassingValue(p.shotsTotal)}</td>
                <td class="p-2">${formatPassingValue(p.shotsOnTarget)}</td>
                <td class="p-2">${formatPassingValue(p.shotsPer90)}</td>
                <td class="p-2">${formatPassingValue(p.shotsOnTargetPer90)}</td>
                <td class="p-2">${formatPassingValue(p.avgShotDistance)}</td>
            </tr>`;

        tbody.insertAdjacentHTML('beforeend', row);
    });
}

        function toggleInactiveRefs() {
            hideInactive = document.getElementById('toggleInactive').checked;
            aggregateData();
        }
        
        function handleSearch() { debounceAggregate(); }
        function renderStatsInsights(data) {}
        function renderMatchesInsights(data) {}
        function toggleDesignationsModal(shouldOpen) {
            const modal = document.getElementById('designations-modal');
            if (shouldOpen) modal.classList.add('open');
            else modal.classList.remove('open');
        }
        function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }

        window.addEventListener('scroll', () => {
            const btn = document.getElementById('scroll-to-top');
            if (window.scrollY > 300) btn.setAttribute('data-visible', 'true');
            else btn.setAttribute('data-visible', 'false');
        });

        function toggleFeedbackPanel(forceState) {
            const panel = document.getElementById('feedback-panel');
            const overlay = document.getElementById('feedback-overlay');
            const emailInput = document.getElementById('feedback-email');
            const shouldOpen = typeof forceState === 'boolean'
                ? forceState
                : panel?.dataset.open !== 'true';

            if (panel) panel.dataset.open = shouldOpen;
            if (overlay) overlay.dataset.open = shouldOpen;

            if (shouldOpen) {
                if (emailInput && !emailInput.value) emailInput.focus({ preventScroll: true });
                else {
                    const textarea = document.getElementById('feedback-text');
                    if (textarea) textarea.focus({ preventScroll: true });
                }
            }
        }

        async function sendFeedback() {
            const textarea = document.getElementById('feedback-text');
            const status = document.getElementById('feedback-status');
            const sendBtn = document.getElementById('feedback-send-btn');
            const emailInput = document.getElementById('feedback-email');
            const userMessage = (textarea?.value || '').trim();
            const userEmail = (emailInput?.value || '').trim();

            if (!textarea || !status || !sendBtn || !emailInput) return;

            const isValidEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(userEmail);

            if (!userEmail || !isValidEmail) {
                status.textContent = 'Inserisci un indirizzo email valido per poterti rispondere.';
                status.classList.remove('text-green-400');
                status.classList.add('text-rose-400');
                emailInput.focus({ preventScroll: true });
                return;
            }

            if (!userMessage) {
                status.textContent = 'Inserisci un messaggio prima di inviare.';
                status.classList.remove('text-green-400');
                status.classList.add('text-rose-400');
                textarea.focus({ preventScroll: true });
                return;
            }

            status.textContent = 'Invio in corso...';
            status.classList.remove('text-rose-400');
            status.classList.add('text-slate-400');
            sendBtn.disabled = true;
            sendBtn.classList.add('opacity-80', 'cursor-not-allowed');

            try {
                const response = await fetch('https://formsubmit.co/ajax/ref-lab@referee-lab.com', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                    body: JSON.stringify({
                        name: 'RefereeLab Feedback',
                        email: userEmail,
                        message: `${userMessage}\n\n---\nRispondi a: ${userEmail}`
                    })
                });

                if (!response.ok) throw new Error('Invio non riuscito');

                status.textContent = 'Messaggio inviato con successo! Ti risponderemo presto.';
                status.classList.remove('text-slate-400');
                status.classList.add('text-green-400');
                textarea.value = '';
                emailInput.value = '';
                toggleFeedbackPanel(false);
            } catch (error) {
                status.textContent = 'Si Ã¨ verificato un problema durante l\'invio. Riprova tra qualche secondo.';
                status.classList.remove('text-slate-400');
                status.classList.add('text-rose-400');
            } finally {
                sendBtn.disabled = false;
                sendBtn.classList.remove('opacity-80', 'cursor-not-allowed');
            }
        }

        function attachRippleEffect(nodes) {
            nodes.forEach((node) => {
                if (!node) return;

                node.classList.add('interactive-surface');

                node.addEventListener('click', (event) => {
                    const rect = node.getBoundingClientRect();
                    const ripple = document.createElement('span');
                    const size = Math.max(rect.width, rect.height);

                    ripple.className = 'ripple';
                    ripple.style.width = ripple.style.height = `${size}px`;
                    ripple.style.left = `${event.clientX - rect.left - size / 2}px`;
                    ripple.style.top = `${event.clientY - rect.top - size / 2}px`;

                    node.appendChild(ripple);
                    node.classList.remove('click-energize');
                    void node.offsetWidth;
                    node.classList.add('click-energize');
                    setTimeout(() => node.classList.remove('click-energize'), 400);
                    ripple.addEventListener('animationend', () => ripple.remove());
                });
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const interactiveTargets = document.querySelectorAll('button, .nav-pill, .season-item, .analytics-season-chip, .analytics-subtab-btn');
            attachRippleEffect(Array.from(interactiveTargets));

            const refreshQuizBtn = document.getElementById('quiz-refresh');
            if (refreshQuizBtn) refreshQuizBtn.addEventListener('click', prepareQuizRound);
            prepareQuizRound();
        });

// --- EVENTO CAMBIO METRICA HEATMAP ---
document.addEventListener('DOMContentLoaded', () => {
    const metricSelect = document.getElementById('heatmap-metric');
    if (!metricSelect) return;

    // valore iniziale
    currentHeatmapMetric = metricSelect.value || 'eff';

    metricSelect.addEventListener('change', () => {
        currentHeatmapMetric = metricSelect.value || 'eff';
        renderTeamHeatmap();
    });
});

// --- EVENTO CAMBIO STAGIONE HEATMAP ---
document.addEventListener('DOMContentLoaded', () => {
    const seasonSelect = document.getElementById('heatmap-season');
    if (!seasonSelect) return;

    currentHeatmapSeason = seasonSelect.value || '2024-25';

    seasonSelect.addEventListener('change', () => {
        currentHeatmapSeason = seasonSelect.value || '2024-25';
        heatmapPinnedCell = null;
        renderTeamHeatmap();
    });
});

        window.addEventListener('popstate', (event) => {
            const viewFromState = event.state?.view;
            const fallbackView = getViewFromLocation();
            const view = viewFromState && VIEW_ROUTE_MAP[viewFromState] ? viewFromState : fallbackView;

            switchView(view, { updateHistory: false });
        });



        window.onload = function() {
            updateSeasonButtonsUI();
            refreshAllAnalyticsSeasonChips();
            const initialView = getViewFromLocation();
            switchView(initialView, { replaceHistory: true });
updateRadarSelectOptions();
            if (window.innerWidth < 1024) document.getElementById('season-dropdown-content').classList.add('hidden');
        };
    </script>
</body>
</html>




