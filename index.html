<!DOCTYPE html>
<html lang="it" class="dark">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYY47HJGR6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-PYY47HJGR6');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RefereeLab - Analytics Pro</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        slate: { 850: '#151e2e', 900: '#0f172a', 950: '#020617' },
                        brand: { gold: '#EAB308', dark: '#0B1120' }
                    },
                    boxShadow: {
                        'card': '0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px -1px rgba(0, 0, 0, 0.2)',
                        'glow': '0 0 15px rgba(234, 179, 8, 0.15)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.4s ease-out forwards',
                        'flash': 'flash 1s infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(5px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        flash: {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.3' },
                        }
                    }
                }
            }
        }


    </script>

    <style>
        /* Base Reset & Typography */
html, body { 
    overflow-x: clip; /* 'clip' Ã¨ meglio di 'hidden' per sticky */
    background-color: #020617; 
    color: #cbd5e1; 
}        
        /* Background Texture */
        body::before {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(15, 23, 42, 0.95), rgba(2, 6, 23, 0.98)),
                url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23334155' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            z-index: -1; pointer-events: none;
        }

        /* Pro UI Cards */
        .pro-card {
            background-color: #0f172a;
            border: 1px solid #1e293b;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }
        
        .pro-header {
            background-color: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid #1e293b;
        }

/* Sidebar sticky SEMPRE (su desktop) */
@media (min-width: 1024px) {
    #sidebar-filters {
        position: sticky;
        top: 6rem;          /* distanza dal top (regola in base all'altezza della navbar) */
        align-self: flex-start; /* Fondamentale: impedisce alla sidebar di allungarsi */
        z-index: 30;        /* Assicura che stia sopra al contenuto ma sotto ai modali */
        max-height: calc(100vh - 7rem); /* Opzionale: se la sidebar Ã¨ molto lunga, permette lo scroll interno */
        overflow-y: auto;   /* Opzionale: abilita lo scroll se il contenuto Ã¨ troppo lungo */
    }
}
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; border: 2px solid #020617; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Navigation Pills (Restored Style) */
        .nav-pills-container {
            display: flex;
            align-items: center;
            padding: 4px;
            border-radius: 9999px;
            border: 1px solid rgba(234, 179, 8, 0.5); /* Yellow border */
            background-color: rgba(15, 23, 42, 0.5);
        }
        
        .nav-pill {
            padding: 6px 16px;
            border-radius: 9999px;
            font-size: 0.75rem; /* text-xs */
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #94a3b8;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

/* Stile per i loghi nel grafico Radar */
.chart-team-logo {
    position: absolute;
    width: 24px;   /* Dimensione logo */
    height: 24px;
    object-fit: contain;
    transform: translate(-50%, -50%); /* Centra l'immagine sul punto esatto */
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5)); /* Ombra per staccare dal fondo */
    z-index: 10;
    transition: all 0.3s ease;
    pointer-events: none; /* Lascia passare il click al grafico sotto */
}

/* Container relativo per permettere il posizionamento assoluto dei loghi */
#chart-top-flop {
    position: relative; 
}
        
        .nav-pill:hover { color: #fff; }
        
        .nav-pill.active {
            background-color: #EAB308;
            color: #020617;
            box-shadow: 0 0 10px rgba(234, 179, 8, 0.3);
        }

        /* Season Selector */
        .season-item {
            border-left: 2px solid transparent;
            transition: all 0.2s;
        }
        .season-item:hover { background-color: #1e293b; color: white; }
        .season-item.active {
            background-color: #1e293b;
            border-left-color: #EAB308;
            color: #EAB308;
        }
        
        /* CORREZIONE 2: Stile per la scritta "SOON" */
        .coming-soon-label {
            /* Meno oscurata: uso text-slate-400 anzichÃ© text-slate-600 */
            color: #94a3b8 !important; 
            /* Rimuovo la classe hidden per gestirne la visibilitÃ  solo tramite JS/opacitÃ  */
        }
        
        .season-item[title]:hover span.coming-soon-label {
            opacity: 1; /* Assicura che la label non si oscuri sull'hover */
        }

        /* Toggle stagioni per i grafici (scheda Grafici) */
        .analytics-season-chip {
            background-color: rgba(15, 23, 42, 0.7);
            border: 1px solid #1e293b;
            color: #cbd5e1;
            font-size: 0.7rem;
            font-weight: 600;
            padding: 6px 10px;
            border-radius: 9999px;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .analytics-season-chip.active {
            background-color: rgba(234, 179, 8, 0.15);
            border-color: rgba(234, 179, 8, 0.6);
            color: #fefce8;
            box-shadow: 0 0 0 1px rgba(234, 179, 8, 0.2);
        }

        .analytics-season-chip:focus-visible {
            outline: 2px solid #eab308;
            outline-offset: 2px;
        }

.pro-table th {
    background-color: #111827;
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: 600;
    padding: 6px 8px; 
    border-bottom: 1px solid #1e293b;
    white-space: nowrap;
}
.pro-table td {
    padding: 6px 8px;
    border-bottom: 1px solid #1e293b;
    font-size: 0.85rem;
}        .pro-table tr:last-child td { border-bottom: none; }
        /* Table Styling */
        .pro-table tr:hover td { background-color: #1e293b; }

.players-table th,
.players-table td {
    text-align: center;
}

.players-table td:first-child,
.players-table th:first-child {
    min-width: 3rem;
    width: 3rem;
}

.players-table td:nth-child(2),
.players-table th:nth-child(2) {
    min-width: 11rem;
}

.players-table td:nth-child(2),
.players-table th:nth-child(2) {
    text-align: left;
}

.players-table th {
    font-size: 0.65rem;
}

.players-table td {
    font-size: 0.8rem;
}

        /* Players table separators */
#players-table tbody tr:not(:last-child) td {
    border-bottom: 1px solid rgba(148, 163, 184, 0.35);
}
        
        .sticky-head { position: sticky; top: 0; z-index: 20; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .sticky-col { position: sticky; left: 0; z-index: 10; background-color: #0f172a; border-right: 1px solid #1e293b; }
        .pro-table tr:hover .sticky-col { background-color: #1e293b; }

        /* Footer Special Style */
        #tableFooter tr td {
            border-top: 2px solid #EAB308;
            background-color: #1e293b; /* Slate 800 */
            color: #fff;
            font-weight: 800; /* Extra bold */
        }
        #tableFooter tr .sticky-col {
            background-color: #1e293b;
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        /* Average Row Style */
        .avg-row td {
            background-color: #1e293b;
            border-top: 2px solid #64748b;
            font-weight: 700;
            color: #e2e8f0;
        }
        .avg-row .sticky-col {
            background-color: #1e293b;
        }

        /* Range Input */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb { 
            -webkit-appearance: none; height: 14px; width: 14px; 
            border-radius: 50%; background: #EAB308; cursor: pointer; margin-top: -5px; 
            box-shadow: 0 0 0 2px #0f172a;
        }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px; }

        /* Mobile Modal Transition */
        #designations-modal { transition: opacity 0.3s ease, visibility 0.3s; opacity: 0; visibility: hidden; }
        #designations-modal.open { opacity: 1; visibility: visible; }
        .modal-content { transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        #designations-modal.open .modal-content { transform: translateX(0); }

        /* Custom Dropdown for Charts */
        .chart-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2394a3b8' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-appearance: none;
            appearance: none;
        }
        
        /* Badge New */
        .badge-new {
            font-size: 0.6rem;
            padding: 2px 6px;
            border-radius: 4px;
            background-color: #ef4444;
            color: white;
            font-weight: 800;
            margin-left: 6px;
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.4);
            animation: pulse-slow 3s infinite;
        }


.quadrant-mini {
    width: 28px;
    height: 28px;
    border: 1px solid #475569; /* slate-600 */
    position: relative;
    border-radius: 4px;
    background: #0f172a; /* stessa card */
}

.quadrant-mini::before, 
.quadrant-mini::after {
    content: "";
    position: absolute;
    background: #475569;
}

.quadrant-mini::before {
    width: 1px;
    height: 100%;
    left: 50%;
    top: 0;
}

.quadrant-mini::after {
    height: 1px;
    width: 100%;
    left: 0;
    top: 50%;
}

.quadrant-dot {
    width: 6px;
    height: 6px;
    background: #eab308; /* default: yellow */
    border-radius: 50%;
    position: absolute;
}

.quadrant-fill {
    position: absolute;
    opacity: 0.35; /* come nei quadranti grandi */
}


        /* Legend Item */
        .legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.7rem; color: #94a3b8; }
        .legend-color { width: 10px; height: 10px; border-radius: 2px; }

        /* Comparison Chips */
        .ref-chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 9999px;
            background-color: rgba(234, 179, 8, 0.1);
            border: 1px solid rgba(234, 179, 8, 0.3);
            color: #EAB308;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .ref-chip button {
            color: #EAB308;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        .ref-chip button:hover { opacity: 1; }

        /* Mobile Optimizations */
        @media (max-width: 640px) {
.pro-table th, .pro-table td {
    padding: 6px 8px; /* <--- MODIFICATO: da 10px a 6px */
    font-size: 0.75rem; 
}            .pro-table th {
                font-size: 0.65rem;
            }
            .pro-card {
                padding: 12px; /* Less padding in cards */
            }
            main {
                padding-left: 1rem;
                padding-right: 1rem;
            }
        }
        
        /* Utilities */
        .text-xxs { font-size: 0.65rem; line-height: 1rem; }
        
        /* Tooltip Container */
        .tooltip { position: relative; display: inline-block; cursor: help; }
        /* Modifica Tooltip Teams: Posizione piÃ¹ bassa e z-index piÃ¹ alto */
        .tooltip .tooltiptext, .tooltip:focus .tooltiptext, .tooltip:active .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #0f172a;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 200; /* Aumentato per evitare sovrapposizione con l'header sticky */
            bottom: 110%; /* Abbassato da 125% per evitare sovrapposizione */
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid #334155;
            font-size: 0.7rem;
            font-weight: normal;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            text-transform: none;
            line-height: 1.4;
            pointer-events: none;
        }
        .tooltip:hover .tooltiptext, .tooltip:focus .tooltiptext, .tooltip:active .tooltiptext { visibility: visible; opacity: 1; pointer-events: auto; }
        
        /* Contenitore per i quadranti DIV (Nuova Soluzione) */
.overlay-quadranti {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 5 !important; /* Sopra la plot area ma sotto i marker */
}

.overlay-quadranti .quadrant {
    position: absolute;
    opacity: 0.22; /* PiÃ¹ visibile */
}        
        .quadrant {
            position: absolute;
            width: 50%;
            height: 50%;
            opacity: 0.18;
            /* I colori sono iniettati via JS */
        }

/* Testo leggibile e bianco per i range della color scale */
.apexcharts-legend-text {
    fill: #ffffff !important;         /* testo SVG */
    color: #ffffff !important;        /* testo HTML fallback */
    opacity: 0.8 !important;            /* ðŸ”¥ niente trasparenza */
}

/* Quadratini legenda con opacitÃ  piena */
.apexcharts-legend-marker {
    opacity: 1 !important;
}

/* Alcune versioni usano <span> dentro il gruppo legenda */
.apexcharts-legend-text span {
    color: #ffffff !important;
    opacity: 1 !important;
}

/* Rende bianchi anche i numeri eventuali dei valori colorScale */
.apexcharts-legend-series {
    opacity: 0.8 !important;
}


<style>
/* Mobile: heatmap scrollabile orizzontalmente */
.heatmap-wrapper {
    overflow-x: auto;
    overflow-y: hidden;
    padding-bottom: 8px;
}

/* Rimuove compressione forzata */
.heatmap-wrapper > div {
    min-width: 600px; /* <= regolabile: 38 colonne * ~24px */
}

/* Mantiene leggibili le squadre */
@media (max-width: 768px) {
    .heatmap-wrapper {
        margin-left: -10px;
        margin-right: -10px;
        padding-left: 10px;
    }
}
</style>


<style>
/* blocca le squadre sulla sinistra */
.apexcharts-yaxis text {
    position: sticky;
    left: 0;
    background: #0f172a; /* colore sfondo tuo */
    padding-right: 6px;
    z-index: 10;
}
</style>

<style>

/* SCROLL ORIZZONTALE MOBILE */
.heatmap-wrapper {
    overflow-x: auto;
    overflow-y: hidden;
    width: 100%;
    -webkit-overflow-scrolling: touch;
}

/* forza larghezza del grafico */
#chart-team-heatmap {
    min-width: 700px;  /* = stessa larghezza settata in ApexCharts */
}

/* Mantiene leggibili le squadre (fisso a sinistra) */
.apexcharts-yaxis text {
    position: sticky;
    left: 0;
    background: #0f172a;
    padding-right: 6px;
    z-index: 10;
}

</style>


</head>
<body class="flex flex-col min-h-screen">

    <!-- Scroll To Top -->
    <button id="scroll-to-top" onclick="scrollToTop()" class="fixed bottom-6 right-6 z-50 w-10 h-10 rounded bg-slate-800 text-yellow-500 shadow-lg flex items-center justify-center hover:bg-slate-700 transition-all border border-slate-700 opacity-0 pointer-events-none data-[visible=true]:opacity-100 data-[visible=true]:pointer-events-auto">
        <i class="fa-solid fa-arrow-up"></i>
    </button>

    <!-- Designations Trigger (Mobile Floating) -->
    <button onclick="toggleDesignationsModal(true)" class="lg:hidden fixed bottom-4 left-4 z-50 w-12 h-12 rounded-full bg-slate-800 border border-slate-700 text-yellow-500 flex items-center justify-center shadow-lg active:scale-95">
        <i class="fa-regular fa-calendar-check text-base"></i>
    </button>

    <!-- Designations Modal (Mobile) -->
    <div id="designations-modal" class="fixed inset-0 z-[60] bg-black/60 backdrop-blur-sm lg:hidden">
        <div class="modal-content absolute top-0 right-0 w-[85%] max-w-sm h-full bg-[#0f172a] shadow-2xl border-l border-slate-800 flex flex-col">
            <div class="h-16 flex items-center justify-between px-5 border-b border-slate-800 bg-[#0b1120]">
                <h2 class="text-white font-bold tracking-tight flex items-center gap-2">
                    <i class="fa-regular fa-calendar-check text-yellow-500"></i> Designazioni
                </h2>
                <button onclick="toggleDesignationsModal(false)" class="w-8 h-8 flex items-center justify-center rounded-full bg-slate-800 text-slate-400 hover:text-white">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="flex-grow overflow-y-auto p-5 space-y-4">
                 <!-- Mobile Designations Content -->
                 <div class="pro-card rounded-lg p-4 border-l-4 border-yellow-500">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <span class="block text-xs font-bold text-slate-400 uppercase tracking-wider">Giornata in corso</span>
                            <span class="text-lg font-bold text-white">13Âª Giornata</span>
                        </div>
                        <span class="bg-red-500/10 text-red-500 text-[10px] px-2 py-0.5 rounded border border-red-500/20 font-bold uppercase animate-flash">Live</span>
                    </div>
                    
                    <div class="space-y-3">
                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>COMO - SASSUOLO</span>
                                <span class="text-slate-500">VEN 20:45</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">MARCHETTI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">GHERSINI</span>
                            </div>
                        </div>
                        
                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>GENOA - VERONA</span>
                                <span class="text-slate-500">SAB 15:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">FABBRI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">MAZZOLENI</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>PARMA - UDINESE</span>
                                <span class="text-slate-500">SAB 15:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">PICCININI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">PRONTERA</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>JUVENTUS - CAGLIARI</span>
                                <span class="text-slate-500">SAB 18:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">CREZZINI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">DI BELLO</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>MILAN - LAZIO</span>
                                <span class="text-slate-500">SAB 20:45</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">COLLU</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">DI PAOLO</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>LECCE - TORINO</span>
                                <span class="text-slate-500">DOM 12:30</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">MARIANI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">MARINI</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>PISA - INTER</span>
                                <span class="text-slate-500">DOM 15:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">GUIDA</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">PATERNA</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>ATALANTA - FIORENTINA</span>
                                <span class="text-slate-500">DOM 18:00</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">MARCENARO</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">CAMPLONE</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>ROMA - NAPOLI</span>
                                <span class="text-slate-500">DOM 20:45</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">MASSA</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">AURELIANO</span>
                            </div>
                        </div>

                        <div class="bg-slate-800/50 rounded p-3 border border-slate-700/50">
                            <div class="flex justify-between text-xs font-bold text-slate-200 mb-2 pb-2 border-b border-slate-700/50">
                                <span>BOLOGNA - CREMONESE</span>
                                <span class="text-slate-500">LUN 20:45</span>
                            </div>
                            <div class="flex justify-between items-center text-xs mb-1">
                                <span class="text-slate-500 uppercase w-8">Arb</span>
                                <span class="text-green-400 font-mono font-bold">FELICIANI</span>
                            </div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="text-slate-500 uppercase w-8">Var</span>
                                <span class="text-slate-300 font-mono">GARIGLIO</span>
                            </div>
                        </div>


                    </div>
                 </div>
            </div>
        </div>
    </div>

    <!-- Navbar Pro (FIXED) -->
    <nav class="pro-header fixed top-0 w-full z-50">
        <div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <!-- Logo & Brand -->
                <div class="flex items-center gap-2 cursor-pointer mr-2" onclick="window.location.reload()">
<div class="w-3 h-10 sm:w-9 sm:h-9 rounded bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center text-slate-900 shadow-glow">
    <i class="fa-solid fa-whistle text-base sm:text-lg rotate-[-15deg]"></i>
</div>
                    <div class="flex flex-col justify-center">
                        <span class="font-bold text-lg leading-none tracking-tight text-white">Referee<span class="text-yellow-500">Lab</span></span>
                        <span class="text-[10px] uppercase tracking-[0.25em] text-slate-500 font-semibold">Analytics Pro</span>
                    </div>
                </div>

                <!-- Desktop Nav Tabs -->
                <div class="hidden md:flex items-center h-full">
                    <div class="nav-pills-container">
                        <button onclick="switchView('stats')" id="nav-stats" class="nav-pill active">
                            <i class="fa-solid fa-chart-bar mr-2"></i>Statistiche
                        </button>
                        <button onclick="switchView('playingTime')" id="nav-time" class="nav-pill">
                            <i class="fa-solid fa-stopwatch mr-2"></i>Tempo Effettivo
                        </button>
                        <button onclick="switchView('matches')" id="nav-matches" class="nav-pill">
                            <i class="fa-solid fa-list mr-2"></i>Database
                        </button>
                        <button onclick="switchView('teams')" id="nav-teams" class="nav-pill">
                            <i class="fa-solid fa-shield-halved mr-2"></i>Squadre
                        </button>
                        <!-- GRAFICI moved to end with BADGE -->
                        <button onclick="switchView('analytics')" id="nav-analytics" class="nav-pill flex items-center">
                            <i class="fa-solid fa-chart-pie mr-2"></i>Grafici <span class="badge-new">NEW</span>
                        </button>
			<button onclick="switchView('players')" id="nav-players" class="nav-pill">
    			    <i class="fa-solid fa-user mr-2"></i>Giocatori 25/26
			</button>

                    </div>
                </div>

                <!-- Mobile & Actions -->
                <div class="flex items-center gap-3">
                    <!-- Mobile View Switcher -->
                    <div class="md:hidden flex bg-slate-800 rounded-lg p-1 border border-slate-700">
                        <button onclick="switchView('stats')" id="mob-nav-stats" class="p-2 rounded text-yellow-500 bg-slate-700"><i class="fa-solid fa-chart-bar"></i></button>
                        <button onclick="switchView('playingTime')" id="mob-nav-time" class="p-2 rounded text-slate-400"><i class="fa-solid fa-stopwatch"></i></button>
                        <button onclick="switchView('matches')" id="mob-nav-matches" class="p-2 rounded text-slate-400"><i class="fa-solid fa-list"></i></button>
                        <button onclick="switchView('teams')" id="mob-nav-teams" class="p-2 rounded text-slate-400"><i class="fa-solid fa-shield-halved"></i></button>
                        <button onclick="switchView('analytics')" id="mob-nav-analytics" class="p-2 rounded text-slate-400 relative">
                            <i class="fa-solid fa-chart-pie"></i>
                            <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                        </button>
                        <button onclick="switchView('players')" id="mob-nav-players" class="p-2 rounded text-slate-400">
                            <i class="fa-solid fa-user"></i>
                        </button>

                    </div>

                    <div class="h-6 w-px bg-slate-800 hidden md:block"></div>
                    
                    <!-- Instagram Button -->
                    <a href="https://instagram.com/reflab25" target="_blank" class="hidden md:flex text-slate-400 hover:text-pink-500 transition-colors transform hover:scale-110 duration-200">
                        <i class="fa-brands fa-instagram text-xl"></i>

                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Wrapper -->
    <main class="flex-grow w-full max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-8">
        
        <!-- Page Header / Breadcrumb -->
        <div class="flex flex-col sm:flex-row sm:items-end justify-between gap-4 mb-2">
            <div>
                <nav class="flex text-xs text-slate-500 mb-1">
                    <span>Dashboard</span>
                    <span class="mx-2">/</span>
                    <span class="text-slate-300 font-medium" id="breadcrumb-current">Overview</span>
                </nav>
                <h1 class="text-xl sm:text-3xl font-bold text-white tracking-tight hidden" id="page-title"></h1>
            </div>
            <div class="flex items-center gap-3 text-xs text-slate-400 bg-slate-900/50 px-3 py-1.5 rounded border border-slate-800">
                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                Database aggiornato: <span class="text-white font-mono">12Âª Giornata</span>
            </div>
        </div>

<div id="layout-grid" class="grid grid-cols-1 lg:grid-cols-12 gap-8">

    <aside id="sidebar-filters" class="lg:col-span-3 space-y-6 lg:self-start">
        <div id="global-search-container" class="pro-card rounded-lg p-1">
            <div class="relative">
                <i class="fa-solid fa-magnifying-glass absolute left-3 top-3 text-slate-500 text-sm"></i>
                <input type="text" id="searchInput" oninput="debounceAggregate()" placeholder="Cerca arbitro..." class="w-full bg-slate-900 text-sm text-white pl-10 pr-4 py-2.5 rounded border border-transparent focus:border-yellow-500 focus:ring-0 outline-none transition-colors placeholder-slate-600">
            </div>
        </div>

        <div id="season-selector-card" class="pro-card rounded-lg overflow-hidden">
            <div class="p-3 bg-slate-800/50 border-b border-slate-800 flex justify-between items-center">
                <h3 class="text-xs font-bold uppercase tracking-wider text-slate-400">Stagione</h3>
                <button onclick="toggleAllSeasons()" class="text-xs text-yellow-500 hover:text-yellow-400 font-medium">Reset</button>
            </div>
            
            <button onclick="toggleSeasonDropdown()" class="w-full lg:hidden flex justify-between items-center p-3 text-sm text-slate-300 hover:bg-slate-800 border-b border-slate-800">
                <span>Seleziona Stagioni</span>
                <i id="season-toggle-icon" class="fa-solid fa-chevron-down text-xs transition-transform"></i>
            </button>

            <div id="season-dropdown-content" class="season-dropdown-content lg:max-h-none lg:block bg-slate-900">
                <div class="flex flex-col p-2 space-y-1">
                    <button onclick="toggleSeason('2025-26')" id="btn-2025-26" class="season-item active w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left group">
                        <span class="font-mono">2025/26</span>
                        <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-100"></i>
                    </button>
                    
                    <div class="pt-2 mt-2 border-t border-slate-800">
                        <p class="px-3 text-[10px] text-slate-600 uppercase font-bold mb-1">Archivio</p>
                        
                        <button onclick="toggleSeason('2024-25')" id="btn-2024-25" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left group text-slate-500">
                            <span class="font-mono">2024-25</span>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                        
                        <button onclick="toggleSeason('2023-24')" id="btn-2023-24" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left text-slate-500" title="dati in arrivo">
                            <span class="font-mono">2023-24</span>
                            <span class="text-[9px] bg-slate-800 px-1.5 rounded coming-soon-label">SOON</span>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                        <button onclick="toggleSeason('2022-23')" id="btn-2022-23" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left text-slate-500" title="dati in arrivo">
                            <span class="font-mono">2022-23</span>
                            <span class="text-[9px] bg-slate-800 px-1.5 rounded coming-soon-label">SOON</span>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                        <button onclick="toggleSeason('2021-22')" id="btn-2021-22" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left text-slate-500" title="dati in arrivo">
                            <span class="font-mono">2021-22</span>
                            <span class="text-[9px] bg-slate-800 px-1.5 rounded coming-soon-label">SOON</span>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                        <button onclick="toggleSeason('2020-21')" id="btn-2020-21" class="season-item w-full flex items-center justify-between px-3 py-2 rounded text-sm text-left text-slate-500" title="dati in arrivo">
                            <span class="font-mono">2020-21</span>
                            <span class="text-[9px] bg-slate-800 px-1.5 rounded coming-soon-label">SOON</span>
                            <i class="fa-solid fa-check text-yellow-500 text-xs check-icon opacity-0"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="stats-controls" class="pro-card rounded-lg p-4 space-y-2">
            <h3 class="text-xs font-bold uppercase tracking-wider text-slate-400 border-b border-slate-800 pb-2">Filtri Dati</h3>
            
            <div id="min-matches-container">
                <div class="flex justify-between items-center mb-2">
                    <label class="text-xs text-slate-400">Presenze minime</label>
                    <span id="minMatchesValue" class="text-xs font-mono text-yellow-500 bg-yellow-500/10 px-1.5 rounded border border-yellow-500/20">0</span>
                    <span id="minMatchesValue_mobile" class="hidden">0</span>
                </div>
                <input type="range" id="minMatches" min="0" max="10" value="0" step="1" oninput="updateMinMatches(this.value)" class="w-full">
                <input type="range" id="minMatches_mobile" class="hidden" oninput="updateMinMatches(this.value)">
            </div>

            <div id="active-filter-container" class="flex items-center justify-between pt-1 border-t border-slate-800 mt-2">
                <span class="text-xs text-slate-400">Solo arbitri attivi</span>
                <label class="relative inline-flex items-center cursor-pointer scale-75 origin-right">
                    <input type="checkbox" id="toggleInactive" onclick="toggleInactiveRefs()" class="sr-only peer">
                    <div class="w-9 h-5 bg-slate-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-yellow-600 peer-checked:after:bg-white"></div>
                </label>
            </div>

            <div id="matches-filters-container" class="hidden space-y-4 pt-2">
                <div class="space-y-1">
                    <label class="text-[10px] uppercase text-slate-500 font-bold tracking-wider">Tempo Totale (min)</label>
                    <div class="flex gap-2">
                        <input type="number" id="filterMinTot" min="90" oninput="debounceAggregate()" placeholder="Min" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                        <input type="number" id="filterMaxTot" oninput="debounceAggregate()" placeholder="Max" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                    </div>
                </div>
                <div class="space-y-1">
                    <label class="text-[10px] uppercase text-slate-500 font-bold tracking-wider">Tempo Effettivo (min)</label>
                    <div class="flex gap-2">
                         <input type="number" id="filterMinEff" oninput="debounceAggregate()" placeholder="Min" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                         <input type="number" id="filterMaxEff" oninput="debounceAggregate()" placeholder="Max" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                    </div>
                </div>
                <div class="space-y-1">
                    <label class="text-[10px] uppercase text-slate-500 font-bold tracking-wider">Falli</label>
                    <div class="flex gap-2">
                         <input type="number" id="filterMinFls" oninput="debounceAggregate()" placeholder="Min" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                         <input type="number" id="filterMaxFls" oninput="debounceAggregate()" placeholder="Max" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-1 text-xs text-white focus:border-yellow-500 outline-none">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="hidden lg:block bg-blue-500/5 border border-blue-500/10 rounded-lg p-4">
            <div class="flex gap-3">
                <i class="fa-solid fa-circle-info text-blue-400 mt-0.5"></i>
                <p class="text-xs text-blue-200/80 leading-relaxed">
                    I dati <span class="text-white font-bold">2025-26</span> sono aggiornati alla fine di ogni giornata.
                </p>
            </div>
        </div>
    </aside>

    <div id="main-content" class="lg:col-span-9 flex flex-col gap-6">

        <div id="update-alert-2526" class="hidden"></div>
        <div id="disclaimer-2526" class="hidden"></div>
        <div id="playing-time-title" class="hidden"></div>
        <div id="matches-title" class="hidden"></div>
        <div id="insights-container" class="hidden"></div>


<!-- ===============================
     PLAYERS VIEW (GIOCATORI 25/26)
=============================== -->
<div id="players-view" class="hidden space-y-6 animate-fade-in">

    <h2 class="text-xl font-bold text-slate-200 mb-4">
        Giocatori â€” Stagione 25/26
    </h2>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <div class="lg:col-span-3 space-y-4">
            <div class="pro-card rounded-lg p-4">
                <label for="players-search" class="text-xs uppercase text-slate-500 font-bold tracking-wider">Ricerca giocatore</label>
                <div class="relative mt-2">
                    <i class="fa-solid fa-magnifying-glass absolute left-3 top-3 text-slate-500 text-sm"></i>
                    <input id="players-search"
                           type="text"
                           placeholder="Cerca giocatore..."
                           oninput="renderPlayersTable()"
                           class="w-full pl-10 pr-3 py-2 rounded bg-slate-900 border border-slate-700 text-slate-200 focus:border-yellow-500 focus:ring-0 outline-none">
                </div>

                <div class="mt-4">
                    <p class="text-xs uppercase text-slate-500 font-bold tracking-wider">Filtra per ruolo</p>
                    <div class="grid grid-cols-2 gap-2 mt-2 text-sm text-slate-200">
                        <label class="flex items-center gap-2 text-orange-400">
                            <input type="checkbox" id="role-filter-por" class="rounded border-slate-700 bg-slate-900 text-orange-400 focus:ring-orange-400" onchange="togglePlayerRole('POR')" checked>
                            <span>POR</span>
                        </label>
                        <label class="flex items-center gap-2 text-green-400">
                            <input type="checkbox" id="role-filter-df" class="rounded border-slate-700 bg-slate-900 text-green-400 focus:ring-green-400" onchange="togglePlayerRole('DF')" checked>
                            <span>DIF</span>
                        </label>
                        <label class="flex items-center gap-2 text-blue-400">
                            <input type="checkbox" id="role-filter-cc" class="rounded border-slate-700 bg-slate-900 text-blue-400 focus:ring-blue-400" onchange="togglePlayerRole('CC')" checked>
                            <span>CC</span>
                        </label>
                        <label class="flex items-center gap-2 text-red-400">
                            <input type="checkbox" id="role-filter-att" class="rounded border-slate-700 bg-slate-900 text-red-400 focus:ring-red-400" onchange="togglePlayerRole('ATT')" checked>
                            <span>ATT</span>
                        </label>
                    </div>
                </div>

                <div class="mt-4 relative" id="players-team-filter-container">
                    <label for="players-team-trigger" class="text-xs uppercase text-slate-500 font-bold tracking-wider">Filtra per squadra</label>
                    <button id="players-team-trigger" type="button" class="mt-2 w-full bg-slate-900 border border-slate-700 text-sm text-slate-200 rounded px-3 py-2 flex items-center justify-between focus:border-yellow-500 focus:ring-0 outline-none" onclick="togglePlayersTeamDropdown()">
                        <span id="players-team-trigger-label">Tutte le squadre</span>
                        <i class="fa-solid fa-chevron-down text-slate-500 text-xs"></i>
                    </button>
                    <div id="players-team-dropdown" class="absolute mt-1 w-full bg-slate-900 border border-slate-700 rounded shadow-card max-h-64 overflow-y-auto hidden z-20">
                        <div class="p-2 text-[11px] text-slate-400 border-b border-slate-800">Seleziona una o piÃ¹ squadre</div>
                        <div id="players-team-options" class="max-h-52 overflow-y-auto"></div>
                    </div>
                </div>
            </div>

            <div class="pro-card rounded-lg p-4">
                <div class="flex items-center justify-between text-xs text-slate-400 mb-2">
                    <span>Min. presenze (90')</span>
                    <span id="playersMinMatchesValue" class="font-mono text-yellow-500 bg-yellow-500/10 px-1.5 rounded border border-yellow-500/20">0</span>
                </div>
                <input type="range" id="playersMinMatches" min="0" max="10" step="1" value="0" oninput="updatePlayersMinMatches(this.value)" class="w-full">
                <button id="players-presence-threshold" type="button" class="mt-3 w-full px-3 py-2 rounded border border-slate-700 text-xs font-semibold text-slate-200 hover:border-yellow-500 hover:text-yellow-400 transition" onclick="toggleLowPresenceExclusion()">
                    Escludi chi Ã¨ sotto il 30% delle presenze
                </button>
            </div>

            <div class="pro-card rounded-lg p-4">
                <div class="flex items-center justify-between border-b border-slate-800 pb-2 mb-3">
                    <div>
                        <p class="text-xs uppercase text-slate-500 font-bold tracking-wider">Confronta giocatori</p>
                        <p class="text-[11px] text-slate-400">Seleziona due nomi per confrontare le metriche.</p>
                    </div>
                    <i class="fa-solid fa-code-compare text-yellow-400"></i>
                </div>

                <div class="space-y-3">
                    <div class="space-y-1">
                        <label for="player-compare-1" class="text-[11px] text-slate-400">Giocatore A</label>
                        <input id="player-compare-1" list="players-compare-options" type="text" placeholder="Digita un nome" oninput="handlePlayerComparisonInput(1, this.value)" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-xs text-white focus:border-yellow-500 focus:ring-0 outline-none" />
                    </div>
                    <div class="space-y-1">
                        <label for="player-compare-2" class="text-[11px] text-slate-400">Giocatore B</label>
                        <input id="player-compare-2" list="players-compare-options" type="text" placeholder="Digita un nome" oninput="handlePlayerComparisonInput(2, this.value)" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-xs text-white focus:border-yellow-500 focus:ring-0 outline-none" />
                    </div>

                    <datalist id="players-compare-options"></datalist>

                    <div class="overflow-hidden rounded border border-slate-800">
                        <table class="w-full text-[11px] text-slate-300" id="players-comparison-table"></table>
                    </div>
                </div>
            </div>
        </div>

                <div class="lg:col-span-9">
            <div class="pro-card rounded-lg overflow-hidden">
                <div class="flex items-center justify-between px-4 py-3 bg-slate-800 border-b border-slate-700/70">
                    <h3 class="text-lg font-extrabold text-white flex items-center gap-3">
                        <span>Giocatori</span>
                    </h3>
                    <div class="flex items-center gap-2 text-xs">
                        <button type="button" class="px-3 py-1 rounded border border-slate-600 text-slate-300 hover:border-yellow-500 hover:text-yellow-400 transition" data-mode="per90" onclick="setPlayersStatMode('per90')">
                            Medie 90'
                        </button>
                        <button type="button" class="px-3 py-1 rounded border border-slate-600 text-slate-300 hover:border-yellow-500 hover:text-yellow-400 transition" data-mode="total" onclick="setPlayersStatMode('total')">
                            Valori totali
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-[11px] text-slate-300 pro-table players-table text-center" id="players-table">
                                                <thead class="bg-slate-800 text-slate-300">
                            <tr>
                                <th class="p-2 w-10" title="Posizione in classifica dinamica rispetto all'ordinamento scelto">#</th>
                                <th class="p-2 cursor-pointer select-none text-left whitespace-nowrap" data-sort-col="name" onclick="handlePlayersSort('name')" title="Cognome in evidenza e nome completo del giocatore">
                                    <span class="players-col-label">Giocatore</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="n90" onclick="handlePlayersSort('n90')" title="Numero di presenze espresse come partite intere da 90 minuti">
                                    <span class="players-col-label" data-label-per90="P" data-label-total="P">P</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="yellow" onclick="handlePlayersSort('yellow')" title="Cartellini gialli ricevuti">
                                    <span class="players-col-label" data-label-per90="Gialli" data-label-total="Gialli Tot">Gialli</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="fouls" onclick="handlePlayersSort('fouls')" title="Falli commessi">
                                    <span class="players-col-label" data-label-per90="Falli C." data-label-total="Falli C. Tot">Falli C.</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="fouled" onclick="handlePlayersSort('fouled')" title="Falli subiti">
                                    <span class="players-col-label" data-label-per90="Falli S." data-label-total="Falli S. Tot">Falli S.</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="crosses" onclick="handlePlayersSort('crosses')" title="Cross tentati">
                                    <span class="players-col-label" data-label-per90="Cross" data-label-total="Cross Tot">Cross</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="passCompleted" onclick="handlePlayersSort('passCompleted')" title="Passaggi completati">
                                    <span class="players-col-label" data-label-per90="PassC" data-label-total="PassC Tot">PassC</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="passAttempted" onclick="handlePlayersSort('passAttempted')" title="Passaggi tentati">
                                    <span class="players-col-label" data-label-per90="PassT" data-label-total="PassT Tot">PassT</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="passPct" onclick="handlePlayersSort('passPct')" title="Percentuale di precisione sui passaggi">
                                    <span class="players-col-label">% Pass</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="shotsPer90" onclick="handlePlayersSort('shotsPer90')" title="Tiri totali">
                                    <span class="players-col-label" data-label-per90="Tiri/90" data-label-total="Tiri Tot">Tiri/90</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>

                                <th class="p-2 cursor-pointer select-none whitespace-nowrap" data-sort-col="shotsOnTargetPer90"onclick="handlePlayersSort('shotsOnTargetPer90')" title="Tiri in porta">
                                    <span class="players-col-label" data-label-per90="TiriP/90" data-label-total="TiriP Tot">TiriP/90</span> <span class="players-sort-icon text-yellow-400"></span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="players-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
        <div id="analytics-view" class="hidden space-y-6 animate-fade-in">
            <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                <div class="flex items-center gap-3 flex-wrap">
                    <span class="text-xs uppercase text-slate-500 font-bold tracking-wider">Vista</span>
                    <div class="bg-slate-900 border border-slate-800 rounded-full p-1 flex">
                        <button type="button" class="analytics-subtab-btn px-4 py-2 rounded-full text-xs font-semibold bg-yellow-500 text-slate-900 shadow-glow" data-tab="arbitri" onclick="switchAnalyticsTab('arbitri')">Arbitri/Squadre</button>
                        <button type="button" class="analytics-subtab-btn px-4 py-2 rounded-full text-xs font-semibold text-slate-200 hover:text-white" data-tab="giocatori" onclick="switchAnalyticsTab('giocatori')">Giocatori</button>
                    </div>
                </div>
                <p class="text-[11px] text-slate-400 max-w-xl">Usa lo switch per passare dai grafici su arbitri e squadre al nuovo scatter dedicato ai giocatori.</p>
            </div>

            <div id="analytics-tab-arbitri" class="space-y-6">
                <div class="pro-card rounded-lg p-4 lg:col-span-2">
                <h3 class="text-sm font-bold text-white uppercase tracking-wider mb-4 border-b border-slate-800 pb-2 flex flex-wrap gap-3 items-center justify-between">
                    <span class="flex items-center gap-2"><i class="fa-solid fa-scale-balanced text-green-500"></i> Ritmo vs Interruzioni</span>
                    <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-ritmo">
                        <span class="text-slate-400">Stagioni:</span>
                        <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('ritmo','2025-26', this)">25/26</button>
                        <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('ritmo','2024-25', this)">24/25</button>
                    </div>
                    <div class="relative w-full sm:w-1/3 min-w-[180px]">
                        <i class="fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-slate-500 text-xs"></i>
                        <input type="text" id="analyticsSearchRitmo" oninput="debounceRenderAnalytics()" placeholder="Filtra per squadra..." class="w-full bg-slate-900 text-xs text-white pl-8 pr-2 py-1.5 rounded border border-slate-700 focus:border-yellow-500 focus:ring-0 outline-none placeholder-slate-600">
                    </div>
                </h3>
                <div id="chart-match-scatter" class="w-full h-[350px] relative">
                    </div>

                <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-[11px] text-slate-300">
                    <div class="flex items-start gap-3">
                        <div class="quadrant-mini">
                            <div class="quadrant-fill" style="left:0; top:0; width:50%; height:50%; background:white;"></div>
                        </div>
                        <p><span class="font-bold text-slate-100">FluiditÃ </span><br>Tempo Effettivo alto e pochi falli</p>
                    </div>
                    <div class="flex items-start gap-3">
                        <div class="quadrant-mini">
                            <div class="quadrant-fill" style="right:0; top:0; width:50%; height:50%; background:white;"></div>
                        </div>
                        <p><span class="font-bold text-slate-100">Intenso</span><br>Tempo effettivo alto nonostante molti falli</p>
                    </div>
                    <div class="flex items-start gap-3">
                        <div class="quadrant-mini">
                            <div class="quadrant-fill" style="left:0; bottom:0; width:50%; height:50%; background:white;"></div>
                        </div>
                        <p><span class="font-bold text-slate-100">Lento</span><br>Pochi falli ma tempo effettivo basso</p>
                    </div>
                    <div class="flex items-start gap-3">
                        <div class="quadrant-mini">
                            <div class="quadrant-fill" style="right:0; bottom:0; width:50%; height:50%; background:white;"></div>
                        </div>
                        <p><span class="font-bold text-slate-100">Spezzettato</span><br>Molti falli e tempo effettivo basso</p>
                    </div>
                </div>
            </div>



            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">              
                <div class="pro-card rounded-lg p-4">
                    <div class="flex flex-col gap-2 mb-4 border-b border-slate-800 pb-2">
                        <h3 class="text-sm font-bold text-white uppercase tracking-wider flex flex-wrap gap-2 items-center justify-between">
                            <span class="flex items-center gap-2"><i class="fa-solid fa-fingerprint text-blue-500"></i> Profilo Arbitro</span>
                            <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-refRadar">
                                <span class="text-slate-400">Stagioni:</span>
                                <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('refRadar','2025-26', this)">25/26</button>
                                <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('refRadar','2024-25', this)">24/25</button>
                            </div>
                        </h3>
                        <div class="flex flex-col gap-2 w-full">
                            <div class="flex gap-2">
                                <select id="radar-ref-select" class="chart-select bg-slate-900 text-xs text-white border border-slate-700 rounded pl-3 pr-8 py-1.5 focus:border-yellow-500 outline-none cursor-pointer flex-grow">
                                    <option value="">Seleziona arbitro da aggiungere...</option>
                                </select>
                                <button onclick="addRefereeToRadar()" class="bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold text-xs px-3 py-1.5 rounded transition-colors">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                            <div id="radar-chips-container" class="flex flex-wrap gap-2 min-h-[28px]">
                                <span class="text-[10px] text-slate-500 italic py-1">Aggiungi fino a 10 arbitri per il confronto...</span>
                            </div>
                            <div class="flex justify-between items-center mt-1 pt-2 border-t border-slate-800">
                                <button onclick="loadPresetRadarRefs()" class="mt-2 w-full bg-blue-600/20 text-blue-400 text-[11px] py-1.5 rounded border border-blue-600/30 hover:bg-blue-600/30 transition">
                                    Carica i 10 arbitri della 13^ giornata
                                </button>
                                <button onclick="resetRadar()" class="text-[10px] text-slate-400 hover:text-white underline">Reset Confronto</button>
                                <span id="radar-count" class="text-[10px] text-slate-500">0/10</span>
                            </div>
                        </div>
                    </div>
                    <div id="chart-radar" class="w-full h-[550px] flex items-center justify-center"></div>
                    <p class="text-[10px] text-slate-400 italic mt-3 text-center">
                        Clicca sul nome dell'arbitro nella legenda per nasconderne/mostrarne il grafico.
                    </p>
                </div>

                <div class="pro-card rounded-lg p-4 relative">
                    <h3 class="text-sm font-bold text-white uppercase tracking-wider mb-4 border-b border-slate-800 pb-2 flex flex-wrap gap-3 items-center justify-between">
                        <span class="flex items-center gap-2"><i class="fa-solid fa-crosshairs text-yellow-500"></i> Indice di SeveritÃ  (Falli vs Cartellini)</span>
                        <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-severity">
                            <span class="text-slate-400">Stagioni:</span>
                            <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('severity','2025-26', this)">25/26</button>
                            <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('severity','2024-25', this)">24/25</button>
                        </div>
                        <div class="relative w-full sm:w-1/3 min-w-[180px]">
                            <i class="fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-slate-500 text-xs"></i>
                            <input type="text" id="analyticsSearchSeverity" oninput="debounceRenderAnalytics()" placeholder="Filtra per arbitro..." class="w-full bg-slate-900 text-xs text-white pl-8 pr-2 py-1.5 rounded border border-slate-700 focus:border-yellow-500 focus:ring-0 outline-none placeholder-slate-600">
                        </div>
                    </h3>

                    <div id="analytics-min-matches-container" class="space-y-2 mb-4">
                        <div class="flex justify-between items-center">
                            <label class="text-xs text-slate-400">Min. Presenze Arbitro</label>
                            <span id="analyticsMinMatchesValue" class="text-xs font-mono text-yellow-500 bg-yellow-500/10 px-1.5 rounded border border-yellow-500/20">0</span>
                        </div>
                        <input type="range" id="analyticsMinMatches" min="0" max="10" value="0" step="1" oninput="updateAnalyticsMinMatches(this.value)" class="w-full">
                    </div>
                    <div id="chart-scatter" class="w-full h-[350px] relative"></div>

                    <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-[11px] text-slate-300">
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="left:0; top:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Chirurgici</span><br>Pochi falli, molti cartellini</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="right:0; top:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Rigidi</span><br>Molti falli e molti cartellini</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="left:0; bottom:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Inglesi</span><br>Pochi falli e pochi cartellini</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="quadrant-mini">
                                <div class="quadrant-fill" style="right:0; bottom:0; width:50%; height:50%; background:white;"></div>
                            </div>
                            <p><span class="font-bold text-slate-100">Gestori</span><br>Molti falli, pochi cartellini</p>
                        </div>
                    </div>
                </div>

            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="pro-card rounded-lg p-4">
                    <div class="flex flex-wrap items-center justify-between gap-3 mb-4 border-b border-slate-800 pb-2">
                        <h3 class="text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2">
                            <i class="fa-solid fa-chart-column text-indigo-400"></i> Distribuzione Tempo Effettivo
                        </h3>
                        <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-eff">
                            <span class="text-slate-400">Stagioni:</span>
                            <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('eff','2025-26', this)">25/26</button>
                            <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('eff','2024-25', this)">24/25</button>
                        </div>
                    </div>

                    <div id="chart-eff-distribution" class="w-full h-[350px]"></div>
                    <p class="text-[10px] text-slate-400 mt-2 italic">
                        Indica quante partite rientrano in ogni fascia di minutaggio reale.
                    </p>
                </div>

                <div class="pro-card rounded-lg p-4">
                    <div class="flex flex-wrap items-center justify-between gap-3 mb-4 border-b border-slate-800 pb-2">
                        <h3 class="text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2">
                            <i class="fa-solid fa-bullseye text-pink-500"></i> Radar: Ritmo Squadre
                        </h3>
                        <div class="flex items-center gap-2 flex-wrap text-[11px]" id="season-toggle-teamRadar">
                            <span class="text-slate-400">Stagioni:</span>
                            <button type="button" class="analytics-season-chip" data-season="2025-26" onclick="toggleAnalyticsSeason('teamRadar','2025-26', this)">25/26</button>
                            <button type="button" class="analytics-season-chip" data-season="2024-25" onclick="toggleAnalyticsSeason('teamRadar','2024-25', this)">24/25</button>
                        </div>
                    </div>

                    <div id="chart-top-flop" class="w-full h-[350px] flex justify-center items-center"></div>
                    <p class="text-[10px] text-slate-400 mt-2 italic text-center">
                        Confronto volumetrico: Spicchi grandi = PiÃ¹ tempo effettivo.
                    </p>
                </div>
            </div>


<!-- HEATMAP SQUADRE (STAGIONE 24/25) -->
<div class="mt-10 w-full">
    <h3 class="text-lg font-bold text-slate-200 mb-4 flex items-center justify-between gap-4">
        <span>Heatmap Squadre â€” Stagione 2024/25</span>

        <!-- Selettore metrica heatmap -->
        <div class="flex items-center gap-2 text-xs">
            <label for="heatmap-metric" class="text-slate-400 hidden sm:inline">Metrica:</label>
            <select id="heatmap-metric"
                    class="bg-slate-800 border border-slate-700 text-slate-100 text-xs rounded px-2 py-1">
                <option value="eff" selected>Tempo effettivo</option>
                <option value="fouls">Falli fischiati</option>
            </select>
        </div>
    </h3>

    <div class="heatmap-wrapper">
        <div id="chart-team-heatmap"></div>
    </div>
</div>

            </div>

            <div id="analytics-tab-giocatori" class="hidden space-y-6">
                <div class="pro-card rounded-lg p-4">
                    <div class="flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between">
                        <div>
                            <h3 class="text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2">
                                <i class="fa-solid fa-futbol text-red-400"></i> Scatter Tiri Giocatori
                            </h3>
                            <p class="text-[11px] text-slate-400">Solo giocatori con almeno il 30% di presenze, portieri esclusi.</p>
                        </div>
                        <div class="flex flex-col items-start gap-2">
                            <span class="text-[11px] text-slate-400">Filtra ruoli</span>
                            <div class="flex flex-wrap gap-2">
                                <button type="button" class="player-scatter-role-toggle border border-slate-700 text-xs font-semibold px-3 py-1 rounded-full flex items-center gap-2 bg-slate-800/70" data-role="DF" onclick="togglePlayerScatterRole('DF')">
                                    <span class="w-2 h-2 rounded-full" style="background-color:#22c55e;"></span>
                                    Difensori
                                </button>
                                <button type="button" class="player-scatter-role-toggle border border-slate-700 text-xs font-semibold px-3 py-1 rounded-full flex items-center gap-2 bg-slate-800/70" data-role="CC" onclick="togglePlayerScatterRole('CC')">
                                    <span class="w-2 h-2 rounded-full" style="background-color:#38bdf8;"></span>
                                    Centrocampisti
                                </button>
                                <button type="button" class="player-scatter-role-toggle border border-slate-700 text-xs font-semibold px-3 py-1 rounded-full flex items-center gap-2 bg-slate-800/70" data-role="ATT" onclick="togglePlayerScatterRole('ATT')">
                                    <span class="w-2 h-2 rounded-full" style="background-color:#ef4444;"></span>
                                    Attaccanti
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="chart-player-scatter" class="w-full h-[460px] mt-4"></div>

                    <p class="text-[11px] text-slate-400 mt-3">Asse X: tiri/90'. Asse Y: tiri in porta/90'. Puoi combinare i ruoli tramite i filtri.</p>
                </div>
            </div>

        </div>



        <div id="table-view" class="pro-card rounded-lg overflow-hidden flex flex-col min-h-[600px] relative">
            <div id="empty-state-msg" class="hidden absolute inset-0 z-30 bg-slate-900/80 backdrop-blur-sm flex flex-col items-center justify-start pt-20">
                <div class="w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mb-4 border border-slate-700">
                    <i class="fa-solid fa-filter text-slate-500 text-2xl"></i>
                </div>
                <h3 class="text-white font-bold text-lg">Nessun dato trovato</h3>
                <p class="text-slate-400 text-sm mt-1">Prova a modificare i filtri di ricerca.</p>
            </div>
            <div id="historical-data-msg" class="hidden absolute inset-0 z-30 bg-slate-900 flex flex-col items-center justify-start pt-20 text-center">
                 <i class="fa-solid fa-circle-notch fa-spin text-3xl text-yellow-500 mb-4"></i>
                 <h3 class="text-white font-bold text-lg mb-2" id="historical-msg-title">Dati Stagione in fase di caricamento...</h3>
                 <p class="text-slate-400 text-sm">Stiamo elaborando i dati storici per le stagioni selezionate.</p>
            </div>
            <div class="overflow-x-auto flex-grow">
                <table class="w-full text-left pro-table" id="mainTable">
                    <thead id="tableHeader" class="sticky-head text-slate-500"></thead>
                    <tbody id="tableBody" class="font-mono text-sm text-slate-200"></tbody>
                    <tfoot id="tableFooter" class="sticky bottom-0 z-20 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.3)]"></tfoot>
                </table>
            </div>
        </div>

        <div class="flex flex-col sm:flex-row justify-between items-center text-xs text-slate-600 border-t border-slate-800 pt-6 mt-2 pb-8">
            <p>Â© 2025 RefereeLab Analytics v2.0</p>
            <div class="flex gap-4 mt-2 sm:mt-0">
                <span>Fonte Dati: Pubblica</span>
                <span>Non affiliato AIA/FIGC</span>
            </div>
        </div>
        <div class="text-center text-[10px] text-slate-700 uppercase tracking-widest pb-4">
            Dati elaborati da fonti pubbliche. Non affiliato con AIA/FIGC.
        </div>

    </div>
</div>

<div class="hidden lg:block fixed bottom-8 right-8 w-72 z-40">
     <div class="pro-card rounded-lg shadow-2xl border border-slate-700 overflow-hidden">
        <div class="bg-slate-900 p-3 flex justify-between items-center border-b border-slate-800 cursor-pointer hover:bg-slate-800 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden')">
            <h3 class="text-xs font-bold text-white flex items-center gap-2">
                <span class="w-2 h-2 bg-red-500 rounded-full animate-flash"></span>
                Scopri le ultime designazioni
            </h3>
            <i class="fa-solid fa-chevron-down text-slate-500 text-xs"></i>
        </div>
        <div class="p-0 max-h-64 overflow-y-auto hidden">
            <div class="p-3 space-y-2">
                <div class="text-[10px] text-yellow-500 font-bold uppercase tracking-wider mb-2">13Âª Giornata</div>
                
                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>COMO - SASSUOLO</span>
                        <span class="text-[10px] text-slate-500">ven 20:45</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Marchetti</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Ghersini</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>GENOA - VERONA</span>
                        <span class="text-[10px] text-slate-500">sab 15:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Fabbri</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Mazzoleni</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>PARMA - UDINESE</span>
                        <span class="text-[10px] text-slate-500">sab 15:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Piccinini</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Prontera</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>JUVENTUS - CAGLIARI</span>
                        <span class="text-[10px] text-slate-500">sab 18:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Crezzini</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Di Bello</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>MILAN - LAZIO</span>
                        <span class="text-[10px] text-slate-500">sab 20:45</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Collu</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Di Paolo</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>LECCE - TORINO</span>
                        <span class="text-[10px] text-slate-500">dom 12:30</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Mariani</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Marini</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>PISA - INTER</span>
                        <span class="text-[10px] text-slate-500">dom 15:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Guida</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Paterna</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>ATALANTA - FIORENTINA</span>
                        <span class="text-[10px] text-slate-500">dom 18:00</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Marcenaro</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Camplone</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>ROMA - NAPOLI</span>
                        <span class="text-[10px] text-slate-500">dom 20:45</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Massa</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Aureliano</span>
                    </div>
                </div>

                <div class="bg-slate-800/40 p-2 rounded border border-slate-700/50 hover:bg-slate-800 transition-colors group">
                    <div class="flex justify-between text-white font-bold text-xs mb-1">
                        <span>BOLOGNA - CREMONESE</span>
                        <span class="text-[10px] text-slate-500">lun 20:45</span>
                    </div>
                    <div class="flex items-center justify-between text-[10px] text-green-400">
                        <span>ARBITRO: Feliciani</span>
                        <span class="flex items-center justify-between text-[10px] text-violet-400">VAR: Gariglio</span>
                    </div>
                </div>

            </div>
        </div>
     </div>
</div>
    </main>

    <script>

const playersRawData = `
Manuel De LucaATTCremonese0,200,005,005,000,00
Enzo EbosseDFHellas Verona0,601,675,000,000,00
Grigoris KastanosCCHellas Verona0,200,005,005,0010,00
Ignace Van Der BremptDFComo1,100,914,551,820,00
Lennon MillerCCUdinese0,901,114,441,113,33
Leonardo PavolettiATTCagliari0,901,114,440,000,00
Luca MazzitelliCCCagliari0,702,864,291,431,43
Almoatasem Al MusratiCCHellas Verona1,200,834,170,000,00
Fabio MirettiCCJuventus0,502,004,002,004,00
Luca MoroATTSassuolo0,500,004,006,000,00
Lorenzo LuccaATTNapoli4,200,243,812,620,00
Daniel MosqueraATTHellas Verona2,100,483,810,950,95
NicolÃ² ZanioloATTUdinese7,700,263,771,824,29
Maxwel CornetATT,DFGenoa0,800,003,751,257,50
Alieu FaderaATTSassuolo4,700,213,624,043,19
Reda BelahyaneCCLazio1,700,593,530,000,00
Jean-Daniel Akpa-AkproCCHellas Verona5,500,733,450,180,55
Gennaro BorrelliATTCagliari7,300,273,423,420,14
Tijjani NoslinATT,CCLazio0,900,003,333,330,00
Abdelhamid SabiriCCFiorentina0,300,003,333,3313,30
Ãlex SalaCCLecce1,200,003,330,832,50
Jan ZiÃ³Å‚kowskiDFRoma1,201,673,333,330,00
Milan ÄuriÄ‡ATTParma0,600,003,331,670,00
Cheikh NiasseCCHellas Verona2,600,003,082,310,77
MartÃ­n PayeroCCCremonese6,200,653,062,261,13
Lameck BandaATTLecce5,300,383,023,023,21
Mattia VitiDFFiorentina2,001,003,001,000,00
Adrian BenedyczakCC,ATTParma2,400,002,920,832,08
Gvidas GineitisCC,ATTTorino3,100,002,903,233,55
Juan David CabalDFJuventus0,701,432,860,000,00
Daniel DenoonDFPisa1,400,712,862,140,00
Santiago PierottiATT,CCLecce7,700,002,860,650,52
Artem DovbykATTRoma3,600,002,781,110,00
Valentin CarboniCC,ATTGenoa4,000,502,751,252,00
Joseph LitetaCCCagliari1,100,002,730,000,00
Junior MessiasATT,CCGenoa1,100,002,734,550,91
Francesco EspositoATTInter4,100,242,684,150,00
Koni De WinterDFMilan3,800,002,630,530,53
Thijs DallingaATTBologna4,200,242,621,430,71
Mateo PellegrinoATTParma12,200,252,622,300,33
Matteo CancellieriATTLazio4,600,002,613,700,22
Giuseppe AmbrosinoATTNapoli0,400,002,502,500,00
Zachary AthekameDF,ATTMilan1,201,672,500,834,17
Fallou ChamDFHellas Verona2,400,002,502,083,75
Francesco FolinoDFCremonese0,400,002,500,000,00
Abdou HarrouiCC,ATTHellas Verona1,600,002,500,633,13
HernaniCC,DFParma0,800,002,503,752,50
Semih KÄ±lÄ±Ã§soyATTCagliari0,801,252,501,251,25
Giorgio ScalviniDFAtalanta3,200,002,500,310,00
Stephan El ShaarawyCC,ATTRoma2,000,502,501,002,50
Lorenzo VenturinoATT,CCGenoa0,400,002,500,0020,00
Antoine BernedeCCHellas Verona10,100,102,480,791,29
Juan JesusDFNapoli7,000,432,430,140,00
NicolÃ¡s PazCCComo12,800,162,421,642,66
Ebenezer AkinsanmiroCCPisa8,300,122,411,690,84
Ä°sak VuralCCPisa2,900,692,414,831,38
Lewis FergusonCCBologna5,900,172,371,691,36
Marin PongraÄiÄ‡DFFiorentina12,000,422,331,080,25
Cesare CasadeiCCTorino11,900,342,270,590,17
Morten ThorsbyCCGenoa5,300,192,260,750,75
Christian OrdoÃ±ezCC,DFParma4,001,002,250,751,75
Aster VranckxCCSassuolo4,900,202,242,860,82
Zakaria AboukhlalATT,CCTorino1,800,562,223,332,22
Marco BrescianiniCCAtalanta1,800,562,221,113,33
Walid CheddiraATTSassuolo0,901,112,224,442,22
Konan N'driATT,CCLecce1,801,112,223,892,78
Hans Nicolussi CavigliaCCFiorentina6,300,322,222,224,44
Gaetano OristanioCC,ATTParma1,800,562,225,562,78
Jamil SiebertDFLecce0,900,002,220,000,00
Adam ObertDFCagliari10,000,602,200,500,80
David NeresATT,CCNapoli6,400,312,190,474,84
Mattia FeliciCC,DFCagliari4,600,652,171,305,00
Alessandro BastoniDFInter11,600,092,160,863,10
Unai NÃºÃ±ezDFHellas Verona8,400,482,140,710,71
Marcus ThuramATTInter6,100,002,131,971,31
Ãlex ValleDFComo9,400,112,131,171,81
Tommaso BaldanziATT,CCRoma3,300,612,124,241,82
Woyo CoulibalyDFSassuolo3,300,002,121,211,21
Santiago CastroATTBologna7,600,132,111,580,13
Amin SarrATTHellas Verona3,800,002,112,110,53
Sebastiano EspositoATTCagliari9,600,312,081,563,65
Jeff EkhatorATTGenoa3,400,592,062,650,88
NicolÃ² CambiaghiATTBologna6,900,292,035,073,19
Lorenzo ColomboATTGenoa7,900,132,032,150,63
Kingsley EhizibueDFUdinese6,000,172,001,503,00
Ivan IliÄ‡CCTorino4,000,252,000,750,25
Adam MasinaDFTorino2,500,002,000,800,00
Jens OdgaardCCBologna5,500,182,001,640,91
Sebastian OtoaDFGenoa0,502,002,000,000,00
Adrien RabiotCCMilan6,000,172,001,501,00
Sergi RobertoCCComo2,001,002,001,501,00
Petar SucicCCInter7,500,402,001,201,20
Oier ZarragaCCUdinese2,000,502,000,502,00
Teun KoopmeinersCC,DFJuventus8,600,471,980,122,56
MÃ¡ximo PerroneCCComo10,600,381,980,660,19
KhÃ©phren ThuramCCJuventus9,100,001,980,880,55
Armel Bella KotchapDFHellas Verona5,600,181,961,250,18
Gianluca GaetanoCC,ATTCagliari4,600,221,961,962,61
Neil El AynaouiCCRoma4,100,491,950,490,98
Gianluca ManciniDFRoma12,900,231,941,630,70
Marius MarinCCPisa7,200,281,941,391,11
Lautaro MartÃ­nezATTInter10,800,191,942,130,83
Ãlvaro MorataATTComo6,700,151,942,990,90
Simon SohmCCFiorentina6,200,321,941,770,32
Assane DiaoATTComo2,600,001,923,081,92
Warren BondoCCCremonese9,400,211,911,910,11
Roberto GagliardiniCCHellas Verona8,400,481,900,830,60
Suat SerdarCCHellas Verona8,400,241,901,190,83
Pablo MarÃ­DFFiorentina8,000,381,881,000,00
Antonio SanabriaATTCremonese4,300,471,861,160,23
Keinan DavisATTUdinese7,600,391,842,630,13
Yann Aurel BisseckDFInter3,300,301,820,910,61
Tommaso BarbieriATT,DFCremonese5,500,181,821,453,27
TorbjÃ¸rn HeggemDFBologna9,900,001,820,400,10
Mateus LusuardiDFPisa2,200,451,820,000,45
Abdoulaye Niakhate NdiayeDFParma5,500,731,821,270,00
Matteo PalmaDFUdinese1,100,001,820,000,00
Alessandro BuongiornoDFNapoli8,300,001,810,960,24
Charalampos LykogiannisDFBologna3,900,511,790,007,44
Martin FreseDFHellas Verona10,100,301,780,593,27
Rasmus HÃ¸jlundATTNapoli7,300,141,782,600,14
NicolÃ² CasaleDFBologna1,700,001,761,180,00
Jayden AddaiATTComo5,700,351,751,931,58
Manuel LocatelliCCJuventus10,400,291,732,120,38
Nikola Å tuliÄ‡ATTLecce8,700,111,721,380,00
Cyril NgongeATT,CCTorino8,200,241,711,591,10
Leo Skiri Ã˜stigÃ¥rdDFGenoa10,500,381,710,570,00
Isak HienDFAtalanta11,200,271,700,980,00
Rolando MandragoraCCFiorentina10,600,191,702,363,30
Giovanni Di LorenzoDFNapoli13,000,081,690,771,31
Mario HermosoDFRoma8,300,361,690,240,60
Giovanni SimeoneATTTorino8,300,001,692,050,12
Patrizio MasiniCCGenoa9,500,321,682,740,95
Giovanni BonfantiDFPisa3,600,001,670,562,50
Federico CeccheriniDFCremonese1,200,001,671,670,00
Giovanni FabbianCCBologna4,800,001,672,920,63
Evan FergusonATTRoma4,200,241,671,430,48
Malthe HojholtCCPisa1,200,831,670,000,00
Emil HolmDFBologna4,800,421,672,292,92
Sandi LovriÄ‡CCUdinese1,200,831,670,007,50
Henrikh MkhitaryanCCInter5,400,371,670,742,41
Adam BuksaATTUdinese4,900,201,632,450,20
Morten FrendrupCCGenoa11,700,091,621,030,26
Henrik MeisterATTPisa6,800,151,621,030,00
Weston McKennieCC,DFJuventus8,200,241,590,240,98
Iker BravoATTUdinese1,900,531,580,531,58
Mohamed KabaCC,ATTLecce1,900,001,583,161,58
Filip KostiÄ‡CCJuventus3,800,001,580,5310,50
M'Bala NzolaATTPisa9,500,111,581,680,63
Kostas TsimikasDFRoma1,900,531,581,055,79
Luca PellegriniDFLazio5,100,201,571,182,55
Vakoun BayoATTUdinese3,200,001,560,940,00
Pontus AlmqvistDF,CCParma3,900,001,543,081,03
Manu KonÃ©CCRoma13,000,001,542,150,00
Lazar SamardzicCCAtalanta5,200,001,540,195,96
Nuno TavaresDFLazio5,200,001,542,126,54
MatÃ­as VecinoCCLazio2,600,001,540,380,00
Michael FolorunshoCCCagliari11,800,171,532,291,19
Roberto PiccoliATT,CCFiorentina5,900,001,532,200,34
Ivan SmolÄiÄ‡DFComo7,200,691,531,671,53
Alessandro DeiolaCC,DFCagliari6,600,451,521,060,15
Ruslan MalinovskyiCCGenoa8,600,581,511,281,86
Bryan CristanteCCRoma12,000,251,500,250,58
Denzel DumfriesDFInter8,000,131,500,752,75
Brooke Norton-CuffyDF,ATTGenoa12,000,331,500,753,08
Martin VitÃ­kDFBologna4,000,251,500,500,25
Francisco ConceiÃ§Ã£oCC,ATTJuventus7,400,001,492,034,32
Tommaso PobegaCCBologna4,700,211,490,430,21
NicolÃ¡s ValentiniDFHellas Verona4,700,211,490,431,06
Jurgen EkkelenkampCCUdinese5,400,001,480,562,22
JoÃ£o MÃ¡rio LopesDFJuventus2,700,371,483,701,85
Alberto MorenoDFComo2,700,371,480,002,96
Jordan ZemuraDFUdinese5,400,191,480,744,26
Toma BaÅ¡iÄ‡CCLazio7,500,001,471,602,27
Albert GuÃ°mundssonCC,ATTFiorentina6,900,291,450,871,01
Lloyd KellyDFJuventus11,000,271,450,550,45
Kristian ThorstvedtCCSassuolo7,600,391,452,240,66
Vasilije AdÅ¾iÄ‡CCJuventus1,400,001,430,711,43
Faustino AnjorinCC,ATTTorino0,700,001,431,430,00
Andrea BelottiATTCagliari2,100,001,433,330,48
Federico BernardeschiATT,CCBologna4,200,481,431,434,29
Ange-Yoan BonnyATTInter4,900,001,432,860,00
Fali CandÃ©DFSassuolo4,200,241,430,950,48
Eddy KouadioDFFiorentina0,700,001,431,431,43
Rafael LeÃ£oATTMilan7,000,141,432,430,57
Yunus MusahCCAtalanta0,700,001,434,290,00
Franco VÃ¡zquezATT,CCCremonese4,900,201,433,063,47
Cristian VolpatoATT,CCSassuolo3,500,571,430,294,57
Edon ZhegrovaCCJuventus0,700,001,431,4315,70
Ylber RamadaniCCLecce12,700,241,421,650,47
Domenico BerardiATTSassuolo9,900,201,411,722,42
Pietro ComuzzoDFFiorentina4,300,001,400,230,00
Federico GattiDFJuventus8,600,351,400,700,12
Alessandro ZanoliDFUdinese7,200,001,390,422,64
Michel AebischerCCPisa10,900,181,381,010,64
RaÃºl AlbiolDFPisa2,900,341,380,690,34
Nikola MoroCCBologna5,800,001,381,382,41
Lorenzo PellegriniCCRoma5,800,171,382,765,34
Jakub PiotrowskiCCUdinese5,800,341,380,860,86
Cristiano BiraghiDF,CCTorino5,100,001,371,186,67
Christian KabaseleDFUdinese7,300,141,370,960,00
Francesco CamardaATTLecce4,400,231,360,450,23
Lorenzo De SilvestriDFBologna2,200,451,360,451,36
BenjamÃ­n DomÃ­nguezATTBologna2,200,001,362,730,45
Ruben Loftus-CheekCCMilan4,400,001,361,140,91
Marco PalestraDFCagliari11,000,001,362,823,00
Mariano TroiloDFParma2,200,911,362,270,45
DuvÃ¡n ZapataATTTorino2,200,001,360,910,91
Romano FlorianiDFCremonese5,200,381,350,582,88
MattÃ©o TramoniCC,ATTPisa6,700,151,340,604,03
WesleyDFRoma11,200,271,342,233,93
SaÃºl CocoDFTorino12,000,081,331,420,08
Yerry MinaDFCagliari9,000,111,331,890,00
Jonathan RoweATTBologna3,000,331,332,333,33
Carlos AugustoDFInter5,300,191,320,752,26
Federico DimarcoDFInter10,600,091,320,6610,20
Valentino LazaroDF,CCTorino9,100,111,320,334,73
VitinhaATT,CCGenoa6,800,291,322,794,26
Zito LuvumboATT,CCCagliari2,300,001,305,221,30
Gift OrbanATTHellas Verona9,200,331,300,540,43
Jacobo RamÃ³nDFComo10,000,301,300,100,10
Zeki Ã‡elikDFRoma10,100,101,290,502,57
Youssouf FofanaCCMilan11,600,261,290,600,43
Odilon KossounouDFAtalanta7,000,001,290,430,29
Obite N'DickaDFRoma12,400,241,291,370,08
ZÃ© Pedro FigueiredoDFCagliari3,900,001,281,540,00
Anastasios DouvikasATTComo6,300,001,272,540,00
Gustav IsaksenATTLazio6,300,001,273,331,90
Matteo PratiCCCagliari10,200,391,270,291,18
Medon BerishaCCLecce8,700,001,261,155,98
Oliver JensenCCParma8,700,231,260,920,57
Victor NelssonDFHellas Verona12,700,161,260,390,00
Nahuel EstÃ©vezCCParma4,000,251,251,503,00
Ardian IsmajliDFTorino5,600,361,251,251,25
Nikola KrstoviÄ‡ATTAtalanta5,600,181,250,890,36
Tete MorenteATT,CCLecce8,800,111,251,362,73
Corrie NdabaDF,CCLecce0,800,001,250,001,25
Nicholas PieriniATTSassuolo0,801,251,253,753,75
Boulaye DiaATTLazio8,900,001,240,900,00
Ã‰dersonCCAtalanta7,300,141,231,640,27
Armand LaurienteATTSassuolo8,100,001,231,232,84
MÃ«rgim VojvodaDFComo6,500,311,230,462,77
Arturo CalabresiDFPisa4,100,241,221,950,98
Danilo CataldiCCLazio9,000,221,220,671,22
Maxence CaqueretCC,ATTComo5,800,171,211,902,41
Alessio ZerbinDF,CCCremonese5,800,171,211,031,03
GiovaneATTHellas Verona11,700,171,201,112,22
MathÃ­as OliveraDFNapoli5,000,401,200,600,00
Moise KeanATTFiorentina11,800,171,192,290,25
Leon BaileyATT,CCRoma1,700,001,180,597,06
Diego CarlosDFComo9,400,321,170,210,11
AarÃ³n MartÃ­nDFGenoa9,400,211,171,068,09
Francesco AcerbiDFInter8,600,231,160,930,12
Marc-Oliver KempfDFComo6,900,141,160,720,00
Antonio CaraccioloDFPisa13,000,231,150,380,00
Lucas Da CunhaCCComo8,700,111,150,692,87
Caleb EkubanATTGenoa3,500,001,143,431,14
Danilo VeigaDFLecce10,500,291,141,242,67
Andrea CambiasoDF,CCJuventus9,700,101,130,414,95
Michel Ndary AdopoCCCagliari10,600,001,130,570,47
Marten de RoonCCAtalanta8,000,501,130,250,50
Juan CuadradoDF,CCPisa3,600,561,112,225,00
Charles De KetelaereCC,ATTAtalanta8,100,251,111,603,21
Stefan PoschDFComo2,700,001,111,481,85
MattÃ©o GuendouziCCLazio10,900,371,101,190,73
Luca RanieriDFFiorentina10,900,371,101,281,56
Nikola VlaÅ¡iÄ‡CCTorino10,000,201,101,401,40
Billy GilmourCCNapoli4,600,221,091,300,43
Federico BaschirottoDFCremonese12,000,081,080,170,17
Lassana CoulibalyCCLecce11,100,271,081,260,36
Jay IdzesDFSassuolo12,000,001,080,500,00
Giuseppe PezzellaDFCremonese7,400,271,080,683,24
Guillermo MaripÃ¡nDFTorino11,200,091,070,000,27
Marcus PedersenDFTorino8,400,121,070,244,88
Kamaldeen SulemanaCCAtalanta5,600,361,071,430,89
NicolÃ² FagioliCCFiorentina6,600,301,061,213,03
Saba GoglichidzeDFUdinese4,700,431,060,850,43
Remo FreulerCCBologna7,600,261,051,050,53
Amir RrahmaniDFNapoli5,700,001,051,050,18
Hakan Ã‡alhanoÄŸluCCInter9,600,211,040,635,10
IsmaÃ«l KonÃ©CCSassuolo9,600,311,041,770,10
Fikayo TomoriDFMilan9,600,311,040,310,63
Jamie VardyATTCremonese6,700,301,040,900,60
Christopher NkunkuATTMilan3,900,001,031,790,26
Mario PaÅ¡aliÄ‡CCAtalanta10,700,091,030,280,28
Riccardo SottilATTLecce3,900,001,033,084,10
Gabriele ZappaDFCagliari8,700,231,030,571,26
Pervis EstupiÃ±Ã¡nDFMilan4,900,201,021,020,82
Oumar SoletDFUdinese12,700,001,021,100,31
Santiago GimÃ©nezATTMilan6,900,141,011,450,14
Jari VandeputteCCCremonese8,900,111,011,245,51
Sebastian WalukiewiczDFSassuolo10,900,181,010,281,83
Sam BeukemaDFNapoli6,000,171,000,330,17
Mikael EllertssonDF,ATTGenoa10,000,101,001,300,70
NiccolÃ² FortiniDF,CCFiorentina4,000,001,002,754,75
Albert GrÃ¸nbaekATT,CCGenoa1,001,001,001,001,00
Sebastiano LupertoDFCagliari10,000,101,000,700,00
Luca MarianucciDFNapoli1,000,001,000,000,00
Scott McTominayCCNapoli11,000,001,002,730,27
Riccardo OrsoliniATTBologna9,100,110,991,651,76
Idrissa TourÃ©DFPisa10,100,000,991,392,77
Rafik BelghaliDF,ATTHellas Verona10,300,390,970,392,72
Mandela KeitaCCParma10,400,100,961,540,10
Andre-Frank Zambo AnguissaCCNapoli10,400,100,961,151,44
Josh DoigDFSassuolo9,500,420,951,051,68
Daniel MaldiniCCAtalanta2,100,480,951,901,90
Gianluca ScamaccaATTAtalanta4,200,240,952,140,00
Mattia ZaccagniATTLazio11,600,260,954,142,07
Matteo BianchettiDFCremonese10,600,090,940,750,38
Adam MaruÅ¡iÄ‡DFLazio10,600,090,940,570,66
AngeliÃ±oDF,CCRoma4,300,230,930,473,26
Jacopo FazziniCC,ATTFiorentina4,300,000,932,331,16
Pierre KaluluDFJuventus13,000,000,920,462,23
Mehdi LÃ©risDF,CCPisa6,500,000,921,385,23
DuÅ¡an VlahoviÄ‡ATTJuventus7,600,000,921,970,39
Miguel GutiÃ©rrezDF,CCNapoli3,300,000,911,823,03
NicolÃ² RovellaCCLazio2,200,450,912,733,18
Ademola LookmanATT,CCAtalanta6,700,000,900,752,39
Tarik MuharemovicDFSassuolo10,000,300,901,100,20
Adrien TamezeDF,CCTorino6,700,150,900,751,19
Alessandro MarcandalliDFGenoa5,600,360,890,360,00
NicolÃ² BertolaDFUdinese6,800,290,880,740,15
Robin GosensDFFiorentina8,000,130,881,132,13
Davide FrattesiCCInter2,300,000,872,170,00
Stefano MoreoATT,CCPisa5,800,000,861,031,03
Tiago GabrielDFLecce12,100,080,830,990,08
Cher NdourCCFiorentina3,600,000,831,391,94
Daniele RuganiDFJuventus2,400,000,830,000,00
Manuel AkanjiDFInter11,000,090,820,450,27
Lautaro ValentiDFParma8,500,240,820,591,29
Kenan YÄ±ldÄ±zCC,ATTJuventus11,000,000,821,734,00
Nadir ZorteaDFBologna4,900,000,821,022,24
Arthur AttaCCUdinese12,300,160,811,542,76
Davide BartesaghiDFMilan7,400,140,810,544,73
Federico BonazzoliATTCremonese6,200,000,812,580,32
Jhon LucumÃ­DFBologna8,600,230,810,930,12
Davide ZappacostaDFAtalanta8,600,230,810,703,37
Kristjan AsllaniCCTorino8,800,340,801,024,20
NicolÃ² BarellaCCInter11,300,090,800,804,34
Edin DÅ¾ekoATTFiorentina2,500,400,802,000,40
Gabriele PiccininiCCPisa2,500,800,801,602,00
Kevin De BruyneCCNapoli6,300,160,790,323,97
Matteo PolitanoCC,ATTNapoli8,900,110,791,577,30
ValentÃ­n CastellanosATTLazio5,100,390,781,961,18
Elif ElmasCC,ATTNapoli3,900,260,770,262,56
Matteo GabbiaDFMilan13,000,150,770,310,08
Johan VÃ¡squezDFGenoa13,000,080,770,770,15
Paulo DybalaATT,CCRoma5,300,000,751,707,92
Nicolas-Gerrit KÃ¼hnATTComo4,000,000,750,501,75
Alessandro CircatiDFParma9,400,000,740,640,00
Juan MirandaDFBologna8,100,250,741,235,43
Strahinja PavloviÄ‡DFMilan12,200,080,740,570,57
Jesus RodrÃ­guezATTComo6,800,000,741,322,06
Sascha BritschgiDFParma8,200,240,731,101,46
Lorenzo BernasconiDFAtalanta2,800,000,710,007,86
Jonathan DavidATTJuventus5,600,000,711,430,36
Honest AhanorDFAtalanta5,700,000,701,930,18
Alberto GrassiCCCremonese4,300,470,701,630,00
Jesper KarlstrÃ¶mCCUdinese12,800,160,701,090,39
Dennis JohnsenATT,CCCremonese1,500,000,670,003,33
Devyne RenschDFRoma1,500,000,672,671,33
Hassane KamaraDFUdinese7,600,260,660,794,21
Oliver NielsenDFLazio3,100,000,650,650,32
Stanislav LobotkaCCNapoli7,800,130,642,050,13
Che AdamsATTTorino6,400,000,630,941,09
Michele CollocoloCCCremonese3,200,310,630,631,56
Simone CanestrelliDFPisa13,000,080,620,310,31
KialondaDFLecce13,000,310,621,080,08
Noa LangATT,CCNapoli3,300,610,611,526,06
Thomas KristensenDFUdinese5,000,000,600,600,20
Manuel LazzariDFLazio3,400,290,592,351,76
Nemanja MatiÄ‡CCSassuolo11,900,080,591,260,67
LoÃ¯s OpendaATT,CCJuventus3,400,000,593,532,06
DodÃ´DFFiorentina12,100,170,581,903,97
Mathias LÃ¸vikDFParma5,200,000,580,382,88
Alessio RomagnoliDFLazio10,300,190,580,580,00
Riyad IdrissiDFCagliari3,500,290,570,294,00
Nicola ZalewskiDFAtalanta5,300,000,572,088,11
Patrick CutroneATTParma8,900,000,561,571,35
Berat DjimsitiDFAtalanta10,700,090,560,090,19
Alexis SaelemaekersCCMilan12,500,080,562,082,32
Enrico Del PratoDFParma13,000,230,540,380,38
Adrian BernabeCCParma11,400,000,532,113,07
Gleison BremerDFJuventus3,800,000,530,790,26
Nicolae StanciuCC,ATTGenoa1,900,000,531,054,74
Leonardo SpinazzolaDF,CCNapoli5,900,170,510,174,24
Domagoj BradariÄ‡DF,ATTHellas Verona10,000,100,500,504,10
PedroATTLazio4,100,240,493,413,41
Mario GilaDFLazio12,500,080,480,960,08
Luka ModriÄ‡CCMilan12,700,160,471,023,94
Samuele AngoriDFPisa6,600,000,451,675,15
Mikayil Ngor FayeDF,ATTCremonese2,300,430,431,301,74
Christian PulisicATT,CCMilan4,700,000,431,492,55
Fabiano ParisiDFFiorentina2,400,830,422,921,67
Christ-Owen KouassiDFLecce2,500,000,401,200,80
Fisayo Dele-BashiruCCLazio2,600,000,380,000,00
Filippo TerraccianoDFCremonese10,900,180,371,011,19
Samuele RicciCCMilan5,700,180,351,750,35
Andrea PinamontiATTSassuolo11,900,080,341,180,59
Stefano SabelliDFGenoa2,900,000,341,721,03
Emanuele ValeriDFParma6,600,000,301,069,09
MatÃ¬as SoulÃ©ATTRoma10,300,000,292,144,08
Antonino GalloDFLecce12,300,080,240,493,50
Raoul BellanovaDFAtalanta9,300,000,110,656,13
Vanja MilinkoviÄ‡-SaviÄ‡PORNapoli9,000,000,110,110,00
Marco CarnesecchiPORAtalanta13,000,000,080,150,00
Nicola LealiPORGenoa13,000,080,080,150,00
Junior AjayiATTHellas Verona0,000,000,000,000,00
Emil AuderoPORCremonese8,000,000,000,380,00
Martin BaturinaATT,CCComo1,900,000,002,114,74
TjaÅ¡ BegiÄ‡DFParma0,000,000,000,000,00
Daniel BolocaCCSassuolo1,500,000,000,670,67
Louis BuffonATTPisa0,200,000,005,000,00
Jean ButezPORComo13,000,000,000,380,00
Elia CaprilePORCagliari13,000,080,000,460,00
Samuel ChukwuezeATTMilan0,300,000,0010,0010,00
Edoardo CorviPORParma2,000,000,000,500,00
Ben CremaschiCCParma0,200,000,000,000,00
Matteo DarmianDFInter0,200,000,000,005,00
Ali DembÃ©lÃ©DFTorino0,100,000,000,000,00
Michele Di GregorioPORJuventus11,000,090,000,270,00
Alessandro Di PardoDFCagliari0,600,000,000,000,00
Andy DioufCCInter0,600,000,001,673,33
Wladimiro FalconePORLecce13,000,080,000,150,00
David de GeaPORFiorentina13,000,000,000,230,00
Andrea GhionATT,CCSassuolo0,100,000,000,0010,00
Edoardo GoldanigaDFComo0,000,000,000,000,00
NicolÃ¡s GonzÃ¡lezCC,DFJuventus0,200,000,0015,000,00
Luis HenriqueDFInter3,100,000,000,001,29
Elseid HysajDFLazio1,700,000,000,591,18
Emirhan Ä°lkhanCCTorino0,600,000,003,330,00
Ciro ImmobileATTBologna0,300,000,000,000,00
Franco IsraelPORTorino8,000,130,000,380,00
Ãlex JimÃ©nezDFMilan0,502,000,002,002,00
ÃžÃ³rir JÃ³hann HelgasonCCLecce0,900,000,000,003,33
Sead KolaÅ¡inacDFAtalanta0,000,000,000,000,00
Tariq LampteyCC,DFFiorentina0,300,000,000,003,33
Dachi LordkipanidzeCCCremonese0,300,000,000,000,00
LorranCC,DFPisa0,200,000,000,005,00
Mike MaignanPORMilan11,600,000,000,170,00
Josep MartinezPORInter2,000,000,000,000,00
Pasquale MazzocchiCCNapoli0,200,000,000,000,00
Alex MeretPORNapoli4,000,000,000,250,00
Rui ModestoCC,DFUdinese0,500,000,000,004,00
Lorenzo MontipÃ²PORHellas Verona13,000,000,000,150,00
Arijanet MuricPORSassuolo12,000,170,000,170,00
Cheveyo MuyATTMilan0,100,000,000,000,00
Niels NkounkouDF,CCTorino3,000,330,000,674,33
David OkerekeATTCremonese0,900,000,000,000,00
Maduka OkoyePORUdinese7,000,000,000,000,00
Jacob OndrejkaCC,ATTParma0,500,000,000,004,00
Daniel OyegokeCC,DFHellas Verona0,200,000,000,005,00
Alberto PaleariPORTorino5,000,000,000,000,00
Faris Pemi MoumbagnaATTCremonese0,200,000,000,000,00
Mattia PerinPORJuventus2,000,000,000,000,00
Massimo PessinaPORBologna0,900,000,000,000,00
Balthazar PierretCCLecce0,300,000,006,670,00
NiccolÃ² PisilliCCRoma0,600,000,000,001,67
Ivan ProvedelPORLazio13,000,000,000,150,00
Federico RavagliaPORBologna2,000,000,000,500,00
Filippo RomagnaDFSassuolo2,200,000,000,450,00
Yellu SantiagoCCHellas Verona0,100,000,0010,000,00
Jeremy SarmientoCC,ATTCremonese1,600,000,000,631,25
Razvan SavaPORUdinese6,000,170,000,000,00
Simone ScuffetPORPisa1,000,000,000,000,00
Adrian Å emperPORPisa12,000,000,000,080,00
Marco SilvestriPORCremonese4,000,000,000,000,00
Åukasz SkorupskiPORBologna9,100,110,000,330,00
Yann SommerPORInter11,000,000,000,090,00
Calvin StengsCCPisa0,100,000,0020,0030,00
Ibrahim SulemanaCCBologna0,100,000,000,000,00
Zion SuzukiPORParma11,000,090,000,180,00
Mile SvilarPORRoma13,000,000,000,230,00
Pietro TerraccianoPORMilan1,400,000,000,000,00
Stefano TuratiPORSassuolo1,000,000,000,000,00
Antonio VergaraCCNapoli0,000,000,000,000,00
Stefan de VrijDFInter2,000,000,000,000,00
Piotr ZieliÅ„skiCCInter3,000,000,000,671,00
`;

const playersPassingRawData = `
Player pass completati pass tentati % pass completati tiri tot tiri in porta tiri tot /90 tiri porta /90 distanza media tiri
Patric 130,00 170,00 76,5% 0 0 0,00 0,00 0,00
Calvin Stengs 130,00 180,00 72,2% 2 1 13,85 6,92 23,70
Luca Marianucci 100,00 102,00 98,0% 1 0 1,00 0,00 30,80
Ardon Jashari 95,00 100,00 95,0% 1 0 5,29 0,00 27,80
Amir Richardson 90,00 120,00 75,0% 1 0 7,50 0,00 17,50
NicolÃ² Rovella 90,00 99,10 90,8% 1 0 0,45 0,00 30,20
Fabio Miretti 86,00 98,00 87,8% 1 0 1,96 0,00 16,00
Hakan Ã‡alhanoÄŸlu 74,90 86,50 86,6% 26 6 2,72 0,63 28,10
Juan Jesus 71,70 77,60 92,4% 2 0 0,29 0,00 7,30
Manuel Locatelli 70,60 80,30 87,9% 15 4 1,44 0,38 22,90
Alessandro Bastoni 69,60 81,70 85,2% 11 3 0,95 0,26 13,30
Manuel Akanji 68,50 75,40 90,8% 7 0 0,64 0,00 18,30
Billy Gilmour 68,30 77,00 88,7% 5 1 1,09 0,22 20,10
Amir Rrahmani 67,00 73,20 91,5% 3 0 0,53 0,00 11,70
Sergi Roberto 65,00 72,00 90,3% 5 1 2,45 0,49 19,30
Luka ModriÄ‡ 64,60 74,20 87,1% 8 4 0,63 0,31 24,80
Sam Beukema 63,70 68,30 93,3% 4 2 0,67 0,33 13,20
MÃ¡ximo Perrone 63,50 69,50 91,4% 4 2 0,38 0,19 11,60
Lewis Ferguson 62,50 70,20 89,0% 4 1 0,67 0,17 20,10
Stefan de Vrij 62,50 66,50 94,0% 1 0 0,50 0,00 9,50
Yann Aurel Bisseck 62,40 67,90 91,9% 5 2 1,54 0,61 10,40
Jacobo RamÃ³n 62,00 67,80 91,4% 13 2 1,30 0,20 14,90
Francesco Acerbi 60,30 63,50 95,0% 3 1 0,35 0,12 8,00
NiccolÃ² Pisilli 60,00 68,30 87,8% 1 1 1,80 1,80 7,00
Ã‰derson 59,90 66,00 90,8% 8 3 1,10 0,41 17,60
Giorgio Scalvini 59,40 69,10 86,0% 2 1 0,62 0,31 12,40
Stanislav Lobotka 59,40 64,60 92,0% 0 0 0,00 0,00 0,00
Pierre Kalulu 59,20 68,40 86,5% 7 1 0,54 0,08 13,10
Marten de Roon 58,80 67,00 87,8% 10 3 1,24 0,37 20,70
Jhon LucumÃ­ 58,60 65,60 89,3% 3 1 0,35 0,12 7,20
Diego Carlos 58,10 62,80 92,5% 1 0 0,11 0,00 36,20
MatÃ­as Vecino 57,70 62,30 92,6% 2 0 0,77 0,00 23,70
Lorenzo Venturino 57,50 80,00 71,9% 1 1 2,25 2,25 31,20
Maxence Caqueret 57,20 65,90 86,8% 5 1 0,86 0,17 21,30
NicolÃ² Barella 57,10 69,60 82,0% 14 1 1,24 0,09 19,30
Alessio Romagnoli 57,10 61,30 93,1% 1 0 0,10 0,00 11,90
Mario PaÅ¡aliÄ‡ 56,40 63,70 88,5% 9 4 0,84 0,37 14,20
Nikola Moro 56,20 66,90 84,0% 4 1 0,69 0,17 27,60
Mario Gila 56,20 62,40 90,1% 7 2 0,56 0,16 10,00
Lloyd Kelly 56,00 63,00 88,9% 7 2 0,64 0,18 18,10
Lucas Da Cunha 55,70 63,30 88,0% 10 5 1,15 0,57 24,10
Nuno Tavares 55,60 68,50 81,2% 6 0 1,16 0,00 23,40
Marc-Oliver Kempf 55,40 62,20 89,1% 6 3 0,87 0,43 11,60
Almoatasem Al Musrati 55,00 63,30 86,9% 1 0 0,81 0,00 20,40
Berat Djimsiti 54,50 61,60 88,5% 6 0 0,56 0,00 9,10
Kevin De Bruyne 54,30 65,90 82,4% 13 4 2,07 0,64 25,60
Daniele Rugani 54,20 59,60 90,9% 0 0 0,00 0,00 0,00
Fikayo Tomori 53,40 60,90 87,7% 5 1 0,52 0,10 16,30
Giovanni Di Lorenzo 53,20 64,30 82,7% 12 6 0,92 0,46 11,10
Oumar Solet 53,20 60,90 87,4% 11 1 0,87 0,08 22,50
RaÃºl Albiol 53,10 60,00 88,5% 0 0 0,00 0,00 0,00
Teun Koopmeiners 53,00 60,60 87,5% 13 3 1,51 0,35 21,20
Strahinja PavloviÄ‡ 53,00 59,20 89,5% 7 3 0,57 0,25 9,70
Leo Skiri Ã˜stigÃ¥rd 52,40 59,10 88,7% 11 6 1,05 0,57 9,10
Oliver Nielsen 52,30 56,80 92,1% 0 0 0,00 0,00 0,00
Obite N'Dicka 52,20 57,70 90,5% 9 0 0,73 0,00 11,40
Lorenzo Bernasconi 52,10 65,00 80,2% 4 0 1,41 0,00 19,80
Alessandro Buongiorno 52,00 57,70 90,1% 3 1 0,36 0,12 6,80
Odilon Kossounou 52,00 56,00 92,9% 3 1 0,43 0,14 21,00
Adam MaruÅ¡iÄ‡ 51,80 59,70 86,8% 4 2 0,38 0,19 18,00
Andy Diouf 51,70 61,70 83,8% 1 1 1,55 1,55 28,40
Alberto Moreno 51,50 60,00 85,8% 4 2 1,46 0,73 19,20
Edon Zhegrova 51,40 78,60 65,4% 4 1 5,90 1,48 22,70
Isak Hien 51,10 56,30 90,8% 3 0 0,27 0,00 8,30
Stefan Posch 51,10 65,60 77,9% 3 2 1,11 0,74 17,20
Andrea Cambiaso 51,00 59,90 85,1% 7 3 0,72 0,31 17,10
Mario Hermoso 50,40 59,50 84,7% 6 3 0,72 0,36 12,50
Koni De Winter 50,30 59,50 84,5% 2 0 0,52 0,00 19,10
Federico Gatti 50,30 55,60 90,5% 10 4 1,16 0,46 12,90
NicolÃ² Fagioli 50,20 58,00 86,6% 2 0 0,30 0,00 27,90
Abdelhamid Sabiri 50,00 76,70 65,2% 1 0 3,33 0,00 32,80
Emirhan Ä°lkhan 50,00 55,00 90,9% 0 0 0,00 0,00 0,00
Ibrahim Sulemana 50,00 60,00 83,3% 0 0 0,00 0,00 0,00
Gabriele Zappa 49,80 59,50 83,7% 2 0 0,23 0,00 17,00
ZÃ© Pedro Figueiredo 49,70 56,90 87,3% 0 0 0,00 0,00 0,00
KhÃ©phren Thuram 49,10 55,80 88,0% 17 6 1,86 0,66 18,20
Ãlex Valle 49,00 58,60 83,6% 5 0 0,53 0,00 16,90
Bryan Cristante 49,00 60,70 80,7% 21 5 1,75 0,42 13,90
Johan VÃ¡squez 48,80 57,50 84,9% 15 3 1,15 0,23 17,90
MathÃ­as Olivera 48,60 56,20 86,5% 3 1 0,60 0,20 5,90
Marin PongraÄiÄ‡ 48,50 54,30 89,3% 5 0 0,42 0,00 15,20
Piotr ZieliÅ„ski 48,30 55,00 87,8% 6 2 2,01 0,67 22,70
Filippo Terracciano 48,20 58,50 82,4% 6 2 0,55 0,18 11,20
Filippo Romagna 47,30 54,50 86,8% 1 0 0,45 0,00 24,90
Nemanja MatiÄ‡ 47,20 56,60 83,4% 5 4 0,42 0,34 20,10
Ivan SmolÄiÄ‡ 46,80 55,60 84,2% 4 0 0,55 0,00 11,70
Remo Freuler 46,60 55,30 84,3% 2 0 0,26 0,00 25,70
Charalampos Lykogiannis 46,20 63,80 72,4% 4 1 1,02 0,25 21,90
Luca Pellegrini 46,10 59,20 77,9% 4 2 0,79 0,40 18,60
Matteo Gabbia 46,00 49,80 92,4% 8 1 0,62 0,08 9,30
Ãlex JimÃ©nez 46,00 50,00 92,0% 0 0 0,00 0,00 0,00
Sandi LovriÄ‡ 45,80 58,30 78,6% 1 0 0,87 0,00 14,90
Honest Ahanor 45,80 50,70 90,3% 5 0 0,87 0,00 9,30
Juan Miranda 45,20 61,60 73,4% 4 2 0,50 0,25 17,70
Lorran 45,00 60,00 75,0% 1 1 4,09 4,09 7,20
Daniel Oyegoke 45,00 75,00 60,0% 1 0 4,74 0,00 18,90
Manu KonÃ© 44,80 49,20 91,1% 8 1 0,62 0,08 20,10
Thomas Kristensen 44,80 51,00 87,8% 3 1 0,60 0,20 14,10
Luis Henrique 44,80 51,00 87,8% 4 0 1,28 0,00 19,80
Carlos Augusto 44,70 53,60 83,4% 8 3 1,51 0,57 12,90
Gianluca Mancini 44,60 52,00 85,8% 8 3 0,62 0,23 13,30
Miguel GutiÃ©rrez 44,50 53,90 82,6% 3 1 0,92 0,31 21,40
Gleison Bremer 44,50 52,10 85,4% 4 1 1,04 0,26 15,30
Davide Zappacosta 44,40 53,40 83,1% 16 3 1,86 0,35 19,90
Matteo Bianchetti 44,20 53,80 82,2% 3 0 0,28 0,00 10,50
Henrikh Mkhitaryan 44,10 53,00 83,2% 11 2 2,05 0,37 18,80
Zeki Ã‡elik 43,80 54,50 80,4% 12 2 1,19 0,20 18,60
Tarik Muharemovic 43,80 52,40 83,6% 6 1 0,60 0,10 18,40
Joseph Liteta 43,60 52,70 82,7% 0 0 0,00 0,00 0,00
Abdoulaye Niakhate Ndiaye 43,60 53,10 82,1% 4 0 0,73 0,00 20,30
Enzo Ebosse 43,30 50,00 86,6% 0 0 0,00 0,00 0,00
TorbjÃ¸rn Heggem 43,20 47,50 90,9% 4 1 0,40 0,10 10,30
Martin VitÃ­k 43,00 51,80 83,0% 2 0 0,50 0,00 7,10
Luca Mazzitelli 42,90 55,70 77,0% 0 0 0,00 0,00 0,00
MattÃ©o Guendouzi 42,90 48,80 87,9% 12 6 1,10 0,55 21,50
Luca Ranieri 42,70 52,50 81,3% 7 2 0,64 0,18 13,80
AngeliÃ±o 42,60 56,70 75,1% 4 2 0,93 0,47 13,10
Petar Sucic 42,50 49,60 85,7% 9 3 1,20 0,40 20,40
Pablo MarÃ­ 42,50 46,50 91,4% 1 0 0,13 0,00 19,40
Nadir Zortea 42,40 53,50 79,3% 5 0 1,03 0,00 27,30
Mariano Troilo 42,30 48,60 87,0% 0 0 0,00 0,00 0,00
Neil El Aynaoui 42,20 47,60 88,7% 3 2 0,73 0,48 26,00
Kristjan Asllani 42,00 53,10 79,1% 13 1 1,48 0,11 29,70
Filip KostiÄ‡ 41,80 56,80 73,6% 4 3 1,05 0,79 22,10
Michel Aebischer 41,30 48,50 85,2% 5 0 0,46 0,00 25,60
Yerry Mina 41,30 46,70 88,4% 4 2 0,45 0,22 14,40
Pervis EstupiÃ±Ã¡n 41,20 49,40 83,4% 5 0 1,02 0,00 23,40
Jamil Siebert 41,10 42,20 97,4% 0 0 0,00 0,00 0,00
Leonardo Spinazzola 40,70 53,40 76,2% 7 4 1,18 0,67 24,30
Adrien Rabiot 40,50 46,30 87,5% 6 0 1,00 0,00 19,50
Lazar Samardzic 40,20 52,70 76,3% 8 3 1,53 0,57 20,80
Andre-Frank Zambo Anguissa 40,20 48,60 82,7% 19 8 1,83 0,77 13,50
Pedro 40,20 48,30 83,2% 8 1 1,96 0,24 22,40
Jean Onana 40,00 70,00 57,1% 0 0 0,00 0,00 0,00
Luca Lipani 40,00 51,50 77,7% 0 0 0,00 0,00 0,00
Zachary Athekame 40,00 50,80 78,7% 2 1 1,61 0,80 27,70
Samuel Chukwueze 40,00 53,30 75,0% 0 0 0,00 0,00 0,00
Yellu Santiago 40,00 70,00 57,1% 2 1 30,00 15,00 32,70
Federico Dimarco 39,80 54,30 73,3% 21 7 1,98 0,66 19,10
Toma BaÅ¡iÄ‡ 39,60 46,80 84,6% 15 7 2,01 0,94 26,40
Wesley 39,60 50,40 78,6% 13 7 1,16 0,62 17,90
Federico Baschirotto 39,60 45,50 87,0% 7 4 0,58 0,33 11,30
Alessandro Circati 39,60 46,70 84,8% 1 1 0,11 0,11 7,70
Hans Nicolussi Caviglia 39,50 51,70 76,4% 4 1 0,63 0,16 26,50
MÃ«rgim Vojvoda 39,50 48,90 80,8% 10 5 1,53 0,76 17,80
Federico Ravaglia 39,50 53,50 73,8% 0 0 0,00 0,00 0,00
Danilo Cataldi 39,40 49,40 79,8% 8 1 0,89 0,11 27,20
Adam Obert 39,30 48,40 81,2% 1 0 0,10 0,00 15,30
Alexis Saelemaekers 39,20 48,60 80,7% 20 6 1,60 0,48 17,80
Fabiano Parisi 39,20 46,30 84,7% 3 0 1,23 0,00 22,30
Sebastiano Luperto 39,10 43,70 89,5% 3 2 0,30 0,20 11,80
Samuele Ricci 39,10 43,00 90,9% 9 4 1,57 0,70 21,80
Edoardo Iannoni 38,90 46,70 83,3% 2 1 2,25 1,13 7,80
Raoul Bellanova 38,70 47,50 81,5% 9 2 0,97 0,22 16,50
Vasilije AdÅ¾iÄ‡ 38,60 50,00 77,2% 5 4 3,57 2,86 26,30
Ruslan Malinovskyi 38,50 47,70 80,7% 18 4 2,09 0,46 26,60
Sebastian Walukiewicz 38,50 46,30 83,2% 1 0 0,09 0,00 29,30
AarÃ³n MartÃ­n 38,30 54,00 70,9% 4 3 0,42 0,32 26,50
Tiago Gabriel 38,30 42,70 89,7% 9 2 0,74 0,16 10,90
Ignace Van Der Brempt 38,20 44,50 85,8% 0 0 0,00 0,00 0,00
Jay Idzes 38,20 42,00 91,0% 1 0 0,08 0,00 28,20
Elseid Hysaj 38,20 48,80 78,3% 0 0 0,00 0,00 0,00
Emil Holm 38,10 49,80 76,5% 2 1 0,42 0,21 11,30
Alberto Grassi 38,10 45,30 84,1% 1 1 0,23 0,23 21,60
Manuel Lazzari 37,90 46,50 81,5% 0 0 0,00 0,00 0,00
Marco Brescianini 37,80 46,10 82,0% 2 1 1,13 0,57 17,40
NicolÃ¡s Paz 37,70 48,00 78,5% 45 19 3,52 1,49 24,60
Woyo Coulibaly 37,60 42,70 88,1% 2 1 0,61 0,31 20,70
Federico Bernardeschi 37,60 46,20 81,4% 11 4 2,65 0,96 21,00
Jan ZiÃ³Å‚kowski 37,50 50,80 73,8% 0 0 0,00 0,00 0,00
Mattia Viti 37,50 45,50 82,4% 0 0 0,00 0,00 0,00
Corrie Ndaba 37,50 41,30 90,8% 0 0 0,00 0,00 0,00
Pietro Comuzzo 37,40 42,80 87,4% 3 0 0,69 0,00 17,00
NicolÃ² Bertola 37,40 46,30 80,8% 2 1 0,30 0,15 17,00
Martin Baturina 37,40 45,30 82,6% 2 1 1,06 0,53 17,40
Lorenzo Pellegrini 37,20 53,10 70,1% 13 6 2,23 1,03 19,60
Stephan El Shaarawy 37,00 47,00 78,7% 6 3 2,95 1,48 20,70
Roberto Gagliardini 37,00 48,70 76,0% 3 1 0,36 0,12 10,30
JoÃ£o MÃ¡rio Lopes 37,00 48,50 76,3% 2 0 0,75 0,00 17,30
Ivan IliÄ‡ 36,80 44,30 83,1% 0 0 0,00 0,00 0,00
SaÃºl Coco 36,80 41,50 88,7% 8 3 0,67 0,25 12,40
Balthazar Pierret 36,70 53,30 68,9% 0 0 0,00 0,00 0,00
Åukasz Skorupski 36,70 46,50 78,9% 0 0 0,00 0,00 0,00
Weston McKennie 36,20 44,00 82,3% 13 3 1,58 0,37 12,30
Simone Scuffet 36,00 45,00 80,0% 0 0 0,00 0,00 0,00
Ylber Ramadani 35,90 44,60 80,5% 8 1 0,63 0,08 26,30
Simon Sohm 35,80 40,80 87,7% 3 0 0,48 0,00 21,10
Davide Bartesaghi 35,80 44,90 79,7% 6 2 0,81 0,27 24,30
Daniel Boloca 35,30 38,00 92,9% 2 0 1,33 0,00 21,80
Unai NÃºÃ±ez 34,90 45,00 77,6% 5 0 0,60 0,00 12,20
Adrian Bernabe 34,80 44,40 78,4% 23 6 2,01 0,52 22,90
Paulo Dybala 34,70 47,00 73,8% 16 7 3,01 1,32 21,40
Hassane Kamara 34,60 45,30 76,4% 11 3 1,44 0,39 24,30
Jari Vandeputte 34,50 48,30 71,4% 9 4 1,01 0,45 20,80
Charles De Ketelaere 34,40 44,30 77,7% 16 7 1,98 0,86 16,90
Jeremy Sarmiento 34,40 38,80 88,7% 2 2 1,27 1,27 31,30
Gianluca Gaetano 34,30 46,50 73,8% 13 5 2,85 1,09 24,10
Josh Doig 34,30 43,60 78,7% 3 2 0,32 0,21 25,70
Kostas Tsimikas 34,20 49,50 69,1% 1 0 0,53 0,00 21,20
Alessandro Deiola 33,90 41,40 81,9% 3 2 0,45 0,30 13,10
MatÃ¬as SoulÃ© 33,90 43,40 78,1% 25 9 2,42 0,87 21,50
Brooke Norton-Cuffy 33,80 43,50 77,7% 4 0 0,33 0,00 13,50
Valentino Lazaro 33,80 43,70 77,3% 1 0 0,11 0,00 17,30
Kialonda 33,80 39,80 84,9% 8 0 0,62 0,00 8,60
Fisayo Dele-Bashiru 33,80 36,50 92,6% 1 0 0,38 0,00 16,70
Antonino Gallo 33,70 50,20 67,1% 2 1 0,16 0,08 12,20
Matteo Palma 33,60 41,80 80,4% 0 0 0,00 0,00 0,00
Ardian Ismajli 33,60 40,90 82,2% 1 0 0,18 0,00 16,10
Warren Bondo 33,40 37,40 89,3% 3 0 0,32 0,00 26,80
Riyad Idrissi 33,40 46,30 72,1% 2 2 0,57 0,57 9,90
Christian Pulisic 33,20 39,10 84,9% 11 8 2,35 1,71 16,00
Jean Butez 33,10 39,60 83,6% 0 0 0,00 0,00 0,00
Edoardo Corvi 33,00 41,50 79,5% 0 0 0,00 0,00 0,00
Yunus Musah 32,90 41,40 79,5% 1 0 1,50 0,00 4,40
Guillermo MaripÃ¡n 32,90 38,20 86,1% 9 5 0,80 0,45 11,70
Christ-Owen Kouassi 32,80 42,80 76,6% 0 0 0,00 0,00 0,00
Francisco ConceiÃ§Ã£o 32,70 40,10 81,5% 22 6 2,96 0,81 17,30
Medon Berisha 32,60 44,10 73,9% 21 4 2,41 0,46 28,20
Federico Ceccherini 32,50 39,20 82,9% 0 0 0,00 0,00 0,00
Adrien Tameze 32,50 41,60 78,1% 2 0 0,30 0,00 10,60
Reda Belahyane 32,40 37,10 87,3% 0 0 0,00 0,00 0,00
Danilo Veiga 32,40 43,50 74,5% 2 1 0,19 0,10 9,60
Stefano Sabelli 32,40 49,30 65,7% 0 0 0,00 0,00 0,00
Yann Sommer 32,40 37,30 86,9% 0 0 0,00 0,00 0,00
Saba Goglichidze 32,30 40,00 80,8% 3 1 0,64 0,21 7,70
Noa Lang 32,10 46,40 69,2% 4 3 1,21 0,91 16,00
Youssef Maleh 32,00 44,00 72,7% 0 0 0,00 0,00 0,00
Kristian Thorstvedt 32,00 41,10 77,9% 15 3 1,99 0,40 13,80
Alessandro Marcandalli 32,00 39,80 80,4% 2 1 0,36 0,18 9,60
Kenan YÄ±ldÄ±z 31,90 40,50 78,8% 28 12 2,54 1,09 19,80
Nicola Zalewski 31,70 48,10 65,9% 7 1 1,33 0,19 20,70
Adam Masina 31,60 38,00 83,2% 0 0 0,00 0,00 0,00
Nicolae Stanciu 31,60 46,30 68,3% 4 0 2,09 0,00 18,10
Fali CandÃ© 31,40 39,80 78,9% 3 0 0,72 0,00 23,20
Juan Cuadrado 31,40 41,70 75,3% 5 1 1,38 0,28 26,80
Enrico Del Prato 31,40 38,40 81,8% 12 7 0,92 0,54 10,00
NiccolÃ² Fortini 31,30 40,00 78,3% 4 1 1,01 0,25 25,50
Cristiano Biraghi 31,00 43,90 70,6% 2 0 0,39 0,00 21,10
Mikayil Ngor Faye 30,90 40,40 76,5% 2 0 0,89 0,00 20,30
Ãlex Sala 30,80 35,80 86,0% 3 1 2,48 0,83 23,20
Antonio Caracciolo 30,70 37,20 82,5% 9 2 0,69 0,15 15,80
Matteo Politano 30,70 43,40 70,7% 24 4 2,70 0,45 19,50
Jesper KarlstrÃ¶m 30,70 39,10 78,5% 10 2 0,78 0,16 18,00
Devyne Rensch 30,70 46,70 65,7% 1 1 0,68 0,68 5,70
Oier Zarraga 30,50 36,00 84,7% 1 0 0,49 0,00 27,50
IsmaÃ«l KonÃ© 30,10 33,50 89,9% 6 1 0,63 0,10 22,10
Emil Audero 30,10 46,90 64,2% 0 0 0,00 0,00 0,00
Daniele Ghilardi 30,00 30,00 100,0% 0 0 0,00 0,00 0,00
Armel Bella Kotchap 30,00 37,10 80,9% 1 0 0,18 0,00 14,90
Ali DembÃ©lÃ© 30,00 70,00 42,9% 1 0 6,92 0,00 12,40
Alessandro Di Pardo 30,00 40,00 75,0% 1 0 1,70 0,00 8,40
Rolando Mandragora 29,80 39,90 74,7% 19 6 1,79 0,57 22,60
Ruben Loftus-Cheek 29,80 35,70 83,5% 13 2 2,97 0,46 10,20
Arturo Calabresi 29,80 37,60 79,3% 2 1 0,49 0,24 21,40
Mateus Lusuardi 29,50 36,40 81,0% 4 0 1,82 0,00 13,60
Simone Canestrelli 29,30 36,70 79,8% 4 1 0,31 0,08 8,90
Malthe Hojholt 29,20 35,80 81,6% 0 0 0,00 0,00 0,00
DodÃ´ 29,20 40,80 71,6% 14 1 1,16 0,08 18,20
Vanja MilinkoviÄ‡-SaviÄ‡ 29,20 42,70 68,4% 0 0 0,00 0,00 0,00
Mike Maignan 29,20 38,20 76,4% 0 0 0,00 0,00 0,00
Tommaso Baldanzi 29,10 35,20 82,7% 8 3 2,41 0,90 18,40
Lorenzo De Silvestri 29,10 37,70 77,2% 0 0 0,00 0,00 0,00
Youssouf Fofana 29,00 34,30 84,5% 22 8 1,90 0,69 19,20
Patrizio Masini 28,90 39,60 73,0% 10 2 1,05 0,21 18,30
NicolÃ² Casale 28,80 38,20 75,4% 0 0 0,00 0,00 0,00
Franco VÃ¡zquez 28,80 39,40 73,1% 11 4 2,24 0,81 20,20
Alessandro Zanoli 28,80 37,10 77,6% 0 0 0,00 0,00 0,00
Arthur Atta 28,80 37,10 77,6% 25 9 2,04 0,73 21,50
Juan David Cabal 28,60 35,70 80,1% 2 1 2,86 1,43 18,70
Cristian Volpato 28,60 38,90 73,5% 6 1 1,74 0,29 15,40
Martin Frese 28,50 43,20 66,0% 11 4 1,09 0,40 19,70
Mile Svilar 28,40 38,10 74,5% 0 0 0,00 0,00 0,00
Elif Elmas 28,20 35,40 79,7% 8 3 2,05 0,77 17,80
Marco Carnesecchi 28,20 37,20 75,8% 0 0 0,00 0,00 0,00
Jordan Zemura 28,00 40,90 68,5% 2 0 0,37 0,00 24,00
Matteo Prati 28,00 36,10 77,6% 13 0 1,28 0,00 24,10
Lautaro Valenti 28,00 41,80 67,0% 5 2 0,59 0,23 30,30
Tijjani Noslin 27,80 33,30 83,5% 3 3 3,21 3,21 12,30
Cheikh Niasse 27,70 35,40 78,2% 1 0 0,39 0,00 13,40
Mattia Zaccagni 27,70 35,60 77,8% 19 7 1,64 0,61 12,40
Valentin Carboni 27,50 36,30 75,8% 6 2 1,51 0,50 17,80
Francesco Folino 27,50 37,50 73,3% 1 1 2,81 2,81 8,00
Nikola VlaÅ¡iÄ‡ 27,50 34,00 80,9% 10 3 1,00 0,30 20,50
Josep Martinez 27,50 35,50 77,5% 0 0 0,00 0,00 0,00
Niels Nkounkou 27,30 37,00 73,8% 2 0 0,67 0,00 18,80
Cesare Casadei 27,10 35,00 77,4% 18 6 1,51 0,50 15,30
Mandela Keita 27,10 31,80 85,2% 5 1 0,48 0,10 28,70
Morten Frendrup 26,90 33,30 80,8% 3 1 0,26 0,09 17,20
David Neres 26,70 36,10 74,0% 13 4 2,02 0,62 22,10
Tariq Lamptey 26,70 36,70 72,8% 0 0 0,00 0,00 0,00
Michele Collocolo 26,60 33,10 80,4% 1 1 0,32 0,32 32,70
Marcus Pedersen 26,50 37,90 69,9% 4 2 0,48 0,24 12,30
Zion Suzuki 26,40 40,60 65,0% 0 0 0,00 0,00 0,00
Aster Vranckx 26,30 32,40 81,2% 2 0 0,40 0,00 27,00
Mohamed Kaba 26,30 36,80 71,5% 4 2 2,08 1,04 16,60
Jonathan Rowe 26,30 32,00 82,2% 9 2 3,03 0,67 20,70
Ivan Provedel 26,10 35,60 73,3% 0 0 0,00 0,00 0,00
Denzel Dumfries 26,00 35,30 73,7% 9 3 1,13 0,38 11,80
Christian Kabasele 26,00 29,60 87,8% 2 1 0,27 0,14 8,60
Robin Gosens 25,90 37,40 69,3% 6 1 0,75 0,12 7,80
Maduka Okoye 25,90 38,30 67,6% 0 0 0,00 0,00 0,00
Victor Nelsson 25,80 30,30 85,1% 1 0 0,08 0,00 10,60
Michele Di Gregorio 25,70 31,50 81,6% 0 0 0,00 0,00 0,00
Rafik Belghali 25,60 34,00 75,3% 8 3 0,78 0,29 14,50
Jakub Piotrowski 25,50 31,00 82,3% 10 2 1,71 0,34 19,60
Scott McTominay 25,50 30,30 84,2% 28 13 2,54 1,18 18,20
Marco Palestra 25,10 32,60 77,0% 4 1 0,36 0,09 19,70
Michel Ndary Adopo 25,10 30,80 81,5% 7 3 0,66 0,28 15,10
Grigoris Kastanos 25,00 55,00 45,5% 1 0 4,50 0,00 16,50
Assane Diao 25,00 34,60 72,3% 2 0 0,77 0,00 29,20
Cher Ndour 25,00 35,00 71,4% 1 0 0,28 0,00 22,80
Domenico Berardi 24,50 33,10 74,0% 16 8 1,61 0,81 20,00
Alessio Zerbin 24,50 33,80 72,5% 6 2 1,04 0,35 16,80
Alex Meret 24,50 27,50 89,1% 0 0 0,00 0,00 0,00
Nahuel EstÃ©vez 24,30 38,50 63,1% 5 0 1,26 0,00 18,00
Marco Silvestri 24,30 39,30 61,8% 0 0 0,00 0,00 0,00
Ebenezer Akinsanmiro 24,10 28,80 83,7% 10 3 1,20 0,36 24,20
Leon Bailey 24,10 34,70 69,5% 1 0 0,57 0,00 4,60
Kamaldeen Sulemana 23,90 29,10 82,1% 8 3 1,44 0,54 15,00
Abdou Harroui 23,80 33,80 70,4% 3 1 1,89 0,63 25,40
Antoine Bernede 23,80 33,30 71,5% 6 1 0,59 0,10 21,50
Daniel Maldini 23,80 33,80 70,4% 7 2 3,33 0,95 23,50
Domagoj BradariÄ‡ 23,80 34,20 69,6% 5 3 0,50 0,30 16,10
Arijanet Muric 23,80 35,40 67,2% 0 0 0,00 0,00 0,00
Kingsley Ehizibue 23,70 33,70 70,3% 1 0 0,17 0,00 13,70
Daniel Denoon 23,60 28,60 82,5% 0 0 0,00 0,00 0,00
Pietro Terracciano 23,60 25,70 91,8% 0 0 0,00 0,00 0,00
Albert GuÃ°mundsson 23,50 27,40 85,8% 3 0 0,43 0,00 23,00
Fallou Cham 23,30 36,30 64,2% 5 2 2,10 0,84 14,20
David de Gea 23,20 33,70 68,8% 0 0 0,00 0,00 0,00
Elia Caprile 23,10 33,10 69,8% 0 0 0,00 0,00 0,00
Eddy Kouadio 22,90 30,00 76,3% 0 0 0,00 0,00 0,00
Mehdi LÃ©ris 22,90 33,40 68,6% 7 1 1,08 0,15 13,70
Mathias LÃ¸vik 22,90 31,30 73,2% 3 0 0,57 0,00 17,80
Franco Israel 22,90 36,00 63,6% 0 0 0,00 0,00 0,00
Edin DÅ¾eko 22,80 31,20 73,1% 4 1 1,62 0,41 11,30
Federico Bonazzoli 22,60 28,90 78,2% 16 8 2,57 1,29 18,20
Giovanni Bonfanti 22,50 37,20 60,5% 5 1 1,39 0,28 14,50
Armand Lauriente 22,50 28,60 78,7% 21 6 2,61 0,74 21,40
Razvan Sava 22,50 28,70 78,4% 0 0 0,00 0,00 0,00
Gustav Isaksen 22,20 28,70 77,4% 16 6 2,56 0,96 17,70
Tete Morente 22,20 32,20 68,9% 14 2 1,58 0,23 18,70
Alberto Paleari 22,20 33,60 66,1% 0 0 0,00 0,00 0,00
Massimo Pessina 22,20 35,60 62,4% 0 0 0,00 0,00 0,00
Jacopo Fazzini 22,10 29,50 74,9% 7 1 1,64 0,23 23,00
Ademola Lookman 22,10 28,70 77,0% 19 5 2,84 0,75 16,80
Nicolas-Gerrit KÃ¼hn 22,00 30,30 72,6% 4 2 1,00 0,50 13,60
MartÃ­n Payero 21,80 30,50 71,5% 5 0 0,81 0,00 28,00
Suat Serdar 21,80 31,10 70,1% 17 5 2,02 0,59 18,30
Adrian Å emper 21,60 33,90 63,7% 0 0 0,00 0,00 0,00
Tommaso Barbieri 21,50 32,00 67,2% 6 1 1,09 0,18 19,00
Faustino Anjorin 21,40 37,10 57,7% 1 0 1,36 0,00 16,50
Giuseppe Pezzella 21,40 31,20 68,6% 3 0 0,41 0,00 15,90
Hernani 21,30 32,50 65,5% 1 0 1,23 0,00 21,90
Nicholas Pierini 21,30 28,80 74,0% 2 0 2,61 0,00 21,50
Jonathan David 21,30 26,80 79,5% 11 4 1,96 0,71 10,30
Tommaso Pobega 20,90 26,80 78,0% 7 4 1,49 0,85 19,40
Oliver Jensen 20,90 26,70 78,3% 8 2 0,91 0,23 18,30
Christopher Nkunku 20,80 22,80 91,2% 5 2 1,29 0,52 12,20
Riccardo Sottil 20,80 28,70 72,5% 4 2 1,04 0,52 27,50
Alieu Fadera 20,60 27,00 76,3% 7 2 1,50 0,43 17,70
Konan N'dri 20,60 30,00 68,7% 6 3 3,29 1,65 21,50
Vakoun Bayo 20,60 26,90 76,6% 11 1 3,43 0,31 13,30
Sascha Britschgi 20,60 29,60 69,6% 6 1 0,73 0,12 21,00
Emanuele Valeri 20,60 38,00 54,2% 7 0 1,06 0,00 28,10
Jesus RodrÃ­guez 20,40 29,00 70,3% 15 5 2,21 0,74 16,70
Lassana Coulibaly 20,10 25,90 77,6% 6 4 0,54 0,36 12,70
Maxwel Cornet 20,00 35,00 57,1% 2 1 2,40 1,20 15,00
Junior Messias 20,00 27,30 73,3% 2 0 1,86 0,00 13,10
Sebastiano Esposito 20,00 30,10 66,4% 16 3 1,67 0,31 19,80
Gianluca Scamacca 20,00 27,10 73,8% 23 8 5,46 1,90 17,50
NicolÃ¡s GonzÃ¡lez 20,00 45,00 44,4% 2 0 9,47 0,00 17,90
Pasquale Mazzocchi 20,00 25,00 80,0% 0 0 0,00 0,00 0,00
Jacob Ondrejka 20,00 28,00 71,4% 3 1 6,00 2,00 15,10
Matteo Cancellieri 19,80 26,30 75,3% 11 5 2,41 1,10 15,60
LoÃ¯s Openda 19,70 29,40 67,0% 13 2 3,84 0,59 17,00
Ãlvaro Morata 19,60 26,10 75,1% 14 4 2,09 0,60 13,90
Rafael LeÃ£o 19,60 25,90 75,7% 18 8 2,58 1,15 20,20
Nikola KrstoviÄ‡ 19,50 25,00 78,0% 29 8 5,18 1,43 14,50
Mattia Perin 19,50 19,50 100,0% 0 0 0,00 0,00 0,00
Idrissa TourÃ© 19,30 31,20 61,9% 13 3 1,29 0,30 11,40
NicolÃ² Cambiaghi 19,00 24,10 78,8% 13 4 1,88 0,58 16,10
Marius Marin 18,90 27,10 69,7% 0 0 0,00 0,00 0,00
ÃžÃ³rir JÃ³hann Helgason 18,90 23,30 81,1% 1 1 1,10 1,10 21,60
Gvidas Gineitis 18,70 29,40 63,6% 1 0 0,32 0,00 30,60
Mattia Felici 18,70 30,00 62,3% 9 6 1,97 1,31 16,30
Amin Sarr 18,70 26,30 71,1% 6 2 1,56 0,52 16,80
Thijs Dallinga 18,60 25,50 72,9% 9 2 2,17 0,48 12,70
Samuele Angori 18,50 30,20 61,3% 1 0 0,15 0,00 33,10
Gabriele Piccinini 18,40 25,20 73,0% 3 1 1,19 0,40 17,10
Lautaro MartÃ­nez 18,30 24,30 75,3% 42 10 3,90 0,93 12,30
Romano Floriani 18,30 26,50 69,1% 2 0 0,38 0,00 21,50
Lameck Banda 18,10 23,60 76,7% 7 4 1,32 0,75 19,30
Boulaye Dia 18,10 22,20 81,5% 8 4 0,90 0,45 11,00
Jurgen Ekkelenkamp 18,00 25,70 70,0% 5 3 0,92 0,55 24,70
Che Adams 18,00 24,20 74,4% 21 8 3,29 1,25 21,30
Rui Modesto 18,00 24,00 75,0% 0 0 0,00 0,00 0,00
Walid Cheddira 17,80 25,60 69,5% 6 2 6,84 2,28 16,50
Giovanni Fabbian 17,70 22,10 80,1% 8 0 1,68 0,00 13,40
Mikael Ellertsson 17,70 24,70 71,7% 12 5 1,19 0,50 16,80
Ä°sak Vural 17,60 22,80 77,2% 1 0 0,34 0,00 12,10
Evan Ferguson 17,60 22,10 79,6% 11 4 2,61 0,95 16,30
NicolÃ¡s Valentini 17,40 26,20 66,4% 3 2 0,63 0,42 18,70
NicolÃ² Zaniolo 17,30 24,00 72,1% 24 9 3,10 1,16 21,10
BenjamÃ­n DomÃ­nguez 17,30 22,30 77,6% 4 0 1,84 0,00 16,80
Marcus Thuram 17,20 23,30 73,8% 22 8 3,61 1,31 12,00
Nicola Leali 17,20 26,20 65,6% 0 0 0,00 0,00 0,00
Francesco Esposito 16,80 24,60 68,3% 13 4 3,19 0,98 11,10
Cyril Ngonge 16,70 24,50 68,2% 16 8 1,96 0,98 19,20
Ange-Yoan Bonny 16,70 21,20 78,8% 9 4 1,85 0,82 12,50
Dachi Lordkipanidze 16,70 23,30 71,7% 0 0 0,00 0,00 0,00
Jayden Addai 16,50 24,00 68,8% 11 6 1,94 1,06 17,70
Santiago Pierotti 16,40 23,20 70,7% 10 3 1,30 0,39 15,20
Luca Moro 16,00 18,00 88,9% 2 0 4,00 0,00 11,80
Morten Thorsby 16,00 25,30 63,2% 8 2 1,52 0,38 11,20
Iker Bravo 15,80 21,60 73,1% 3 1 1,56 0,52 20,80
Michael Folorunsho 15,80 24,40 64,8% 15 2 1,27 0,17 17,70
Lorenzo MontipÃ² 15,80 30,00 52,7% 0 0 0,00 0,00 0,00
Pontus Almqvist 15,40 20,50 75,1% 1 0 0,26 0,00 16,80
Jean-Daniel Akpa-Akpro 15,30 22,00 69,5% 4 1 0,73 0,18 17,00
Giovane 15,30 24,90 61,4% 33 18 2,82 1,54 20,00
Wladimiro Falcone 15,10 30,60 49,3% 0 0 0,00 0,00 0,00
Riccardo Orsolini 14,60 24,50 59,6% 28 11 3,08 1,21 20,50
Rasmus HÃ¸jlund 14,50 18,90 76,7% 7 4 0,95 0,55 14,40
Leonardo Pavoletti 14,40 27,80 51,8% 2 0 2,14 0,00 9,90
Vitinha 14,00 23,10 60,6% 16 4 2,37 0,59 17,90
Albert GrÃ¸nbaek 14,00 18,00 77,8% 0 0 0,00 0,00 0,00
Giovanni Simeone 13,90 18,80 73,9% 27 9 3,24 1,08 17,80
Semih KÄ±lÄ±Ã§soy 13,80 20,00 69,0% 0 0 0,00 0,00 0,00
Jens Odgaard 13,60 18,40 73,9% 10 4 1,80 0,72 19,20
MattÃ©o Tramoni 13,60 21,80 62,4% 13 3 1,95 0,45 19,70
Christian OrdoÃ±ez 13,50 18,50 73,0% 2 1 0,50 0,25 12,70
Artem Dovbyk 13,30 18,90 70,4% 9 4 2,48 1,10 9,50
Ciro Immobile 13,30 30,00 44,3% 0 0 0,00 0,00 0,00
DuvÃ¡n Zapata 13,20 19,10 69,1% 7 2 3,18 0,91 18,10
Anastasios Douvikas 13,20 17,10 77,2% 15 8 2,39 1,28 12,80
Stefano Moreo 13,10 22,60 58,0% 10 3 1,72 0,52 12,80
Davide Frattesi 13,00 17,80 73,0% 7 3 3,07 1,32 14,90
Lorenzo Colombo 12,70 19,10 66,5% 22 7 2,80 0,89 15,90
M'Bala Nzola 12,70 16,30 77,9% 18 3 1,90 0,32 16,70
Adrian Benedyczak 12,50 22,10 56,6% 4 0 1,66 0,00 12,90
Keinan Davis 12,40 16,20 76,5% 18 8 2,36 1,05 14,30
ValentÃ­n Castellanos 12,40 20,00 62,0% 13 5 2,56 0,98 16,60
Lennon Miller 12,20 20,00 61,0% 2 1 2,34 1,17 20,00
Gaetano Oristanio 12,20 16,70 73,1% 4 0 2,25 0,00 14,30
Sebastian Otoa 12,00 14,00 85,7% 0 0 0,00 0,00 0,00
Dennis Johnsen 12,00 28,70 41,8% 1 0 0,67 0,00 31,70
Patrick Cutrone 12,00 19,70 60,9% 23 7 2,59 0,79 15,50
Zakaria Aboukhlal 11,70 18,30 63,9% 2 2 1,09 1,09 13,10
Zito Luvumbo 11,70 15,70 74,5% 7 4 3,01 1,72 18,50
DuÅ¡an VlahoviÄ‡ 11,70 17,20 68,0% 29 10 3,84 1,32 16,30
Lorenzo Lucca 11,20 14,30 78,3% 12 5 2,83 1,18 14,00
Caleb Ekuban 11,10 18,30 60,7% 11 3 3,13 0,85 14,60
Andrea Belotti 11,00 14,80 74,3% 5 3 2,39 1,44 12,20
Andrea Pinamonti 11,00 16,80 65,5% 32 16 2,68 1,34 14,20
Nikola Å tuliÄ‡ 10,80 16,80 64,3% 11 3 1,27 0,35 18,80
Antonio Sanabria 10,70 13,00 82,3% 3 1 0,70 0,23 5,70
Jeff Ekhator 10,60 19,40 54,6% 8 2 2,35 0,59 14,00
Daniel Mosquera 10,50 18,60 56,5% 5 3 2,34 1,41 13,70
Gennaro Borrelli 10,50 15,30 68,6% 13 5 1,77 0,68 12,70
Santiago GimÃ©nez 10,30 13,00 79,2% 21 6 3,04 0,87 11,80
NicolÃ² Cavuoti 10,00 10,00 100,0% 0 0 0,00 0,00 0,00
Adam Buksa 10,00 16,90 59,2% 6 3 1,24 0,62 14,30
Andrea Ghion 10,00 20,00 50,0% 0 0 0,00 0,00 0,00
Stefano Turati 10,00 26,00 38,5% 0 0 0,00 0,00 0,00
Santiago Castro 9,61 13,90 69,1% 16 7 2,12 0,93 15,00
Gift Orban 9,24 15,00 61,6% 35 12 3,81 1,31 18,70
Mateo Pellegrino 8,69 15,60 55,7% 21 8 1,72 0,65 17,00
Francesco Camarda 8,41 12,00 70,1% 7 2 1,59 0,45 16,40
Milan ÄuriÄ‡ 8,33 31,70 26,3% 3 0 5,09 0,00 9,00
Roberto Piccoli 7,29 13,60 53,6% 16 7 2,71 1,19 14,40
Jamie Vardy 7,16 12,70 56,4% 7 4 1,04 0,60 14,10
Moise Kean 6,02 8,98 67,0% 47 10 3,97 0,84 15,30
David Okereke 5,56 10,00 55,6% 0 0 0,00 0,00 0,00
Idrissa GuÃ¨ye 5,00 10,00 50,0% 0 0 0,00 0,00 0,00
Alieu Njie 5,00 15,00 33,3% 1 1 5,29 5,29 11,70
Manuel De Luca 5,00 25,00 20,0% 1 1 5,63 5,63 31,60
Henrik Meister 5,00 8,82 56,7% 10 3 1,46 0,44 11,40
Ben Cremaschi 5,00 5,00 100,0% 0 0 0,00 0,00 0,00
Matteo Darmian 5,00 20,00 25,0% 0 0 0,00 0,00 0,00
Giuseppe Ambrosino 2,50 10,00 25,0% 0 0 0,00 0,00 0,00
Sead KolaÅ¡inac 2,00 2,00 100,0% 0 0 0,00 0,00 0,00
Antonio Vergara 2,00 2,00 100,0% 0 0 0,00 0,00 0,00
Junior Ajayi 1,00 1,00 100,0% 0 0 0,00 0,00 0,00
TjaÅ¡ BegiÄ‡ 0,00 1,00 0,0% 0 0 0,00 0,00 0,00
Louis Buffon 0,00 5,00 0,0% 0 0 0,00 0,00 0,00
Edoardo Goldaniga 0,00 1,00 0,0% 0 0 0,00 0,00 0,00
Cheveyo Muy 0,00 10,00 0,0% 1 0 18,00 0,00 13,70
Faris Pemi Moumbagna 0,00 10,00 0,0% 1 0 6,00 0,00 11,70
`;

let playersData = [];
let playersPassingData = [];
let playersPassingIndex = new Map();
let playersMinMatches = 0;
let playersMaxMatches = 0;
let playersSortColumn = 'name';
let playersSortDirection = 'asc';
const PLAYER_ROLES = ['POR', 'DF', 'CC', 'ATT'];
let selectedPlayerRoles = new Set(PLAYER_ROLES);
let selectedTeams = new Set(['all']);
let playersStatMode = 'per90';
let playerTeams = [];
let excludeLowPresencePlayers = true;
let playerComparisonSelections = { first: '', second: '' };

        // --- DATA SECTION (Empty as requested) ---
        const MATCHES_DB_2425 = `Genoa-Inter	103,10	46,39	45,0%	29
Parma-Fiorentina	97,04	48,46	49,9%	24
Empoli-Monza	100,37	44,43	44,3%	35
Milan-Torino	101,58	58,27	57,4%	17
Bologna-Udinese	100,25	48,59	48,5%	28
Verona-Napoli	101,32	48,53	47,9%	28
Cagliari-Roma	94,22	53,36	56,6%	22
Lazio-Venezia	96,00	56,00	58,3%	25
Lecce-Atalanta	92,58	54,12	58,5%	34
Juventus-Como	99,04	56,43	57,0%	23
Parma-Milan	98,04	59,00	60,2%	22
Udinese-Lazio	103,14	49,49	48,0%	25
Inter-Lecce	98,08	56,21	57,3%	21
Monza-Genoa	105,55	56,58	53,6%	23
Torino-Atalanta	103,21	51,08	49,5%	25
Fiorentina-Venezia	97,03	55,29	57,0%	34
Napoli-Bologna	101,09	53,23	52,7%	28
Roma-Empoli	97,20	58,22	59,9%	21
Cagliari-Como	100,35	53,12	52,9%	22
Verona-Juventus	97,02	61,58	63,5%	16
Venezia-Torino	99,08	52,45	52,9%	22
Inter-Atalanta 	97,01	53,40	55,0%	21
Bologna-Empoli 	103,12	55,44	53,8%	33
Lecce-Cagliari	100,37	47,36	47,2%	23
Lazio-Milan	97,00	54,06	55,7%	21
Napoli-Parma	109,08	60,21	55,2%	18
Fiorentina-Monza	103,20	54,53	52,8%	32
Genoa-Verona	99,33	51,32	51,7%	24
Juventus-Roma	96,58	58,50	60,6%	23
Udinese-Como	103,30	54,24	52,5%	25
Como-Bologna	103,14	54,03	52,4%	29
Empoli-Juventus	95,14	60,04	63,1%	21
Milan-Venezia	97,55	57,21	58,6%	24
Genoa-Roma	104,11	53,12	51,0%	21
Atalanta-Fiorentina	95,42	51,04	53,5%	31
Torino-Lecce	95,10	54,31	57,1%	26
Cagliari-Napoli	102,10	50,07	49,0%	33
Monza-Inter	95,18	57,28	60,2%	30
Parma-Udinese	96,05	53,01	55,2%	26
Lazio-Verona	96,07	56,25	58,6%	23
Cagliari-Empoli	97,05	48,44	49,9%	36
Verona-Torino	97,05	60,20	62,0%	18
Venezia-Genoa	100,20	48,20	48,1%	21
Juventus-Napoli	96,26	64,10	66,6%	23
Lecce-Parma	98,37	54,32	55,2%	33
Fiorentina-Lazio	97,15	52,35	53,9%	26
Monza-Bologna	95,05	55,34	58,2%	36
Roma-Udinese	95,00	55,33	58,2%	26
Inter-Milan	97,50	55,33	56,7%	17
Atalanta-Como	98,35	58,21	59,2%	29
Milan-Lecce	96,02	55,41	57,7%	13
Udinese-Inter	98,00	61,58	62,8%	19
Genoa-Juventus	95,10	58,44	61,5%	22
Bologna-Atalanta	97,44	57,29	58,8%	28
Torino-Lazio	96,10	57,06	59,4%	23
Como-Verona	96,57	49,47	51,2%	29
Roma-Venezia	96,08	52,36	54,5%	21
Empoli-Fiorentina	94,11	54,28	57,7%	27
Napoli-Monza	95,57	60,33	63,1%	24
Parma-Cagliari	95,58	55,21	57,8%	26
Napoli-Como	96,28	59,25	61,5%	17
Verona-Venezia	95,02	47,29	49,8%	15	
Udinese-Lecce	95,50	55,10	57,7%	28
Atalanta-Genoa	95,55	55,41	58,0%	24
Inter-Torino	98,30	54,09	55,0%	15
Juventus-Cagliari	99,01	60,08	60,7%	23
Bologna-Parma	95,58	54,55	57,1%	31
Lazio-Empoli	100,48	53,07	52,8%	27
Monza-Roma	99,08	56,25	56,8%	29
Fiorentina-Milan	97,26	48,43	49,8%	33
Como-Parma	96,09	60,51	63,0%	24
Genoa-Bologna	95,51	47,58	49,8%	32
Milan-Udinese	106,27	52,59	49,5%	17
Juventus-Lazio	97,31	56,44	58,0%	25
Empoli-Napoli	96,05	51,43	53,5%	27
Lecce-Fiorentina	93,03	53,12	57,1%	22
Venezia-Atalanta	94,10	54,15	57,5%	18
Cagliari-Torino	96,35	52,53	54,5%	17
Roma-Inter	97,00	59,00	60,8%	25
Verona-Monza	94,00	54,17	57,6%	21
Udinese-Cagliari	94,51	54,38	57,5%	22
Torino-Como	97,40	55,42	56,9%	25
Napoli-Lecce	96,27	52,02	54,0%	20
Bologna-Milan	96,21	53,33	55,4%	28
Atalanta-Verona	91,25	58,27	63,9%	18
Parma-Empoli	95,45	55,33	58,0%	29
Lazio-Genoa	96,07	57,36	59,7%	18
Monza-Venezia	95,57	49,01	51,3%	33
Inter-Juventus	95,12	52,00	54,7%	27
Fiorentina-Roma	94,27	55,39	58,8%	24	
Cagliari-Bologna	94,25	55,29	58,7%	35
Lecce-Verona	98,15	49,06	50,0%	35
Milan-Napoli	96,55	60,55	62,7%	20
Empoli-Inter	96,01	55,51	57,8%	25
Venezia-Udinese	97,22	49,10	50,5%	21
Atalanta-Monza	96,20	57,39	59,7%	25
Juventus-Parma	95,30	61,18	64,2%	12
Genoa-Fiorentina	98,09	52,02	53,0%	23
Como-Lazio	97,44	50,20	51,5%	32
Roma-Torino	95,15	59,29	62,3%	26
Bologna-Lecce	95,25	50,36	52,9%	23
Udinese-Juventus	96,07	55,50	57,8%	26
Monza-Milan	98,17	56,22	57,3%	33
Napoli-Atalanta	96,00	62,27	64,9%	18
Torino-Fiorentina	97,17	59,23	61,0%	28
Verona-Roma	97,43	53,58	55,0%	27
Inter-Venezia	99,15	55,55	56,0%	29
Empoli-Como	96,10	54,05	56,2%	26
Parma-Genoa	97,16	51,42	52,9%	23
Lazio-Cagliari	96,13	54,05	56,2%	29
Genoa-Como	98,16	50,21	51,2%	32
Lecce-Empoli	97,00	51,23	52,8%	31
Venezia-Parma	95,15	57,06	60,0%	19
Cagliari-Milan	100,14	54,30	54,2%	18
Juventus-Torino	95,06	55,08	57,9%	21
Atalanta-Udinese	98,40	51,34	52,2%	22
Fiorentina-Verona	96,53	46,44	48,1%	20
Roma-Bologna	98,55	49,51	50,2%	37
Monza-Lazio	97,01	56,45	58,2%	23
Inter-Napoli	95,15	56,03	58,9%	27
Verona-Inter	93,00	65,30	70,2%	19
Milan-Juventus	95,40	59,45	62,3%	21
Parma-Atalanta	95,40	66,25	69,4%	14
Genoa-Cagliari	98,00	53,26	54,3%	18
Como-Fiorentina	97,00	55,23	56,9%	26
Torino-Monza	93,12	57,26	61,5%	30
Napoli-Roma	93,51	58,44	62,5%	17
Lazio-Bologna	94,57	55,30	58,5%	28
Empoli-Udinese	95,22	58,51	61,4%	21
Venezia-Lecce	96,01	56,21	58,5%	28
Cagliari-Verona	95,29	50,46	53,0%	22
Como-Monza	96,30	51,14	53,1%	27
Milan-Empoli	95,43	54,43	57,0%	28
Bologna-Venezia	96,14	49,35	51,3%	29
Udinese-Genoa	97,10	57,46	59,2%	24
Parma-Lazio	103,52	55,40	53,5%	30
Torino-Napoli	94,42	59,16	62,7%	24
Fiorentina-Inter	101,09	53,53	53,0%	21
Lecce-Juventus	95,05	62,25	65,5%	17
Roma-Atalanta	95,03	55,10	58,0%	30
Inter-Parma	95,00	55,37	58,3%	11
Atalanta-Milan	97,25	59,24	60,9%	27
Genoa-Torino	96,34	56,35	58,5%	27
Juventus-Bologna	98,03	52,19	53,2%	32
Roma-Lecce	97,28	55,05	56,6%	19
Fiorentina-Cagliari	96,03	53,17	55,4%	29
Verona-Empoli	97,20	54,48	56,0%	31
Venezia-Como	95,28	44,33	46,5%	22
Napoli-Lazio	98,45	58,47	59,4%	28
Monza-Udinese	97,10	53,45	55,0%	28
Empoli-Torino	95,04	49,22	51,8%	22
Cagliari-Atalanta	96,30	57,31	59,5%	26
Udinese-Napoli	97,00	51,56	53,2%	22
Juventus-Venezia	98,50	59,57	60,5%	17
Lecce-Monza	99,07	47,00	47,4%	31
Bologna-Fiorentina	96,02	48,30	50,3%	26
Parma-Verona	95,56	54,08	56,6%	21
Como-Roma	98,32	52,56	53,5%	35
Milan-Genoa	96,57	61,42	63,6%	23
Lazio-Inter	99,10	55,11	55,6%	21
Verona-Milan	99,21	54,44	54,9%	30
Torino-Bologna	101,15	56,57	55,9%	28
Genoa-Napoli	97,03	57,55	59,3%	16
Lecce-Lazio	100,19	56,47	56,4%	25
Roma-Parma	91,06	55,55	61,0%	19
Venezia-Cagliari	96,33	49,18	51,1%	17
Atalanta-Empoli	98,00	54,38	55,5%	26
Monza-Juventus	96,32	61,14	63,5%	20
Fiorentina-Udinese	100,55	53,21	52,9%	24
Inter-Como	94,10	52,23	55,5%	28
Empoli-Genoa	98,00	51,47	52,5%	29
Parma-Monza	100,00	48,53	48,5%	37
Cagliari-Inter	95,15	52,18	54,8%	19
Lazio-Atalanta	96,05	58,07	60,5%	17
Udinese-Torino	97,09	54,20	55,8%	29
Napoli-Venezia	95,30	54,07	56,7%	22
Juventus-Fiorentina	97,05	51,51	53,1%	23
Milan-Roma	96,05	51,06	53,2%	25
Como-Lecce	96,37	52,23	54,2%	27
Bologna-Verona	97,39	46,47	47,7%	33
Venezia-Empoli	94,56	51,16	54,1%	29
Fiorentina-Napoli	95,50	49,34	51,7%	32
Verona-Udinese	96,00	50,49	52,6%	30
Monza-Cagliari	99,18	48,31	48,7%	35
Lecce-Genoa	94,12	54,20	57,6%	26
Torino-Parma	97,10	59,17	60,9%	18
Roma-Lazio	97,15	53,25	54,8%	30
Como-Milan	95,10	50,49	53,1%	28
Atalanta-Juventus	97,45	64,13	65,8%	17
Inter-Bologna	96,05	52,32	54,5%	32
Lazio-Como	95,03	47,58	50,1%	29
Empoli-Lecce	98,34	49,09	49,9%	33
Udinese-Atalanta	97,38	58,41	60,0%	20
Torino-Juventus	96,58	60,08	62,2%	27
Milan-Cagliari	96,38	56,05	58,2%	20
Genoa-Parma	96,37	52,11	54,1%	20
Venezia-Inter	95,18	55,10	57,9%	33
Bologna-Roma	98,34	54,11	55,0%	28
Napoli-Verona	93,00	62,26	66,9%	11
Monza-Fiorentina	97,05	60,55	62,4%	35
Roma-Genoa	96,00	58,40	60,8%	24
Bologna-Monza	97,41	59,30	60,9%	34
Juventus-Milan	95,14	56,11	59,0%	30
Atalanta-Napoli	95,06	57,43	60,4%	27
Fiorentina-Torino	96,47	56,28	58,3%	27
Cagliari-Lecce	95,56	51,45	53,8%	21
Parma-Venezia	97,07	50,03	51,5%	29
Verona-Lazio	94,55	55,10	58,3%	18
Inter-Empoli	95,18	57,07	60,0%	20
Como-Udinese	95,57	51,13	53,5%	26
Torino-Cagliari	95,20	57,17	60,1%	21
Como-Atalanta	97,39	56,26	57,8%	25
Napoli-Juventus	97,37	54,14	55,6%	24
Empoli-Bologna	98,56	46,31	47,0%	38
Milan-Parma	99,11	52,02	52,5%	21
Udinese-Roma	99,57	56,19	56,4%	27
Lecce-Inter	93,56	57,11	61,0%	25
Lazio-Fiorentina	100,15	53,46	53,4%	21
Venezia-Verona	96,56	49,18	50,9%	30
Genoa-Monza	97,00	41,34	42,6%	32
Parma-Lecce	97,15	56,49	58,1%	22
Monza-Verona	95,47	53,12	55,6%	35
Udinese-Venezia	97,41	42,22	43,3%	29
Atalanta-Torino	101,01	63,01	62,4%	17
Bologna-Como	96,40	50,12	52,0%	34
Juventus-Empoli	95,12	45,47	47,8%	27
Fiorentina-Genoa	96,09	47,18	49,1%	31
Milan-Inter	98,05	58,36	59,5%	14
Roma-Napoli	96,44	57,50	59,6%	22
Cagliari-Lazio	96,15	55,09	57,3%	23
Como-Juventus	96,52	50,13	51,9%	30
Verona-Atalanta	93,51	56,03	59,9%	16
Empoli-Milan	98,38	48,47	49,3%	27
Torino-Genoa	98,42	57,33	58,3%	21
Venezia-Roma	95,45	53,23	55,8%	34
Cagliari-Parma	96,34	52,57	54,6%	26
Lazio-Monza	94,15	55,49	58,9%	22
Lecce-Bologna	100,17	52,43	52,3%	30
Napoli-Udinese	97,20	57,54	59,2%	21
Inter-Fiorentina	96,10	54,37	56,6%	31
Bologna-Torino	95,32	46,59	48,9%	24
Atalanta-Cagliari	95,19	64,30	67,5%	18
Lazio-Napoli	94,58	55,22	58,4%	28
Milan-Verona	96,20	49,24	51,2%	29
Fiorentina-Como	98,16	58,37	59,5%	38
Monza-Lecce	95,57	56,57	59,2%	28
Udinese-Empoli	95,06	52,19	54,9%	29
Parma-Roma	97,39	58,43	60,0%	16
Juventus-Inter	94,24	55,49	58,9%	27
Genoa-Venezia	93,59	45,50	48,6%	29
Lecce-Udinese	97,16	54,09	55,7%	26
Parma-Bologna	97,04	52,14	53,7%	27
Venezia-Lazio	96,59	56,03	58,0%	33
Torino-Milan	95,15	55,53	58,4%	19
Inter-Genoa	96,44	58,04	60,2%	21
Como-Napoli	96,45	52,35	54,3%	31
Verona-Fiorentina	98,57	51,57	52,3%	27
Empoli-Atalanta	94,57	51,29	54,2%	21
Cagliari-Juventus	96,00	60,44	63,0%	24
Roma-Monza	93,11	61,54	66,1%	13
Fiorentina-Lecce	98,25	54,37	55,3%	22
Atalanta-Venezia	96,53	59,11	61,2%	26
Napoli-Inter	99,30	52,11	52,5%	22
Udinese-Parma	97,32	57,58	59,2%	22
Monza-Torino	93,56	56,28	60,2%	30
Bologna-Cagliari	96,19	51,33	53,4%	39
Genoa-Empoli	96,53	47,28	49,0%	30
Roma-Como	94,57	61,34	64,9%	24
Milan-Lazio	101,13	57,54	56,9%	20
Juventus-Verona	97,43	55,31	56,8%	22
Cagliari-Genoa	96,07	50,53	52,6%	31
Como-Venezia	96,12	51,43	53,5%	25
Parma-Torino	96,32	46,27	48,0%	31
Lecce-Milan	99,34	52,03	52,4%	20
Inter-Monza	98,52	57,48	58,3%	15
Verona-Bologna	96,23	56,41	58,6%	34
Napoli-Fiorentina	96,52	59,57	61,7%	15
Empoli-Roma	96,05	60,45	62,9%	22
Juventus-Atalanta	94,15	57,31	60,9%	23
Lazio-Udinese	97,05	59,55	61,4%	20
Genoa-Lecce	98,10	51,18	52,2%	22
Monza-Parma	94,56	56,25	59,5%	30
Udinese-Verona	94,02	56,15	59,7%	37
Milan-Como	99,27	51,46	51,8%	28
Torino-Empoli	100,23	46,00	45,9%	21
Venezia-Napoli	100,02	48,55	48,5%	27
Bologna-Lazio	94,55	54,15	57,3%	34
Roma-Cagliari	99,22	60,28	60,8%	16
Fiorentina-Juventus	93,14	52,43	56,3%	22
Atalanta-Inter	103,06	54,31	52,7%	25
Como-Empoli	96,34	52,17	54,2%	27
Venezia-Bologna	95,58	53,24	55,7%	35
Juventus-Genoa	94,56	54,24	57,4%	24
Lecce-Roma	97,25	51,33	52,8%	17
Cagliari-Monza	95,57	50,35	52,7%	28
Fiorentina-Atalanta	97,34	55,08	56,6%	23
Inter-Udinese	98,25	55,26	56,2%	22
Napoli-Milan	97,10	59,08	60,8%	15
Verona-Parma	96,29	51,46	53,4%	20
Lazio-Torino	97,50	54,35	55,7%	29
Genoa-Udinese	96,33	54,22	56,3%	30
Monza-Como	95,52	58,00	60,7%	40
Parma-Inter	97,28	57,35	59,0%	16
Milan-Fiorentina	99,07	53,20	53,7%	24
Lecce-Venezia	95,06	44,36	46,7%	24
Empoli-Cagliari	95,00	45,56	48,0%	24
Torino-Verona	96,20	52,10	54,2%	28
Atalanta-Lazio	98,36	60,27	61,3%	12
Roma-Juventus	94,26	61,47	65,2%	26
Bologna-Napoli	98,46	51,14	51,9%	29
Udinese-Milan	96,01	57,21	59,6%	19
Venezia-Monza	100,45	45,52	45,3%	40
Inter-Cagliari	95,55	61,00	63,8%	18
Juventus-Lecce	96,28	55,04	57,2%	17
Atalanta-Bologna	100,02	52,31	52,3%	29
Fiorentina-Parma	95,10	59,22	62,3%	29
Verona-Genoa	96,18	46,55	48,4%	30
Como-Torino	97,30	55,02	56,5%	25
Lazio-Roma	96,24	49,34	51,3%	24
Napoli-Empoli	94,02	54,09	57,5%	23
Lecce-Como	100,53	46,22	46,0%	32
Monza-Napoli	94,19	56,00	59,5%	29
Roma-Verona	93,58	54,09	57,8%	22
Empoli-Venezia	95,32	44,36	46,5%	33
Bologna-Inter	98,55	50,02	50,8%	33
Milan-Atalanta	95,50	62,56	65,5%	15
Torino-Udinese	95,07	53,25	56,0%	24
Cagliari-Fiorentina	100,56	53,48	53,2%	30
Genoa-Lazio	102,15	55,47	54,3%	26
Parma-Juventus	100,20	58,32	58,2%	19
Atalanta-Lecce	99,02	56,54	57,1%	18
Como-Genoa	96,15	54,58	56,8%	34
Venezia-Milan	98,56	52,47	53,2%	27
Fiorentina-Empoli	99,14	48,14	48,6%	34
Inter-Roma	97,22	58,15	59,8%	20
Juventus-Monza	97,00	55,31	57,0%	22
Napoli-Torino	97,54	58,59	60,1%	18
Udinese-Bologna	95,52	47,37	49,6%	31
Verona-Cagliari	97,01	51,05	52,6%	23
Lazio-Parma	98,08	60,08	61,3%	23
Torino-Venezia	100,00	53,17	53,2%	25
Cagliari-Udinese	97,49	55,29	56,7%	20
Parma-Como	96,02	50,20	52,3%	30
Lecce-Napoli	105,14	58,14	55,3%	15
Inter-Verona	95,25	61,36	64,4%	17
Empoli-Lazio	98,03	55,18	56,3%	24
Monza-Atalanta	94,45	57,35	60,7%	19
Roma-Fiorentina	101,34	63,43	62,6%	17
Bologna-Juventus	98,06	45,42	46,3%	25
Genoa-Milan	98,17	52,54	53,5%	26
Milan-Bologna	97,45	56,48	58,0%	19
Como-Cagliari	100,35	54,24	54,1%	24
Lazio-Juventus	99,22	51,18	51,6%	24
Empoli-Parma	98,00	47,27	48,2%	37
Udinese-Monza	95,23	54,45	57,2%	29
Verona-Lecce	98,03	44,14	45,0%	32
Torino-Inter	99,11	57,18	57,7%	20
Napoli-Genoa	98,25	55,15	56,1%	26
Venezia-Fiorentina	98,32	54,06	55,0%	38
Atalanta-Roma	97,05	51,49	53,1%	28
Genoa-Atalanta	97,16	52,40	53,9%	24
Cagliari-Venezia	98,25	52,10	53,0%	16
Fiorentina-Bologna	98,55	51,27	52,0%	38
Inter-Lazio	102,53	58,13	56,7%	24
Juventus-Udinese	96,37	47,39	49,2%	22
Lecce-Torino	96,47	55,00	57,0%	21
Monza-Empoli	95,12	58,32	61,3%	24
Parma-Napoli	103,36	52,42	50,7%	29
Roma-Milan	96,20	61,26	63,7%	28
Verona-Como	97,07	48,53	50,0%	23
Como-Inter	98,45	60,24	61,2%	19
Napoli-Cagliari	100,40	51,44	51,2%	28
Bologna-Genoa	96,11	46,03	47,9%	36
Milan-Monza	92,19	59,23	64,2%	17
Atalanta-Parma	98,25	58,43	59,5%	14
Empoli-Verona	99,03	43,40	43,8%	39
Lazio-Lecce	99,12	52,01	52,5%	22
Torino-Roma	94,54	57,30	60,6%	26
Udinese-Fiorentina	96,02	57,55	59,9%	21
Venezia-Juventus	98,32	49,56	50,4%	28`;

        // INIEZIONE DEI NUOVI DATI FORNITI DALL'UTENTE
        const MATCHES_DB_2526 = `Genoa-Lecce	95,47	46,53	48,7%	29
Sassuolo-Napoli	97,20	60,05	61,8%	30
Milan-Cremonese	97,21	65,26	67,1%	28
Roma-Bologna	96,35	59,56	61,8%	24
Cagliari-Fiorentina	100,54	49,03	48,8%	32
Como-Lazio	95,46	54,15	56,7%	27
Atalanta-Pisa	96,06	57,39	59,7%	19
Juventus-Parma	96,26	55,01	57,1%	22
Udinese-Verona	94,24	54,35	57,7%	24
Inter-Torino	91,24	52,19	57,2%	20
Cremonese-Sassuolo	98,13	59,20	60,3%	29
Lecce-Milan	100,08	58,39	58,3%	18
Bologna-Como	96,20	55,35	57,5%	32
Parma-Atalanta	97,06	59,53	61,3%	23
Napoli-Cagliari	97,56	64,09	65,7%	28
Pisa-Roma	96,46	59,27	61,4%	24
Genoa-Juventus	98,26	54,37	55,3%	29
Torino-Fiorentina	94,09	51,30	54,5%	34
Inter-Udinese	98,12	57,38	58,5%	22
Lazio-Verona	93,02	59,58	64,1%	27
Cagliari-Parma	101,55	54,11	53,3%	33
Juventus-Inter	97,19	54,23	55,8%	24
Fiorentina-Napoli	99,24	54,04	54,5%	28
Roma-Torino	102,10	56,51	55,3%	29
Atalanta-Lecce	94,30	58,12	61,6%	19
Pisa-Udinese	96,31	58,32	60,6%	28
Sassuolo-Lazio	101,17	63,56	62,8%	26
Milan-Bologna	98,03	59,39	60,6%	32
Verona-Cremonese	97,02	61,52	63,4%	21
Como-Genoa	99,29	57,30	57,7%	31
Lecce-Cagliari	96,37	53,19	55,2%	29
Bologna-Genoa	108,02	53,57	49,6%	27
Verona-Juventus	99,52	54,14	54,4%	28
Udinese-Milan	95,27	65,04	68,3%	16
Lazio-Roma	100,08	51,06	51,0%	36
Cremonese-Parma	100,26	56,21	56,1%	24
Torino-Atalanta	95,17	63,29	66,5%	20
Fiorentina-Como	106,39	58,50	55,0%	35
Inter-Sassuolo	98,24	56,21	57,2%	23
Napoli-Pisa	101,11	57,06	56,4%	27
Como-Cremonese	97,54	ND	ND	33
Juventus-Atalanta	98,52	ND	ND	13
Cagliari-Inter	96,35	ND	ND	27
Sassuolo-Udinese	98,39	ND	ND	27
Pisa-Fiorentina	98,27	ND	ND	30
Roma-Verona	100,00	ND	ND	30
Lecce-Bologna	97,51	ND	ND	26
Milan-Napoli	99,10	ND	ND	13
Parma-Torino	98,49	ND	ND	22
Genoa-Lazio	96,06	ND	ND	34
Verona-Sassuolo	99,27	49,17	49,5%	26
Lazio-Torino	103,57	54,51	52,6%	35
Parma-Lecce	101,04	47,10	46,6%	32
Inter-Cremonese	95,20	55,44	58,2%	17
Atalanta-Como	95,25	56,48	59,3%	29
Udinese-Cagliari	97,10	50,42	51,9%	29
Bologna-Pisa	91,03	51,05	56,1%	28
Fiorentina-Roma	98,08	49,19	50,2%	40
Napoli-Genoa	96,31	ND	ND	31
Juventus-Milan	94,13	57,17	60,7%	23
Lecce-Sassuolo	97,33	ND	ND	30
Pisa-Verona	98,41	52,04	52,9%	22
Torino-Napoli	99,17	60,15	60,7%	18
Roma-Inter	96,40	55,18	57,2%	47
Como-Juventus	98,59	48,03	48,7%	32
Cagliari-Bologna	96,32	50,55	52,5%	37
Genoa-Parma	99,37	53,50	53,8%	28
Atalanta-Lazio	95,15	64,07	67,3%	15
Milan-Fiorentina	98,13	54,05	55,1%	26
Cremonese-Udinese	94,10	49,12	52,2%	29
Milan-Pisa	100,06	56,45	56,4%	29
Parma-Como	98,03	56,10	57,2%	24
Udinese-Lecce	96,22	51,39	53,4%	21
Napoli-Inter	102,58	54,57	53,2%	25
Cremonese-Atalanta	96,00	57,39	59,8%	14
Torino-Genoa	97,28	52,06	53,5%	23
Sassuolo-Roma	98,24	49,54	50,4%	34
Verona-Cagliari	100,04	54,13	54,1%	27
Fiorentina-Bologna	101,03	43,00	42,6%	33
Lazio-Juventus	96,12	54,45	56,6%	29
Lecce-Napoli	99,07	54,46	55,0%	24
Atalanta-Milan	97,51	59,25	60,8%	17
Como-Verona	99,03	53,25	53,8%	32
Juventus-Udinese	102,54	51,31	50,0%	25
Roma-Parma	97,04	53,34	55,0%	17
Bologna-Torino	96,01	57,36	59,7%	31
Genoa-Cremonese	100,41	46,31	46,1%	29
Inter-Fiorentina	95,10	54,25	57,0%	27
Cagliari-Sassuolo	100,29	50,07	49,9%	41
Pisa-Lazio	95,16	57,15	60,1%	28
Udinese-Atalanta	95,30	57,43	60,3%	25
Napoli-Como	98,23	56,49	57,5%	31
Cremonese-Juventus	99,18	58,32	58,8%	24
Verona-Inter	99,00	57,18	57,8%	20
Fiorentina-Lecce	97,15	52,10	53,6%	35
Torino-Pisa	97,32	52,41	53,9%	22
Parma-Bologna	101,04	47,22	46,7%	31
Milan-Roma	97,10	56,38	58,1%	25
Sassuolo-Genoa	99,04	55,16	55,7%	26
Lazio-Cagliari	95,01	57,15	60,2%	26
Pisa-Cremonese	96,03	53,23	55,4%	28
Como-Cagliari	99,11	51,53	52,0%	36
Lecce-Verona	97,28	48,07	49,4%	28
Juventus-Torino	99,50	64,42	64,7%	13
Parma-Milan	95,00	57,59	60,6%	24
Atalanta-Sassuolo	99,06	60,28	60,9%	17
Bologna-Napoli	99,24	54,49	54,9%	29
Genoa-Fiorentina	97,03	46,12	47,5%	35
Roma-Udinese	98,21	58,53	59,6%	27
Inter-Lazio	97,11	59,00	60,8%	37
Cagliari-Genoa	96,36	45,56	47,3%	38
Udinese-Bologna	101,03	46,21	45,7%	35
Fiorentina-Juventus	101,06	55,15	54,6%	29
Napoli-Atalanta	96,16	56,23	58,5%	23
Verona-Parma	98,17	54,51	55,5%	30
Cremonese-Roma	100,43	53,23	53,0%	28
Lazio-Lecce	98,36	59,36	60,4%	21
Inter-Milan	98,01	60,11	61,3%	16
Torino-Como	96,52	53,33	55,3%	15
Sassuolo-Pisa	98,18	54,38	55,6%	20`;
        // DATI PARTITE ND AGGIUNTI MANUALMENTE
        const EXTRA_MATCHES_2526 = ``;
        
        const PLAYING_TIME_DB = {
            "2025-26": `Massa	46,53
Ayroldi	60,05
Collu	65,26
Zufferli	59,56
Sozza	49,03
Manganiello	54,15
Arena	57,39
Marcenaro	55,01
Tremolada	54,35
La Penna	52,19
Guida	59,20
Marinelli	58,39
Doveri	55,35
Mariani	59,53
Bonacina	64,09
Collu	59,27
Chiffi	54,37
Abisso	51,30
Marchetti	57,38
Crezzini	59,58
Fourneau	54,11
Colombo	54,23
Zufferli	54,04
Ayroldi	56,51
Manganiello	58,12
Massa	58,32
Tremolada	63,56
Marcenaro	59,39
Arena	61,52
Piccinini	57,30
Zufferli	53,19
Collu	53,57
Rapuano	54,14
Doveri	65,04
Sozza	51,06
La Penna	56,21
Colombo	63,29
Bonacina	58,50
Marinelli	56,21
Crezzini	57,06
Fourneau	49,17
Piccinini	54,51
Doveri	47,10
Feliciani	55,44
Zufferli	56,48
Arena	50,42
Abisso	51,05
Colombo	49,19
Guida	57,17
Guida	52,04
Marcenaro	60,15
Massa	55,18
Ayroldi	48,03
Marchetti	50,55
Sozza	53,50
Collu	64,07
Marinelli	54,05
Fabbri	49,12
Zufferli	56,45
Chiffi	56,10
Feliciani	51,39
Mariani	54,57
Arena	57,39
Bonacina	52,06
Manganiello	49,54
Dionisi	54,13
La Penna	43,00
Colombo	54,45
Collu	54,46
Doveri	59,25
Marcenaro	53,25
Di Bello	51,31
Crezzini	53,34
Ayroldi	57,36
Abisso	46,31
Sozza	54,25
Pairetto	50,07
Massa	57,15
Fabbri	57,43
Zufferli	56,49
Chiffi	58,32
Doveri	57,18
Rapuano	52,10
Arena	52,41
Bonacina	47,22
Guida	56,38
Feliciani	55,16
Sacchi	57,15
Marcenaro	53,23
Pezzuto	51,53
Abisso	48,07
Zufferli	64,42
Di Bello	57,59
Crezzini	60,28
Chiffi	54,49
Guida	46,12
Collu	58,53
Manganiello	59,00
La Penna	45,56
Sacchi	46,21
Doveri	55,15
Di Bello	56,23
Pairetto	54,51
Ayroldi	53,23
Arena	59,36
Sozza	60,11
Bonacina	53,33
Di Marco	54,38'
`,
            "2024-25": `Feliciani	46,39
Ayroldi	48,46
Fabbri	44,43
Maresca	58,27
Caputi	48,59
Marchetti	48,53
Marinelli	53,36
Tremolada	56,00
Massa	54,12
Marcenaro	56,43
Sacchi	59,00
Doveri	49,49
Di Marco	56,21
Mariani	56,58
Rapuano	51,08
Sozza	55,29
Pairetto	53,23
Zufferli	58,22
Di Bello	53,12
Giua	61,58
Marcenaro	52,45
Marchetti	53,40
Marinelli	55,44
Fabbri	47,36
Massa	54,06
Tremolada	60,21
Colombo	54,53
Ayroldi	51,32
Guida	58,50
Prontera	54,24
Piccinini	54,03
Di Bello	60,04
Di Marco	57,21
Giua	53,12
Sacchi	51,04
Colombo	54,31
La Penna	50,07
Pairetto	57,28
Abisso	53,01
Zufferli	56,25
Sozza	48,44
Marinelli	60,20
Marchetti	48,20
Doveri	64,10
Guida	54,32
Marcenaro	52,35
Massa	55,34
Feliciani	55,33
Mariani	55,33
Tremolada	58,21
Zufferli	55,41
Sacchi	61,58
Colombo	58,44
Rapuano	57,29
Sozza	57,06
Giua	49,47
Abisso	52,36
Aureliano	54,28
Manganiello	60,33
Fourneau	55,21
Feliciani	59,25
Guida	47,29
Mariani	55,10
Chiffi	55,41
Marcenaro	54,09
Marinelli	60,08
Di Bello	54,55
Ayroldi	53,07
La Penna	56,25
Pairetto	48,43
Fabbri	60,51
Doveri	47,58
Chiffi	52,59
Sacchi	56,44
Abisso	51,43
Fourneau	53,12
Zufferli	54,15
Aureliano	52,53
Massa	59,00
Dionisi	54,17
Manganiello	54,38
Ayroldi	55,42
Tremolada	52,02
Mariani	53,33
Feliciani	58,27
La Penna	55,33
Piccinini	57,36
Rapuano	49,01
Guida	52,00
Sozza	55,39
Fourneau	55,29
Mariani	49,06
Colombo	60,55
Marchetti	55,51
Massa	49,10
Piccinini	57,39
Zufferli	61,18
Chiffi	52,02
Pairetto	50,20
Fabbri	59,29
Collu	50,36
Abisso	55,50
Feliciani	56,22
Doveri	62,27
La Penna	59,23
Marcenaro	53,58
Caputi	55,55
Di Bello	54,05
Guida	51,42
Ayroldi	54,05
Rapuano	50,21
Sacchi	51,23
Chiffi	57,06
Fabbri	54,30
Sozza	55,08
Di Bello	51,34
Zufferli	46,44
Manganiello	49,51
Colombo	56,45
Mariani	56,03
Colombo	65,30
Chiffi	59,45
Manganiello	66,25
Sozza	53,26
Marchetti	55,23
Abisso	57,26
Massa	58,44
Rapuano	55,30
Marinelli	58,51
Pairetto	56,21
Mariani	50,46
Sacchi	51,14
Dionisi	54,43
Massimi	49,35
Aureliano	57,46
Zufferli	55,40
Fabbri	59,16
Doveri	53,53
Rapuano	62,25
Guida	55,10
Abisso	55,37
La Penna	59,24
Marinelli	56,35
Marchetti	52,19
Chiffi	55,05
Piccinini	53,17
Di Bello	54,48
Doveri	44,33
Colombo	58,47
Manganiello	53,45
Bonacina	49,22
Pairetto	57,31
Doveri	51,56
Giua	59,57
Mariani	47,00
Fabbri	48,30
Sozza	54,08
Rapuano	52,56
Guida	61,42
Chiffi	55,11
Marinelli	54,44
Piccinini	56,57
La Penna	57,55
Manganiello	56,47
Di Bello	55,55
Guida	49,18
Feliciani	54,38
Massa	61,14
Marcenaro	53,21
Giua	52,23
Rapuano	51,47
La Penna	48,53
Doveri	52,18
Massa	58,07
Fourneau	54,20
Cosso	54,07
Mariani	51,51
Fabbri	51,06
Piccinini	52,23
Ayroldi	46,47
Sacchi	51,16
Manganiello	49,34
Dionisi	50,49
Di Bello	48,31
Marinelli	54,20
Feliciani	59,17
Pairetto	53,25
Manganiello	50,49
Doveri	64,13
Pairetto	52,32
Tremolada	47,58
Chiffi	49,09
Mariani	58,41
Fabbri	60,08
Fourneau	56,05
Colombo	52,11
Piccinini	55,10
Abisso	54,11
Zufferli	62,26
Dionisi	60,55
Zufferli	58,40
Mariani	59,30
Massa	56,11
Colombo	57,43
Marinelli	56,28
Sacchi	51,45
Fourneau	50,03
Fabbri	55,10
Feliciani	57,07
Cosso	51,13
Bonacina	57,17
Pairetto	56,26
Chiffi	54,14
La Penna	46,31
Abisso	52,02
Sozza	56,19
Marinelli	57,11
Rapuano	53,46
Manganiello	49,18
Doveri	41,34
Sozza	56,49
Massa	53,12
Mariani	42,22
Piccinini	63,01
Massimi	50,12
Zufferli	45,47
Collu	47,18
Chiffi	58,36
Fabbri	57,50
Manganiello	55,09
Abisso	50,13
Sozza	56,03
Pairetto	48,47
Feliciani	57,33
Zufferli	53,23
Di Bello	52,57
Aureliano	55,49
Fourneau	52,43
Marinelli	57,54
La Penna	54,37
Fabbri	46,59
Marchetti	64,30
Massa	55,22
Fourneau	49,24
Piccinini	58,37
Collu	56,57
Doveri	52,19
Chiffi	58,43
Mariani	55,49
Marinelli	45,50
Bonacina	54,09
Abisso	52,14
Marchetti	56,03
Sozza	55,53
Piccinini	58,04
Manganiello	52,35
Di Bello	51,57
Mariani	51,29
Colombo	60,44
Maresca	61,54
Marinelli	54,37
Collu	59,11
Doveri	52,11
Maresca	57,58
Rapuano	56,28
Zufferli	51,33
Massa	47,28
Pairetto	61,34
Manganiello	57,54
Marchetti	55,31
Fabbri	50,53
Ayroldi	51,43
Fourneau	46,27
Doveri	52,03
Zufferli	57,48
Rapuano	56,41
Colombo	59,57
Di Bello	60,45
Sozza	57,31
Piccinini	59,55
Maresca	51,18
Manganiello	56,25
Ayroldi	56,15
Marchetti	51,46
Chiffi	46,00
Mariani	48,55
Colombo	54,15
Piccinini	60,28
Fabbri	52,43
Massa	54,31
Mariani	52,17
Di Bello	53,24
Rapuano	54,24
Manganiello	51,33
Fourneau	50,35
Doveri	55,08
Chiffi	55,26
Sozza	59,08
Sacchi	51,46
Massa	54,35
Perenzoni	54,22
Collu	58,00
Doveri	57,35
Ayroldi	53,20
Piccinini	44,36
La Penna	45,56
Bonacina	52,10
Chiffi	60,27
Colombo	61,47
Massa	51,14
Sacchi	57,21
Maresca	45,52
Di Bello	61,00
Zufferli	55,04
Mariani	52,31
Manganiello	59,22
Marchetti	46,55
Marcenaro	55,02
Sozza	49,34
Fabbri	54,09
Sozza	46,22
La Penna	56,00
Pairetto	54,09
Massa	44,36
Colombo	50,02
Piccinini	62,56
Collu	53,25
Marinelli	53,48
Ayroldi	55,47
Chiffi	58,32
La Penna	56,54
Arena	54,58
Manganiello	52,47
Rapuano	48,14
Fabbri	58,15
Perenzoni	55,31
Mariani	58,59
Maresca	47,37
Abisso	51,05
Sacchi	60,08
Sozza	53,17
Feliciani	55,29
Di Bello	50,20
Massa	58,14
Manganiello	61,36
Colombo	55,18
Pairetto	57,35
Chiffi	63,43
Doveri	45,42
Collu	52,54
Marinelli	56,48
Fourneau	54,24
Massa	51,18
Fabbri	47,27
Crezzini	54,45
Maresca	44,14
La Penna	57,18
Piccinini	55,15
Marchetti	54,06
Sozza	51,49
Ghersini	52,40
Pairetto	52,10
Zufferli	51,27
Chiffi	58,13
Ayroldi	47,39
Rapuano	55,00
Marinelli	58,32
Doveri	52,42
Piccinini	61,26
Abisso	48,53
Massa	60,24
La Penna	51,44
Monaldi	46,03
Rutella	59,23
Marinelli	58,43
Doveri	43,40
Fabbri	52,01
Di Bello	57,30
Marcenaro	57,55
Colombo	49,56`,
            "2023-24": ``, "2022-23": ``, "2021-22": ``, "2020-21": ``
        };
        
        const TOTAL_TIME_DB = `Massa	95,47
Ayroldi	97,20
Collu	97,21
Zufferli	96,35
Sozza	100,54
Manganiello	95,46
Arena	96,06
Marcenaro	96,26
Tremolada	94,24
La Penna	91,24
Guida	98,13
Marinelli	100,08
Doveri	96,20
Mariani	97,06
Bonacina	97,56
Collu	96,46
Chiffi	98,26
Abisso	94,09
Marchetti	98,12
Crezzini	93,02
Fourneau	101,55
Colombo	97,19
Zufferli	99,24
Ayroldi	102,10
Manganiello	94,30
Massa	96,31
Tremolada	101,17
Marcenaro	98,03
Arena	97,02
Piccinini	99,29
Zufferli	96,37
Collu	108,02
Rapuano	99,52
Doveri	95,27
Sozza	100,08
La Penna	100,26
Colombo	95,17
Bonacina	106,39
Marinelli	98,24
Crezzini	101,11
Di Bello	97,54
Sozza	98,52
Piccinini	96,35
Perenzoni	98,39
Manganiello	98,27
Feliciani	100,00
Fourneau	97,51
Chiffi	99,10
Collu	98,49
Ayroldi	96,06
Fourneau	99,27
Piccinini	103,57
Doveri	101,04
Feliciani	95,20
Zufferli	95,25
Arena	97,10
Abisso	91,03
Colombo	98,08
La Penna	96,31
Guida	94,13
Crezzini	97,33
Guida	98,41
Marcenaro	99,17
Massa	96,40
Ayroldi	98,59
Marchetti	96,32
Sozza	99,37
Collu	95,15
Marinelli	98,13
Fabbri	94,10
Zufferli	100,06
Chiffi	98,03
Feliciani	96,22
Mariani	102,58
Arena	96,00
Bonacina	97,28
Manganiello	98,24
Dionisi	100,04
La Penna	101,03
Colombo	96,12
Collu	99,07
Doveri	97,51
Marcenaro	99,03
Di Bello	102,54
Crezzini	97,04
Ayroldi	96,01
Abisso	100,41
Sozza	95,10
Pairetto	100,29
Massa	95,16
Fabbri	95,30
Zufferli	98,23
Chiffi	99,18
Doveri	99,00
Rapuano	97,15
Arena	97,32
Bonacina	101,04
Guida	97,10
Feliciani	99,04
Sacchi	95,01
Marcenaro	96,03
Pezzuto	99,11
Abisso	97,28
Zufferli	99,50
Di Bello	95,00
Crezzini	99,06
Chiffi	99,24
Guida	97,03
Collu	98,21
Manganiello	97,11
La Penna	96,36
Sacchi	101,03
Doveri	101,06
Di Bello	96,16
Pairetto	98,17
Ayroldi	100,43
Arena	98,36
Sozza	98,01
Bonacina	96,52
Di Marco	98,18`;

        // --- STATS DB (IMPORTANTE: INCOLLA QUI IL TUO CODICE con const db = { ... }) ---
        // Il sistema userÃ  questa variabile per le statistiche.
        
        const db = {
            "2025-26": [
                { name: "Luca Zufferli", matches: 7, fouls_avg: 26.71, penalties_ap: 0.57, yellows_ap: 3.00, yellows: 21, reds_ap: 0.00, reds: 0 },
                { name: "Giuseppe Collu", matches: 7, fouls_avg: 23.29, penalties_ap: 0.57, yellows_ap: 4.29, yellows: 30, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 5, fouls_avg: 26.80, penalties_ap: 1.20, yellows_ap: 5.00, yellows: 25, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Doveri", matches: 6, fouls_avg: 24.33, penalties_ap: 0.00, yellows_ap: 4.33, yellows: 26, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Chiffi", matches: 5, fouls_avg: 23.40, penalties_ap: 0.20, yellows_ap: 2.00, yellows: 10, reds_ap: 0.20, reds: 1 },
                { name: "Gianluca Manganiello", matches: 5, fouls_avg: 29.40, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Simone Sozza", matches: 6, fouls_avg: 25.33, penalties_ap: 0.50, yellows_ap: 3.00, yellows: 18, reds_ap: 0.83, reds: 5 },
                { name: "Giovanni Ayroldi", matches: 6, fouls_avg: 31.17, penalties_ap: 0.00, yellows_ap: 4.33, yellows: 26, reds_ap: 0.17, reds: 1 },
                { name: "Matteo Marcenaro", matches: 5, fouls_avg: 26.60, penalties_ap: 0.00, yellows_ap: 4.40, yellows: 22, reds_ap: 0.20, reds: 1 },
                { name: "Valerio Crezzini", matches: 5, fouls_avg: 23.80, penalties_ap: 0.40, yellows_ap: 2.60, yellows: 13, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Arena", matches: 6, fouls_avg: 21.17, penalties_ap: 0.17, yellows_ap: 2.83, yellows: 17, reds_ap: 0.00, reds: 0 },
                { name: "Davide Massa", matches: 4, fouls_avg: 33.00, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 19, reds_ap: 0.00, reds: 0 },
                { name: "Rosario Abisso", matches: 4, fouls_avg: 29.75, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.25, reds: 1 },
                { name: "Federico La Penna", matches: 5, fouls_avg: 29.20, penalties_ap: 0.40, yellows_ap: 3.20, yellows: 16, reds_ap: 0.40, reds: 2 },
                { name: "Andrea Colombo", matches: 4, fouls_avg: 28.25, penalties_ap: 0.25, yellows_ap: 3.75, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Ermanno Feliciani", matches: 4, fouls_avg: 24.25, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Kevin Bonacina", matches: 5, fouls_avg: 26.40, penalties_ap: 0.20, yellows_ap: 3.80, yellows: 19, reds_ap: 0.20, reds: 1 },
                { name: "Marco Di Bello", matches: 4, fouls_avg: 26.25, penalties_ap: 0.75, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                { name: "Marco Piccinini", matches: 3, fouls_avg: 30.67, penalties_ap: 0.33, yellows_ap: 4.00, yellows: 12, reds_ap: 0.33, reds: 1 },
                { name: "Livio Marinelli", matches: 3, fouls_avg: 22.33, penalties_ap: 0.33, yellows_ap: 3.33, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Fourneau", matches: 3, fouls_avg: 28.33, penalties_ap: 0.67, yellows_ap: 5.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Maurizio Mariani", matches: 2, fouls_avg: 24.00, penalties_ap: 1.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Michael Fabbri", matches: 2, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Rapuano", matches: 2, fouls_avg: 31.50, penalties_ap: 0.50, yellows_ap: 5.50, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Marchetti", matches: 2, fouls_avg: 29.50, penalties_ap: 0.50, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Paride Tremolada", matches: 2, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Luca Pairetto", matches: 2, fouls_avg: 35.50, penalties_ap: 0.00, yellows_ap: 7.50, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 1, fouls_avg: 36.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Juan Luca Sacchi", matches: 2, fouls_avg: 30.50, penalties_ap: 0.50, yellows_ap: 1.50, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 1, fouls_avg: 28.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Perenzoni", matches: 1, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 1, fouls_avg: 20.00, penalties_ap: 1.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 }
            ],
            "2024-25": [
                { name: "Davide Massa", matches: 19, fouls_avg: 25.74, penalties_ap: 0.16, yellows_ap: 4.21, yellows: 80, reds_ap: 0.26, reds: 5 },
                { name: "Maurizio Mariani", matches: 18, fouls_avg: 25.94, penalties_ap: 0.11, yellows_ap: 3.72, yellows: 67, reds_ap: 0.17, reds: 3 },
                { name: "Michael Fabbri", matches: 18, fouls_avg: 24.89, penalties_ap: 0.06, yellows_ap: 3.89, yellows: 70, reds_ap: 0.33, reds: 6 },
                { name: "Daniele Doveri", matches: 18, fouls_avg: 24.11, penalties_ap: 0.22, yellows_ap: 2.50, yellows: 45, reds_ap: 0.11, reds: 2 },
                { name: "Daniele Chiffi", matches: 17, fouls_avg: 20.29, penalties_ap: 0.29, yellows_ap: 3.71, yellows: 63, reds_ap: 0.18, reds: 3 },
                { name: "Gianluca Manganiello", matches: 17, fouls_avg: 25.59, penalties_ap: 0.24, yellows_ap: 3.24, yellows: 55, reds_ap: 0.18, reds: 3 },
                { name: "Livio Marinelli", matches: 17, fouls_avg: 24.18, penalties_ap: 0.29, yellows_ap: 2.88, yellows: 49, reds_ap: 0.18, reds: 3 },
                { name: "Simone Sozza", matches: 17, fouls_avg: 24.00, penalties_ap: 0.59, yellows_ap: 3.53, yellows: 60, reds_ap: 0.06, reds: 1 },
                { name: "Marco Piccinini", matches: 16, fouls_avg: 24.00, penalties_ap: 0.19, yellows_ap: 3.81, yellows: 61, reds_ap: 0.06, reds: 1 },
                { name: "Andrea Colombo", matches: 16, fouls_avg: 25.19, penalties_ap: 0.13, yellows_ap: 4.13, yellows: 66, reds_ap: 0.13, reds: 2 },
                { name: "Marco Di Bello", matches: 15, fouls_avg: 26.20, penalties_ap: 0.27, yellows_ap: 2.60, yellows: 39, reds_ap: 0.13, reds: 2 },
                { name: "Luca Zufferli", matches: 15, fouls_avg: 22.80, penalties_ap: 0.20, yellows_ap: 2.73, yellows: 41, reds_ap: 0.20, reds: 3 },
                { name: "Luca Pairetto", matches: 14, fouls_avg: 26.57, penalties_ap: 0.29, yellows_ap: 4.14, yellows: 58, reds_ap: 0.50, reds: 7 },
                { name: "Federico La Penna", matches: 14, fouls_avg: 27.71, penalties_ap: 0.43, yellows_ap: 4.36, yellows: 61, reds_ap: 0.07, reds: 1 },
                { name: "Antonio Rapuano", matches: 14, fouls_avg: 27.93, penalties_ap: 0.14, yellows_ap: 4.50, yellows: 63, reds_ap: 0.43, reds: 6 },
                { name: "Rosario Abisso", matches: 12, fouls_avg: 24.42, penalties_ap: 0.50, yellows_ap: 3.83, yellows: 46, reds_ap: 0.17, reds: 2 },
                { name: "Matteo Marchetti", matches: 12, fouls_avg: 26.83, penalties_ap: 0.08, yellows_ap: 4.00, yellows: 48, reds_ap: 0.25, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 11, fouls_avg: 24.27, penalties_ap: 0.09, yellows_ap: 3.36, yellows: 37, reds_ap: 0.18, reds: 2 },
                { name: "Francesco Fourneau", matches: 11, fouls_avg: 27.55, penalties_ap: 0.27, yellows_ap: 4.18, yellows: 46, reds_ap: 0.09, reds: 1 },
                { name: "Giovanni Ayroldi", matches: 11, fouls_avg: 26.91, penalties_ap: 0.36, yellows_ap: 5.73, yellows: 63, reds_ap: 0.55, reds: 6 },
                { name: "Ermanno Feliciani", matches: 10, fouls_avg: 22.90, penalties_ap: 0.40, yellows_ap: 2.50, yellows: 25, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 8, fouls_avg: 22.63, penalties_ap: 0.25, yellows_ap: 3.88, yellows: 31, reds_ap: 0.25, reds: 2 },
                { name: "Matteo Marcenaro", matches: 8, fouls_avg: 22.88, penalties_ap: 0.50, yellows_ap: 5.00, yellows: 40, reds_ap: 0.38, reds: 3 },
                { name: "Fabio Maresca", matches: 7, fouls_avg: 25.43, penalties_ap: 0.29, yellows_ap: 4.43, yellows: 31, reds_ap: 0.14, reds: 1 },
                { name: "Giuseppe Collu", matches: 7, fouls_avg: 28.29, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 28, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Giua", matches: 5, fouls_avg: 22.20, penalties_ap: 0.60, yellows_ap: 3.60, yellows: 18, reds_ap: 0.20, reds: 1 },
                { name: "Paride Tremolada", matches: 5, fouls_avg: 24.20, penalties_ap: 0.60, yellows_ap: 4.20, yellows: 21, reds_ap: 0.40, reds: 2 },
                { name: "Gianluca Aureliano", matches: 4, fouls_avg: 22.50, penalties_ap: 0.25, yellows_ap: 2.75, yellows: 11, reds_ap: 0.25, reds: 1 },
                { name: "Federico Dionisi", matches: 4, fouls_avg: 28.50, penalties_ap: 0.25, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                { name: "Kevin Bonacina", matches: 4, fouls_avg: 24.25, penalties_ap: 0.50, yellows_ap: 3.00, yellows: 12, reds_ap: 0.50, reds: 2 },
                { name: "Luca Massimi", matches: 2, fouls_avg: 31.50, penalties_ap: 1.00, yellows_ap: 4.50, yellows: 9, reds_ap: 0.50, reds: 1 },
                { name: "Francesco Cosso", matches: 2, fouls_avg: 24.00, penalties_ap: 0.50, yellows_ap: 2.50, yellows: 5, reds_ap: 1.00, reds: 2 },
                { name: "Daniele Perenzoni", matches: 2, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.50, reds: 1 },
                { name: "Maria Ferrieri Caputi", matches: 2, fouls_avg: 32.00, penalties_ap: 1.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 2, fouls_avg: 22.50, penalties_ap: 1.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.50, reds: 1 },
                { name: "Davide Ghersini", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 0.00, yellows: 0, reds_ap: 0.00, reds: 0 },
                { name: "Alessandro Prontera", matches: 1, fouls_avg: 25.00, penalties_ap: 1.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Rutella", matches: 1, fouls_avg: 17.00, penalties_ap: 0.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Marco Monaldi", matches: 1, fouls_avg: 36.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Valerio Crezzini", matches: 1, fouls_avg: 29.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 5, reds_ap: 0.00, reds: 0 }
            ],
            "2023-24": [
                { name: "Marco Guida", matches: 17, fouls_avg: 23.59, penalties_ap: 0.47, yellows_ap: 4.00, yellows: 68, reds_ap: 0.06, reds: 1 },
                { name: "Daniele Doveri", matches: 17, fouls_avg: 24.47, penalties_ap: 0.18, yellows_ap: 3.24, yellows: 55, reds_ap: 0.35, reds: 6 },
                { name: "Daniele Orsato", matches: 16, fouls_avg: 23.38, penalties_ap: 0.31, yellows_ap: 4.69, yellows: 75, reds_ap: 0.19, reds: 3 },
                { name: "Davide Massa", matches: 16, fouls_avg: 26.06, penalties_ap: 0.31, yellows_ap: 5.06, yellows: 81, reds_ap: 0.00, reds: 0 },
                { name: "Fabio Maresca", matches: 16, fouls_avg: 25.50, penalties_ap: 0.25, yellows_ap: 5.69, yellows: 91, reds_ap: 0.06, reds: 1 },
                { name: "Andrea Colombo", matches: 16, fouls_avg: 24.19, penalties_ap: 0.19, yellows_ap: 5.38, yellows: 86, reds_ap: 0.38, reds: 6 },
                { name: "Maurizio Mariani", matches: 15, fouls_avg: 23.80, penalties_ap: 0.33, yellows_ap: 3.80, yellows: 57, reds_ap: 0.27, reds: 4 },
                { name: "Federico La Penna", matches: 15, fouls_avg: 24.07, penalties_ap: 0.40, yellows_ap: 4.60, yellows: 69, reds_ap: 0.13, reds: 2 },
                { name: "Juan Luca Sacchi", matches: 15, fouls_avg: 25.60, penalties_ap: 0.40, yellows_ap: 4.40, yellows: 66, reds_ap: 0.07, reds: 1 },
                { name: "Antonio Rapuano", matches: 15, fouls_avg: 25.40, penalties_ap: 0.40, yellows_ap: 3.93, yellows: 59, reds_ap: 0.27, reds: 4 },
                { name: "Luca Pairetto", matches: 14, fouls_avg: 23.36, penalties_ap: 0.50, yellows_ap: 4.14, yellows: 58, reds_ap: 0.00, reds: 0 },
                { name: "Michael Fabbri", matches: 13, fouls_avg: 24.31, penalties_ap: 0.31, yellows_ap: 3.23, yellows: 42, reds_ap: 0.15, reds: 2 },
                { name: "Ermanno Feliciani", matches: 13, fouls_avg: 22.38, penalties_ap: 0.23, yellows_ap: 3.08, yellows: 40, reds_ap: 0.08, reds: 1 },
                { name: "Gianluca Aureliano", matches: 12, fouls_avg: 25.50, penalties_ap: 0.50, yellows_ap: 4.25, yellows: 51, reds_ap: 0.17, reds: 2 },
                { name: "Gianluca Manganiello", matches: 12, fouls_avg: 22.33, penalties_ap: 0.25, yellows_ap: 3.67, yellows: 44, reds_ap: 0.25, reds: 3 },
                { name: "Marco Piccinini", matches: 12, fouls_avg: 23.17, penalties_ap: 0.50, yellows_ap: 3.83, yellows: 46, reds_ap: 0.17, reds: 2 },
                { name: "Matteo Marcenaro", matches: 12, fouls_avg: 22.58, penalties_ap: 0.33, yellows_ap: 4.83, yellows: 58, reds_ap: 0.25, reds: 3 },
                { name: "Marco Di Bello", matches: 11, fouls_avg: 23.18, penalties_ap: 0.45, yellows_ap: 4.18, yellows: 46, reds_ap: 0.45, reds: 5 },
                { name: "Antonio Giua", matches: 11, fouls_avg: 23.00, penalties_ap: 0.27, yellows_ap: 3.64, yellows: 40, reds_ap: 0.27, reds: 3 },
                { name: "Simone Sozza", matches: 11, fouls_avg: 26.36, penalties_ap: 0.82, yellows_ap: 4.36, yellows: 48, reds_ap: 0.18, reds: 2 },
                { name: "Matteo Marchetti", matches: 11, fouls_avg: 23.27, penalties_ap: 0.18, yellows_ap: 3.00, yellows: 33, reds_ap: 0.09, reds: 1 },
                { name: "Daniele Chiffi", matches: 9, fouls_avg: 22.22, penalties_ap: 0.11, yellows_ap: 4.00, yellows: 36, reds_ap: 0.11, reds: 1 },
                { name: "Alessandro Prontera", matches: 9, fouls_avg: 22.22, penalties_ap: 0.67, yellows_ap: 3.78, yellows: 34, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 9, fouls_avg: 27.89, penalties_ap: 0.11, yellows_ap: 3.22, yellows: 29, reds_ap: 0.11, reds: 1 },
                { name: "Livio Marinelli", matches: 8, fouls_avg: 24.38, penalties_ap: 0.25, yellows_ap: 4.50, yellows: 36, reds_ap: 0.50, reds: 4 },
                { name: "Luca Massimi", matches: 8, fouls_avg: 25.13, penalties_ap: 0.25, yellows_ap: 3.75, yellows: 30, reds_ap: 0.13, reds: 1 },
                { name: "Giovanni Ayroldi", matches: 8, fouls_avg: 26.13, penalties_ap: 0.38, yellows_ap: 5.25, yellows: 42, reds_ap: 0.38, reds: 3 },
                { name: "Maria Ferrieri Caputi", matches: 8, fouls_avg: 23.13, penalties_ap: 0.38, yellows_ap: 4.13, yellows: 33, reds_ap: 0.38, reds: 3 },
                { name: "Rosario Abisso", matches: 7, fouls_avg: 23.86, penalties_ap: 0.43, yellows_ap: 5.29, yellows: 37, reds_ap: 0.14, reds: 1 },
                { name: "Luca Zufferli", matches: 6, fouls_avg: 22.00, penalties_ap: 0.17, yellows_ap: 2.50, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Fourneau", matches: 5, fouls_avg: 21.80, penalties_ap: 0.40, yellows_ap: 3.60, yellows: 18, reds_ap: 0.20, reds: 1 },
                { name: "Alberto Santoro", matches: 3, fouls_avg: 26.67, penalties_ap: 0.33, yellows_ap: 5.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Paride Tremolada", matches: 3, fouls_avg: 25.67, penalties_ap: 0.67, yellows_ap: 4.33, yellows: 13, reds_ap: 0.00, reds: 0 },
                { name: "Giuseppe Collu", matches: 2, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 6, reds_ap: 0.00, reds: 0 },
                { name: "Davide Di Marco", matches: 2, fouls_avg: 21.00, penalties_ap: 0.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Davide Ghersini", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 1.00, reds: 1 },
                { name: "Francesco Cosso", matches: 1, fouls_avg: 20.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 2, reds_ap: 0.00, reds: 0 }
            ],
            "2022-23": [
                 { name: "Daniele Orsato", matches: 15, fouls_avg: 21.40, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 45, reds_ap: 0.07, reds: 1 },
                 { name: "Fabio Maresca", matches: 15, fouls_avg: 25.60, penalties_ap: 0.00, yellows_ap: 5.33, yellows: 80, reds_ap: 0.20, reds: 3 },
                 { name: "Daniele Chiffi", matches: 15, fouls_avg: 23.47, penalties_ap: 0.00, yellows_ap: 4.47, yellows: 67, reds_ap: 0.20, reds: 3 },
                 { name: "Maurizio Mariani", matches: 14, fouls_avg: 24.07, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 63, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Doveri", matches: 14, fouls_avg: 25.43, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 49, reds_ap: 0.21, reds: 3 },
                 { name: "Davide Massa", matches: 14, fouls_avg: 27.64, penalties_ap: 0.00, yellows_ap: 6.21, yellows: 87, reds_ap: 0.29, reds: 4 },
                 { name: "Antonio Rapuano", matches: 14, fouls_avg: 22.43, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 63, reds_ap: 0.21, reds: 3 },
                 { name: "Livio Marinelli", matches: 14, fouls_avg: 24.07, penalties_ap: 0.00, yellows_ap: 3.36, yellows: 47, reds_ap: 0.21, reds: 3 },
                 { name: "Michael Fabbri", matches: 12, fouls_avg: 23.17, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 57, reds_ap: 0.33, reds: 4 },
                 { name: "Luca Pairetto", matches: 12, fouls_avg: 26.08, penalties_ap: 0.00, yellows_ap: 4.42, yellows: 53, reds_ap: 0.17, reds: 2 },
                 { name: "Giovanni Ayroldi", matches: 12, fouls_avg: 27.50, penalties_ap: 0.00, yellows_ap: 5.25, yellows: 63, reds_ap: 0.08, reds: 1 },
                 { name: "Andrea Colombo", matches: 12, fouls_avg: 22.83, penalties_ap: 0.00, yellows_ap: 4.75, yellows: 57, reds_ap: 0.00, reds: 0 },
                 { name: "Matteo Marcenaro", matches: 12, fouls_avg: 23.42, penalties_ap: 0.00, yellows_ap: 4.83, yellows: 58, reds_ap: 0.50, reds: 6 },
                 { name: "Marco Di Bello", matches: 11, fouls_avg: 28.55, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 55, reds_ap: 0.18, reds: 2 },
                 { name: "Antonio Giua", matches: 11, fouls_avg: 23.64, penalties_ap: 0.00, yellows_ap: 5.18, yellows: 57, reds_ap: 0.36, reds: 4 },
                 { name: "Simone Sozza", matches: 11, fouls_avg: 26.09, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 55, reds_ap: 0.00, reds: 0 },
                 { name: "Matteo Marchetti", matches: 11, fouls_avg: 27.45, penalties_ap: 0.00, yellows_ap: 4.09, yellows: 45, reds_ap: 0.27, reds: 3 },
                 { name: "Massimiliano Irrati", matches: 10, fouls_avg: 23.70, penalties_ap: 0.00, yellows_ap: 5.10, yellows: 51, reds_ap: 0.20, reds: 2 },
                 { name: "Rosario Abisso", matches: 10, fouls_avg: 24.60, penalties_ap: 0.00, yellows_ap: 3.90, yellows: 39, reds_ap: 0.30, reds: 3 },
                 { name: "Francesco Fourneau", matches: 10, fouls_avg: 24.20, penalties_ap: 0.00, yellows_ap: 4.70, yellows: 47, reds_ap: 0.00, reds: 0 },
                 { name: "Luca Massimi", matches: 10, fouls_avg: 22.70, penalties_ap: 0.00, yellows_ap: 4.10, yellows: 41, reds_ap: 0.40, reds: 4 },
                 { name: "Juan Luca Sacchi", matches: 9, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 3.22, yellows: 29, reds_ap: 0.22, reds: 2 },
                 { name: "Marco Piccinini", matches: 9, fouls_avg: 25.33, penalties_ap: 0.00, yellows_ap: 4.44, yellows: 40, reds_ap: 0.00, reds: 0 },
                 { name: "Federico Dionisi", matches: 9, fouls_avg: 28.11, penalties_ap: 0.00, yellows_ap: 4.56, yellows: 41, reds_ap: 0.11, reds: 1 },
                 { name: "Gianluca Aureliano", matches: 8, fouls_avg: 24.25, penalties_ap: 0.00, yellows_ap: 3.13, yellows: 25, reds_ap: 0.13, reds: 1 },
                 { name: "Paolo Valeri", matches: 7, fouls_avg: 26.86, penalties_ap: 0.00, yellows_ap: 4.57, yellows: 32, reds_ap: 0.14, reds: 1 },
                 { name: "Davide Ghersini", matches: 7, fouls_avg: 23.00, penalties_ap: 0.00, yellows_ap: 4.14, yellows: 29, reds_ap: 0.29, reds: 2 },
                 { name: "Federico La Penna", matches: 7, fouls_avg: 25.14, penalties_ap: 0.00, yellows_ap: 3.86, yellows: 27, reds_ap: 0.00, reds: 0 },
                 { name: "Alessandro Prontera", matches: 7, fouls_avg: 26.29, penalties_ap: 0.00, yellows_ap: 4.43, yellows: 31, reds_ap: 0.14, reds: 1 },
                 { name: "Alberto Santoro", matches: 7, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 4.86, yellows: 34, reds_ap: 0.14, reds: 1 },
                 { name: "Gianluca Manganiello", matches: 6, fouls_avg: 21.17, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 21, reds_ap: 0.00, reds: 0 },
                 { name: "Marco Guida", matches: 5, fouls_avg: 23.20, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                 { name: "Ivano Pezzuto", matches: 5, fouls_avg: 23.80, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 20, reds_ap: 0.00, reds: 0 },
                 { name: "Francesco Cosso", matches: 5, fouls_avg: 22.20, penalties_ap: 0.00, yellows_ap: 3.40, yellows: 17, reds_ap: 0.40, reds: 2 },
                 { name: "Ermanno Feliciani", matches: 5, fouls_avg: 22.40, penalties_ap: 0.00, yellows_ap: 3.80, yellows: 19, reds_ap: 0.00, reds: 0 },
                 { name: "NiccolÃ² Baroni", matches: 4, fouls_avg: 26.25, penalties_ap: 0.00, yellows_ap: 4.25, yellows: 17, reds_ap: 0.25, reds: 1 },
                 { name: "Manuel Volpi", matches: 4, fouls_avg: 26.75, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 16, reds_ap: 0.00, reds: 0 },
                 { name: "Giacomo Camplone", matches: 4, fouls_avg: 23.75, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 14, reds_ap: 0.50, reds: 2 },
                 { name: "Luca Zufferli", matches: 3, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 9, reds_ap: 0.00, reds: 0 },
                 { name: "Maria Ferrieri Caputi", matches: 3, fouls_avg: 23.67, penalties_ap: 0.00, yellows_ap: 2.33, yellows: 7, reds_ap: 0.00, reds: 0 },
                 { name: "Marco Serra", matches: 2, fouls_avg: 28.00, penalties_ap: 0.00, yellows_ap: 3.50, yellows: 7, reds_ap: 0.50, reds: 1 },
                 { name: "Daniele Perenzoni", matches: 2, fouls_avg: 28.50, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Minelli", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 0.00, reds: 0 },
                 { name: "Daniele Paterna", matches: 1, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 6.00, yellows: 6, reds_ap: 2.00, reds: 2 },
                 { name: "Francesco Meraviglia", matches: 1, fouls_avg: 24.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 }
            ],
            "2021-22": [
                { name: "Daniele Doveri", matches: 17, fouls_avg: 26.82, penalties_ap: 0.35, yellows_ap: 3.47, yellows: 59, reds_ap: 0.18, reds: 3 },
                { name: "Marco Di Bello", matches: 17, fouls_avg: 27.18, penalties_ap: 0.47, yellows_ap: 4.29, yellows: 73, reds_ap: 0.24, reds: 4 },
                { name: "Fabio Maresca", matches: 16, fouls_avg: 24.75, penalties_ap: 0.38, yellows_ap: 4.50, yellows: 72, reds_ap: 0.31, reds: 5 },
                { name: "Daniele Chiffi", matches: 16, fouls_avg: 24.88, penalties_ap: 0.31, yellows_ap: 3.63, yellows: 58, reds_ap: 0.19, reds: 3 },
                { name: "Daniele Orsato", matches: 15, fouls_avg: 28.00, penalties_ap: 0.27, yellows_ap: 5.87, yellows: 88, reds_ap: 0.13, reds: 2 },
                { name: "Maurizio Mariani", matches: 14, fouls_avg: 28.79, penalties_ap: 0.21, yellows_ap: 4.86, yellows: 68, reds_ap: 0.36, reds: 5 },
                { name: "Marco Guida", matches: 14, fouls_avg: 27.14, penalties_ap: 0.29, yellows_ap: 4.79, yellows: 67, reds_ap: 0.21, reds: 3 },
                { name: "Davide Massa", matches: 14, fouls_avg: 26.29, penalties_ap: 0.14, yellows_ap: 4.21, yellows: 59, reds_ap: 0.36, reds: 5 },
                { name: "Livio Marinelli", matches: 14, fouls_avg: 21.86, penalties_ap: 0.29, yellows_ap: 3.93, yellows: 55, reds_ap: 0.00, reds: 0 },
                { name: "Simone Sozza", matches: 14, fouls_avg: 26.43, penalties_ap: 0.29, yellows_ap: 4.36, yellows: 61, reds_ap: 0.21, reds: 3 },
                { name: "Rosario Abisso", matches: 13, fouls_avg: 25.92, penalties_ap: 0.46, yellows_ap: 4.69, yellows: 61, reds_ap: 0.31, reds: 4 },
                { name: "Paolo Valeri", matches: 12, fouls_avg: 30.25, penalties_ap: 0.42, yellows_ap: 5.00, yellows: 60, reds_ap: 0.17, reds: 2 },
                { name: "Michael Fabbri", matches: 12, fouls_avg: 23.67, penalties_ap: 0.17, yellows_ap: 3.67, yellows: 44, reds_ap: 0.50, reds: 6 },
                { name: "Luca Pairetto", matches: 12, fouls_avg: 26.58, penalties_ap: 0.92, yellows_ap: 4.33, yellows: 52, reds_ap: 0.25, reds: 3 },
                { name: "Gianluca Manganiello", matches: 12, fouls_avg: 24.08, penalties_ap: 0.17, yellows_ap: 3.50, yellows: 42, reds_ap: 0.17, reds: 2 },
                { name: "Massimiliano Irrati", matches: 11, fouls_avg: 27.00, penalties_ap: 0.64, yellows_ap: 5.64, yellows: 62, reds_ap: 0.27, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 11, fouls_avg: 25.55, penalties_ap: 0.09, yellows_ap: 3.45, yellows: 38, reds_ap: 0.27, reds: 3 },
                { name: "Francesco Fourneau", matches: 11, fouls_avg: 27.45, penalties_ap: 0.36, yellows_ap: 4.73, yellows: 52, reds_ap: 0.27, reds: 3 },
                { name: "Luca Massimi", matches: 11, fouls_avg: 29.27, penalties_ap: 0.18, yellows_ap: 4.27, yellows: 47, reds_ap: 0.27, reds: 3 },
                { name: "Giovanni Ayroldi", matches: 11, fouls_avg: 29.82, penalties_ap: 0.18, yellows_ap: 5.36, yellows: 59, reds_ap: 0.18, reds: 2 },
                { name: "Alessandro Prontera", matches: 10, fouls_avg: 26.70, penalties_ap: 0.50, yellows_ap: 4.70, yellows: 47, reds_ap: 0.40, reds: 4 },
                { name: "Antonio Rapuano", matches: 9, fouls_avg: 26.22, penalties_ap: 0.44, yellows_ap: 4.11, yellows: 37, reds_ap: 0.56, reds: 5 },
                { name: "Davide Ghersini", matches: 8, fouls_avg: 21.38, penalties_ap: 0.63, yellows_ap: 3.25, yellows: 26, reds_ap: 0.13, reds: 1 },
                { name: "Gianluca Aureliano", matches: 8, fouls_avg: 29.63, penalties_ap: 0.75, yellows_ap: 5.13, yellows: 41, reds_ap: 0.25, reds: 2 },
                { name: "Marco Piccinini", matches: 8, fouls_avg: 26.00, penalties_ap: 0.38, yellows_ap: 4.25, yellows: 34, reds_ap: 0.50, reds: 4 },
                { name: "Matteo Marchetti", matches: 8, fouls_avg: 26.13, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 36, reds_ap: 0.00, reds: 0 },
                { name: "Ivano Pezzuto", matches: 7, fouls_avg: 31.14, penalties_ap: 0.14, yellows_ap: 4.86, yellows: 34, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 7, fouls_avg: 26.86, penalties_ap: 0.43, yellows_ap: 3.57, yellows: 25, reds_ap: 0.43, reds: 3 },
                { name: "Antonio Giua", matches: 6, fouls_avg: 25.67, penalties_ap: 0.50, yellows_ap: 5.33, yellows: 32, reds_ap: 0.17, reds: 1 },
                { name: "Manuel Volpi", matches: 6, fouls_avg: 31.17, penalties_ap: 0.50, yellows_ap: 6.17, yellows: 37, reds_ap: 0.33, reds: 2 },
                { name: "Piero Giacomelli", matches: 5, fouls_avg: 29.60, penalties_ap: 0.40, yellows_ap: 4.60, yellows: 23, reds_ap: 0.00, reds: 0 },
                { name: "Marco Serra", matches: 5, fouls_avg: 24.80, penalties_ap: 1.00, yellows_ap: 5.20, yellows: 26, reds_ap: 0.20, reds: 1 },
                { name: "Lorenzo Maggioni", matches: 4, fouls_avg: 29.00, penalties_ap: 0.50, yellows_ap: 5.00, yellows: 20, reds_ap: 0.25, reds: 1 },
                { name: "Giacomo Camplone", matches: 3, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 3.67, yellows: 11, reds_ap: 0.67, reds: 2 },
                { name: "Andrea Colombo", matches: 3, fouls_avg: 25.33, penalties_ap: 0.00, yellows_ap: 5.33, yellows: 16, reds_ap: 0.33, reds: 1 },
                { name: "Matteo Marcenaro", matches: 3, fouls_avg: 28.33, penalties_ap: 0.33, yellows_ap: 4.67, yellows: 14, reds_ap: 0.00, reds: 0 },
                { name: "Valerio Marini", matches: 2, fouls_avg: 28.50, penalties_ap: 1.50, yellows_ap: 5.50, yellows: 11, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Santoro", matches: 2, fouls_avg: 25.50, penalties_ap: 0.00, yellows_ap: 2.50, yellows: 5, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Gariglio", matches: 2, fouls_avg: 25.00, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 10, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Cosso", matches: 2, fouls_avg: 25.00, penalties_ap: 1.00, yellows_ap: 5.00, yellows: 10, reds_ap: 1.00, reds: 2 },
                { name: "Antonio Di Martino", matches: 1, fouls_avg: 26.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "NiccolÃ² Baroni", matches: 1, fouls_avg: 23.00, penalties_ap: 2.00, yellows_ap: 3.00, yellows: 3, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Paterna", matches: 1, fouls_avg: 30.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Meraviglia", matches: 1, fouls_avg: 29.00, penalties_ap: 0.00, yellows_ap: 7.00, yellows: 7, reds_ap: 0.00, reds: 0 },
                { name: "Gianpiero Miele", matches: 1, fouls_avg: 27.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 }
            ],
            "2020-21": [
                { name: "Maurizio Mariani", matches: 18, fouls_avg: 27.11, penalties_ap: 0.50, yellows_ap: 3.67, yellows: 66, reds_ap: 0.11, reds: 2 },
                { name: "Daniele Doveri", matches: 17, fouls_avg: 29.06, penalties_ap: 0.29, yellows_ap: 4.06, yellows: 69, reds_ap: 0.00, reds: 0 },
                { name: "Davide Massa", matches: 17, fouls_avg: 27.76, penalties_ap: 0.35, yellows_ap: 4.47, yellows: 76, reds_ap: 0.24, reds: 4 },
                { name: "Marco Di Bello", matches: 17, fouls_avg: 27.41, penalties_ap: 0.47, yellows_ap: 4.65, yellows: 79, reds_ap: 0.18, reds: 3 },
                { name: "Piero Giacomelli", matches: 17, fouls_avg: 29.65, penalties_ap: 0.65, yellows_ap: 4.59, yellows: 78, reds_ap: 0.06, reds: 1 },
                { name: "Gianpaolo Calvarese", matches: 16, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 3.50, yellows: 56, reds_ap: 0.31, reds: 5 },
                { name: "Daniele Chiffi", matches: 16, fouls_avg: 27.75, penalties_ap: 0.31, yellows_ap: 3.56, yellows: 57, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Orsato", matches: 15, fouls_avg: 29.07, penalties_ap: 0.13, yellows_ap: 5.13, yellows: 77, reds_ap: 0.13, reds: 2 },
                { name: "Luca Pairetto", matches: 15, fouls_avg: 28.67, penalties_ap: 0.47, yellows_ap: 3.80, yellows: 57, reds_ap: 0.40, reds: 6 },
                { name: "Michael Fabbri", matches: 14, fouls_avg: 23.57, penalties_ap: 0.36, yellows_ap: 4.57, yellows: 64, reds_ap: 0.21, reds: 3 },
                { name: "Fabio Maresca", matches: 14, fouls_avg: 26.64, penalties_ap: 0.07, yellows_ap: 6.00, yellows: 84, reds_ap: 0.29, reds: 4 },
                { name: "Paolo Valeri", matches: 13, fouls_avg: 27.00, penalties_ap: 0.38, yellows_ap: 4.38, yellows: 57, reds_ap: 0.23, reds: 3 },
                { name: "Rosario Abisso", matches: 13, fouls_avg: 27.23, penalties_ap: 0.62, yellows_ap: 4.31, yellows: 56, reds_ap: 0.31, reds: 4 },
                { name: "Marco Piccinini", matches: 13, fouls_avg: 27.85, penalties_ap: 0.38, yellows_ap: 3.62, yellows: 47, reds_ap: 0.08, reds: 1 },
                { name: "Fabrizio Pasqua", matches: 12, fouls_avg: 25.00, penalties_ap: 0.25, yellows_ap: 3.42, yellows: 41, reds_ap: 0.25, reds: 3 },
                { name: "Juan Luca Sacchi", matches: 12, fouls_avg: 25.75, penalties_ap: 0.33, yellows_ap: 4.17, yellows: 50, reds_ap: 0.08, reds: 1 },
                { name: "Massimiliano Irrati", matches: 11, fouls_avg: 27.73, penalties_ap: 0.09, yellows_ap: 4.55, yellows: 50, reds_ap: 0.00, reds: 0 },
                { name: "Marco Guida", matches: 10, fouls_avg: 27.70, penalties_ap: 0.50, yellows_ap: 4.20, yellows: 42, reds_ap: 0.30, reds: 3 },
                { name: "Federico La Penna", matches: 10, fouls_avg: 28.00, penalties_ap: 0.40, yellows_ap: 4.80, yellows: 48, reds_ap: 0.40, reds: 4 },
                { name: "Gianluca Manganiello", matches: 10, fouls_avg: 25.40, penalties_ap: 0.20, yellows_ap: 3.00, yellows: 30, reds_ap: 0.10, reds: 1 },
                { name: "Francesco Fourneau", matches: 9, fouls_avg: 29.00, penalties_ap: 0.67, yellows_ap: 5.56, yellows: 50, reds_ap: 0.22, reds: 2 },
                { name: "Valerio Marini", matches: 7, fouls_avg: 30.57, penalties_ap: 0.71, yellows_ap: 4.29, yellows: 30, reds_ap: 0.00, reds: 0 },
                { name: "Giovanni Ayroldi", matches: 7, fouls_avg: 26.00, penalties_ap: 0.57, yellows_ap: 3.86, yellows: 27, reds_ap: 0.43, reds: 3 },
                { name: "Gianluca Aureliano", matches: 6, fouls_avg: 26.17, penalties_ap: 0.67, yellows_ap: 5.50, yellows: 33, reds_ap: 0.00, reds: 0 },
                { name: "Livio Marinelli", matches: 6, fouls_avg: 23.83, penalties_ap: 0.17, yellows_ap: 4.00, yellows: 24, reds_ap: 0.17, reds: 1 },
                { name: "Antonio Giua", matches: 6, fouls_avg: 31.00, penalties_ap: 0.33, yellows_ap: 3.83, yellows: 23, reds_ap: 0.33, reds: 2 },
                { name: "Simone Sozza", matches: 6, fouls_avg: 25.00, penalties_ap: 0.17, yellows_ap: 3.33, yellows: 20, reds_ap: 0.33, reds: 2 },
                { name: "Ivano Pezzuto", matches: 5, fouls_avg: 28.40, penalties_ap: 0.80, yellows_ap: 3.00, yellows: 15, reds_ap: 0.00, reds: 0 },
                { name: "Alessandro Prontera", matches: 5, fouls_avg: 28.60, penalties_ap: 0.40, yellows_ap: 3.40, yellows: 17, reds_ap: 0.40, reds: 2 },
                { name: "Manuel Volpi", matches: 5, fouls_avg: 32.20, penalties_ap: 0.40, yellows_ap: 3.20, yellows: 16, reds_ap: 0.00, reds: 0 },
                { name: "Federico Dionisi", matches: 5, fouls_avg: 29.40, penalties_ap: 0.40, yellows_ap: 4.40, yellows: 22, reds_ap: 0.00, reds: 0 },
                { name: "Davide Ghersini", matches: 4, fouls_avg: 25.75, penalties_ap: 1.00, yellows_ap: 4.50, yellows: 18, reds_ap: 0.00, reds: 0 },
                { name: "Antonio Di Martino", matches: 4, fouls_avg: 28.75, penalties_ap: 0.25, yellows_ap: 4.75, yellows: 19, reds_ap: 0.75, reds: 3 },
                { name: "Antonio Rapuano", matches: 4, fouls_avg: 27.50, penalties_ap: 0.50, yellows_ap: 4.75, yellows: 19, reds_ap: 0.00, reds: 0 },
                { name: "Luca Massimi", matches: 4, fouls_avg: 31.25, penalties_ap: 0.50, yellows_ap: 4.50, yellows: 18, reds_ap: 0.25, reds: 1 },
                { name: "Eugenio Abbattista", matches: 3, fouls_avg: 26.33, penalties_ap: 0.00, yellows_ap: 5.00, yellows: 15, reds_ap: 0.33, reds: 1 },
                { name: "Marco Serra", matches: 2, fouls_avg: 33.00, penalties_ap: 0.00, yellows_ap: 4.50, yellows: 9, reds_ap: 0.00, reds: 0 },
                { name: "Daniele Paterna", matches: 2, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Alberto Santoro", matches: 2, fouls_avg: 27.00, penalties_ap: 0.50, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Gariglio", matches: 2, fouls_avg: 25.00, penalties_ap: 0.50, yellows_ap: 2.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Matteo Marchetti", matches: 2, fouls_avg: 32.00, penalties_ap: 0.00, yellows_ap: 4.00, yellows: 8, reds_ap: 0.00, reds: 0 },
                { name: "Riccardo Ros", matches: 1, fouls_avg: 37.00, penalties_ap: 1.00, yellows_ap: 6.00, yellows: 6, reds_ap: 1.00, reds: 1 },
                { name: "Lorenzo Maggioni", matches: 1, fouls_avg: 21.00, penalties_ap: 0.00, yellows_ap: 1.00, yellows: 1, reds_ap: 0.00, reds: 0 },
                { name: "Giacomo Camplone", matches: 1, fouls_avg: 20.00, penalties_ap: 1.00, yellows_ap: 4.00, yellows: 4, reds_ap: 0.00, reds: 0 },
                { name: "Francesco Meraviglia", matches: 1, fouls_avg: 22.00, penalties_ap: 0.00, yellows_ap: 3.00, yellows: 3, reds_ap: 1.00, reds: 1 }
            ],
        };

        const HISTORICAL_SEASONS = ['2023-24', '2022-23', '2021-22', '2020-21'];
        const SOON_SEASONS = ['2023-24', '2022-23', '2021-22', '2020-21']; // Re-added
        const ANALYTICS_SEASON_OPTIONS = ['2025-26', '2024-25'];
        const ANALYTICS_SEASON_DEFAULT = ['2025-26'];
        let analyticsSeasonFilters = {
            ritmo: [...ANALYTICS_SEASON_DEFAULT],
            severity: [...ANALYTICS_SEASON_DEFAULT],
            refRadar: [...ANALYTICS_SEASON_DEFAULT],
            eff: [...ANALYTICS_SEASON_DEFAULT],
            teamRadar: [...ANALYTICS_SEASON_DEFAULT],
        };

        // --- LOGIC SECTION ---
        let currentView = 'stats';
        let activeSeasons = ['2025-26'];
        let sortColumn = 'matches';
        let sortDirection = 'desc';
        let minMatchesFilterStats = 0;
	let minMatchesFilterPT = 0;
        let analyticsMinMatchesFilter = 0; // NUOVA VARIABILE PER IL FILTRO ANALYTICS
        let hideInactive = false;
        let isSeasonDropdownOpen = false;
        let debounceTimer; // Timer for debounce optimization
        
        // Paging variables for 'matches' view
        let matchesDataAll = [];
        let matchesCurrentPage = 1;
        const MATCHES_PER_PAGE = 50;


        // Chart Instances
        let chartScatter = null;
        let chartMatchCorrelation = null;
        let chartPlayerScatter = null;
        let currentAnalyticsData = [];
        let currentMatchData = [];
let refereeData = [];
let chartRadar = null;
let selectedRadarReferees = [];
        let analyticsActiveTab = 'arbitri';

        const PLAYER_SCATTER_ROLE_COLORS = {
            DF: '#22c55e',
            CC: '#38bdf8',
            ATT: '#ef4444'
        };

        const PLAYER_SCATTER_ROLE_LABELS = {
            DF: 'Difensori',
            CC: 'Centrocampisti',
            ATT: 'Attaccanti'
        };

        let analyticsPlayerRoles = new Set(['DF', 'CC', 'ATT']);


// ðŸ”µ Lista arbitri predefiniti (CAMBIALA OGNI GIORNATA)
const PRESET_RADAR_REFEREES = [
    "Matteo Marchetti",
    "Maurizio Mariani",
    "Marco Guida",
    "Matteo Marcenaro",
    "Michael Fabbri",
    "Valerio Crezzini",
    "Giuseppe Collu",
    "Marco Piccinini",
    "Davide Massa",
    "Ermanno Feliciani"
];


        const REFEREES_2425 = ["Feliciani", "Ayroldi", "Fabbri", "Maresca", "Caputi", "Marchetti", "Marinelli", "Tremolada", "Massa", "Marcenaro", "Sacchi", "Doveri", "Di Marco", "Mariani", "Rapuano", "Sozza", "Pairetto", "Zufferli", "Di Bello", "Giua", "Colombo", "Guida", "Prontera", "Piccinini", "La Penna", "Abisso", "Aureliano", "Manganiello", "Fourneau", "Chiffi", "Dionisi", "Collu", "Massimi", "Bonacina", "Cosso", "Perenzoni", "Ghersini", "Monaldi", "Rutella"];
        const REFEREES_2526 = ["Massa", "Ayroldi", "Collu", "Zufferli", "Sozza", "Manganiello", "Arena", "Marcenaro", "Tremolada", "La Penna", "Guida", "Marinelli", "Doveri", "Mariani", "Bonacina", "Chiffi", "Abisso", "Marchetti", "Crezzini", "Fourneau", "Colombo", "Piccinini", "Rapuano", "Feliciani", "Fabbri", "Dionisi", "Di Bello", "Pairetto", "Sacchi", "Pezzuto", "Di Marco", "GalipÃ²", "Perenzoni", "Ghersini", "Rutella", "Camplone", "Monaldi", "Cosso", "Santoro", "Scatena"];
        const ACTIVE_EXCEPTIONS = ["Maresca", "Caputi", "Ferrieri Caputi"];
        const HISTORICAL_SURNAMES = ["Irrati", "Orsato", "Valeri", "Pasqua", "Calvarese", "Giacomelli"];

// --- DATABASE LOGHI SQUADRE (Fonte: FotMob CDN - PNG Trasparenti) ---
const TEAM_LOGOS = {
    "Atalanta": "https://images.fotmob.com/image_resources/logo/teamlogo/8524.png",
    "Bologna": "https://images.fotmob.com/image_resources/logo/teamlogo/9857.png",
    "Cagliari": "https://images.fotmob.com/image_resources/logo/teamlogo/8529.png",
    "Como": "https://images.fotmob.com/image_resources/logo/teamlogo/10171.png",
    "Cremonese": "https://images.fotmob.com/image_resources/logo/teamlogo/7801.png",
    "Empoli": "https://images.fotmob.com/image_resources/logo/teamlogo/8534.png",
    "Fiorentina": "https://images.fotmob.com/image_resources/logo/teamlogo/8535.png",
    "Genoa": "https://images.fotmob.com/image_resources/logo/teamlogo/10233.png",
    "Inter": "https://images.fotmob.com/image_resources/logo/teamlogo/8636.png",
    "Juventus": "https://images.fotmob.com/image_resources/logo/teamlogo/9885.png",
    "Lazio": "https://images.fotmob.com/image_resources/logo/teamlogo/8543.png",
    "Lecce": "https://images.fotmob.com/image_resources/logo/teamlogo/9888.png",
    "Milan": "https://images.fotmob.com/image_resources/logo/teamlogo/8564.png",
    "Monza": "https://images.fotmob.com/image_resources/logo/teamlogo/6504.png",
    "Napoli": "https://images.fotmob.com/image_resources/logo/teamlogo/9875.png",
    "Parma": "https://images.fotmob.com/image_resources/logo/teamlogo/10167.png",
    "Pisa": "https://images.fotmob.com/image_resources/logo/teamlogo/6479.png",
    "Roma": "https://images.fotmob.com/image_resources/logo/teamlogo/8686.png",
    "Sassuolo": "https://images.fotmob.com/image_resources/logo/teamlogo/7943.png",
    "Torino": "https://images.fotmob.com/image_resources/logo/teamlogo/9804.png",
    "Udinese": "https://images.fotmob.com/image_resources/logo/teamlogo/8600.png",
    "Venezia": "https://images.fotmob.com/image_resources/logo/teamlogo/7881.png",
    "Verona": "https://images.fotmob.com/image_resources/logo/teamlogo/9876.png"
};

// Funzione helper per ottenere il logo (o uno scudetto grigio se manca)
function getTeamLogo(teamName) {
    // Cerca corrispondenza esatta o parziale
    const key = Object.keys(TEAM_LOGOS).find(k => teamName.includes(k));
    return key ? TEAM_LOGOS[key] : "https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg";
}

        // --- DEBOUNCE FUNCTION ---
        function debounce(func, timeout = 300) {
          return (...args) => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => { func.apply(this, args); }, timeout);
          };
        }
        const debounceAggregate = debounce(aggregateData);
        // Nuova funzione debounce per i grafici
        const debounceRenderAnalytics = debounce(renderAnalyticsWithFilters);

        // Helper Functions
        function parseTimeStr(str) {
            if(!str || str.trim().toUpperCase() === 'ND') return NaN;
            const clean = str.replace(/[^\d,\.]/g, '').replace(',', '.');
            const parts = clean.split('.');
            let m = parseInt(parts[0]) || 0;
            let s = parts.length > 1 ? parseInt(parts[1]) : 0;
            return (m * 60) + s;
        }

        function formatSecondsToTime(totalSeconds) {
            if(isNaN(totalSeconds)) return "ND";
            if(!totalSeconds && totalSeconds !== 0) return "00'00''";
            const m = Math.floor(totalSeconds / 60);
            const s = Math.round(totalSeconds % 60);
            return `${m}'${s.toString().padStart(2, '0')}''`;
        }

        function calculateEffRatio(effSec, totSec) {
            if (!Number.isFinite(effSec) || !Number.isFinite(totSec) || totSec === 0) return NaN;
            return (effSec / totSec) * 100;
        }

        function formatEffRatio(value) {
            return Number.isFinite(value) ? `${value.toFixed(1)}%` : '-';
        }

        function parseItalianFloat(str) {
            if(!str || str.trim().toUpperCase() === 'ND') return NaN;
            return parseFloat(str.replace(',', '.').replace('%', ''));
        }

        function isRefereeActive(name) {
            const searchName = name.toUpperCase();
            if (activeSeasons.includes('2025-26')) {
                 if (REFEREES_2526.some(surname => searchName.includes(surname.toUpperCase()))) return true;
                 if (ACTIVE_EXCEPTIONS.some(ex => searchName.includes(ex.toUpperCase()))) return true;
            }
            if (!activeSeasons.includes('2025-26') && activeSeasons.includes('2024-25')) {
                 if (REFEREES_2425.some(surname => searchName.includes(surname.toUpperCase()))) return true;
            }
            return REFEREES_2526.some(surname => searchName.includes(surname.toUpperCase())) ||
                   ACTIVE_EXCEPTIONS.some(ex => searchName.includes(ex.toUpperCase()));
        }

        function formatRefereeNameHTML(fullName) {
            const upperName = fullName.toUpperCase();
            const allSurnames = [...REFEREES_2526, ...REFEREES_2425, ...ACTIVE_EXCEPTIONS, ...HISTORICAL_SURNAMES];
            const matches = allSurnames.filter(s => {
                const sUp = s.toUpperCase();
                return upperName.endsWith(" " + sUp) || upperName === sUp || upperName.includes(" " + sUp + " ");
            });
            const match = matches.sort((a, b) => b.length - a.length)[0];
            let surname = "", firstname = "";

            if (match) {
                const idx = upperName.lastIndexOf(match.toUpperCase());
                surname = fullName.substring(idx);
                firstname = fullName.substring(0, idx).trim();
            } else {
                const parts = fullName.split(' ');
                surname = parts.pop();
                firstname = parts.join(' ');
            }
            return `<div class="flex items-center truncate">
                        <span class="text-slate-500 font-medium mr-1.5 capitalize text-xs hidden sm:inline">${firstname.toLowerCase()}</span> 
                        <span class="text-white font-bold uppercase tracking-wide text-xs sm:text-sm">${surname}</span>
                    </div>`;
        }
        
        function getRefereeSurname(fullName) {
            const upperName = fullName.toUpperCase();
            const allSurnames = [...REFEREES_2526, ...REFEREES_2425, ...ACTIVE_EXCEPTIONS, ...HISTORICAL_SURNAMES];
            const matches = allSurnames.filter(s => upperName.includes(s.toUpperCase()));
            return matches.length > 0 ? matches.sort((a, b) => b.length - a.length)[0] : fullName.split(' ').pop();
        }

        /**
         * Calcola il colore in base al valore.
         * @param {number} value Il valore da colorare.
         * @param {number} min Il valore minimo del range.
         * @param {number} max Il valore massimo del range.
         * @param {boolean} reverse Se TRUE, Verde=Basso, Rosso=Alto. Utile per Tempo Totale.
         * @returns {string} La stringa CSS hsl() per il colore.
         */
        function getColorForValue(value, min, max, reverse = false) {
            if (isNaN(value) || value === null) return 'inherit';
            const range = max - min;
            if (range === 0) return 'hsl(120, 80%, 50%)'; // Verde fisso se il range Ã¨ nullo
            
            let percent = Math.min(1, Math.max(0, (value - min) / range));
            
            // Hue from 0 (red) to 120 (green)
            let hue;
            if (reverse) {
                // Rosso (0) per alto, Verde (120) per basso
                hue = (1 - percent) * 120;
            } else {
                // Rosso (0) per basso, Verde (120) per alto
                hue = percent * 120;
            }
            
            return `hsl(${hue}, 80%, 50%)`;
        }

        function parseMatchesDB(dbString, season) {
            if(!dbString || dbString.trim() === '') return [];
            return dbString.trim().split('\n').map(line => {
                const p = line.trim().split(/\t+/);
                if (p.length < 5) return null;
                return {
                    match: p[0].trim(), totalTimeSec: parseTimeStr(p[1]), effectiveTimeSec: parseTimeStr(p[2]),
                    ratio: parseItalianFloat(p[3]), fouls: parseInt(p[4]) || 0, yellows: p.length > 5 ? (parseInt(p[5]) || 0) : 0,
                    reds: p.length > 6 ? (parseInt(p[6]) || 0) : 0, pens: p.length > 7 ? (parseItalianFloat(p[7]) || 0) : 0,
                    season: season, rawTotal: p[1], rawEff: p[2]
                };
            }).filter(x => x);
        }

        function parsePlayingTimeDB(dbString, season) {
             if(!dbString || dbString.trim() === '') return [];
             return dbString.trim().split('\n').map(line => {
                 const p = line.split('\t');
                 if (p.length < 2) return null;
                 return { season: season, referee: p[0].trim(), effectiveTimeSec: parseTimeStr(p[1]), totalTimeSec: p.length > 2 ? parseTimeStr(p[2]) : NaN };
             }).filter(x => x);
        }

        function processStatsData(seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            let statsMap = new Map();
            const sourceDB = (typeof db !== 'undefined') ? db : STATS_DB;
            seasonsToUse.forEach(season => {
                // Filtra solo le stagioni con dati disponibili (db[season].length > 0)
                if (sourceDB[season] && sourceDB[season].length > 0) {
                    sourceDB[season].forEach(m => {
                        if (!statsMap.has(m.name)) statsMap.set(m.name, { name: m.name, matches: 0, fouls: 0, yellows: 0, reds: 0, pens: 0, w_avgFouls: 0, w_avgYellows: 0, w_avgReds: 0, w_avgPens: 0, w_effMin: 0 });
                        let r = statsMap.get(m.name);
                        r.matches += m.matches; r.yellows += m.yellows; r.reds += m.reds;
                        r.w_avgFouls += m.fouls_avg * m.matches; r.w_avgYellows += m.yellows_ap * m.matches;
                        r.w_avgReds += m.reds_ap * m.matches; r.w_avgPens += m.penalties_ap * m.matches;
                        // Uso eff_min per i dati dummy, altrimenti viene sovrascritto da ptData
                        r.w_effMin += (m.eff_min || 0) * m.matches; 
                    });
                }
            });
            return Array.from(statsMap.values()).map(r => {
                r.avgFouls = r.matches ? (r.w_avgFouls / r.matches) : 0; r.avgYellows = r.matches ? (r.w_avgYellows / r.matches) : 0;
                r.avgReds = r.matches ? (r.w_avgReds / r.matches) : 0; r.avgPens = r.matches ? (r.w_avgPens / r.matches) : 0;
                // Pre-popolo avgEffSec con i dati dummy, se presenti
                r.avgEffSec = r.matches ? (r.w_effMin / r.matches) * 60 : 0; 
                r.isInactive = !isRefereeActive(r.name);
                return r;
            });
        }

        function processCombinedStats(seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            const stats = processStatsData(seasonsToUse);
            const pt = processPlayingTimeViewData(seasonsToUse);
            
            // IMPROVED MERGE: Match by Surname to solve "0 data" issues
            return stats.map(s => {
                const surnameS = getRefereeSurname(s.name);
                const ptData = pt.find(p => getRefereeSurname(p.name) === surnameS);
                // Se ci sono dati in ptData, sovrascrivi l'avgEffSec calcolato prima
                s.avgEffSec = ptData ? ptData.avgEffSec : s.avgEffSec; 
                return {
                    ...s,
                    // avgEffSec: ptData ? ptData.avgEffSec : 0, // Rimossa, usiamo s.avgEffSec giÃ  aggiornato
                    avgTotSec: ptData ? ptData.avgTotSec : 0
                };
            });
        }

        function processPlayingTimeViewData(seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            let statsMap = new Map();
            let allMatchData = [];
            seasonsToUse.forEach(s => {
                let db = (s === '2025-26') ? MATCHES_DB_2526 + EXTRA_MATCHES_2526 : (s === '2024-25' ? MATCHES_DB_2425 : null);
                if(db) allMatchData = allMatchData.concat(parseMatchesDB(db, s));
            });
            seasonsToUse.forEach(season => {
                const refData = parsePlayingTimeDB(PLAYING_TIME_DB[season], season);
                const assignedMatches = new Set();
                refData.forEach(entry => {
                    if (!statsMap.has(entry.referee)) statsMap.set(entry.referee, { name: entry.referee, matches: 0, totalEffectiveSec: 0, totalTotalSec: 0, validEffMatches: 0, validTotMatches: 0, matchList: [] });
                    let r = statsMap.get(entry.referee);
                    r.matches++;
                    if(!isNaN(entry.effectiveTimeSec)) { r.totalEffectiveSec += entry.effectiveTimeSec; r.validEffMatches++; }
                    let match = null;
                    const unassigned = allMatchData.filter(m => !assignedMatches.has(m.match) && m.season === season);
                    if (!isNaN(entry.effectiveTimeSec)) match = unassigned.find(m => Math.abs(m.effectiveTimeSec - entry.effectiveTimeSec) < 1);
                    if (!match && !isNaN(entry.totalTimeSec)) { const c = unassigned.filter(m => Math.abs(m.totalTimeSec - entry.totalTimeSec) < 2); if(c.length) match = c[0]; }
                    if(match) {
                        match.effRatio = Number.isFinite(match.ratio) ? match.ratio : calculateEffRatio(match.effectiveTimeSec, match.totalTimeSec);
                        r.matchList.push(match);
                        assignedMatches.add(match.match);
                        if(!isNaN(match.totalTimeSec)) { r.totalTotalSec += match.totalTimeSec; r.validTotMatches++; }
                    }
                    else {
                        let mt = !isNaN(entry.totalTimeSec) ? entry.totalTimeSec : NaN;
                        if(!isNaN(mt)) { r.totalTotalSec += mt; r.validTotMatches++; }
                        const effRatio = calculateEffRatio(entry.effectiveTimeSec, mt);
                        r.matchList.push({ match: "Dettaglio non disp.", season: season, effectiveTimeSec: entry.effectiveTimeSec, totalTimeSec: mt, effRatio });
                    }
                });
            });
            return Array.from(statsMap.values()).map(r => {
                r.avgEffSec = r.validEffMatches ? (r.totalEffectiveSec / r.validEffMatches) : 0;
                r.avgTotSec = r.validTotMatches ? (r.totalTotalSec / r.validTotMatches) : 0;
                r.effRatio = calculateEffRatio(r.avgEffSec, r.avgTotSec);
                return r;
            });
        }

        function processMatchesViewData(seasons) {
            const seasonsToUse = Array.isArray(seasons) && seasons.length ? seasons : activeSeasons;
            let all = [];
            seasonsToUse.forEach(s => {
                let dbData = (s === '2025-26') ? MATCHES_DB_2526 + EXTRA_MATCHES_2526 : (s === '2024-25' ? MATCHES_DB_2425 : null);
                if(dbData) all = all.concat(parseMatchesDB(dbData, s));
            });

            return all;
        }

        function processTeamsData(seasons) {
            let teamsMap = new Map();
            const matches = processMatchesViewData(seasons);

            matches.forEach(m => {
                if(!m.match.includes('-')) return;
                const parts = m.match.split('-').map(s => s.trim());
                if(parts.length !== 2) return;
                const home = parts[0];
                const away = parts[1];

                [home, away].forEach((team, idx) => {
                    if(!teamsMap.has(team)) teamsMap.set(team, { 
                        name: team, matches: 0, 
                        totalFoulsInGames: 0, homeFoulsInGames: 0, awayFoulsInGames: 0,
                        homeGames: 0, awayGames: 0,
                        totalEffSec: 0, homeEffSec: 0, awayEffSec: 0,
                        validHomeEff: 0, validAwayEff: 0, validTotalEff: 0
                    });
                    
                    const t = teamsMap.get(team);
                    t.matches++;
                    t.totalFoulsInGames += m.fouls;
                    
                    if (!isNaN(m.effectiveTimeSec)) {
                        t.totalEffSec += m.effectiveTimeSec;
                        t.validTotalEff++;
                        if(idx === 0) { // Home
                            t.homeEffSec += m.effectiveTimeSec;
                            t.validHomeEff++;
                        } else { // Away
                            t.awayEffSec += m.effectiveTimeSec;
                            t.validAwayEff++;
                        }
                    }

                    if(idx === 0) { // Home
                        t.homeGames++;
                        t.homeFoulsInGames += m.fouls;
                    } else { // Away
                        t.awayGames++;
                        t.awayFoulsInGames += m.fouls;
                    }
                });
            });

            return Array.from(teamsMap.values()).map(t => {
                const avgFoulsHome = t.homeGames ? t.homeFoulsInGames/t.homeGames : 0;
                const avgFoulsAway = t.awayGames ? t.awayFoulsInGames/t.awayGames : 0;
                return {
                    name: t.name,
                    matches: t.matches,
                    avgFouls: t.matches ? t.totalFoulsInGames/t.matches : 0,
                    avgFoulsHome: avgFoulsHome,
                    avgFoulsAway: avgFoulsAway,
                    avgEff: t.validTotalEff ? t.totalEffSec/t.validTotalEff : 0,
                    avgEffHome: t.validHomeEff ? t.homeEffSec/t.validHomeEff : 0,
                    avgEffAway: t.validAwayEff ? t.awayEffSec/t.validAwayEff : 0
                };
            });
        }

        // --- Aggregation & UI Update ---
        function aggregateData() {
            // Nasconde i messaggi di stato
            ['historical-data-msg', 'empty-state-msg'].forEach(id => document.getElementById(id)?.classList.add('hidden'));
            
            let result = [];
            let matchResult = [];
            
            // Gestione della visibilitÃ  della ricerca globale e dei filtri laterali
            const globalSearchContainer = document.getElementById('global-search-container');
            const statsControls = document.getElementById('stats-controls');
            const minMatchesContainer = document.getElementById('min-matches-container');
            const activeFilterContainer = document.getElementById('active-filter-container');
            const matchesFiltersContainer = document.getElementById('matches-filters-container');

            // Nascondo tutti i filtri specifici per riabilitare solo quelli necessari
            if (globalSearchContainer) globalSearchContainer.classList.add('hidden');
            if (statsControls) statsControls.classList.add('hidden');
            if (matchesFiltersContainer) matchesFiltersContainer.classList.add('hidden');
            if (minMatchesContainer) minMatchesContainer.classList.add('hidden');
            if (activeFilterContainer) activeFilterContainer.classList.add('hidden');


            if (currentView === 'stats') {
                if (globalSearchContainer) globalSearchContainer.classList.remove('hidden');
                if (statsControls) statsControls.classList.remove('hidden');
                if (minMatchesContainer) minMatchesContainer.classList.remove('hidden');
                if (activeFilterContainer) activeFilterContainer.classList.remove('hidden');

                matchesCurrentPage = 1; 
                result = processCombinedStats(); 
                
                if(result.length > 0) {
                    const maxMatches = Math.max(...result.map(r => r.matches));
                    document.getElementById('minMatches').max = maxMatches;
                    document.getElementById('minMatches_mobile').max = maxMatches;
                }
                result = result.filter(r => r.matches >= minMatchesFilterStats);
                if(hideInactive) result = result.filter(r => !r.isInactive);
            } 

else if (currentView === 'playingTime') {
    if (globalSearchContainer) globalSearchContainer.classList.remove('hidden');
    if (statsControls) statsControls.classList.remove('hidden');
    if (minMatchesContainer) minMatchesContainer.classList.remove('hidden');

    matchesCurrentPage = 1;

    result = processPlayingTimeViewData();

    // â­ AGGIORNA IL MASSIMO DEL FILTRO (NUOVO)
    if (result.length > 0) {
        const maxMatchesPT = Math.max(...result.map(r => r.matches));
        document.getElementById('minMatches').max = maxMatchesPT;
        document.getElementById('minMatches_mobile').max = maxMatchesPT;
    }

    // â­ APPLICA IL FILTRO DI PLAYING TIME
    result = result.filter(r => r.matches >= minMatchesFilterPT);
}

else if (currentView === 'matches') {
    if (globalSearchContainer) globalSearchContainer.classList.remove('hidden');
    if (statsControls) statsControls.classList.remove('hidden');
    if (matchesFiltersContainer) matchesFiltersContainer.classList.remove('hidden');
    
    result = processMatchesViewData();
    const minTot = parseInt(document.getElementById('filterMinTot').value) * 60 || 0;
    const maxTot = (parseInt(document.getElementById('filterMaxTot').value) * 60) || 999999;
    const minEff = parseInt(document.getElementById('filterMinEff').value) * 60 || 0;
    const maxEff = (parseInt(document.getElementById('filterMaxEff').value) * 60) || 999999;
    const minFls = parseInt(document.getElementById('filterMinFls').value) || 0;
    const maxFls = parseInt(document.getElementById('filterMaxFls').value) || 999999;
    
    // ðŸ”¢ filtro per minuti / falli
    result = result.filter(r => {
        const tot = r.totalTimeSec || 0; 
        const eff = r.effectiveTimeSec || 0; 
        const fls = r.fouls || 0;
        return (
            tot >= minTot && tot <= maxTot &&
            eff >= minEff && eff <= maxEff &&
            fls >= minFls && fls <= maxFls
        );
    });

    // ðŸ” filtro di ricerca SOLO per la vista "Database / Partite"
    const qMatches = document.getElementById('searchInput')?.value?.toLowerCase() || '';
    if (qMatches) {
        result = result.filter(r =>
            (r.match || '').toLowerCase().includes(qMatches)
        );
    }
    
    matchesDataAll = result; 
    result = matchesDataAll.slice(0, matchesCurrentPage * MATCHES_PER_PAGE);
}

            else if (currentView === 'teams') {
                 if (globalSearchContainer) globalSearchContainer.classList.remove('hidden');
                 matchesCurrentPage = 1;
                 result = processTeamsData();
            }
            else if (currentView === 'analytics') {
                 // NESSUNA RICERCA/FILTRO GLOBALE PER I GRAFICI (solo filtri interni)
                 matchesCurrentPage = 1;

                 // Carica sempre tutte le stagioni disponibili per i grafici, poi i filtri locali gestiscono la selezione
                 result = processCombinedStats(ANALYTICS_SEASON_OPTIONS);
                 matchResult = processMatchesViewData(ANALYTICS_SEASON_OPTIONS);

                 // Imposta il massimo per il filtro min presenze dell'analytics
                 if(result.length > 0) {
                     const maxMatches = Math.max(...result.map(r => r.matches));
                     const analyticsMinMatchesEl = document.getElementById('analyticsMinMatches');
                     if(analyticsMinMatchesEl) analyticsMinMatchesEl.max = maxMatches;
                 }

                 // Il filtro per presenze minime in analytics viene applicato in renderAnalyticsWithFilters
                 if(hideInactive) result = result.filter(r => !r.isInactive);
            }


// Search (applied globally where applicable)
const q = document.getElementById('searchInput')?.value?.toLowerCase() || '';

if(q && result.length && currentView !== 'analytics') {

    if(currentView === 'matches') {
        result = result.filter(r =>
            (r.match || `${r.homeTeam}-${r.awayTeam}`)
                .toLowerCase()
                .includes(q)
        );
    }

    else {
        result = result.filter(r =>
            (r.name || '').toLowerCase().includes(q)
        );
    }
}

            // Sort (applied before paging if matches view)
            if (matchesDataAll.length && currentView === 'matches') {
                 matchesDataAll.sort((a, b) => { 
                    let va = a[sortColumn], vb = b[sortColumn];
                    const isInvalid = (v) => (typeof v === 'number' && isNaN(v)) || v === null || v === undefined;
                    if (isInvalid(va) && isInvalid(vb)) return 0;
                    if (isInvalid(va)) return 1; 
                    if (isInvalid(vb)) return -1; 
                    if (typeof va === 'string') return sortDirection === 'asc' ? va.localeCompare(vb) : vb.localeCompare(va);
                    return sortDirection === 'desc' ? vb - va : va - vb;
                 });
                 result = matchesDataAll.slice(0, matchesCurrentPage * MATCHES_PER_PAGE);
            } else if (result.length && currentView !== 'analytics') {
                result.sort((a, b) => {
                    let va = a[sortColumn], vb = b[sortColumn];
                    if (currentView === 'teams' && ['avgFouls', 'avgEff', 'avgFoulsHome', 'avgFoulsAway'].includes(sortColumn)) { 
                        const isInvalid = (v) => (typeof v === 'number' && isNaN(v)) || v === null || v === undefined || v === 0;
                        if (isInvalid(va) && isInvalid(vb)) return 0;
                        if (isInvalid(va)) return 1; 
                        if (isInvalid(vb)) return -1; 
                    }
                    const isInvalid = (v) => (typeof v === 'number' && isNaN(v)) || v === null || v === undefined;
                    if (isInvalid(va) && isInvalid(vb)) return 0;
                    if (isInvalid(va)) return 1; 
                    if (isInvalid(vb)) return -1; 
                    if (typeof va === 'string') return sortDirection === 'asc' ? va.localeCompare(vb) : vb.localeCompare(va);
                    return sortDirection === 'desc' ? vb - va : va - vb;
                });
            }

            // Render
            if (result.length > 0 || (currentView === 'analytics' && matchResult.length > 0)) {
                if (currentView === 'analytics') {
                    currentAnalyticsData = result;
                    currentMatchData = matchResult.filter(m => !isNaN(m.effectiveTimeSec) && m.effectiveTimeSec > 0 && m.fouls > 0); 
    refereeData = currentAnalyticsData;
                    renderAnalyticsWithFilters(); // Render with local filters
                } else {
                    renderTable(result);
                }
                updateKPIDashboard(result);
            } else {
                updateKPIDashboard([]);
                
                const viewsWithHistorical = ['playingTime', 'matches', 'teams'];
                const isHistoricalView = viewsWithHistorical.includes(currentView);
                const selectedHistorical = activeSeasons.filter(s => SOON_SEASONS.includes(s));
                
                // Controlla se ci sono dati per le stagioni 2024-25 e 2025-26
                const currentDataAvailable = db['2025-26'].length > 0 || db['2024-25'].length > 0;
                
                // Il messaggio storico appare se una vista storica Ã¨ selezionata E ci sono solo stagioni senza dati (SOON) selezionate
                const onlySoonSelected = activeSeasons.every(s => SOON_SEASONS.includes(s));
                const showHistoricalMessage = isHistoricalView && onlySoonSelected && !currentDataAvailable;

                if (showHistoricalMessage) {
                    const msgDiv = document.getElementById('historical-data-msg');
                    msgDiv.classList.remove('hidden');
                    document.getElementById('historical-msg-title').innerText = `Dati Stagione ${selectedHistorical.join(', ')} in fase di caricamento...`;
                } else {
                    document.getElementById('empty-state-msg').classList.remove('hidden');
                }
            }

            updateSeasonButtonsUI();
            updatePageTitleUI();
        }
        
        // --- PAGINATION / LAZY LOADING FUNCTIONS ---
        
        function resetMatchesPaging() {
            matchesCurrentPage = 1;
        }

        function loadMoreMatches() {
            matchesCurrentPage++;
            const startIndex = (matchesCurrentPage - 1) * MATCHES_PER_PAGE;
            const endIndex = matchesCurrentPage * MATCHES_PER_PAGE;
            
            const newMatches = matchesDataAll.slice(startIndex, endIndex);
            
            if (newMatches.length > 0) {
                renderMatchesRows(newMatches, false);
            }
            
            updateLoadMoreButton();
        }

        function updateLoadMoreButton() {
            const btnContainer = document.getElementById('loadMoreContainer');
            if(!btnContainer) return;

            const totalLoaded = matchesCurrentPage * MATCHES_PER_PAGE;
            const totalAvailable = matchesDataAll.length;
            
            if (currentView === 'matches' && totalLoaded < totalAvailable) {
                btnContainer.classList.remove('hidden');
                btnContainer.innerHTML = `<button onclick="loadMoreMatches()" class="w-full bg-slate-800 hover:bg-slate-700 text-yellow-500 font-bold py-2 px-4 rounded transition-colors text-sm flex items-center justify-center gap-2">
                    <i class="fa-solid fa-arrow-down-to-line"></i> Carica altre ${Math.min(MATCHES_PER_PAGE, totalAvailable - totalLoaded)} partite (${totalAvailable - totalLoaded} rimanenti)
                </button>`;
            } else {
                btnContainer.classList.add('hidden');
                if (currentView === 'matches' && totalAvailable > 0) {
                    const tfoot = document.getElementById('tableFooter');
                    // Rimuove messaggi precedenti prima di aggiungere il nuovo
                    const existingMsg = tfoot.querySelector('.final-message');
                    if (existingMsg) existingMsg.remove();
                    // Aggiungo un messaggio finale solo se non ci sono piÃ¹ match da caricare
                    const msgRow = document.createElement('tr');
                    msgRow.innerHTML = `<td colspan="6" class="text-center p-3 text-slate-500 text-xs border-t border-slate-700/50 final-message">Tutte le ${totalAvailable} partite visualizzate.</td>`;
                    tfoot.appendChild(msgRow);
                }
            }
        }
        
        // --- APEX CHARTS LOGIC ---
        
        // NUOVA FUNZIONE PER AGGIORNARE IL FILTRO MIN MATCHES DELL'ANALYTICS
        function updateAnalyticsMinMatches(val) {
            analyticsMinMatchesFilter = parseInt(val);
            document.getElementById('analyticsMinMatchesValue').innerText = val;
            debounceRenderAnalytics(); 
        }

        /**
         * Soluzione Definitiva Quadranti: Iniezione di DIV/HTML (Overlay)
         * Si basa sul ricalcolo manuale della plot area di ApexCharts e l'iniezione
         * di 4 DIV posizionati assolutamente.
         * @param {object} chartContext Il contesto del grafico ApexCharts.
         * @param {number} midXVal Valore medio dell'asse X.
         * @param {number} midYVal Valore medio dell'asse Y.
         * @param {boolean} isSeverityChart TRUE se Ã¨ il grafico di SeveritÃ .
         */

        function injectQuadrantDIVOverlay(chartContext, midXVal, midYVal, isSeverityChart = true) {
            const chart = chartContext.w.globals;
            const containerEl = chart.dom.baseEl;
            
            // Trova l'area di plotting (dove i dati sono disegnati)
            const plotArea = containerEl.querySelector('.apexcharts-plot-area');
            if (!plotArea) return;

            // Rimuove vecchi overlay
            let quadrantLayer = containerEl.querySelector('.overlay-quadranti');
            if (quadrantLayer) {
                quadrantLayer.remove();
            }

            // Aggiunge un nuovo layer di overlay come primo figlio (sotto SVG/Canvas)
            quadrantLayer = document.createElement('div');
            quadrantLayer.className = 'overlay-quadranti';
            containerEl.prepend(quadrantLayer);

            // Calcola le dimensioni e la posizione del plot area rispetto al container
            const containerRect = containerEl.getBoundingClientRect();
            const plotRect = plotArea.getBoundingClientRect();

            const plotTop = plotRect.top - containerRect.top;
            const plotLeft = plotRect.left - containerRect.left;
            const plotWidth = plotRect.width;
            const plotHeight = plotRect.height;

            // Applica le dimensioni e la posizione all'overlay
            quadrantLayer.style.top = `${plotTop}px`;
            quadrantLayer.style.left = `${plotLeft}px`;
            quadrantLayer.style.width = `${plotWidth}px`;
            quadrantLayer.style.height = `${plotHeight}px`;

            // Calcola le coordinate in pixel della linea mediana
            const xRange = chart.maxX - chart.minX;
            const yRange = chart.maxY - chart.minY;
            
            const xPercent = (midXVal - chart.minX) / xRange;
            const yPercent = (midYVal - chart.minY) / yRange;

            // La coordinata X (orizzontale) cresce da sinistra a destra
            let midXPixel = xPercent * plotWidth;
            
            // La coordinata Y (verticale) cresce dall'alto al basso (0% top, 100% bottom)
            // L'asse Y di ApexCharts Ã¨ invertito (Y=min Ã¨ in basso, Y=max Ã¨ in alto)
            let midYPixel = plotHeight * (1 - yPercent);

            // Correzione per valori fuori scala (midXPixel/midYPixel potrebbe essere < 0 o > plotWidth/plotHeight)
            midXPixel = Math.max(0, Math.min(plotWidth, midXPixel));
            midYPixel = Math.max(0, Math.min(plotHeight, midYPixel));

            // Colori: [Top-Left, Top-Right, Bottom-Left, Bottom-Right]
            const SEVERITY_COLORS = {
                // Low F, High Y (Chirurgici)
                TL: '#eab308',
                // High F, High Y (Rigidi)
                TR: '#ef4444', 
                // Low F, Low Y (Inglesi)
                BL: '#64748b', 
                // High F, Low Y (Gestori)
                BR: '#3b82f6'
            };

            const RITMO_COLORS = {
                // Low F, High TE (FluiditÃ )
                TL: '#22c55e', 
                // High F, High TE (Intenso)
                TR: '#3b82f6', 
                // Low F, Low TE (Lento)
                BL: '#64748b', 
                // High F, Low TE (Spezzettato)
                BR: '#ef4444' 
            };

            const colors = isSeverityChart ? SEVERITY_COLORS : RITMO_COLORS;
            
            // Aggiungi i 4 quadranti come DIV (posizionati relativamente all'overlay)
            quadrantLayer.innerHTML = `
                <!-- Top Left (Low X, High Y) -->
                <div class="quadrant" style="top: 0; left: 0; width: ${midXPixel}px; height: ${midYPixel}px; background-color: ${colors.TL}"></div>
                <!-- Top Right (High X, High Y) -->
                <div class="quadrant" style="top: 0; left: ${midXPixel}px; width: ${plotWidth - midXPixel}px; height: ${midYPixel}px; background-color: ${colors.TR}"></div>
                <!-- Bottom Left (Low X, Low Y) -->
                <div class="quadrant" style="top: ${midYPixel}px; left: 0; width: ${midXPixel}px; height: ${plotHeight - midYPixel}px; background-color: ${colors.BL}"></div>
                <!-- Bottom Right (High X, Low Y) -->
                <div class="quadrant" style="top: ${midYPixel}px; left: ${midXPixel}px; width: ${plotWidth - midXPixel}px; height: ${plotHeight - midYPixel}px; background-color: ${colors.BR}"></div>
            `;
            
            // Aggiungi le linee divisorie nel DIV overlay per evitare sovrapposizioni delle etichette
            quadrantLayer.innerHTML += `
                <!-- Linea Orizzontale -->
                <div style="position: absolute; top: ${midYPixel}px; left: 0; width: 100%; height: 1px; background: none; border-top: 1px dashed #475569; pointer-events: none; z-index: 2;"></div>
                <!-- Linea Verticale -->
                <div style="position: absolute; top: 0; left: ${midXPixel}px; width: 1px; height: 100%; background: none; border-left: 1px dashed #475569; pointer-events: none; z-index: 2;"></div>
            `;
        }

        function renderAnalyticsWithFilters() {
            // 1. Applica filtri locali ai dati globali
            const qSeverity = document.getElementById('analyticsSearchSeverity')?.value?.toLowerCase() || '';
            const qRitmo = document.getElementById('analyticsSearchRitmo')?.value?.toLowerCase() || '';

            const severitySeasons = analyticsSeasonFilters.severity || ANALYTICS_SEASON_DEFAULT;
            const radarSeasons = analyticsSeasonFilters.refRadar || ANALYTICS_SEASON_DEFAULT;
            const ritmoSeasons = analyticsSeasonFilters.ritmo || ANALYTICS_SEASON_DEFAULT;
            const effSeasons = analyticsSeasonFilters.eff || ANALYTICS_SEASON_DEFAULT;
            const teamRadarSeasons = analyticsSeasonFilters.teamRadar || ANALYTICS_SEASON_DEFAULT;

            // --- APPLICAZIONE NUOVO FILTRO MIN MATCHES (Feature 1) ---
            const minMatches = analyticsMinMatchesFilter;

            let filteredRefData = processCombinedStats(severitySeasons).filter(r =>
                getRefereeSurname(r.name).toLowerCase().includes(qSeverity) &&
                r.matches >= minMatches
            );

            let radarData = processCombinedStats(radarSeasons).filter(r => r.matches >= minMatches);
            if (hideInactive) {
                filteredRefData = filteredRefData.filter(r => !r.isInactive);
                radarData = radarData.filter(r => !r.isInactive);
            }

            radarData = radarData.filter(r => getRefereeSurname(r.name).toLowerCase().includes(qSeverity));

            const ritmoMatches = processMatchesViewData(ritmoSeasons);
            const filteredMatchData = ritmoMatches.filter(m =>
                m.match.toLowerCase().includes(qRitmo)
            );

            const effMatches = processMatchesViewData(effSeasons);

            // Aggiorna i dataset globali usati dai grafici radar e scatter
            currentAnalyticsData = radarData;
            currentMatchData = ritmoMatches;
            refereeData = radarData;

            // Aggiorna la UI dei chip stagione
            refreshAllAnalyticsSeasonChips();

            // Popola il dropdown del Radar
            const populateSelect = (id) => {
                const select = document.getElementById(id);
                // Salva lo stato del dropdown e ricarica solo le opzioni
                const currentValue = select.value;
                select.innerHTML = '<option value="">Seleziona arbitro da aggiungere...</option>';
                const sortedRefs = [...currentAnalyticsData].sort((a, b) => getRefereeSurname(a.name).localeCompare(getRefereeSurname(b.name)));
                sortedRefs.forEach(r => {
                    const opt = document.createElement('option');
                    opt.value = r.name;
                    opt.text = getRefereeSurname(r.name);
                    select.appendChild(opt);
                });
                select.value = currentValue; // Ripristina il valore selezionato
            }
            populateSelect('radar-ref-select');
            renderRadarChips();

            // 2. Renderizza i grafici con i dati filtrati
            renderSeverityScatter(filteredRefData);
            renderRitmoScatter(filteredMatchData, ritmoMatches, ritmoSeasons);
            updateRadarChart();
            renderEffDistributionChart(effMatches); // Passiamo i dati delle partite
            renderTopFlopTeamsChart(teamRadarSeasons); // Questa calcolerÃ  i dati delle squadre internamente
            renderTeamHeatmap();

        }

        function renderSeverityScatter(refData) {
            const scatterData = refData.filter(r => r.avgFouls > 0 && r.avgYellows > 0).map(r => ({
                x: parseFloat(r.avgFouls.toFixed(2)),
                y: parseFloat(r.avgYellows.toFixed(2)),
                name: getRefereeSurname(r.name)
            }));
            
            const xVals = scatterData.map(d => d.x);
            const yVals = scatterData.map(d => d.y);
            const xMinData = xVals.length ? Math.min(...xVals) : 20;
            const xMaxData = xVals.length ? Math.max(...xVals) : 30;
            const yMinData = yVals.length ? Math.min(...yVals) : 3;
            const yMaxData = yVals.length ? Math.max(...yVals) : 6;

            // Allinea le tacche dei falli a step fissi di 4 unitÃ 
            const FOUL_TICK_STEP = 4;
            const xMin = Math.floor((xMinData - 1) / FOUL_TICK_STEP) * FOUL_TICK_STEP;
            const xMax = Math.ceil((xMaxData + 3) / FOUL_TICK_STEP) * FOUL_TICK_STEP;
            const xTickAmount = Math.max(Math.round((xMax - xMin) / FOUL_TICK_STEP), 1);

            const yMin = Math.floor(yMinData - 0.5);
            const yMax = Math.ceil(yMaxData + 1.5);

            // Calcola le medie reali dei punti mostrati
            const midFouls = xVals.length ? parseFloat((xVals.reduce((sum, val) => sum + val, 0) / xVals.length).toFixed(2)) : 24.5;
            const midYellows = yVals.length ? parseFloat((yVals.reduce((sum, val) => sum + val, 0) / yVals.length).toFixed(2)) : 4.5;

            const scatterOptions = {
                series: [{ name: "Arbitri", data: scatterData }],
                chart: { 
                    type: 'scatter', height: 350, background: 'transparent', 
                    toolbar: { show: false }, zoom: { enabled: false },
                    events: {
                        // Eventi per disegnare l'overlay DIV
                        mounted: (chartContext) => injectQuadrantDIVOverlay(chartContext, midFouls, midYellows, true),
                        updated: (chartContext) => injectQuadrantDIVOverlay(chartContext, midFouls, midYellows, true)
                    }
                },
                // Marker size ripristinata
                markers: { size: 4 }, 
                colors: ['#EAB308'],
                xaxis: { 
                    title: { text: 'Media Falli', style: { color: '#94a3b8' } }, 
                    tickAmount: xTickAmount,
                    min: xMin, max: xMax,
                    labels: { style: { colors: '#cbd5e1' } },
                    axisBorder: { color: '#334155' },
                    axisTicks: { color: '#334155' } 
                },
                yaxis: { 
                    title: { text: 'Media Gialli', style: { color: '#94a3b8' } }, 
                    tickAmount: 5, 
                    min: yMin, max: yMax, 
                    labels: { style: { colors: '#cbd5e1' } } 
                },
                // Linee di annotazione mantenute per le etichette
                annotations: {
                    shapes: [], 
                    xaxis: [{ 
                        x: midFouls, borderColor: '#475569', strokeDashArray: 5, 
                        label: { 
                            borderColor: '#475569', 
                            style: { color: '#cbd5e1', background: '#334155' }, 
                            text: 'Media Falli',
                            offsetY: 10, 
                        } 
                    }],
                    yaxis: [{ 
                        y: midYellows, borderColor: '#475569', strokeDashArray: 5, 
                        label: { 
                            borderColor: '#475569', 
                            style: { color: '#cbd5e1', background: '#334155' }, 
                            text: 'Media Gialli',
                            offsetX: -15, 
                        } 
                    }]
                },
grid: {
    show: true,
    strokeDashArray: 0,
    borderColor: 'rgba(255,255,255,0.04)',

    xaxis: {
        lines: {
            show: true,
            color: 'rgba(255,255,255,0.10)'   // linee verticali leggere
        }
    },

    yaxis: {
        lines: {
            show: true,
            color: 'rgba(255,255,255,0.18)'   // linee orizzontali un po' piÃ¹ visibili
        }
    }
},

                theme: { mode: 'dark' },
                tooltip: { custom: ({ series, seriesIndex, dataPointIndex, w }) => { const d = w.globals.initialSeries[seriesIndex].data[dataPointIndex]; return `<div class="px-3 py-2 bg-slate-800 border border-slate-700 rounded shadow-lg"><div class="font-bold text-white text-xs mb-1">${d.name}</div><div class="text-[10px] text-slate-300">Falli: ${d.x} - Gialli: ${d.y}</div></div>`; } }
            };

            if(chartScatter) chartScatter.destroy();
            chartScatter = new ApexCharts(document.querySelector("#chart-scatter"), scatterOptions);
            chartScatter.render();
        }

function renderRitmoScatter(matchData, fullMatchData, seasonsOverride) {
    // Usa i filtri locali delle stagioni del grafico (fallback ai default analytics)
    const seasons = (seasonsOverride && seasonsOverride.length)
        ? seasonsOverride
        : ANALYTICS_SEASON_OPTIONS;

    // ðŸ”¹ Dati per le MEDIE: tutte le partite delle stagioni selezionate
    const base = (fullMatchData || matchData).filter(m =>
        seasons.includes(m.season)
    );

    // ðŸ”¹ Dati mostrati nel grafico: filtrati da ricerca + stagioni
    const filtered = matchData.filter(m =>
        seasons.includes(m.season)
    );

    // ðŸ”¹ Escludiamo i dati senza Tempo Effettivo o Falli validi
    const validBase = base.filter(m => !isNaN(m.effectiveTimeSec) && !isNaN(m.fouls));
    const validFiltered = filtered.filter(m => !isNaN(m.effectiveTimeSec) && !isNaN(m.fouls));

    // Se NON ci sono punti da mostrare (es. filtro squadra troppo stretto) â†’ grafico "vuoto"
    if (!validFiltered.length) {
        if (chartMatchCorrelation) chartMatchCorrelation.destroy();

        chartMatchCorrelation = new ApexCharts(
            document.querySelector("#chart-match-scatter"),
            {
                series: [],
                chart: {
                    type: 'scatter',
                    height: 350,
                    background: 'transparent',
                    toolbar: { show: false }
                },
                noData: {
                    text: 'Nessun dato per il filtro selezionato',
                    align: 'center',
                    style: {
                        color: '#cbd5e1',
                        fontSize: '12px'
                    }
                },
                xaxis: {
                    labels: { style: { colors: '#cbd5e1' } }
                },
                yaxis: {
                    labels: { style: { colors: '#cbd5e1' } }
                }
            }
        );

        chartMatchCorrelation.render();
        return;
    }

    // ðŸ”¹ Serie del grafico (solo dati FILTRATI -> i pallini che vedi)
    const series = seasons.map(season => ({
        name: season,
        data: validFiltered
            .filter(m => m.season === season)
            .map(m => ({
                x: m.fouls,
                y: +(m.effectiveTimeSec / 60).toFixed(2), // minuti
                matchName: m.match
            }))
    }));

    // ðŸ”¹ Assi fissi
    const mXMin = 10;
    const mXMax = 48;
    const mYMin = 40;
    const mYMax = 70;

    // ðŸ”¹ MEDIE calcolate SOLO sui dati base (tutte le partite delle stagioni attive)
    const totalSeconds = validBase.reduce((sum, m) => sum + m.effectiveTimeSec, 0);
    const avgEffSec = validBase.length ? (totalSeconds / validBase.length) : NaN;
    const avgEff = isNaN(avgEffSec) ? ((mYMin + mYMax) / 2) : +(avgEffSec / 60).toFixed(2);

    const avgFouls = validBase.length ? (validBase.reduce((s, m) => s + m.fouls, 0) / validBase.length) : ((mXMin + mXMax) / 2);


    const matchChartOptions = {
        series: series,

        chart: {
            type: 'scatter',
            height: 350,
            background: 'transparent',
            toolbar: { show: false },
            zoom: { enabled: false },
            events: {
                mounted: (ctx) => injectQuadrantDIVOverlay(ctx, avgFouls, avgEff, false),
                updated: (ctx) => injectQuadrantDIVOverlay(ctx, avgFouls, avgEff, false)
            }
        },

// --- INIZIO MODIFICA: Aggiungi questo blocco RESPONSIVE ---
        responsive: [
            {
                breakpoint: 640, // Si attiva su schermi < 640px (cellulari)
                options: {
                    xaxis: {
                        labels: {
                            rotate: -45, // Consiglio: ruota leggermente i numeri per evitare sovrapposizioni
                            style: {
                                fontSize: '8px', // QUI riduci la dimensione del font (default Ã¨ circa 12px)
                            },
                            hideOverlappingLabels: true // Nasconde i numeri se si accavallano
                        }
                    }
                }
            }
        ],
        // --- FINE MODIFICA ---

        markers: { size: 2.5,
strokeWidth: 0,
            hover: {
                size: 4 // OPZIONALE: Quando ci passi sopra col mouse, si ingrandisce a 5
            }
        },

        // Legenda: solo se >1 stagione
        legend: {
            show: seasons.length > 1,
            position: "top",
            horizontalAlign: "left",
            labels: { colors: "#cbd5e1" },
            fontSize: "11px"
        },

        colors: ['#3b82f6', '#22c55e', '#eab308', '#f97316'],

xaxis: {
    title: { text: 'Falli Totali', style: { color: '#94a3b8' } },
    min: 10,
    max: 48,
    tickAmount: 19,
    labels: {
        style: { colors: '#cbd5e1' },
        formatter: (val) => val
    },
    axisBorder: { color: 'rgba(255,255,255,0.15)' },  // piÃ¹ trasparente
    axisTicks:  { color: 'rgba(255,255,255,0.15)' }    // piÃ¹ trasparente
},

yaxis: {
    title: { text: 'Tempo Effettivo (min)', style: { color: '#94a3b8' } },
    min: mYMin,
    max: mYMax,
    tickAmount: 6,
    labels: {
        style: { colors: '#cbd5e1' },
        formatter: (val) => val.toFixed(0)
    },
    axisBorder: { show: true, color: 'rgba(255,255,255,0.15)' },
    axisTicks:  { show: true, color: 'rgba(255,255,255,0.15)' }
},

grid: {
    borderColor: 'rgba(255,255,255,0.04)',  // linee piÃ¹ morbide
    xaxis: { lines: { show: true } },        // mostra linee verticali
    yaxis: { lines: { show: true } }         // mostra linee orizzontali
},

        // ðŸ”¹ Etichette delle medie â€“ SOLO TESTO, posizionate fuori dai pallini
        annotations: {
            xaxis: [{
                x: avgFouls,
                borderColor: "#475569",
                strokeDashArray: 5,
                label: {
                    borderColor: '#475569',
                    style: { color: '#cbd5e1', background: '#334155' },
                    text: 'Media Falli',
                    offsetY: -20,
                    offsetX: -10
                }
            }],
            yaxis: [{
                y: avgEff,
                borderColor: "#475569",
                strokeDashArray: 5,
                label: {
                    borderColor: '#475569',
                    style: { color: '#cbd5e1', background: '#334155' },
                    text: 'Media T.E.',
                    offsetX: -40,
                    offsetY: 20
                }
            }]
        },

        tooltip: {
            custom: ({ seriesIndex, dataPointIndex, w }) => {
                const d = w.globals.initialSeries[seriesIndex].data[dataPointIndex];
                if (!d) return '';
                return `
                    <div class="px-3 py-2 bg-slate-800 border border-slate-700 rounded shadow-lg">
                        <div class="font-bold text-white text-xs mb-1">${d.matchName}</div>
                        <div class="text-[10px] text-slate-300">
                            Falli: ${d.x} â€“ T.E.: ${d.y.toFixed(2)} min
                        </div>
                    </div>`;
            }
        }
    };

    if (chartMatchCorrelation) chartMatchCorrelation.destroy();
    chartMatchCorrelation = new ApexCharts(
        document.querySelector("#chart-match-scatter"),
        matchChartOptions
    );
    chartMatchCorrelation.render();
}

//NUOVO GRAFICO DITRIBUZIONE TEMPO EFFETTIVO
function renderEffDistributionChart(matches) {
    // 1. Definiamo le fasce (Bins)
    const bins = {
        '< 45 min': 0,
        '45-50 min': 0,
        '50-55 min': 0,
        '55-60 min': 0,
        '> 60 min': 0
    };

    // 2. Contiamo le partite e calcoliamo il totale
    let totalMatches = 0;
    matches.forEach(m => {
        const minutes = m.effectiveTimeSec / 60;
        
        // Controlliamo che il dato sia valido
        if (!isNaN(minutes) && minutes > 0) {
            totalMatches++;
            if (minutes < 45) bins['< 45 min']++;
            else if (minutes >= 45 && minutes < 50) bins['45-50 min']++;
            else if (minutes >= 50 && minutes < 55) bins['50-55 min']++;
            else if (minutes >= 55 && minutes < 60) bins['55-60 min']++;
            else if (minutes >= 60) bins['> 60 min']++;
        }
    });

    const categories = Object.keys(bins);
    const dataValues = Object.values(bins);
    
    // CALCOLO PERCENTUALI
    const dataPercentages = dataValues.map(val => {
        return totalMatches > 0 ? ((val / totalMatches) * 100).toFixed(1) : 0;
    });

    // 3. Configurazione Grafico
    const options = {
        series: [{
            name: '% Partite',
            data: dataPercentages // Usiamo le percentuali qui
        }],
        chart: {
            type: 'bar',
            height: 350,
            background: 'transparent',
            toolbar: { show: false }
        },
        plotOptions: {
            bar: {
                borderRadius: 4,
                columnWidth: '50%',
                distributed: true
            }
        },
        colors: ['#ef4444', '#f97316', '#eab308', '#22c55e', '#00ff1a'],
        dataLabels: {
            enabled: true,
            style: { colors: ['#fff'] },
            formatter: function (val) {
                return val + "%"; // Aggiunge il simbolo % sulle barre
            }
        },
        legend: { show: false },
        xaxis: {
            categories: categories,
            labels: {
                style: { colors: '#cbd5e1', fontSize: '11px' }
            },
            axisBorder: { show: false },
            axisTicks: { show: false }
        },
        yaxis: {
            title: { text: '% Partite', style: { color: '#94a3b8' } },
            labels: { 
                style: { colors: '#cbd5e1' },
                formatter: (val) => parseInt(val) + "%" 
            },
min: 0, // <--- CORREZIONE FONDAMENTALE: Forza l'inizio a 0
            max: function(max) { return max + 5; }, // Lascia spazio in alto
            forceNiceScale: true // Aiuta a rendere i numeri sull'asse piÃ¹ "puliti"
        },
        grid: {
            borderColor: 'rgba(255,255,255,0.05)',
        },
        tooltip: {
            theme: 'dark',
            y: {
                formatter: function (val, { dataPointIndex }) {
                    // Mostra sia la percentuale che il numero reale tra parentesi
                    const count = dataValues[dataPointIndex];
                    return val + "% (" + count + " partite)";
                }
            }
        }
    };

    const chartDiv = document.querySelector("#chart-eff-distribution");
    chartDiv.innerHTML = "";
    const chart = new ApexCharts(chartDiv, options);
    chart.render();
}


//NUOVO GRAFICO radar ritmo squadre

function renderTopFlopTeamsChart(seasons) {
    // 1. Dati e Ordinamento
    let teamsData = processTeamsData(seasons);
    teamsData = teamsData.filter(t => t.avgEff > 0)
                         .sort((a, b) => b.avgEff - a.avgEff);

    if (teamsData.length === 0) return;

    // 2. Dati Reali e Normalizzati
    const realValues = teamsData.map(t => parseFloat((t.avgEff / 60).toFixed(1)));
    const labels = teamsData.map(t => t.name);

    // TRUCCO MATEMATICO (Scala visiva)
    const minVal = Math.min(...realValues);
    const baseline = minVal - 10.0; 
    const visualData = realValues.map(val => parseFloat((val - baseline).toFixed(2)));

    // Colori
    function generateColors(count) {
        const palette = [
            '#22c55e', '#4ade80', '#86efac', 
            '#facc15', '#eab308',            
            '#fb923c', '#f87171', '#ef4444', 
            '#dc2626', '#991b1b'             
        ];
        const colors = [];
        for (let i = 0; i < count; i++) {
            const index = Math.floor((i / count) * palette.length);
            colors.push(palette[Math.min(index, palette.length - 1)]);
        }
        return colors;
    }

    const teamColors = generateColors(realValues.length);

    const options = {
        series: visualData,
        labels: labels,
        chart: {
            type: 'polarArea',
            height: 480, 
            background: 'transparent',
            toolbar: { show: false },
            animations: { enabled: true },
            events: {
                // FONDAMENTALE: Ridisegna i loghi quando il grafico Ã¨ pronto o aggiornato
                mounted: function(chartContext, config) {
                    setTimeout(() => renderRadarLogos(teamsData), 100);
                },
                updated: function(chartContext, config) {
                    setTimeout(() => renderRadarLogos(teamsData), 100);
                }
            }
        },
        stroke: { colors: ['#0f172a'], width: 1 },
        fill: { opacity: 0.9 },
        colors: teamColors, 
        yaxis: { show: false },
        legend: { show: false }, // Nascondiamo la legenda, usiamo i loghi!
        plotOptions: {
            polarArea: {
                rings: { strokeWidth: 0 },
                spokes: { connectorColors: 'rgba(255,255,255,0.1)' }
            }
        },
        dataLabels: { enabled: false }, // Disabilitiamo le etichette di testo
        tooltip: {
            theme: 'dark',
            y: {
                formatter: function (val, { dataPointIndex }) {
                    const trueValue = realValues[dataPointIndex];
                    return trueValue + " min";
                }
            }
        }
    };

    const chartDiv = document.querySelector("#chart-top-flop");
    chartDiv.innerHTML = ""; 
    const chart = new ApexCharts(chartDiv, options);
    chart.render();
}

// --- NUOVA FUNZIONE PER DISEGNARE I LOGHI ---
function renderRadarLogos(teamsData) {
    const container = document.querySelector("#chart-top-flop");
    if (!container) return;

    // 1. Pulizia vecchi loghi
    const oldLogos = container.querySelectorAll('.chart-team-logo');
    oldLogos.forEach(el => el.remove());

    // 2. Trova il centro e il raggio del grafico
    // ApexCharts piazza il canvas al centro. Dobbiamo calcolare in base alle dimensioni del container.
    const rect = container.getBoundingClientRect();
    const width = rect.width;
    const height = rect.height;
    
    // Il centro Ã¨ la metÃ  del contenitore
    const centerX = width / 2;
    const centerY = height / 2;
    
    // Il raggio esterno dove piazzare i loghi. 
    // In un grafico height 480, il raggio utile Ã¨ circa 200-220px. 
    // Se lo schermo Ã¨ piccolo, dobbiamo ridurre.
    const maxRadius = Math.min(width, height) / 2;
    const logoRadius = maxRadius - 30; // 30px dal bordo esterno per non tagliare

    const totalSlices = teamsData.length;
    const angleStep = (2 * Math.PI) / totalSlices;
    
    // ApexCharts Polar inizia a -90 gradi (ore 12)
    const startAngle = -Math.PI / 2; 

    teamsData.forEach((team, index) => {
        // Calcola l'angolo per il centro dello spicchio corrente
        // Angolo Inizio + (Indice * Step) + (Mezzo Step per centrare)
        const angle = startAngle + (index * angleStep) + (angleStep / 2);

        // Calcola coordinate X e Y (Trigonometria di base)
        // x = r * cos(a) + cx
        // y = r * sin(a) + cy
        const x = logoRadius * Math.cos(angle) + centerX;
        const y = logoRadius * Math.sin(angle) + centerY;

        // Crea l'immagine
        const img = document.createElement('img');
        img.src = getTeamLogo(team.name);
        img.className = 'chart-team-logo';
        img.style.left = `${x}px`;
        img.style.top = `${y}px`;
        img.title = `${team.name}: ${(team.avgEff/60).toFixed(1)} min`; // Tooltip nativo

        container.appendChild(img);
    });
}



        

// =========================================================
function addRefereeToRadar() {
    const select = document.getElementById('radar-ref-select');
    const name = select.value;
    if (name && !selectedRadarReferees.includes(name)) {
        if (selectedRadarReferees.length >= 10) {
            console.error("Massimo 10 arbitri raggiunti per il confronto.");
            return;
        }
        selectedRadarReferees.push(name);
        renderRadarChips();
        updateRadarChart();
    }
    select.value = "";
}

function removeRefereeFromRadar(name) {
    selectedRadarReferees = selectedRadarReferees.filter(n => n !== name);
    renderRadarChips();
    updateRadarChart();
}

function resetRadar() {
    selectedRadarReferees = [];
    renderRadarChips();
    updateRadarChart();
}

function loadPresetRadarRefs() {
    // Svuota selezione corrente
    selectedRadarReferees = [];

    PRESET_RADAR_REFEREES.forEach(ref => {
        if (!selectedRadarReferees.includes(ref)) {
            selectedRadarReferees.push(ref);
        }
    });

    renderRadarChips();
    updateRadarChart();
    // se non hai una funzione refreshRadarDropdownChecks(), puoi commentare la prossima riga:
    // refreshRadarDropdownChecks();
}

function renderRadarChips() {
    const container = document.getElementById('radar-chips-container');
    const count = document.getElementById('radar-count');
    container.innerHTML = '';
    if (selectedRadarReferees.length === 0) {
         container.innerHTML = '<span class="text-[10px] text-slate-500 italic py-1">Aggiungi fino a 10 arbitri per il confronto...</span>';
    } else {
        selectedRadarReferees.forEach(name => {
            const surname = getRefereeSurname(name);
            const div = document.createElement('div');
            div.className = 'ref-chip';
            div.innerHTML = `<span>${surname}</span><button onclick="removeRefereeFromRadar('${name}')"><i class="fa-solid fa-times"></i></button>`;
            container.appendChild(div);
        });
    }
    count.innerText = `${selectedRadarReferees.length}/10`;
}

function updateRadarChart() {
    const data = currentAnalyticsData;
    
    // SCALA per â€œspacchettareâ€ i dati
    const SCALE = { 
        FOULS:   { min: 15, max: 35 }, 
        YELLOWS: { min: 1,  max: 7  },
        REDS:    { min: 0,  max: 0.6 },
        PENS:    { min: 0,  max: 0.6 }, 
        EFF:     { min: 50, max: 60 } 
    };
    
    // Calcolo media
    let tF=0, tY=0, tR=0, tP=0, tEff=0, count=0, effCount=0;
    data.forEach(r => { 
        tF += r.avgFouls; 
        tY += r.avgYellows; 
        tR += r.avgReds; 
        tP += r.avgPens; 
        if (r.avgEffSec > 0) { 
            tEff += r.avgEffSec; 
            effCount++; 
        } 
        count++; 
    });

    const avgF   = count     ? tF / count      : 0; 
    const avgY   = count     ? tY / count      : 0; 
    const avgR   = count     ? tR / count      : 0; 
    const avgP   = count     ? tP / count      : 0; 
    const avgEff = effCount  ? (tEff / effCount) / 60 : 0;

    const normalize = (val, min, max) =>
        Math.min(100, Math.max(0, ((val - min) / (max - min)) * 100));

    let seriesData = [{ 
        name: 'Media', 
        data: [
            normalize(avgF,   SCALE.FOULS.min,   SCALE.FOULS.max),
            normalize(avgY,   SCALE.YELLOWS.min, SCALE.YELLOWS.max),
            normalize(avgR,   SCALE.REDS.min,    SCALE.REDS.max),
            normalize(avgP,   SCALE.PENS.min,    SCALE.PENS.max),
            normalize(avgEff, SCALE.EFF.min,     SCALE.EFF.max)
        ],
        raw: [
            avgF.toFixed(1),
            avgY.toFixed(1),
            avgR.toFixed(2),
            avgP.toFixed(2),
            avgEff.toFixed(1)
        ] 
    }];
    
    const addSeries = (name) => {
        const r = data.find(x => x.name === name);
        if (r) {
            const eff = r.avgEffSec > 0 ? (r.avgEffSec / 60) : 0;
            seriesData.push({ 
                name: getRefereeSurname(r.name), 
                data: [
                    normalize(r.avgFouls,   SCALE.FOULS.min,   SCALE.FOULS.max),
                    normalize(r.avgYellows, SCALE.YELLOWS.min, SCALE.YELLOWS.max),
                    normalize(r.avgReds,    SCALE.REDS.min,    SCALE.REDS.max),
                    normalize(r.avgPens,    SCALE.PENS.min,    SCALE.PENS.max),
                    normalize(eff,         SCALE.EFF.min,     SCALE.EFF.max)
                ],
                raw: [
                    r.avgFouls.toFixed(1),
                    r.avgYellows.toFixed(1),
                    r.avgReds.toFixed(2),
                    r.avgPens.toFixed(2),
                    eff.toFixed(1)
                ] 
            });
        }
    };

    selectedRadarReferees.forEach(name => addSeries(name));

    const radarOptions = {
        series: seriesData,
        chart: { 
            type: 'radar', 
            height: 530, 
            background: 'transparent', 
            toolbar: { show: false }
        },
        labels: ['Falli', 'Gialli', 'Rossi', 'Rigori', 'Temp. Eff.'],
        stroke: { width: 1 }, 
        fill: { opacity: 0.25 }, 
        markers: { size: 2.2, strokeWidth: 0.5 }, 
        yaxis: { show: false, max: 100 },
        xaxis: { labels: { style: { colors: ['#cbd5e1','#cbd5e1','#cbd5e1','#cbd5e1','#cbd5e1'], fontSize: '10px', fontFamily: 'JetBrains Mono' } } },
        grid: {
            padding: {
                left: 40,
                right: 10,
                top: 10,
                bottom: 10
            }
        },
        theme: { mode: 'dark', palette: 'palette1' }, 
        legend: { position: 'bottom', labels: { colors: '#cbd5e1' } },
        tooltip: { 
            theme: 'dark', 
            y: { 
                formatter: (val, { seriesIndex, dataPointIndex, w }) => {
                    const series = w.config.series[seriesIndex];
                    if (series && series.raw && series.raw[dataPointIndex] !== undefined) {
                        return series.raw[dataPointIndex] + (dataPointIndex === 4 ? " min" : "");
                    }
                    return val.toFixed(1);
                }
            } 
        }
    };
    
    // Distruggi eventuale grafico precedente
    if (chartRadar) {
        chartRadar.destroy();
        chartRadar = null;
    }

    const radarContainer = document.getElementById('chart-radar');

    // Se NON sono selezionati arbitri â†’ mostra solo il messaggio
    if (selectedRadarReferees.length === 0) {
        radarContainer.innerHTML =
            '<p class="text-xs text-slate-500">Seleziona un arbitro per vedere il profilo.</p>';
        return;
    }

    // Almeno un arbitro â†’ pulisco eventuale messaggio e disegno il grafico
    radarContainer.innerHTML = '';
    chartRadar = new ApexCharts(radarContainer, radarOptions);
    chartRadar.render();
}

// ===========================================
// PARSER STAGIONE 24/25 (TEMPO EFFETTIVO + FALLI)
// ===========================================
function parseSeasonMatches2425() {
    const lines = MATCHES_DB_2425.split('\n').map(l => l.trim()).filter(l => l.length > 0);

    const matrix = {};

    const orderedTeams = [
        "Monza","Venezia","Empoli","Lecce","Parma","Cagliari","Verona","Genoa","Udinese","Torino",
        "Como","Bologna","Milan","Lazio","Fiorentina","Roma","Juventus","Atalanta","Inter","Napoli"
    ];

    orderedTeams.forEach(t => {
        matrix[t] = {};
    });

    let matchIndex = 0;
    for (let i = 0; i < lines.length; i++) {
        const line = lines[i];
        const parts = line.split(/\s+/);

        // 1) Match: "Genoa-Inter"
        const matchName = parts[0];
        const [home, away] = matchName.split('-');

        // 2) TEMPO EFFETTIVO = TERZA COLONNA (parts[2])
        const effStr = parts[2].replace(',', '.');
        const eff = parseFloat(effStr);

        // 3) FALLI = QUINTA COLONNA (parts[4])
        const fouls = parseInt(parts[4], 10) || 0;

        // 4) Giornata (1â€“38, 10 partite per giornata)
        const giornata = Math.floor(matchIndex / 10) + 1;
        matchIndex++;

        if (!matrix[home]) matrix[home] = {};
        if (!matrix[away]) matrix[away] = {};

        // Salvo gli stessi valori per entrambe le squadre
        const cellData = { eff, fouls, match: `${home}-${away}` };
        matrix[home][giornata] = cellData;
        matrix[away][giornata] = cellData;
    }

    const teams = orderedTeams;
    return { teams, matrix };
}

let currentHeatmapMetric = 'eff'; // 'eff' oppure 'fouls'

// ===========================================
// RENDER HEATMAP SQUADRE (24/25) - METRICA DINAMICA
// ===========================================
function renderTeamHeatmap() {

    const { teams, matrix } = parseSeasonMatches2425();

    const orderedTeams = [
        "Monza","Venezia","Empoli","Lecce","Parma","Cagliari","Verona","Genoa","Udinese","Torino",
        "Como","Bologna","Milan","Lazio","Fiorentina","Roma","Juventus","Atalanta","Inter","Napoli"
    ];

    // --- 1) Costruisco la serie in base alla metrica corrente ---
    const metric = currentHeatmapMetric; // 'eff' o 'fouls'

    const series = orderedTeams.map(team => {
        const data = [];
        for (let g = 1; g <= 38; g++) {
            const cell = matrix[team][g];
            if (!cell) {
                data.push(null);
            } else {
                const val = (metric === 'eff') ? cell.eff : cell.fouls;
                data.push(val);
            }
        }
        return {
            name: team,
            data
        };
    });

    // --- 2) Color scale diversa per le due metriche ---
    const effColorScale = {
        ranges: [
            { from: 0,   to: 45,  color: '#e86f5c' },
            { from: 45,  to: 47,  color: '#eba96d' },
            { from: 47,  to: 49,  color: '#efc06f' },
            { from: 49,  to: 51,  color: '#f6d977' },
            { from: 51,  to: 53,  color: '#fae98a' },
            { from: 53,  to: 55,  color: '#f2e897' },
            { from: 55,  to: 57,  color: '#d7e5a4' },
            { from: 57,  to: 59,  color: '#b9dca1' },
            { from: 59,  to: 61,  color: '#9ad593' },
            { from: 61,  to: 63,  color: '#7ac87d' },
            { from: 63,  to: 65,  color: '#5dbf72' },
            { from: 65,  to: 70,  color: '#4fb56b' }
        ]
    };

    // stima range falli ~ 10â€“40 (puoi rifinirla piÃ¹ avanti)
const foulsColorScale = {
    ranges: [
        { from: 0,  to: 18, color: '#7ac87d' },   // pochi falli â†’ verde chiaro
        { from: 18, to: 21, color: '#9ad593' },
        { from: 21, to: 24, color: '#b9dca1' },
        { from: 24, to: 27, color: '#d7e5a4' },
        { from: 27, to: 30, color: '#fae98a' },
        { from: 30, to: 33, color: '#f6d977' },
        { from: 33, to: 36, color: '#efc06f' },
        { from: 36, to: 40, color: '#eba96d' },
        { from: 40, to: 99, color: '#e86f5c' }   // molti falli â†’ rosso
    ]
};

    const colorScale = (metric === 'eff') ? effColorScale : foulsColorScale;

    const options = {
        series: series,
        chart: {
            type: "heatmap",
            height: 600,
            background: "transparent",
            toolbar: { show: false }
        },
        plotOptions: {
            heatmap: {
                enableShades: false,
                shadeIntensity: 0,
                colorScale: colorScale,
                radius: 0
            }
        },
        xaxis: {
            categories: Array.from({ length: 38 }, (_, i) => i + 1),
            title: { text: "Giornate", style: { color: '#cbd5e1' } },
            labels: { style: { colors: '#94a3b8', fontSize: '10px' } }
        },
        yaxis: {
            categories: orderedTeams,
            labels: { style: { colors: '#cbd5e1', fontSize: '11px' } }
        },
        dataLabels: { enabled: false },
        tooltip: {
            theme: 'dark',
            x: { show: false },
            y: { show: false },
            custom: function({ seriesIndex, dataPointIndex }) {
                const squadra = orderedTeams[seriesIndex];
                const giornata = dataPointIndex + 1;
                const row = matrix[squadra];
                if (!row) return '';

                const cell = row[giornata];
                if (!cell) return '';

                const nomePartita = cell.match;

                let valueLabel;
                if (metric === 'eff') {
                    valueLabel = `${cell.eff.toFixed(2)} min`;
                } else {
                    valueLabel = `${cell.fouls} falli fischiati`;
                }

                return `
                    <div class="px-2 py-1 text-xs bg-slate-900 border border-slate-700 rounded shadow-lg text-slate-100">
                        ${nomePartita} â€” ${valueLabel}
                    </div>
                `;
            }
        }
    };

    const container = document.getElementById("chart-team-heatmap");

    if (container._chart) {
        container._chart.destroy();
    }

    container._chart = new ApexCharts(container, options);
    container._chart.render();
}




// Ricalcola e riposiziona l'overlay ad ogni ridimensionamento
window.addEventListener('resize', debounceRenderAnalytics);

        function updatePlayerScatterRoleUI() {
            document.querySelectorAll('.player-scatter-role-toggle').forEach((btn) => {
                const role = btn.getAttribute('data-role');
                const isActive = analyticsPlayerRoles.has(role);

                btn.classList.toggle('bg-slate-800/70', isActive);
                btn.classList.toggle('bg-slate-900/40', !isActive);
                btn.style.borderColor = isActive
                    ? (PLAYER_SCATTER_ROLE_COLORS[role] || '#eab308')
                    : '#1e293b';
            });
        }

        function togglePlayerScatterRole(role) {
            if (!PLAYER_SCATTER_ROLE_COLORS[role]) return;

            if (analyticsPlayerRoles.has(role) && analyticsPlayerRoles.size > 1) {
                analyticsPlayerRoles.delete(role);
            } else {
                analyticsPlayerRoles.add(role);
            }

            updatePlayerScatterRoleUI();
            renderPlayerScatterChart();
        }

        function renderPlayerScatterChart() {
            const container = document.querySelector('#chart-player-scatter');
            if (!container) return;

            const minPresence = playersMaxMatches ? playersMaxMatches * 0.3 : 0;

            const eligiblePlayers = playersData
                .filter(p => Number.isFinite(p.n90) && p.n90 >= minPresence)
                .filter(p => {
                    const roles = (p.role || '')
                        .split(',')
                        .map(r => r.trim().toUpperCase())
                        .filter(Boolean);

                    const nonGoalkeeperRoles = roles.filter(r => r !== 'POR');
                    if (!nonGoalkeeperRoles.length) return false;

                    return nonGoalkeeperRoles.some(r => analyticsPlayerRoles.has(r));
                })
                .filter(p => Number.isFinite(p.shotsPer90) && Number.isFinite(p.shotsOnTargetPer90));

            const series = Array.from(analyticsPlayerRoles).map((role) => {
                const roleData = eligiblePlayers
                    .filter(p => (p.role || '').toUpperCase().includes(role))
                    .map(p => ({
                        x: p.shotsPer90,
                        y: p.shotsOnTargetPer90,
                        name: formatPlayerName(p.name),
                        team: p.team || ''
                    }));

                return {
                    name: PLAYER_SCATTER_ROLE_LABELS[role] || role,
                    data: roleData,
                    color: PLAYER_SCATTER_ROLE_COLORS[role]
                };
            }).filter(series => series.data.length);

            if (chartPlayerScatter) {
                chartPlayerScatter.destroy();
                chartPlayerScatter = null;
            }

            if (!series.length) {
                chartPlayerScatter = new ApexCharts(container, {
                    series: [],
                    chart: {
                        type: 'scatter',
                        height: 420,
                        background: 'transparent',
                        toolbar: { show: false }
                    },
                    noData: {
                        text: 'Nessun giocatore corrisponde ai filtri',
                        align: 'center',
                        style: { color: '#cbd5e1', fontSize: '12px' }
                    },
                    xaxis: { labels: { style: { colors: '#cbd5e1' } } },
                    yaxis: { labels: { style: { colors: '#cbd5e1' } } }
                });

                chartPlayerScatter.render();
                return;
            }

            const computeAxisParams = (maxValue) => {
                const safeMax = Math.max(maxValue, 1);
                const targetTicks = 6;
                const roughStep = safeMax / targetTicks;
                const magnitude = Math.pow(10, Math.floor(Math.log10(roughStep)));
                const residual = roughStep / magnitude;

                let niceStep;
                if (residual >= 5) niceStep = 10;
                else if (residual >= 2) niceStep = 5;
                else if (residual >= 1) niceStep = 2;
                else niceStep = 1;

                const stepSize = niceStep * magnitude;
                const niceMax = Math.ceil(safeMax / stepSize) * stepSize;
                const tickAmount = Math.max(3, Math.min(10, Math.round(niceMax / stepSize)));

                return { niceMax, tickAmount };
            };

            const maxShotsPer90 = Math.max(...eligiblePlayers.map(p => p.shotsPer90));
            const maxShotsOnTargetPer90 = Math.max(...eligiblePlayers.map(p => p.shotsOnTargetPer90));

            const { niceMax: maxX, tickAmount: xTicks } = computeAxisParams(maxShotsPer90);
            const { niceMax: maxY, tickAmount: yTicks } = computeAxisParams(maxShotsOnTargetPer90);

            const scatterOptions = {
                series,
                chart: {
                    type: 'scatter',
                    height: 460,
                    background: 'transparent',
                    toolbar: { show: false },
                    zoom: { enabled: false },
                    events: {
                        dataPointMouseEnter: (event, chartContext, config) => {
                            const d = config.w.config.series?.[config.seriesIndex]?.data?.[config.dataPointIndex];
                            if (!d) return;

                            chartContext?.updateOptions({
                                annotations: {
                                    xaxis: [{
                                        x: d.x,
                                        strokeDashArray: 5,
                                        borderColor: 'rgba(255,255,255,0.4)'
                                    }],
                                    yaxis: [{
                                        y: d.y,
                                        strokeDashArray: 5,
                                        borderColor: 'rgba(255,255,255,0.4)'
                                    }]
                                }
                            }, false, false);
                        },
                        dataPointMouseLeave: (event, chartContext) => {
                            chartContext?.updateOptions({ annotations: { xaxis: [], yaxis: [] } }, false, false);
                        }
                    }
                },
                colors: series.map(s => s.color),
                dataLabels: { enabled: false },
                markers: { size: 3, strokeWidth: 0 },
                grid: {
                    borderColor: 'rgba(255,255,255,0.08)',
                    strokeDashArray: 0,
                    xaxis: { lines: { show: true } },
                    yaxis: { lines: { show: true } }
                },
                xaxis: {
                    title: { text: 'Tiri/90', style: { color: '#cbd5e1', fontWeight: 600 } },
                    labels: { style: { colors: '#cbd5e1' } },
                    min: 0,
                    max: maxX,
                    tickAmount: xTicks,
                    crosshairs: {
                        show: true,
                        position: 'back',
                        stroke: { color: 'rgba(255,255,255,0.4)', width: 1, dashArray: 5 }
                    }
                },
                yaxis: {
                    title: { text: 'Tiri in porta/90', style: { color: '#cbd5e1', fontWeight: 600 } },
                    labels: { style: { colors: '#cbd5e1' } },
                    min: 0,
                    max: maxY,
                    tickAmount: yTicks,
                    crosshairs: {
                        show: true,
                        stroke: { color: 'rgba(255,255,255,0.4)', width: 1, dashArray: 5 }
                    }
                },
                legend: {
                    labels: { colors: '#e2e8f0' }
                },
                tooltip: {
                    custom: ({ seriesIndex, dataPointIndex, w }) => {
                        const d = w.globals.initialSeries[seriesIndex].data[dataPointIndex];
                        if (!d) return '';

                        const roleKey = Object.keys(PLAYER_SCATTER_ROLE_LABELS).find(key =>
                            PLAYER_SCATTER_ROLE_LABELS[key] === w.globals.initialSeries[seriesIndex].name
                        );

                        const bullet = roleKey && PLAYER_SCATTER_ROLE_COLORS[roleKey]
                            ? `<span style="background:${PLAYER_SCATTER_ROLE_COLORS[roleKey]};" class="inline-block w-2 h-2 rounded-full mr-2"></span>`
                            : '';

                        const shots = Number.isFinite(d.x) ? d.x.toFixed(2) : d.x;
                        const shotsOn = Number.isFinite(d.y) ? d.y.toFixed(2) : d.y;

                        return `
                            <div class="px-3 py-2 bg-slate-800 border border-slate-700 rounded shadow-lg">
                                <div class="font-bold text-white text-xs mb-1">${bullet}${d.name}</div>
                                <div class="text-[10px] text-slate-300">${d.team ? `${d.team} Â· ` : ''}Tiri/90: ${shots} â€” Tiri in porta/90: ${shotsOn}</div>
                            </div>`;
                    }
                },
                annotations: { xaxis: [], yaxis: [] }
            };

            chartPlayerScatter = new ApexCharts(container, scatterOptions);
            chartPlayerScatter.render();
        }




        


        // --- UI RENDER FUNCTIONS ---
        function updatePageTitleUI() {
            const el = document.getElementById('breadcrumb-current');
            const title = document.getElementById('page-title');
            if(currentView === 'stats') { el.innerText = "Overview"; title.innerText = ""; }
            else if(currentView === 'analytics') { el.innerText = "Visual"; title.innerText = ""; }
            else if(currentView === 'playingTime') { el.innerText = "Performance"; title.innerText = ""; }
            else if(currentView === 'teams') { el.innerText = "Ranking"; title.innerText = ""; }
            else { el.innerText = "Database"; title.innerText = ""; }
        }

        function renderTable(data) {
            const thead = document.getElementById('tableHeader');
            const tbody = document.getElementById('tableBody');
            const tfoot = document.getElementById('tableFooter');
            
            thead.innerHTML = ''; tbody.innerHTML = ''; tfoot.innerHTML = '';
            
            const getSortIcon = (col) => sortColumn === col ? (sortDirection === 'asc' ? '<i class="fa-solid fa-sort-up ml-1 text-yellow-500"></i>' : '<i class="fa-solid fa-sort-down ml-1 text-yellow-500"></i>') : '';
            
            // Tooltip mapping for Teams view
            const tooltipMap = {
                'matches': 'Partite giocate dalla squadra nella stagione selezionata.',
                'avgFouls': 'Media falli fischiati nella partita (a favore/contro la squadra) per partita.',
                'avgFoulsHome': 'Media falli a partita, considerando solo le partite in casa.',
                'avgFoulsAway': 'Media falli a partita, considerando solo le partite in trasferta.',
                'avgEffHome': 'Tempo effettivo medio delle partite casalinghe (in minuti e secondi).',
                'avgEffAway': 'Tempo effettivo medio delle partite in trasferta (in minuti e secondi).',
                'avgEff': 'Tempo effettivo medio totale (in minuti e secondi).'
            };
            
            const th = (lbl, col, cls='', tooltip='') => {
                const titleAttr = tooltip ? `title="${tooltip}"` : '';
                return `<th class="cursor-pointer select-none hover:text-white transition-colors ${cls}" onclick="handleSort('${col}')" ${titleAttr}>
                    <span class="flex items-center justify-center ${cls.includes('sticky-col') ? 'justify-start' : 'justify-center'}">
                        ${lbl}${getSortIcon(col)}
                    </span>
                </th>`;
            }

            if (currentView === 'stats') {
                thead.innerHTML = `<tr>${th('Arbitro', 'name', 'sticky-col')}${th('Presenze', 'matches', 'text-center')}${th('Falli/P', 'avgFouls', 'text-center')}${th('Gialli Tot', 'yellows', 'text-center !text-yellow-500 font-bold')}${th('Gialli/P', 'avgYellows', 'text-center !text-yellow-500')}${th('Rossi Tot', 'reds', 'text-center !text-red-500 font-bold')}${th('Rossi/P', 'avgReds', 'text-center !text-red-500')}${th('Rigori/P', 'avgPens', 'text-center')}</tr>`;
                let tM=0, tF=0, tY=0, tR=0, tP=0;
                data.forEach((r) => { tM+=r.matches; tF+=r.avgFouls*r.matches; tY+=r.yellows; tR+=r.reds; tP+=r.avgPens*r.matches; tbody.innerHTML += `<tr class="${r.isInactive?'opacity-50 grayscale':''}"><td class="sticky-col border-b border-slate-800">${formatRefereeNameHTML(r.name)}</td><td class="text-center font-bold text-white text-base">${r.matches}</td><td class="text-center text-slate-300">${r.avgFouls.toFixed(2)}</td><td class="text-center !text-yellow-500 font-bold">${r.yellows}</td><td class="text-center !text-yellow-500">${r.avgYellows.toFixed(2)}</td><td class="text-center !text-red-500 font-bold">${r.reds}</td><td class="text-center !text-red-500">${r.avgReds.toFixed(2)}</td><td class="text-center text-slate-400">${r.avgPens.toFixed(2)}</td></tr>`; });
                // Nota come ho cambiato tutti i 'p-3' in 'p-2'
tfoot.innerHTML = `<tr><td class="sticky-col p-2 border-t border-slate-700">TOTALE</td><td class="text-center p-2 text-white">${tM}</td><td class="text-center p-2">${(tF/tM).toFixed(2)}</td><td class="text-center p-2 text-yellow-500 font-bold">${tY}</td><td class="text-center p-2 text-yellow-500">${(tY/tM).toFixed(2)}</td><td class="text-center p-2 text-red-500 font-bold">${tR}</td><td class="text-center p-2 text-red-500">${(tR/tM).toFixed(2)}</td><td class="text-center p-2">${(tP/tM).toFixed(2)}</td></tr>`;
            } 
            else if (currentView === 'playingTime') {
                const showTot = activeSeasons.includes('2025-26') || activeSeasons.includes('2024-25');
                thead.innerHTML = `<tr>${th('Arbitro', 'name', 'sticky-col')}${th('Match', 'matches', 'text-center')}${th('Media T.E.', 'avgEffSec', 'text-center text-green-400')}${showTot ? th('Media T.Tot', 'avgTotSec', 'text-center text-blue-400') : ''}${th('Media % T.Eff', 'effRatio', 'text-center text-yellow-400')}<th class="w-10"></th></tr>`;
                data.forEach((r, i) => {
                    tbody.innerHTML += `<tr class="cursor-pointer group" onclick="toggleDetails(${i})"><td class="sticky-col border-b border-slate-800">${formatRefereeNameHTML(r.name)}</td><td class="text-center text-white">${r.matches}</td><td class="text-center font-bold text-green-400 font-mono text-base">${formatSecondsToTime(r.avgEffSec)}</td>${showTot ? `<td class="text-center font-medium text-blue-400 font-mono">${formatSecondsToTime(r.avgTotSec)}</td>` : ''}<td class="text-center font-mono text-yellow-400 font-semibold">${formatEffRatio(r.effRatio)}</td><td class="text-center text-slate-600 group-hover:text-white transition-colors"><i class="fa-solid fa-chevron-down text-xs" id="icon-${i}"></i></td></tr>`;
                    const matchesHeader = `<div class="grid grid-cols-${showTot ? '5' : '4'} gap-2 px-4 pb-2 text-[10px] uppercase tracking-wider text-slate-500"><span class="text-left">Partita</span><span class="text-center">Stagione</span><span class="text-center">T. Eff</span>${showTot ? '<span class="text-center">T. Tot</span>' : ''}<span class="text-center">% Eff</span></div>`;
                    const matchesHtml = r.matchList.map(m => {
                        const ratioDisplay = formatEffRatio(Number.isFinite(m.effRatio) ? m.effRatio : calculateEffRatio(m.effectiveTimeSec, m.totalTimeSec));
                        return `<div class="grid grid-cols-${showTot ? '5' : '4'} gap-2 py-2 px-4 border-b border-slate-800/50 text-xs hover:bg-slate-800 items-center">`+
                            `<span class="text-white font-bold truncate">${m.match}</span>`+
                            `<span class="text-center text-slate-500 font-mono">${m.season || '-'}</span>`+
                            `<span class="text-center font-mono ${m.effectiveTimeSec ? 'text-green-400' : 'text-slate-600'}">${formatSecondsToTime(m.effectiveTimeSec)}</span>`+
                            `${showTot ? `<span class="text-center font-mono text-blue-400">${formatSecondsToTime(m.totalTimeSec)}</span>` : ''}`+
                            `<span class="text-center font-mono text-yellow-400">${ratioDisplay}</span>`+
                        `</div>`;
                    }).join('');
                    tbody.innerHTML += `<tr id="details-${i}" class="hidden bg-slate-900/50"><td colspan="${showTot ? 6 : 5}" class="p-0 border-b border-slate-800"><div class="py-2 bg-[#0b1120] shadow-inner">${matchesHeader}${matchesHtml}</div></td></tr>`;
                });
            } else if (currentView === 'matches') {

                // Separated rendering logic for paging
                renderMatchesHeader(thead, th, getSortIcon);
                renderMatchesRows(data, true); // Pass true to clear tbody first
                renderMatchesFooter(tfoot, data.length);
                updateLoadMoreButton();
            } else if (currentView === 'teams') {
                // Squadra, Partite, Falli Tot, Falli Casa, Falli Trasf, T.Eff. Medio, T.Eff. Casa, T.Eff. Trasf.
                
                thead.innerHTML = `<tr>
                    ${th('Squadra', 'name', 'sticky-col')}
                    ${th('Partite', 'matches', 'text-center', tooltipMap.matches)}
                    ${th('Falli Tot', 'avgFouls', 'text-center text-red-400', tooltipMap.avgFouls)}
                    ${th('Falli Casa', 'avgFoulsHome', 'text-center text-red-400/70', tooltipMap.avgFoulsHome)}
                    ${th('Falli Trasf', 'avgFoulsAway', 'text-center text-red-400/70', tooltipMap.avgFoulsAway)}
                    ${th('T.Eff. Medio', 'avgEff', 'text-center text-green-400 font-bold', tooltipMap.avgEff)}
                    ${th('T.Eff. Casa', 'avgEffHome', 'text-center text-green-400/70', tooltipMap.avgEffHome)}
                    ${th('T.Eff. Trasf', 'avgEffAway', 'text-center text-green-400/70', tooltipMap.avgEffAway)}
                    </tr>`;
                
                data.forEach(t => {
                    tbody.innerHTML += `<tr>
                        <td class="sticky-col border-b border-slate-800 font-bold text-white">${t.name}</td>
                        <td class="text-center text-slate-400">${t.matches}</td>
                        <td class="text-center font-bold text-red-400">${t.avgFouls.toFixed(1)}</td>
                        <td class="text-center text-red-400/70">${t.avgFoulsHome.toFixed(1)}</td>
                        <td class="text-center text-red-400/70">${t.avgFoulsAway.toFixed(1)}</td>
                        <td class="text-center font-mono font-bold text-green-400">${formatSecondsToTime(t.avgEff)}</td>
                        <td class="text-center font-mono text-green-400/70">${formatSecondsToTime(t.avgEffHome)}</td>
                        <td class="text-center font-mono text-green-400/70">${formatSecondsToTime(t.avgEffAway)}</td>
                    </tr>`;
                });
            }
        }
        
        function renderMatchesHeader(thead, th, getSortIcon) {
             thead.innerHTML = `<tr>${th('Partita', 'match', 'sticky-col')}${th('Stagione', 'season', 'text-center')}${th('Tempo Tot', 'totalTimeSec', 'text-center text-blue-400')}${th('Tempo Eff', 'effectiveTimeSec', 'text-center text-green-400')}${th('% Eff', 'ratio', 'text-center')}${th('Falli', 'fouls', 'text-center text-red-400')}</tr>`;
        }

        function renderMatchesRows(data, clearTbody = true) {
            const tbody = document.getElementById('tableBody');
            if (clearTbody) tbody.innerHTML = '';
            
            // Per il calcolo dei colori, usiamo tutti i dati filtrati (matchesDataAll)
            const validTots = matchesDataAll.map(d=>d.totalTimeSec).filter(v=>!isNaN(v));
            const validEffs = matchesDataAll.map(d=>d.effectiveTimeSec).filter(v=>!isNaN(v));
            const validRatios = matchesDataAll.map(d=>d.ratio).filter(v=>!isNaN(v));
            
            const minTot = Math.min(...validTots); const maxTot = Math.max(...validTots);
            const minEff = Math.min(...validEffs); const maxEff = Math.max(...validEffs);
            const minRat = Math.min(...validRatios); const maxRat = Math.max(...validRatios);

            let rowsHtml = '';
            data.forEach((r) => { 
                const colTot = getColorForValue(r.totalTimeSec, minTot, maxTot, true);
                const colEff = getColorForValue(r.effectiveTimeSec, minEff, maxEff);
                const colRat = getColorForValue(r.ratio, minRat, maxRat);

                rowsHtml += `<tr>
                    <td class="sticky-col border-b border-slate-800 font-bold text-white text-xs sm:text-sm truncate max-w-[180px] sm:max-w-none" title="${r.match}">${r.match}</td>
                    <td class="text-center text-slate-500 text-xs">${r.season}</td>
                    <td class="text-center font-mono" style="color: ${colTot}">${formatSecondsToTime(r.totalTimeSec)}</td>
                    <td class="text-center font-mono font-bold" style="color: ${colEff}">${formatSecondsToTime(r.effectiveTimeSec)}</td>
                    <td class="text-center font-mono font-bold" style="color: ${colRat}">${r.ratio ? r.ratio.toFixed(1) + '%' : '-'}</td>
                    <td class="text-center font-bold text-white bg-slate-800/30 rounded">${r.fouls}</td>
                </tr>`;
            });
            tbody.innerHTML += rowsHtml;
        }

        function renderMatchesFooter(tfoot, dataLength) {
            tfoot.innerHTML = '';
            
            const dataToCalculate = matchesDataAll;
            let sumTot=0, countTot=0, sumEff=0, countEff=0, sumRat=0, countRat=0, sumFouls=0, countFouls=0, countMatches=dataToCalculate.length;

            dataToCalculate.forEach((r) => { 
                if(!isNaN(r.totalTimeSec)) { sumTot+=r.totalTimeSec; countTot++; }
                if(!isNaN(r.effectiveTimeSec)) { sumEff+=r.effectiveTimeSec; countEff++; }
                if(!isNaN(r.ratio)) { sumRat+=r.ratio; countRat++; }
                if(!isNaN(r.fouls)) { sumFouls+=r.fouls; countFouls++; }
            });

            if(countMatches > 0) {
                 const avgTot = countTot > 0 ? sumTot / countTot : 0;
                 const avgEff = countEff > 0 ? sumEff / countEff : 0;
                 const avgRat = countRat > 0 ? sumRat / countRat : 0;
                 const avgFouls = countFouls > 0 ? sumFouls / countFouls : 0;
                
                 // Container per il pulsante "Carica altro" PRIMA della riga medie
                 const loadMoreRow = document.createElement('tr');
                 loadMoreRow.innerHTML = `<td colspan="6" class="p-3 text-center" id="loadMoreContainer"></td>`;
                 tfoot.appendChild(loadMoreRow);

                 tfoot.innerHTML += `<tr class="avg-row">
                    <td class="sticky-col">MEDIE (${countMatches} partite)</td>
                    <td class="text-center">-</td>
                    <td class="text-center font-mono text-blue-300">${formatSecondsToTime(avgTot)}</td>
                    <td class="text-center font-mono text-green-300">${formatSecondsToTime(avgEff)}</td>
                    <td class="text-center font-mono text-yellow-300">${avgRat.toFixed(1)}%</td>
                    <td class="text-center text-white">${avgFouls.toFixed(1)}</td>
                 </tr>`;
            } else {
                 // Container per il pulsante "Carica altro"
                tfoot.innerHTML += `<tr><td colspan="6" class="p-3 text-center" id="loadMoreContainer"></td></tr>`;
            }

        }

        function updateKPIDashboard(data) {
            const container = document.getElementById('kpi-dashboard');
            
            if (currentView === 'teams' || currentView === 'analytics') {
                container.classList.add('opacity-0', 'h-0', 'overflow-hidden');
                container.classList.remove('h-auto', 'opacity-100');
                return;
            } else {
                container.classList.remove('opacity-0', 'h-0', 'overflow-hidden');
                container.classList.add('h-auto', 'opacity-100');
            }

            const v1 = document.getElementById('kpi-value-1'); const v2 = document.getElementById('kpi-value-2'); const v3 = document.getElementById('kpi-value-3'); const v4 = document.getElementById('kpi-value-4');
            const l1 = document.getElementById('kpi-label-1'); const l2 = document.getElementById('kpi-label-2'); const l3 = document.getElementById('kpi-label-3'); const l4 = document.getElementById('kpi-label-4');
            if(!v1) return; const count = data.length;

            if (currentView === 'stats') {
                let tM=0, tF=0, tY=0, tR=0; data.forEach(r => { tM+=r.matches; tF+=r.avgFouls*r.matches; tY+=r.yellows; tR+=r.reds; });
                l1.innerText = "Arbitri"; v1.innerText = count; l2.innerText = "Falli P/P"; v2.innerText = tM ? (tF/tM).toFixed(2) : '-'; l3.innerText = "Gialli / P"; v3.innerText = tM ? (tY/tM).toFixed(2) : '-'; l4.innerText = "Rossi / P"; v4.innerText = tM ? (tR/tM).toFixed(2) : '-';
            } else if (currentView === 'playingTime') {
                let tEff=0, cEff=0, tTot=0, cTot=0; data.forEach(r => { if(r.avgEffSec){ tEff+=r.avgEffSec; cEff++; } if(r.avgTotSec){ tTot+=r.avgTotSec; cTot++; } });
                l1.innerText = "Arbitri"; v1.innerText = count; l2.innerText = "Partite"; v2.innerText = data.reduce((a,b)=>a+b.matches,0); l3.innerText = "Media T.E."; v3.innerText = cEff ? formatSecondsToTime(tEff/cEff) : '-'; l4.innerText = "Media Tot"; v4.innerText = cTot ? formatSecondsToTime(tTot/cTot) : '-';
            } else if (currentView === 'matches') {
                const matchData = matchesDataAll;
                let tM=matchData.length, sumTot=0, countTot=0, sumEff=0, countEff=0, sumFouls=0;
                matchData.forEach(r => { 
                    if (!isNaN(r.totalTimeSec)) { sumTot += r.totalTimeSec; countTot++; }
                    if (!isNaN(r.effectiveTimeSec)) { sumEff += r.effectiveTimeSec; countEff++; }
                    sumFouls += r.fouls; 
                });
                
                // Card order: Partite -> Tempo Tot -> Tempo Eff -> Falli/P
                l1.innerText = "Partite Tot"; v1.innerText = tM;
                l2.innerText = "Tempo Tot Medio"; v2.innerText = countTot ? formatSecondsToTime(sumTot/countTot) : '-';
                l3.innerText = "Tempo Eff Medio"; v3.innerText = countEff ? formatSecondsToTime(sumEff/countEff) : '-';
                l4.innerText = "Falli / P"; v4.innerText = tM ? (sumFouls/tM).toFixed(2) : '-';
            }
        }

        function toggleDetails(i) {
            const row = document.getElementById(`details-${i}`);
            const icon = document.getElementById(`icon-${i}`);
            if(row.classList.contains('hidden')) { row.classList.remove('hidden'); icon.classList.replace('fa-chevron-down', 'fa-chevron-up'); }
            else { row.classList.add('hidden'); icon.classList.replace('fa-chevron-up', 'fa-chevron-down'); }
        }

        function handleSort(col) {
            if (currentView === 'matches') resetMatchesPaging();

            if (sortColumn === col) sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            else { sortColumn = col; sortDirection = 'desc'; }

            // Nuovi default di ordinamento per la scheda teams dopo la rimozione di contactIndex
            if(currentView === 'teams' && col === 'name') sortDirection = 'asc';
            if(currentView === 'teams' && col === 'matches') sortDirection = 'desc';

            aggregateData();
        }

        function switchView(view) {
            // CORREZIONE BUG: Resetta la selezione delle stagioni a '2025-26' ad ogni cambio di vista
            if (currentView !== view) {
                activeSeasons = ['2025-26'];
                // Reset analytics filter to avoid confusing behavior on switch
                analyticsMinMatchesFilter = 0;
                const analyticsMinMatchesEl = document.getElementById('analyticsMinMatches');
                if(analyticsMinMatchesEl) analyticsMinMatchesEl.value = 0;
                const analyticsMinMatchesValueEl = document.getElementById('analyticsMinMatchesValue');
                if(analyticsMinMatchesValueEl) analyticsMinMatchesValueEl.innerText = 0;
            }
            
            currentView = view;


    // â­â­â­ RESET DEI FILTRI PRESENZE QUANDO CAMBIO SCHEDA
    minMatchesFilterStats = 0;
    minMatchesFilterPT = 0;

    if (document.getElementById('minMatches')) {
        document.getElementById('minMatches').value = 0;
    }
    if (document.getElementById('minMatchesValue')) {
        document.getElementById('minMatchesValue').innerText = 0;
    }
    // â­â­â­ FINE RESET

            resetMatchesPaging(); 

            // Update Active State (Desktop)
            ['nav-stats', 'nav-analytics', 'nav-time', 'nav-matches', 'nav-teams', 'nav-players'].forEach(id => {
                const el = document.getElementById(id);
                if(el) {
                    if(id === `nav-${view === 'playingTime' ? 'time' : view}`) el.classList.add('active');
                    else el.classList.remove('active');
                }
            });
            // Mobile State
             ['mob-nav-stats', 'mob-nav-analytics', 'mob-nav-time', 'mob-nav-matches', 'mob-nav-teams', 'mob-nav-players'].forEach(id => {
                 const el = document.getElementById(id);
                 if(el) {
                     if(id === `mob-nav-${view === 'playingTime' ? 'time' : view}`) {
                         el.classList.add('text-yellow-500', 'bg-slate-700'); el.classList.remove('text-slate-400');
                     } else {
                         el.classList.remove('text-yellow-500', 'bg-slate-700'); el.classList.add('text-slate-400');
                     }
                 }
            });

const searchInput   = document.getElementById('searchInput');
const tableView     = document.getElementById('table-view');
const analyticsView = document.getElementById('analytics-view');
const playersView   = document.getElementById('players-view');
const sidebar       = document.getElementById('sidebar-filters');
const mainContent   = document.getElementById('main-content');
const seasonCard    = document.getElementById('season-selector-card');

        if (view === 'analytics') {
            if (tableView)     tableView.classList.add('hidden');
            if (analyticsView) analyticsView.classList.remove('hidden');
            if (playersView)   playersView.classList.add('hidden');
            if (sidebar)       sidebar.classList.remove('hidden');
    if (seasonCard)    seasonCard.classList.add('hidden');
    if (mainContent) {
        mainContent.classList.remove('lg:col-span-12');
        mainContent.classList.add('lg:col-span-9');
    }
            if (analyticsActiveTab === 'giocatori') renderPlayerScatterChart();
            else renderAnalyticsWithFilters();
        } else if (view === 'players') {
            if (tableView)     tableView.classList.add('hidden');
            if (analyticsView) analyticsView.classList.add('hidden');
            if (playersView)   playersView.classList.remove('hidden');
    if (sidebar)       sidebar.classList.add('hidden');
    if (seasonCard)    seasonCard.classList.add('hidden');
    if (mainContent) {
        mainContent.classList.remove('lg:col-span-9');
        mainContent.classList.add('lg:col-span-12');
    }


    // renderizza / aggiorna la tabella giocatori
    initPlayersFilters();
    renderPlayersTable();
} else {

    // stats, matches, playingTime, teams
    if (tableView)     tableView.classList.remove('hidden');
    if (analyticsView) analyticsView.classList.add('hidden');
    if (playersView)   playersView.classList.add('hidden');
    if (sidebar)       sidebar.classList.remove('hidden');
    if (seasonCard)    seasonCard.classList.remove('hidden');
    if (mainContent) {
        mainContent.classList.remove('lg:col-span-12');
        mainContent.classList.add('lg:col-span-9');
    }
}
            // Update search placeholder based on view
            if(searchInput) {
                 if(view === 'teams') searchInput.placeholder = 'Cerca squadra...';
                 else if(view === 'matches') searchInput.placeholder = 'Cerca squadra o partita...';
                 else searchInput.placeholder = 'Cerca arbitro...';
                 searchInput.value = '';
            }

            // Set default sort columns
            if(view === 'stats' || view === 'analytics') { sortColumn = 'matches'; sortDirection = 'desc'; }
            if(view === 'playingTime') { sortColumn = 'avgEffSec'; sortDirection = 'desc'; }
            if(view === 'matches') { sortColumn = 'match'; sortDirection = 'asc'; }
            if(view === 'teams') { sortColumn = 'matches'; sortDirection = 'desc'; } // Nuovo default per squadre

            updateSeasonButtonsUI(); 
            aggregateData(); // Non debouncato per il cambio scheda, deve essere immediato
        }

        function toggleSeason(s) {
            resetMatchesPaging();

            // Blocco le stagioni SOON solo se la vista attuale Ã¨ una di quelle con il blocco attivo
            const viewsToBlockSoon = ['playingTime', 'matches', 'teams']; 
            const isBlockedView = viewsToBlockSoon.includes(currentView);
            const isSoonSeason = SOON_SEASONS.includes(s);

            if (isBlockedView && isSoonSeason && s !== '2024-25' && !activeSeasons.includes(s)) {
                // Previene la selezione di stagioni SOON che non sono 2024-25 in viste bloccate
                return;
            }

            if(activeSeasons.includes(s)) activeSeasons = activeSeasons.filter(x => x !== s);
            else activeSeasons.push(s);
            updateSeasonButtonsUI();
            aggregateData();
        }

        function toggleAllSeasons() {
            resetMatchesPaging();
            
            const all = ['2025-26', '2024-25']; 
            activeSeasons = activeSeasons.length === all.length ? [] : [...all];
            updateSeasonButtonsUI();
            aggregateData();
        }

        function updateSeasonButtonsUI() {
            const allSeasons = ['2025-26', '2024-25', '2023-24', '2022-23', '2021-22', '2020-21'];
            // Viste in cui i dati storici sono "SOON" e quindi disabilitati (a meno che non siano stats/analytics)
            const viewsToBlockSoon = ['playingTime', 'matches', 'teams']; 
            const isBlockedView = viewsToBlockSoon.includes(currentView);

            allSeasons.forEach(s => {
                const btn = document.getElementById(`btn-${s}`);
                if(!btn) return;
                const icon = btn.querySelector('.check-icon');
                const soonLabel = btn.querySelector('.coming-soon-label');
                const isSoonSeason = SOON_SEASONS.includes(s);
                const is2425 = s === '2024-25';
                const isSelected = activeSeasons.includes(s); 

                // Gestione VisibilitÃ  SOON
                if (isSoonSeason && soonLabel) {
                    if (isBlockedView) {
                         // CORREZIONE 2: Rende la label visibile con opacitÃ  ridotta, ma non 'hidden'
                         soonLabel.style.display = 'inline-block';
                         soonLabel.style.opacity = '0.9';
                    } else {
                         soonLabel.style.display = 'none';
                    }
                } else {
                    if (soonLabel) soonLabel.style.display = 'none'; 
                }
                
                // Gestione Disabilitazione / OpacitÃ 
                const shouldBeBlocked = isBlockedView && isSoonSeason && !is2425;

                if (shouldBeBlocked) {
                    btn.disabled = true;
                    // Rimuovo l'opacitÃ  dal pulsante stesso per non oscurare troppo la label SOON
                    btn.classList.add('cursor-not-allowed', 'text-slate-500'); 
                    btn.classList.remove('opacity-40', 'text-slate-400', 'text-white', 'text-yellow-500');
                    if(icon) icon.classList.add('opacity-0');
                } else {
                    // SBLOCCA: Rimuovi disabilitazione e opacitÃ 
                    btn.disabled = false;
                    btn.classList.remove('opacity-40', 'cursor-not-allowed', 'text-slate-500');
                }

                // Gestione Active State e Spunta Gialla
                if(isSelected) {
                    btn.classList.add('active');
                    // La spunta deve essere visibile solo se selezionata
                    if(icon) {
                        icon.classList.remove('opacity-0');
                        icon.classList.add('opacity-100');
                    }
                } else {
                    btn.classList.remove('active');
                    // La spunta deve essere invisibile se non selezionata
                    if(icon) {
                        icon.classList.remove('opacity-100');
                        icon.classList.add('opacity-0');
                    }
                }
            });
        }

        function toggleAnalyticsSeason(chartKey, season) {
            if (!analyticsSeasonFilters[chartKey]) return;

            const current = new Set(analyticsSeasonFilters[chartKey]);

            if (current.has(season) && current.size > 1) {
                current.delete(season);
            } else {
                current.add(season);
            }

            analyticsSeasonFilters[chartKey] = Array.from(current);
            updateAnalyticsSeasonChipsUI(chartKey);
            renderAnalyticsWithFilters();
        }

        function updateAnalyticsSeasonChipsUI(chartKey) {
            const activeSet = new Set(analyticsSeasonFilters[chartKey] || []);
            const container = document.getElementById(`season-toggle-${chartKey}`);
            if (!container) return;

            container.querySelectorAll('.analytics-season-chip').forEach(btn => {
                const btnSeason = btn.getAttribute('data-season');
                if (activeSet.has(btnSeason)) btn.classList.add('active');
                else btn.classList.remove('active');
            });
        }

        function refreshAllAnalyticsSeasonChips() {
            Object.keys(analyticsSeasonFilters).forEach(updateAnalyticsSeasonChipsUI);
        }

        function switchAnalyticsTab(tab) {
            if (!['arbitri', 'giocatori'].includes(tab)) return;

            analyticsActiveTab = tab;

            const arbitriTab = document.getElementById('analytics-tab-arbitri');
            const playersTab = document.getElementById('analytics-tab-giocatori');

            if (arbitriTab) arbitriTab.classList.toggle('hidden', tab !== 'arbitri');
            if (playersTab) playersTab.classList.toggle('hidden', tab !== 'giocatori');

            document.querySelectorAll('.analytics-subtab-btn').forEach((btn) => {
                const isActive = btn.getAttribute('data-tab') === tab;

                btn.classList.toggle('bg-yellow-500', isActive);
                btn.classList.toggle('text-slate-900', isActive);
                btn.classList.toggle('shadow-glow', isActive);
                btn.classList.toggle('text-slate-200', !isActive);
            });

            if (tab === 'giocatori') renderPlayerScatterChart();
            else renderAnalyticsWithFilters();
        }

        function toggleSeasonDropdown() {
            const c = document.getElementById('season-dropdown-content');
            const i = document.getElementById('season-toggle-icon');
            if(c.classList.contains('hidden')) { c.classList.remove('hidden'); i.style.transform = 'rotate(180deg)'; }

            else { c.classList.add('hidden'); i.style.transform = 'rotate(0deg)'; }
        }

function updateMinMatches(val) {
    if (currentView === 'stats') {
        minMatchesFilterStats = parseInt(val);
    } else if (currentView === 'playingTime') {
        minMatchesFilterPT = parseInt(val);
    }

    document.getElementById('minMatchesValue').innerText = val;
    document.getElementById('minMatches').value = val;
document.getElementById("players-view").classList.add("hidden");


    debounceAggregate();
}

function getPlayerStatsForMode(player) {
    const presence = Number.isFinite(player.n90) ? player.n90 : 0;
    const roundTotal = (val) => Number.isFinite(val) ? Math.round(val * presence) : 0;

    const per90Stats = {
        n90: presence,
        yellow: player.yellow ?? 0,
        fouls: player.fouls ?? 0,
        fouled: player.fouled ?? 0,
        crosses: player.crosses ?? 0,
        passCompleted: player.passCompleted,
        passAttempted: player.passAttempted,
        passPct: player.passPct,
        shotsTotal: player.shotsTotal,
        shotsOnTarget: player.shotsOnTarget,
        shotsPer90: player.shotsPer90,
        shotsOnTargetPer90: player.shotsOnTargetPer90,
    };

    const totals = {
        ...per90Stats,
        yellow: roundTotal(player.yellow),
        fouls: roundTotal(player.fouls),
        fouled: roundTotal(player.fouled),
        crosses: roundTotal(player.crosses),
        passCompleted: roundTotal(player.passCompleted),
        passAttempted: roundTotal(player.passAttempted),
        shotsPer90: roundTotal(player.shotsPer90),
        shotsOnTargetPer90: roundTotal(player.shotsOnTargetPer90),
    };
    return playersStatMode === 'total' ? totals : per90Stats;
}

function updatePlayersModeToggleUI() {
    document.querySelectorAll('[data-mode]').forEach((btn) => {
        const isActive = btn.getAttribute('data-mode') === playersStatMode;
        btn.classList.toggle('bg-yellow-500/10', isActive);
        btn.classList.toggle('border-yellow-500', isActive);
        btn.classList.toggle('text-yellow-400', isActive);
    });

    document.querySelectorAll('#players-table thead .players-col-label').forEach((labelEl) => {
        const per90 = labelEl.getAttribute('data-label-per90');
        const total = labelEl.getAttribute('data-label-total');
        if (per90 && total) {
            labelEl.textContent = playersStatMode === 'total' ? total : per90;
        }
    });
}

function setPlayersStatMode(mode) {
    if (!['per90', 'total'].includes(mode)) return;
    playersStatMode = mode;
    updatePlayersModeToggleUI();
    renderPlayersTable();
    renderPlayerComparisonTable();
}

function renderPlayersTable() {
    const q = (document.getElementById("players-search")?.value || "").toLowerCase();
    const tbody = document.getElementById("players-table-body");
    if (!tbody) return;
    tbody.innerHTML = "";

    const filtered = playersData
        .filter(p => p.name.toLowerCase().includes(q))
        .filter(p => p.n90 >= playersMinMatches)
        .filter(p => !excludeLowPresencePlayers || playersMaxMatches === 0 || p.n90 >= playersMaxMatches * 0.3)
        .filter(p => {
            const playerRoles = (p.role || '')
                .split(',')
                .map(r => r.trim())
                .filter(Boolean);
            const matchesRole = selectedPlayerRoles.size === 0
                ? true
                : playerRoles.some(r => selectedPlayerRoles.has(r));
            const matchesTeam = selectedTeams.has('all') || selectedTeams.size === 0
                ? true
                : selectedTeams.has((p.team || '').toLowerCase());

            return matchesRole && matchesTeam;
        });

    const sorted = [...filtered].sort((a, b) => {
        const valA = getPlayersSortValue(a, playersSortColumn);
        const valB = getPlayersSortValue(b, playersSortColumn);

        if (typeof valA === 'string' || typeof valB === 'string') {
            const comparison = String(valA).localeCompare(String(valB), 'it', { sensitivity: 'base' });
            return playersSortDirection === 'asc' ? comparison : -comparison;
        }

        const comparison = valA - valB;
        return playersSortDirection === 'asc' ? comparison : -comparison;
    });

    sorted.forEach((p, index) => {
        const tr = document.createElement("tr");
        const stats = getPlayerStatsForMode(p);
        const rateDigits = playersStatMode === 'total' ? 0 : 2;
        const volumeDigits = playersStatMode === 'total' ? 0 : 1;
        const passPct = Number.isFinite(stats.passPct)
            ? `${stats.passPct.toFixed(1).replace('.', ',')}%`
            : '-';

        tr.title = p.team ? `Squadra: ${p.team}` : 'Squadra non disponibile';
        tr.innerHTML = `
            <td class="p-2 font-mono text-xs text-slate-400">${index + 1}</td>
            <td class="p-2 text-left whitespace-nowrap">${formatPlayerName(p.name)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.n90, 1)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.yellow, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.fouls, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.fouled, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.crosses, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.passCompleted, volumeDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.passAttempted, volumeDigits)}</td>
            <td class="p-2 whitespace-nowrap">${passPct}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.shotsPer90, rateDigits)}</td>
            <td class="p-2 whitespace-nowrap">${formatPassingValue(stats.shotsOnTargetPer90, rateDigits)}</td>
        `;
        tbody.appendChild(tr);
    });

    updatePlayersSortUI();
}

function getPlayersSortValue(player, column) {
    const stats = getPlayerStatsForMode(player);
    switch (column) {
        case 'name':
            return extractSurname(player.name) || '';
        case 'role':
            return (player.role || '').toLowerCase();
        case 'team':
            return (player.team || '').toLowerCase();
        case 'n90':
            return stats.n90 || 0;
        case 'yellow':
            return stats.yellow || 0;
        case 'fouls':
            return stats.fouls || 0;
        case 'fouled':
            return stats.fouled || 0;
        case 'crosses':
            return stats.crosses || 0;
        case 'passCompleted':
            return Number.isFinite(stats.passCompleted) ? stats.passCompleted : 0;
        case 'passAttempted':
            return Number.isFinite(stats.passAttempted) ? stats.passAttempted : 0;
        case 'passPct':
            return Number.isFinite(stats.passPct) ? stats.passPct : 0;
        case 'shotsPer90':
            return Number.isFinite(stats.shotsPer90) ? stats.shotsPer90 : 0;
        case 'shotsOnTargetPer90':
            return Number.isFinite(stats.shotsOnTargetPer90) ? stats.shotsOnTargetPer90 : 0;
        default:
            return 0;
    }
}

function handlePlayersSort(column) {
    if (playersSortColumn === column) {
        playersSortDirection = playersSortDirection === 'asc' ? 'desc' : 'asc';
    } else {
        playersSortColumn = column;
        playersSortDirection = column === 'name' ? 'asc' : 'desc';
    }

    renderPlayersTable();
}

function updatePlayersSortUI() {
    document.querySelectorAll('#players-table thead th[data-sort-col]').forEach(th => {
        const icon = th.querySelector('.players-sort-icon');
        const isActive = th.dataset.sortCol === playersSortColumn;

        th.classList.toggle('text-yellow-400', isActive);

        if (!icon) return;

        if (isActive) icon.textContent = playersSortDirection === 'asc' ? 'â†‘' : 'â†“';
        else icon.textContent = '';
    });
}

function populatePlayersComparisonOptions() {
    const datalist = document.getElementById('players-compare-options');
    if (!datalist) return;

    const options = playersData
        .map((p) => `<option value="${p.name}"></option>`)
        .join('');

    datalist.innerHTML = options;
}

function handlePlayerComparisonInput(slot, value) {
    const sanitized = (value || '').trim();
    if (slot === 1) playerComparisonSelections.first = sanitized;
    else if (slot === 2) playerComparisonSelections.second = sanitized;

    renderPlayerComparisonTable();
}

function findPlayerByName(name) {
    if (!name) return null;
    const key = normalizePlayerKey(name);
    return playersData.find((p) => normalizePlayerKey(p.name) === key) || null;
}

function buildComparisonRow(label, rawA, rawB, formatter) {
    const displayA = formatter(rawA);
    const displayB = formatter(rawB);

    const isNumA = Number.isFinite(rawA);
    const isNumB = Number.isFinite(rawB);
    const highlightA = isNumA && (!isNumB || rawA > rawB);
    const highlightB = isNumB && (!isNumA || rawB > rawA);

    const cellA = highlightA ? `<span class="font-bold text-white">${displayA}</span>` : displayA;
    const cellB = highlightB ? `<span class="font-bold text-white">${displayB}</span>` : displayB;

    return `
        <tr class="border-t border-slate-800">
            <th class="p-2 text-left text-slate-400 font-semibold">${label}</th>
            <td class="p-2 text-center font-mono text-slate-200">${cellA}</td>
            <td class="p-2 text-center font-mono text-slate-200">${cellB}</td>
        </tr>
    `;
}

function renderPlayerComparisonTable() {
    const table = document.getElementById('players-comparison-table');
    if (!table) return;

    const playerA = findPlayerByName(playerComparisonSelections.first);
    const playerB = findPlayerByName(playerComparisonSelections.second);

    if (!playerA && !playerB) {
        table.innerHTML = `<tbody><tr><td class="p-3 text-center text-slate-500" colspan="3">Seleziona due giocatori per confrontare le statistiche.</td></tr></tbody>`;
        return;
    }

    const statsA = playerA ? getPlayerStatsForMode(playerA) : null;
    const statsB = playerB ? getPlayerStatsForMode(playerB) : null;
    const rateDigits = playersStatMode === 'total' ? 0 : 2;
    const volumeDigits = playersStatMode === 'total' ? 0 : 1;
    const presenceDigits = playersStatMode === 'total' ? 0 : 1;

    const formatPercent = (value) => Number.isFinite(value) ? `${value.toFixed(1).replace('.', ',')}%` : '-';

    const rows = [
        buildComparisonRow("Presenze (90')", statsA?.n90, statsB?.n90, (v) => formatPassingValue(v, presenceDigits)),
        buildComparisonRow('Gialli', statsA?.yellow, statsB?.yellow, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('Falli Commessi', statsA?.fouls, statsB?.fouls, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('Falli Subiti', statsA?.fouled, statsB?.fouled, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('Cross', statsA?.crosses, statsB?.crosses, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('PassC', statsA?.passCompleted, statsB?.passCompleted, (v) => formatPassingValue(v, volumeDigits)),
        buildComparisonRow('PassT', statsA?.passAttempted, statsB?.passAttempted, (v) => formatPassingValue(v, volumeDigits)),
        buildComparisonRow('% Pass', statsA?.passPct, statsB?.passPct, formatPercent),
        buildComparisonRow('Tiri', statsA?.shotsPer90, statsB?.shotsPer90, (v) => formatPassingValue(v, rateDigits)),
        buildComparisonRow('Tiri in Porta', statsA?.shotsOnTargetPer90, statsB?.shotsOnTargetPer90, (v) => formatPassingValue(v, rateDigits)),
    ];

    const headerA = playerA ? formatPlayerName(playerA.name) : 'â€”';
    const headerB = playerB ? formatPlayerName(playerB.name) : 'â€”';

    table.innerHTML = `
        <thead class="bg-slate-900/60 border-b border-slate-800">
            <tr>
                <th class="p-2 text-left text-slate-400">STATS</th>
                <th class="p-2 text-center text-white">${headerA}</th>
                <th class="p-2 text-center text-white">${headerB}</th>
            </tr>
        </thead>
        <tbody>${rows.join('')}</tbody>
    `;
}

function normalizePlayerKey(name) {
    return (name || '')
        .normalize('NFD')
        .replace(/\p{Diacritic}/gu, '')
        .toLowerCase()
        .replace(/\s+/g, ' ')
        .trim();
}

// Converte la stringa TSV dei giocatori in un array di oggetti
function parsePlayersDB(raw) {
    if (!raw) return [];

    const toNumber = (val) => {
        const normalized = (val || '').replace(',', '.');
        const parsed = parseFloat(normalized);
        return Number.isFinite(parsed) ? parsed : 0;
    };

    const parseLine = (line) => {
        const tabParts = line.split('\t');

        let name = '';
        let role = '';
        let team = '';
        let statsTokens = [];

        if (tabParts.length >= 8) {
            [name, role, team, ...statsTokens] = tabParts.slice(0, 8);
        } else {
            const trimmed = line.trim();
            const numberMatches = Array.from(trimmed.matchAll(/(\d+,\d{1,2})/g));

            if (numberMatches.length < 5) return null;

            const statsMatches = numberMatches.slice(-5);
            statsTokens = statsMatches.map((m) => m[1]);

            const firstStatIndex = statsMatches[0]?.index ?? trimmed.length;
            const prefix = trimmed.slice(0, firstStatIndex).trim();

            const nameRoleTeamMatch = prefix.match(/^(?<name>.+?)(?<role>[A-Z]{2,3}(?:,[A-Z]{2,3})*)(?<team>[A-ZÃ€-Ã¿][A-Za-zÃ€-Ã¿'\.\s-]*)$/);
            if (!nameRoleTeamMatch || !nameRoleTeamMatch.groups) return null;

            name = (nameRoleTeamMatch.groups.name || '').trim();
            role = (nameRoleTeamMatch.groups.role || '').trim();
            team = (nameRoleTeamMatch.groups.team || '').trim();
        }

        if (statsTokens.length < 5) return null;

        return {
            name,
            role,
            team,
            n90:     toNumber(statsTokens[0]),
            yellow:  toNumber(statsTokens[1]),
            fouls:   toNumber(statsTokens[2]),
            fouled:  toNumber(statsTokens[3]),
            crosses: toNumber(statsTokens[4])
        };
    };
    return raw
        .trim()
        .split('\n')
        .map(parseLine)
        .filter(Boolean);
}

// Parsing per il dataset Passaggi/Tiri giocatori
function parsePlayersPassing(raw) {
    if (!raw) return [];

    const toNumber = (val) => {
        const normalized = String(val || '').replace('%', '').replace(',', '.');
        const parsed = parseFloat(normalized);
        return Number.isFinite(parsed) ? parsed : 0;
    };

    const numberPattern = /(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)%?\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)\s+(\d+(?:[.,]\d+)?)/;

    return raw
        .trim()
        .split('\n')
        .map((line) => {
            const trimmed = line.trim();
            if (!trimmed || trimmed.toLowerCase().startsWith('player pass')) return null;

            const match = trimmed.match(numberPattern);
            if (!match) return null;

            const name = trimmed.slice(0, match.index).trim();
            if (!name) return null;

            const [_, passesCompleted, passesAttempted, passPct, shotsTotal, shotsOnTarget, shotsPer90, shotsOnTargetPer90, avgShotDistance] = match;

            return {
                name,
                passesCompleted: toNumber(passesCompleted),
                passesAttempted: toNumber(passesAttempted),
                passPct: toNumber(passPct),
                shotsTotal: toNumber(shotsTotal),
                shotsOnTarget: toNumber(shotsOnTarget),
                shotsPer90: toNumber(shotsPer90),
                shotsOnTargetPer90: toNumber(shotsOnTargetPer90),
                avgShotDistance: toNumber(avgShotDistance)
            };
        })
        .filter(Boolean);
}

function buildPlayersPassingIndex() {
    playersPassingIndex = new Map(
        playersPassingData.map((p) => [normalizePlayerKey(p.name), p])
    );

    playersData = playersData.map((player) => {
        const passing = playersPassingIndex.get(normalizePlayerKey(player.name)) || {};
        const toNullableNumber = (val) => (Number.isFinite(val) ? val : null);

        return {
            ...player,
            passCompleted: toNullableNumber(passing.passesCompleted),
            passAttempted: toNullableNumber(passing.passesAttempted),
            passPct: toNullableNumber(passing.passPct),
            shotsTotal: toNullableNumber(passing.shotsTotal),
            shotsOnTarget: toNullableNumber(passing.shotsOnTarget),
            shotsPer90: toNullableNumber(passing.shotsPer90),
            shotsOnTargetPer90: toNullableNumber(passing.shotsOnTargetPer90),
            avgShotDistance: toNullableNumber(passing.avgShotDistance),
        };
    });
}

// Sovrascriviamo playersData con lâ€™array parsato
playersData = parsePlayersDB(playersRawData);
playersPassingData = parsePlayersPassing(playersPassingRawData);
buildPlayersPassingIndex();
initPlayersFilters();
populatePlayersComparisonOptions();
renderPlayerComparisonTable();
updatePlayerScatterRoleUI();
function extractSurname(fullName) {
    const parts = (fullName || '').trim().split(/\s+/);
    return parts.length ? parts[parts.length - 1].toLowerCase() : '';
}

function updatePlayersMinMatches(val) {
    const parsed = parseFloat(val);
    playersMinMatches = Number.isFinite(parsed) ? parsed : 0;

    const label = document.getElementById('playersMinMatchesValue');
    if (label) label.innerText = playersMinMatches;

    renderPlayersTable();
}

function updatePresenceThresholdButton() {
    const btn = document.getElementById('players-presence-threshold');
    if (!btn) return;

    const threshold = playersMaxMatches ? playersMaxMatches * 0.3 : 0;
    const thresholdLabel = threshold ? threshold.toFixed(1).replace('.', ',') : '0';

    btn.textContent = excludeLowPresencePlayers
        ? `Esclusi i giocatori sotto ${thresholdLabel} presenze (30%)`
        : 'Escludi chi Ã¨ sotto il 30% delle presenze';

    btn.classList.toggle('border-yellow-500', excludeLowPresencePlayers);
    btn.classList.toggle('text-yellow-400', excludeLowPresencePlayers);
    btn.classList.toggle('bg-yellow-500/10', excludeLowPresencePlayers);
}

function toggleLowPresenceExclusion() {
    excludeLowPresencePlayers = !excludeLowPresencePlayers;
    updatePresenceThresholdButton();
    renderPlayersTable();
}

function initPlayersFilters() {
    const slider = document.getElementById('playersMinMatches');
    const label = document.getElementById('playersMinMatchesValue');
    const teamOptionsContainer = document.getElementById('players-team-options');

    if (slider) {
        playersMaxMatches = playersData.length ? Math.max(...playersData.map(p => p.n90)) : 0;
        slider.max = Math.max(10, Math.ceil(playersMaxMatches));
        slider.value = playersMinMatches;
    }

    if (label) label.innerText = playersMinMatches;

    updatePresenceThresholdButton();

    playerTeams = Array.from(new Set(playersData
        .map(p => (p.team || '').trim())
        .filter(Boolean)))
        .sort((a, b) => a.localeCompare(b, 'it', { sensitivity: 'base' }));

    if (teamOptionsContainer) renderPlayersTeamOptions();

    PLAYER_ROLES.forEach(role => {
        const cb = document.getElementById(`role-filter-${role.toLowerCase()}`);
        if (cb) cb.checked = selectedPlayerRoles.has(role);
    });

    updatePlayersModeToggleUI();
}

function renderPlayersTeamOptions() {
    const container = document.getElementById('players-team-options');
    if (!container) return;

    const teams = ['all', ...playerTeams];
    const optionHtml = teams.map((team) => {
        const value = team === 'all' ? 'all' : team.toLowerCase();
        const isChecked = selectedTeams.has('all') ? team === 'all' : selectedTeams.has(value);
        const label = team === 'all' ? 'Tutte le squadre' : team;

        return `
            <label class="flex items-center gap-2 px-3 py-2 text-sm text-slate-200 hover:bg-slate-800 cursor-pointer">
                <input type="checkbox" class="rounded border-slate-700 bg-slate-900 text-yellow-400 focus:ring-yellow-400" value="${value}" ${isChecked ? 'checked' : ''} onchange="handlePlayersTeamCheckbox(this)">
                <span>${label}</span>
            </label>
        `;
    }).join('');

    container.innerHTML = optionHtml;
    updatePlayersTeamTriggerLabel();
}

function updatePlayersTeamTriggerLabel() {
    const triggerLabel = document.getElementById('players-team-trigger-label');
    if (!triggerLabel) return;

    if (selectedTeams.has('all') || selectedTeams.size === 0) {
        triggerLabel.textContent = 'Tutte le squadre';
        return;
    }

    const selectedLabels = playerTeams
        .filter(team => selectedTeams.has(team.toLowerCase()))
        .slice(0, 3);

    const moreCount = selectedTeams.size - selectedLabels.length;
    const baseLabel = selectedLabels.join(', ');
    triggerLabel.textContent = moreCount > 0
        ? `${baseLabel} +${moreCount}`
        : baseLabel || 'Tutte le squadre';
}

function handlePlayersTeamCheckbox(checkbox) {
    if (!checkbox) return;
    const value = (checkbox.value || '').toLowerCase();

    if (value === 'all') {
        selectedTeams = checkbox.checked ? new Set(['all']) : new Set();
    } else {
        if (checkbox.checked) {
            selectedTeams.delete('all');
            selectedTeams.add(value);
        } else {
            selectedTeams.delete(value);
        }

        if (selectedTeams.size === 0) selectedTeams.add('all');
    }

    syncPlayersTeamCheckboxes();
    updatePlayersTeamTriggerLabel();
    renderPlayersTable();
}

function syncPlayersTeamCheckboxes() {
    document.querySelectorAll('#players-team-options input[type="checkbox"]').forEach((input) => {
        const val = (input.value || '').toLowerCase();
        input.checked = selectedTeams.has('all') ? val === 'all' : selectedTeams.has(val);
    });
}

function togglePlayersTeamDropdown(forceState) {
    const dropdown = document.getElementById('players-team-dropdown');
    if (!dropdown) return;

    const shouldOpen = typeof forceState === 'boolean'
        ? forceState
        : dropdown.classList.contains('hidden');

    dropdown.classList.toggle('hidden', !shouldOpen);
}

function closePlayersTeamDropdown() {
    togglePlayersTeamDropdown(false);
}

document.addEventListener('click', (event) => {
    const container = document.getElementById('players-team-filter-container');
    if (!container) return;
    if (!container.contains(event.target)) closePlayersTeamDropdown();
});

function togglePlayerRole(role) {
    if (!PLAYER_ROLES.includes(role)) return;

    if (selectedPlayerRoles.has(role)) selectedPlayerRoles.delete(role);
    else selectedPlayerRoles.add(role);

    renderPlayersTable();
}

function formatPlayerName(fullName) {
    const parts = (fullName || '').trim().split(/\s+/);
    if (!parts.length) return '';

    const surnamePrefixes = new Set([
        'de', 'del', 'della', 'dello', 'dei', 'degli', 'delle',
        'di', 'da', 'dal', 'dalla', 'dall', 'dallo',
        'van', 'von', 'der', 'den',
        'dos', 'das', 'do', 'du',
        'le', 'la', 'lo',
        'mc', 'mac',
        "d'", "l'", "del'",
        'san', 'santa', 'st', 'saint'
    ]);

    let idx = parts.length - 1;
    const surnameParts = [parts[idx]];
    idx--;

    while (idx >= 0) {
        const lower = parts[idx].toLowerCase();
        if (surnamePrefixes.has(lower) || lower.endsWith("'")) {
            surnameParts.unshift(parts[idx]);
            idx--;
        } else {
            break;
        }
    }

    const givenNames = parts.slice(0, idx + 1).join(' ');

    return `<span class="font-bold">${surnameParts.join(' ')}</span>${givenNames ? ` ${givenNames}` : ''}`;
}

function formatPassingValue(val, digits = 2) {
    if (!Number.isFinite(val)) return '-';
    return val.toFixed(digits).replace('.', ',');
}

function renderPlayersPassingTable() {
    const tbody = document.getElementById('players-passing-body');
    if (!tbody) return;

    tbody.innerHTML = '';

    playersPassingData.forEach((p, index) => {
        const passPct = Number.isFinite(p.passPct)
            ? `${p.passPct.toFixed(1).replace('.', ',')}%`
            : '-';

        const row = `
            <tr>
                <td class="p-2 font-mono text-xs text-slate-400">${index + 1}</td>
                <td class="p-2 text-left">${formatPlayerName(p.name)}</td>
                <td class="p-2">${formatPassingValue(p.passesCompleted)}</td>
                <td class="p-2">${formatPassingValue(p.passesAttempted)}</td>
                <td class="p-2">${passPct}</td>
                <td class="p-2">${formatPassingValue(p.shotsTotal)}</td>
                <td class="p-2">${formatPassingValue(p.shotsOnTarget)}</td>
                <td class="p-2">${formatPassingValue(p.shotsPer90)}</td>
                <td class="p-2">${formatPassingValue(p.shotsOnTargetPer90)}</td>
                <td class="p-2">${formatPassingValue(p.avgShotDistance)}</td>
            </tr>`;

        tbody.insertAdjacentHTML('beforeend', row);
    });
}

        function toggleInactiveRefs() {
            hideInactive = document.getElementById('toggleInactive').checked;
            aggregateData();
        }
        
        function handleSearch() { debounceAggregate(); }
        function renderStatsInsights(data) {}
        function renderMatchesInsights(data) {}
        function toggleDesignationsModal(shouldOpen) {
            const modal = document.getElementById('designations-modal');
            if (shouldOpen) modal.classList.add('open');
            else modal.classList.remove('open');
        }
        function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }

        window.addEventListener('scroll', () => {
            const btn = document.getElementById('scroll-to-top');
            if (window.scrollY > 300) btn.setAttribute('data-visible', 'true');
            else btn.setAttribute('data-visible', 'false');
        });

// --- EVENTO CAMBIO METRICA HEATMAP ---
document.addEventListener('DOMContentLoaded', () => {
    const metricSelect = document.getElementById('heatmap-metric');
    if (!metricSelect) return;

    // valore iniziale
    currentHeatmapMetric = metricSelect.value || 'eff';

    metricSelect.addEventListener('change', () => {
        currentHeatmapMetric = metricSelect.value || 'eff';
        renderTeamHeatmap();
    });
});



        window.onload = function() {
            updateSeasonButtonsUI();
            refreshAllAnalyticsSeasonChips();
            switchView('stats');
updateRadarSelectOptions();
            if (window.innerWidth < 1024) document.getElementById('season-dropdown-content').classList.add('hidden');
        };
    </script>
</body>
</html>
